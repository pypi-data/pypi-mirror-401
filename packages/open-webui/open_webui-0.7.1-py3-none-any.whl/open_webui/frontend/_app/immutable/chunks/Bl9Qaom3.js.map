{"version":3,"file":"Bl9Qaom3.js","sources":["../../../../../../src/lib/apis/notes/index.ts"],"sourcesContent":["import { WEBUI_API_BASE_URL } from '$lib/constants';\nimport { getTimeRange } from '$lib/utils';\n\ntype NoteItem = {\n\ttitle: string;\n\tdata: object;\n\tmeta?: null | object;\n\taccess_control?: null | object;\n};\n\nexport const createNewNote = async (token: string, note: NoteItem) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/create`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\t...note\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getNotes = async (token: string = '', raw: boolean = false) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\tif (raw) {\n\t\treturn res; // Return raw response if requested\n\t}\n\n\tif (!Array.isArray(res)) {\n\t\treturn {}; // or throw new Error(\"Notes response is not an array\")\n\t}\n\n\t// Build the grouped object\n\tconst grouped: Record<string, any[]> = {};\n\tfor (const note of res) {\n\t\tconst timeRange = getTimeRange(note.updated_at / 1000000000);\n\t\tif (!grouped[timeRange]) {\n\t\t\tgrouped[timeRange] = [];\n\t\t}\n\t\tgrouped[timeRange].push({\n\t\t\t...note,\n\t\t\ttimeRange\n\t\t});\n\t}\n\n\treturn grouped;\n};\n\nexport const searchNotes = async (\n\ttoken: string = '',\n\tquery: string | null = null,\n\tviewOption: string | null = null,\n\tpermission: string | null = null,\n\tsortKey: string | null = null,\n\tpage: number | null = null\n) => {\n\tlet error = null;\n\tconst searchParams = new URLSearchParams();\n\n\tif (query !== null) {\n\t\tsearchParams.append('query', query);\n\t}\n\n\tif (viewOption !== null) {\n\t\tsearchParams.append('view_option', viewOption);\n\t}\n\n\tif (permission !== null) {\n\t\tsearchParams.append('permission', permission);\n\t}\n\n\tif (sortKey !== null) {\n\t\tsearchParams.append('order_by', sortKey);\n\t}\n\n\tif (page !== null) {\n\t\tsearchParams.append('page', `${page}`);\n\t}\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/search?${searchParams.toString()}`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getNoteList = async (token: string = '', page: number | null = null) => {\n\tlet error = null;\n\tconst searchParams = new URLSearchParams();\n\n\tif (page !== null) {\n\t\tsearchParams.append('page', `${page}`);\n\t}\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/?${searchParams.toString()}`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getNoteById = async (token: string, id: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/${id}`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateNoteById = async (token: string, id: string, note: NoteItem) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/${id}/update`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\t...note\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const deleteNoteById = async (token: string, id: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/${id}/delete`, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n"],"names":["createNewNote","token","note","error","res","WEBUI_API_BASE_URL","err","searchNotes","query","viewOption","permission","sortKey","page","searchParams","json","getNoteList","getNoteById","id","updateNoteById","deleteNoteById"],"mappings":"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"}