{"version":3,"file":"24.BK8orAbr.js","sources":["../../../../../../src/lib/components/notes/Notes.svelte","../../../../../../src/routes/(app)/notes/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { marked } from 'marked';\n\timport { toast } from 'svelte-sonner';\n\timport fileSaver from 'file-saver';\n\n\tconst { saveAs } = fileSaver;\n\n\timport dayjs from '$lib/dayjs';\n\timport duration from 'dayjs/plugin/duration';\n\timport relativeTime from 'dayjs/plugin/relativeTime';\n\n\tdayjs.extend(duration);\n\tdayjs.extend(relativeTime);\n\n\tasync function loadLocale(locales) {\n\t\tfor (const locale of locales) {\n\t\t\ttry {\n\t\t\t\tdayjs.locale(locale);\n\t\t\t\tbreak; // Stop after successfully loading the first available locale\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(`Could not load locale '${locale}':`, error);\n\t\t\t}\n\t\t}\n\t}\n\n\timport { onMount, getContext, onDestroy } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\t// Assuming $i18n.languages is an array of language codes\n\t$: loadLocale($i18n.languages);\n\n\timport { goto } from '$app/navigation';\n\timport { WEBUI_NAME, config, prompts as _prompts, user } from '$lib/stores';\n\timport { createNewNote, deleteNoteById, getNoteList, searchNotes } from '$lib/apis/notes';\n\timport { capitalizeFirstLetter, copyToClipboard, getTimeRange } from '$lib/utils';\n\timport { downloadPdf, createNoteHandler } from './utils';\n\n\timport EllipsisHorizontal from '../icons/EllipsisHorizontal.svelte';\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\n\timport Search from '../icons/Search.svelte';\n\timport Plus from '../icons/Plus.svelte';\n\timport ChevronRight from '../icons/ChevronRight.svelte';\n\timport Spinner from '../common/Spinner.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport NoteMenu from './Notes/NoteMenu.svelte';\n\timport FilesOverlay from '../chat/MessageInput/FilesOverlay.svelte';\n\timport XMark from '../icons/XMark.svelte';\n\timport DropdownOptions from '../common/DropdownOptions.svelte';\n\timport Loader from '../common/Loader.svelte';\n\n\tlet loaded = false;\n\n\tlet importFiles = '';\n\tlet selectedNote = null;\n\tlet showDeleteConfirm = false;\n\n\tlet notes = {};\n\n\tlet items = null;\n\tlet total = null;\n\n\tlet query = '';\n\n\tlet sortKey = null;\n\tlet displayOption = null;\n\tlet viewOption = null;\n\tlet permission = null;\n\n\tlet page = 1;\n\n\tlet itemsLoading = false;\n\tlet allItemsLoaded = false;\n\n\tconst downloadHandler = async (type) => {\n\t\tif (type === 'txt') {\n\t\t\tconst blob = new Blob([selectedNote.data.content.md], { type: 'text/plain' });\n\t\t\tsaveAs(blob, `${selectedNote.title}.txt`);\n\t\t} else if (type === 'md') {\n\t\t\tconst blob = new Blob([selectedNote.data.content.md], { type: 'text/markdown' });\n\t\t\tsaveAs(blob, `${selectedNote.title}.md`);\n\t\t} else if (type === 'pdf') {\n\t\t\ttry {\n\t\t\t\tawait downloadPdf(selectedNote);\n\t\t\t} catch (error) {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst deleteNoteHandler = async (id) => {\n\t\tconst res = await deleteNoteById(localStorage.token, id).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tinit();\n\t\t}\n\t};\n\n\tconst inputFilesHandler = async (inputFiles) => {\n\t\t// Check if all the file is a markdown file and extract name and content\n\n\t\tfor (const file of inputFiles) {\n\t\t\tif (file.type !== 'text/markdown') {\n\t\t\t\ttoast.error($i18n.t('Only markdown files are allowed'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = async (event) => {\n\t\t\t\tconst content = event.target.result;\n\t\t\t\tlet name = file.name.replace(/\\.md$/, '');\n\n\t\t\t\tif (typeof content !== 'string') {\n\t\t\t\t\ttoast.error($i18n.t('Invalid file content'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Create a new note with the content\n\t\t\t\tconst res = await createNewNote(localStorage.token, {\n\t\t\t\t\ttitle: name,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\tjson: null,\n\t\t\t\t\t\t\thtml: marked.parse(content ?? ''),\n\t\t\t\t\t\t\tmd: content\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tmeta: null,\n\t\t\t\t\taccess_control: {}\n\t\t\t\t}).catch((error) => {\n\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\treturn null;\n\t\t\t\t});\n\n\t\t\t\tif (res) {\n\t\t\t\t\tinit();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treader.readAsText(file);\n\t\t}\n\t};\n\n\tconst reset = () => {\n\t\tpage = 1;\n\t\titems = null;\n\t\ttotal = null;\n\t\tallItemsLoaded = false;\n\t\titemsLoading = false;\n\t\tnotes = {};\n\t};\n\n\tconst loadMoreItems = async () => {\n\t\tif (allItemsLoaded) return;\n\t\tpage += 1;\n\t\tawait getItemsPage();\n\t};\n\n\tconst init = async () => {\n\t\treset();\n\t\tawait getItemsPage();\n\t};\n\n\t$: if (\n\t\tloaded &&\n\t\tquery !== undefined &&\n\t\tsortKey !== undefined &&\n\t\tpermission !== undefined &&\n\t\tviewOption !== undefined\n\t) {\n\t\tinit();\n\t}\n\n\tconst getItemsPage = async () => {\n\t\titemsLoading = true;\n\n\t\tif (viewOption === 'created') {\n\t\t\tpermission = null;\n\t\t}\n\n\t\tconst res = await searchNotes(\n\t\t\tlocalStorage.token,\n\t\t\tquery,\n\t\t\tviewOption,\n\t\t\tpermission,\n\t\t\tsortKey,\n\t\t\tpage\n\t\t).catch(() => {\n\t\t\treturn [];\n\t\t});\n\n\t\tif (res) {\n\t\t\tconsole.log(res);\n\t\t\ttotal = res.total;\n\t\t\tconst pageItems = res.items;\n\n\t\t\tif ((pageItems ?? []).length === 0) {\n\t\t\t\tallItemsLoaded = true;\n\t\t\t} else {\n\t\t\t\tallItemsLoaded = false;\n\t\t\t}\n\n\t\t\tif (items) {\n\t\t\t\titems = [...items, ...pageItems];\n\t\t\t} else {\n\t\t\t\titems = pageItems;\n\t\t\t}\n\t\t}\n\n\t\titemsLoading = false;\n\t\treturn res;\n\t};\n\n\tconst groupNotes = (res) => {\n\t\tif (!Array.isArray(res)) {\n\t\t\treturn []; // Return empty array for invalid input\n\t\t}\n\n\t\t// Build the grouped object while tracking order\n\t\tconst grouped: Record<string, any[]> = {};\n\t\tconst orderedKeys: string[] = [];\n\n\t\tfor (const note of res) {\n\t\t\tconst timeRange = getTimeRange(note.updated_at / 1000000000);\n\t\t\tif (!grouped[timeRange]) {\n\t\t\t\tgrouped[timeRange] = [];\n\t\t\t\torderedKeys.push(timeRange);\n\t\t\t}\n\t\t\tgrouped[timeRange].push({\n\t\t\t\t...note,\n\t\t\t\ttimeRange\n\t\t\t});\n\t\t}\n\n\t\t// Return as array of [timeRange, notes] to preserve insertion order\n\t\treturn orderedKeys.map((key) => [key, grouped[key]] as [string, any[]]);\n\t};\n\n\tlet dragged = false;\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\n\t\t// Check if a file is being dragged.\n\t\tif (e.dataTransfer?.types?.includes('Files')) {\n\t\t\tdragged = true;\n\t\t} else {\n\t\t\tdragged = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = () => {\n\t\tdragged = false;\n\t};\n\n\tconst onDrop = async (e) => {\n\t\te.preventDefault();\n\t\tconsole.log(e);\n\n\t\tif (e.dataTransfer?.files) {\n\t\t\tconst inputFiles = Array.from(e.dataTransfer?.files);\n\t\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\t\tconsole.log(inputFiles);\n\t\t\t\tinputFilesHandler(inputFiles);\n\t\t\t}\n\t\t}\n\n\t\tdragged = false;\n\t};\n\n\tonMount(async () => {\n\t\tviewOption = localStorage?.noteViewOption ?? null;\n\t\tdisplayOption = localStorage?.noteDisplayOption ?? null;\n\n\t\tloaded = true;\n\n\t\tconst dropzoneElement = document.getElementById('notes-container');\n\t\tdropzoneElement?.addEventListener('dragover', onDragOver);\n\t\tdropzoneElement?.addEventListener('drop', onDrop);\n\t\tdropzoneElement?.addEventListener('dragleave', onDragLeave);\n\t});\n\n\tonDestroy(() => {\n\t\tconsole.log('destroy');\n\t\tconst dropzoneElement = document.getElementById('notes-container');\n\n\t\tif (dropzoneElement) {\n\t\t\tdropzoneElement?.removeEventListener('dragover', onDragOver);\n\t\t\tdropzoneElement?.removeEventListener('drop', onDrop);\n\t\t\tdropzoneElement?.removeEventListener('dragleave', onDragLeave);\n\t\t}\n\t});\n</script>\n\n<svelte:head>\n\t<title>\n\t\t{$i18n.t('Notes')} â€¢ {$WEBUI_NAME}\n\t</title>\n</svelte:head>\n\n<FilesOverlay show={dragged} />\n\n<div id=\"notes-container\" class=\"w-full min-h-full h-full px-3 md:px-[18px]\">\n\t{#if loaded}\n\t\t<DeleteConfirmDialog\n\t\t\tbind:show={showDeleteConfirm}\n\t\t\ttitle={$i18n.t('Delete note?')}\n\t\t\ton:confirm={() => {\n\t\t\t\tdeleteNoteHandler(selectedNote.id);\n\t\t\t\tshowDeleteConfirm = false;\n\t\t\t}}\n\t\t>\n\t\t\t<div class=\" text-sm text-gray-500 truncate\">\n\t\t\t\t{$i18n.t('This will delete')} <span class=\"  font-semibold\">{selectedNote.title}</span>.\n\t\t\t</div>\n\t\t</DeleteConfirmDialog>\n\n\t\t<div class=\"flex flex-col gap-1 px-1 mt-1.5 mb-3\">\n\t\t\t<div class=\"flex justify-between items-center\">\n\t\t\t\t<div class=\"flex items-center md:self-center text-xl font-medium px-0.5 gap-2 shrink-0\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{$i18n.t('Notes')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"text-lg font-medium text-gray-500 dark:text-gray-500\">\n\t\t\t\t\t\t{total}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"flex w-full justify-end gap-1.5\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\" px-2 py-1.5 rounded-xl bg-black text-white dark:bg-white dark:text-black transition font-medium text-sm flex items-center\"\n\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\tconst res = await createNoteHandler(dayjs().format('YYYY-MM-DD'));\n\n\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\tgoto(`/notes/${res.id}`);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Plus className=\"size-3\" strokeWidth=\"2.5\" />\n\n\t\t\t\t\t\t<div class=\" ml-1 text-xs\">{$i18n.t('New Note')}</div>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div\n\t\t\tclass=\"py-2 bg-white dark:bg-gray-900 rounded-3xl border border-gray-100/30 dark:border-gray-850/30\"\n\t\t>\n\t\t\t<div class=\"px-3.5 flex flex-1 items-center w-full space-x-2 py-0.5 pb-2\">\n\t\t\t\t<div class=\"flex flex-1 items-center\">\n\t\t\t\t\t<div class=\" self-center ml-1 mr-3\">\n\t\t\t\t\t\t<Search className=\"size-3.5\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass=\" w-full text-sm py-1 rounded-r-xl outline-hidden bg-transparent\"\n\t\t\t\t\t\tbind:value={query}\n\t\t\t\t\t\tplaceholder={$i18n.t('Search Notes')}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{#if query}\n\t\t\t\t\t\t<div class=\"self-center pl-1.5 translate-y-[0.5px] rounded-l-xl bg-transparent\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"p-0.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-900 transition\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tquery = '';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<XMark className=\"size-3\" strokeWidth=\"2\" />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"px-3 flex justify-between\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"flex w-full bg-transparent overflow-x-auto scrollbar-none\"\n\t\t\t\t\ton:wheel={(e) => {\n\t\t\t\t\t\tif (e.deltaY !== 0) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.currentTarget.scrollLeft += e.deltaY;\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"flex gap-3 w-fit text-center text-sm rounded-full bg-transparent px-0.5 whitespace-nowrap\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<DropdownOptions\n\t\t\t\t\t\t\talign=\"start\"\n\t\t\t\t\t\t\tclassName=\"flex w-full items-center gap-2 truncate px-3 py-1.5 text-sm bg-gray-50 dark:bg-gray-850 rounded-xl  placeholder-gray-400 outline-hidden focus:outline-hidden\"\n\t\t\t\t\t\t\tbind:value={viewOption}\n\t\t\t\t\t\t\titems={[\n\t\t\t\t\t\t\t\t{ value: null, label: $i18n.t('All') },\n\t\t\t\t\t\t\t\t{ value: 'created', label: $i18n.t('Created by you') },\n\t\t\t\t\t\t\t\t{ value: 'shared', label: $i18n.t('Shared with you') }\n\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\tonChange={(value) => {\n\t\t\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\t\t\tlocalStorage.noteViewOption = value;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdelete localStorage.noteViewOption;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t{#if [null, 'shared'].includes(viewOption)}\n\t\t\t\t\t\t\t<DropdownOptions\n\t\t\t\t\t\t\t\talign=\"start\"\n\t\t\t\t\t\t\t\tbind:value={permission}\n\t\t\t\t\t\t\t\titems={[\n\t\t\t\t\t\t\t\t\t{ value: null, label: $i18n.t('Write') },\n\t\t\t\t\t\t\t\t\t{ value: 'read_only', label: $i18n.t('Read Only') }\n\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div>\n\t\t\t\t\t<DropdownOptions\n\t\t\t\t\t\talign=\"start\"\n\t\t\t\t\t\tbind:value={displayOption}\n\t\t\t\t\t\titems={[\n\t\t\t\t\t\t\t{ value: null, label: $i18n.t('List') },\n\t\t\t\t\t\t\t{ value: 'grid', label: $i18n.t('Grid') }\n\t\t\t\t\t\t]}\n\t\t\t\t\t\tonChange={() => {\n\t\t\t\t\t\t\tif (displayOption) {\n\t\t\t\t\t\t\t\tlocalStorage.noteDisplayOption = displayOption;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdelete localStorage.noteDisplayOption;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if items !== null && total !== null}\n\t\t\t\t{#if (items ?? []).length > 0}\n\t\t\t\t\t{@const groupedNotes = groupNotes(items)}\n\n\t\t\t\t\t<div class=\"@container h-full py-2.5 px-2.5\">\n\t\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t\t{#each groupedNotes as [timeRange, notesList], idx}\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"w-full text-xs text-gray-500 dark:text-gray-500 font-medium px-2.5 pb-2.5\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{$i18n.t(timeRange)}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t{#if displayOption === null}\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"{groupedNotes.length - 1 !== idx ? 'mb-3' : ''} gap-1.5 flex flex-col\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{#each notesList as note, idx (note.id)}\n\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\" flex cursor-pointer w-full px-3.5 py-1.5 border border-gray-50 dark:border-gray-850/30 bg-transparent dark:hover:bg-gray-850 hover:bg-white rounded-2xl transition\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<a href={`/notes/${note.id}`} class=\"w-full flex flex-col justify-between\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"  flex items-center gap-2 self-center justify-between\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={note.title}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplacement=\"top-start\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" text-sm font-medium capitalize flex-1 w-full line-clamp-1\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{note.title}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex shrink-0 items-center text-xs gap-2.5\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={dayjs(note.updated_at / 1000000).format('LLLL')}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{dayjs(note.updated_at / 1000000).fromNow()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={note?.user?.email ?? $i18n.t('Deleted User')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex shrink-0\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplacement=\"top-start\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"shrink-0 text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('By {{name}}', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: capitalizeFirstLetter(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnote?.user?.name ??\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnote?.user?.email ??\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t('Deleted User')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<NoteMenu\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDownload={(type) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedNote = note;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdownloadHandler(type);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonCopyLink={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst baseUrl = window.location.origin;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst res = await copyToClipboard(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`${baseUrl}/notes/${note.id}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.success($i18n.t('Copied link to clipboard'));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Failed to copy link'));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDelete={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedNote = note;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center w-fit text-sm p-1 dark:text-gray-300 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/5 rounded-xl\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<EllipsisHorizontal className=\"size-5\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</NoteMenu>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{:else if displayOption === 'grid'}\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"{groupedNotes.length - 1 !== idx\n\t\t\t\t\t\t\t\t\t\t\t? 'mb-5'\n\t\t\t\t\t\t\t\t\t\t\t: ''} gap-2.5 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{#each notesList as note, idx (note.id)}\n\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\" flex space-x-4 cursor-pointer w-full px-4.5 py-4 border border-gray-50 dark:border-gray-850/30 bg-transparent dark:hover:bg-gray-850 hover:bg-white rounded-2xl transition\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" flex flex-1 space-x-4 cursor-pointer w-full\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thref={`/notes/${note.id}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-full -translate-y-0.5 flex flex-col justify-between\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"  flex items-center gap-2 self-center mb-1 justify-between\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" font-semibold line-clamp-1 capitalize\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{note.title}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<NoteMenu\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDownload={(type) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedNote = note;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdownloadHandler(type);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonCopyLink={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst baseUrl = window.location.origin;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst res = await copyToClipboard(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`${baseUrl}/notes/${note.id}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.success($i18n.t('Copied link to clipboard'));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Failed to copy link'));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDelete={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedNote = note;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowDeleteConfirm = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center w-fit text-sm p-1 dark:text-gray-300 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/5 rounded-xl\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<EllipsisHorizontal className=\"size-5\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</NoteMenu>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" text-xs text-gray-500 dark:text-gray-500 mb-3 line-clamp-3 min-h-10\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{#if note.data?.content?.md}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{note.data?.content?.md}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('No content')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" text-xs px-0.5 w-full flex justify-between items-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{dayjs(note.updated_at / 1000000).fromNow()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={note?.user?.email ?? $i18n.t('Deleted User')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex shrink-0\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplacement=\"top-start\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"shrink-0 text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('By {{name}}', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: capitalizeFirstLetter(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnote?.user?.name ??\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnote?.user?.email ??\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t('Deleted User')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t{/each}\n\n\t\t\t\t\t\t\t{#if !allItemsLoaded}\n\t\t\t\t\t\t\t\t<Loader\n\t\t\t\t\t\t\t\t\ton:visible={(e) => {\n\t\t\t\t\t\t\t\t\t\tif (!itemsLoading) {\n\t\t\t\t\t\t\t\t\t\t\tloadMoreItems();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"w-full flex justify-center py-4 text-xs animate-pulse items-center gap-2\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\n\t\t\t\t\t\t\t\t\t\t<div class=\" \">{$i18n.t('Loading...')}</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</Loader>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"w-full h-full flex flex-col items-center justify-center\">\n\t\t\t\t\t\t<div class=\"py-20 text-center\">\n\t\t\t\t\t\t\t<div class=\" text-sm text-gray-400 dark:text-gray-600\">\n\t\t\t\t\t\t\t\t{$i18n.t('No Notes')}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"mt-1 text-xs text-gray-300 dark:text-gray-700\">\n\t\t\t\t\t\t\t\t{$i18n.t('Create your first note by clicking on the plus button below.')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t{:else}\n\t\t\t\t<div class=\"w-full h-full flex justify-center items-center py-10\">\n\t\t\t\t\t<Spinner className=\"size-4\" />\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t{:else}\n\t\t<div class=\"w-full h-full flex justify-center items-center\">\n\t\t\t<Spinner className=\"size-4\" />\n\t\t</div>\n\t{/if}\n</div>\n","<script>\n\timport { getContext, onMount } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport dayjs from '$lib/dayjs';\n\timport { mobile, showArchivedChats, showSidebar, user } from '$lib/stores';\n\timport { goto } from '$app/navigation';\n\timport { page } from '$app/stores';\n\n\timport { createNoteHandler } from '$lib/components/notes/utils';\n\n\timport UserMenu from '$lib/components/layout/Sidebar/UserMenu.svelte';\n\timport Notes from '$lib/components/notes/Notes.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Sidebar from '$lib/components/icons/Sidebar.svelte';\n\timport { WEBUI_API_BASE_URL } from '$lib/constants';\n\n\tlet loaded = false;\n\n\tonMount(async () => {\n\t\tif (\n\t\t\t$page.url.searchParams.get('content') !== null ||\n\t\t\t$page.url.searchParams.get('title') !== null\n\t\t) {\n\t\t\tconst title = $page.url.searchParams.get('title') ?? dayjs().format('YYYY-MM-DD');\n\t\t\tconst content = $page.url.searchParams.get('content') ?? '';\n\n\t\t\tconst res = await createNoteHandler(title, content);\n\n\t\t\tif (res) {\n\t\t\t\tgoto(`/notes/${res.id}`);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tloaded = true;\n\t});\n</script>\n\n{#if loaded}\n\t<div\n\t\tclass=\" flex flex-col w-full h-screen max-h-[100dvh] transition-width duration-200 ease-in-out {$showSidebar\n\t\t\t? 'md:max-w-[calc(100%-var(--sidebar-width))]'\n\t\t\t: ''} max-w-full\"\n\t>\n\t\t<nav class=\"   px-2 pt-1.5 backdrop-blur-xl w-full drag-region\">\n\t\t\t<div class=\" flex items-center\">\n\t\t\t\t{#if $mobile}\n\t\t\t\t\t<div class=\"{$showSidebar ? 'md:hidden' : ''} flex flex-none items-center\">\n\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\tcontent={$showSidebar ? $i18n.t('Close Sidebar') : $i18n.t('Open Sidebar')}\n\t\t\t\t\t\t\tinteractive={true}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tid=\"sidebar-toggle-button\"\n\t\t\t\t\t\t\t\tclass=\" cursor-pointer flex rounded-lg hover:bg-gray-100 dark:hover:bg-gray-850 transition cursor-\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tshowSidebar.set(!$showSidebar);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\" self-center p-1.5\">\n\t\t\t\t\t\t\t\t\t<Sidebar />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t<div class=\"ml-2 py-0.5 self-center flex items-center justify-between w-full\">\n\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"flex gap-1 scrollbar-none overflow-x-auto w-fit text-center text-sm font-medium bg-transparent py-1 touch-auto pointer-events-auto\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<a class=\"min-w-fit transition\" href=\"/notes\">\n\t\t\t\t\t\t\t\t{$i18n.t('Notes')}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\" self-center flex items-center gap-1\">\n\t\t\t\t\t\t{#if $user !== undefined && $user !== null}\n\t\t\t\t\t\t\t<UserMenu\n\t\t\t\t\t\t\t\tclassName=\"max-w-[240px]\"\n\t\t\t\t\t\t\t\trole={$user?.role}\n\t\t\t\t\t\t\t\thelp={true}\n\t\t\t\t\t\t\t\ton:show={(e) => {\n\t\t\t\t\t\t\t\t\tif (e.detail === 'archived-chat') {\n\t\t\t\t\t\t\t\t\t\tshowArchivedChats.set(true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\t\t\taria-label=\"User Menu\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\" self-center\">\n\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\tsrc={`${WEBUI_API_BASE_URL}/users/${$user?.id}/profile/image`}\n\t\t\t\t\t\t\t\t\t\t\tclass=\"size-6 object-cover rounded-full\"\n\t\t\t\t\t\t\t\t\t\t\talt=\"User profile\"\n\t\t\t\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</UserMenu>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</nav>\n\n\t\t<div class=\" flex-1 max-h-full overflow-y-auto @container\">\n\t\t\t<Notes />\n\t\t</div>\n\t</div>\n{/if}\n"],"names":["saveAs","fileSaver","dayjs","duration","relativeTime","loadLocale","locales","locale","error","i18n","getContext","loaded","selectedNote","showDeleteConfirm","items","total","query","sortKey","displayOption","viewOption","permission","page","itemsLoading","allItemsLoaded","downloadHandler","type","blob","$.get","downloadPdf","toast","deleteNoteHandler","id","deleteNoteById","init","inputFilesHandler","inputFiles","file","$i18n","reader","event","content","name","createNewNote","marked","reset","$.set","loadMoreItems","getItemsPage","res","searchNotes","pageItems","groupNotes","grouped","orderedKeys","note","timeRange","getTimeRange","key","dragged","onDragOver","e","_b","_a","onDragLeave","onDrop","onMount","dropzoneElement","onDestroy","$WEBUI_NAME","$$value","$.untrack","$.event","button_1","$$render","consequent","value","groupedNotes","$.derived_safe_equal","$.index","$$anchor","$$item","idx","$$array","notesList","$.each","div_21","$$array_1","capitalizeFirstLetter","baseUrl","copyToClipboard","div_30","$$array_2","$.template_effect","$.set_text","text_10","consequent_3","alternate","consequent_4","consequent_2","alternate_1","consequent_5","consequent_7","alternate_3","button","createNoteHandler","goto","$.bind_value","input","div_15","consequent_8","alternate_4","$page","title","$showSidebar","showSidebar","$mobile","$0","$user","showArchivedChats","WEBUI_API_BASE_URL","consequent_1"],"mappings":"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"}