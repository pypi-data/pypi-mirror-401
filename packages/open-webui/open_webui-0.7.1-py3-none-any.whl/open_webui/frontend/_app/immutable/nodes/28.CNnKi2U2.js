import"../chunks/CWj6FrbW.js";import"../chunks/CN51-NxK.js";import{g as se,o as le,t as S,a as R,p as re,f as C,b as ie,i,j as l,k as z,m as g,c as a,r as s,aR as ne,n as F,s as J,l as L}from"../chunks/Cef1s1vS.js";import{i as de}from"../chunks/DtBwJrag.js";import{a as ce}from"../chunks/CepVL_7U.js";import{b as fe}from"../chunks/C-UcLPd1.js";import{b as ue}from"../chunks/DhQBHKPK.js";import{i as ve}from"../chunks/D6HxSY24.js";import{s as me,a as f}from"../chunks/B0aKtzpN.js";import"../chunks/Bfaq2Jpc.js";import{g as pe}from"../chunks/BUPwbfhi.js";import{b as ge}from"../chunks/CIXyf-s1.js";import{u as xe,b as be,c as _e,a as he}from"../chunks/D3pt6ESx.js";import{c as we}from"../chunks/DjfhbysU.js";import{o as ye}from"../chunks/DHdn9FJM.js";import{S as $e}from"../chunks/BPTO5YHe.js";var ke=C('<button class="px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"> </button>'),Se=C('<button class="px-3 py-1.5 text-sm font-medium bg-gray-300 text-black transition rounded-full"> </button>'),Re=C('<div class=" flex flex-col justify-between w-full overflow-y-auto h-full"><div class="mx-auto w-full md:px-0 h-full"><div class=" flex flex-col h-full px-4"><div class="flex flex-col justify-between mb-1 gap-1"><div class="flex flex-col gap-1 w-full"><div class="flex w-full"><div class="overflow-hidden w-full"><div class="max-w-full"><!></div></div></div></div></div> <div class=" pt-0.5 pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0" id="messages-container"><div class=" h-full w-full flex flex-col"><div class="flex-1"><textarea id="text-completion-textarea" class="w-full h-full p-3 bg-transparent border border-gray-100/30 dark:border-gray-850/30 outline-hidden resize-none rounded-lg text-sm"></textarea></div></div></div> <div class="pb-3 flex justify-end"><!></div></div></div></div>');function Ce(x,W){ie(W,!1);const j=()=>f(he,"$models",d),Y=()=>f(xe,"$user",d),T=()=>f(be,"$settings",d),E=()=>f(_e,"$config",d),u=()=>f(K,"$i18n",d),[d,G]=me(),K=se("i18n");let c=g(""),n=g(""),b=g(!1),v=!1,_=g();const P=()=>{const e=l(_);e&&(e.scrollTop=e==null?void 0:e.scrollHeight)},Q=()=>{v=!0},V=async()=>{const e=j().find(r=>r.id===l(n)),[t,o]=await we(localStorage.token,{model:e.id,stream:!0,messages:[{role:"assistant",content:l(c)}]},`${ge}/api`);if(t&&t.ok){const r=t.body.pipeThrough(new TextDecoderStream).pipeThrough(ye(`
`)).getReader();for(;;){const{value:p,done:ae}=await r.read();if(ae||v){v&&o.abort("User: Stop Response");break}try{let $=p.split(`
`);for(const k of $)if(k!==""&&!k.includes("[DONE]")){let q=JSON.parse(k.replace(/^data: /,""));i(c,l(c)+(q.choices[0].delta.content??""))}}catch($){}P()}}},X=async()=>{l(n)&&(i(b,!0),await V(),i(b,!1),v=!1)};le(async()=>{var e,t,o,r,p;((e=Y())==null?void 0:e.role)!=="admin"&&await pe("/"),(t=T())!=null&&t.models?i(n,(o=T())==null?void 0:o.models[0]):(r=E())!=null&&r.default_models?i(n,(p=E())==null?void 0:p.default_models.split(",")[0]):i(n,"")}),ve();var h=Re(),B=a(h),H=a(B),w=a(H),U=a(w),A=a(U),D=a(A),I=a(D),Z=a(I);{let e=F(()=>u().t("Select a model")),t=F(()=>j().map(o=>({value:o.id,label:o.name,model:o})));$e(Z,{get placeholder(){return l(e)},get items(){return l(t)},get value(){return l(n)},set value(o){i(n,o)},$$legacy:!0})}s(I),s(D),s(A),s(U),s(w);var y=z(w,2),M=a(y),N=a(M),m=a(N);ne(m),ue(m,e=>i(_,e),()=>l(_)),s(N),s(M),s(y);var O=z(y,2),ee=a(O);{var te=e=>{var t=ke(),o=a(t,!0);s(t),S(r=>J(o,r),[()=>u().t("Run")]),L("click",t,()=>{X()}),R(e,t)},oe=e=>{var t=Se(),o=a(t,!0);s(t),S(r=>J(o,r),[()=>u().t("Cancel")]),L("click",t,()=>{Q()}),R(e,t)};de(ee,e=>{l(b)?e(oe,!1):e(te)})}s(O),s(H),s(B),s(h),S(e=>ce(m,"placeholder",e),[()=>u().t("You're a helpful assistant.")]),fe(m,()=>l(c),e=>i(c,e)),R(x,h),re(),G()}function Le(x){Ce(x,{})}export{Le as component};
//# sourceMappingURL=28.CNnKi2U2.js.map
