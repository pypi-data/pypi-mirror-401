{
  "markdown": "# Backend Profiles\n\nBSL provides a profile system for managing database connections using configuration files. Profiles let you:\n\n- **Store backend configurations** for different environments (dev, staging, prod)\n- **Share connections across systems** using global or local profile files\n- **Switch backends easily** without changing your code\n- **Secure credentials** with environment variable substitution\n\n\n## Quick Start\n\n### Python-Based\n\n```python\nfrom boring_semantic_layer import get_connection, to_semantic_table\n\n# Load connection directly by profile name\n# Searches for 'my_db' profile in:\n#   1. ~/.config/bsl/profiles/my_db.yml\n#   2. ./profiles.yml (current directory)\n#   3. xorq profiles directory\ncon = get_connection('my_db')\n\n# Load from a specific file\ncon = get_connection('my_db', profile_file='config/profiles.yml')\n\n# Use the connection to access tables and create semantic tables\nflights_table = con.table('flights')\nflights = to_semantic_table(flights_table)\n```\n\n## Profile YAML Format\n\nCreate a `profiles.yml` file in your project directory:\n\n```yaml\ndev_db:\n  type: duckdb\n  database: dev.db\n\nprod_db:\n  type: postgres\n  host: ${POSTGRES_HOST}\n  database: ${POSTGRES_DB}\n  user: ${POSTGRES_USER}\n  password: ${POSTGRES_PASSWORD}\n```\n\n**Notes:**\n- The `type` field corresponds to the ibis backend name. Each backend has specific required parameters - see the [Supported Backends](#supported-backends) section below for details.\n- Use `${VAR_NAME}` or `$VAR_NAME` syntax for environment variables (see `prod_db` example above for securing credentials). Environment variables are resolved at connection time from the OS environment.\n\n### YAML-Based\n\n**File-level profile** - all tables from one connection (must be defined in a profiles.yml file):\n\n```yaml\n# flights_model.yml\nprofile: my_db\n\nflights:\n  table: flights\n  dimensions:\n    origin: _.origin\n  measures:\n    flight_count: _.count()\n```\n\n**Table-level profiles** - different tables from different connections:\n\n```yaml\n# multi_db_model.yml\nflights:\n  profile: postgres_db\n  table: flights\n  dimensions:\n    origin: _.origin\n  measures:\n    flight_count: _.count()\n\ncarriers:\n  profile: duckdb_db\n  table: carriers\n  dimensions:\n    code: _.code\n    name: _.name\n```\n\n```python\nfrom boring_semantic_layer import from_yaml\n\n# Profiles loaded automatically from YAML\nmodels = from_yaml('multi_db_model.yml')\n\n# Or pass profile as parameter\nmodels = from_yaml('model.yml', profile='my_db')\n```\n\n## Profile Resolution Order\n\n`get_connection('my_db')` searches in this order:\n1. `~/.config/bsl/profiles/my_db.yml` (BSL-specific profiles)\n2. `./profiles.yml` (local project profiles)\n3. xorq profiles directory (system-wide xorq profiles)\n\nYou can customize the search order:\n\n```python\nfrom boring_semantic_layer import get_connection\n\n# Specify custom search order\ncon = get_connection('my_db', search_locations=['bsl_dir'])\n\n# Search only local directory\ncon = get_connection('my_db', search_locations=['local'])\n\n# Custom order\ncon = get_connection('my_db', search_locations=['local', 'bsl_dir', 'xorq_dir'])\n```\n\n`from_yaml()` resolves profiles in priority order (first match wins):\n\n1. **`profile` parameter** - Explicit argument passed to `from_yaml()`:\n   ```python\n   models = from_yaml('model.yml', profile='my_db')\n   ```\n\n2. **`BSL_PROFILE` environment variable** - System-wide default:\n   ```bash\n   export BSL_PROFILE=my_db\n   ```\n\n3. **YAML file-level `profile`** - Default defined inside the YAML file:\n   ```yaml\n   profile: my_db  # File-level default\n   models:\n     flights: ...\n   ```\n\n4. **Table-level `profile`** - Per-table override (see [YAML-Based](#yaml-based) section)\n\n## Supported Backends\n\nBSL uses xorq backends for all connections, which provide caching and performance optimizations. The `type` field in your profile corresponds to the ibis backend name, and the other fields are passed as connection parameters.\n\n```python\ncon = get_connection('my_db')  # Uses xorq backend\n```\n\nSee the [ibis backends documentation](https://ibis-project.org/backends/) for the complete list of supported backends and their required connection parameters.\n\n## Auto-Loading Parquet Files\n\nThe `tables` configuration automatically creates database tables from parquet files when loading a profile:\n\n```python\nfrom boring_semantic_layer import get_connection\n\ncon = get_connection('test_db')  # Creates 'flights' table\nprint(con.list_tables())         # ['flights']\n```\n\nSupports both string paths and dict config:\n\n```yaml\ntest_db:\n  type: duckdb\n  database: \":memory:\"\n  tables:\n    # String format\n    flights: \"data/flights.parquet\"\n\n    # Dict format\n    carriers:\n      source: \"data/carriers.parquet\"\n```\n\nIdeal for testing, CI/CD, and prototyping. Supports local files, remote URLs, and S3 paths. The `tables` configuration works with any backend that supports `read_parquet()` (DuckDB, Polars, DataFusion, etc.). An error will be raised if the backend doesn't support this feature.",
  "queries": {},
  "files": {}
}
