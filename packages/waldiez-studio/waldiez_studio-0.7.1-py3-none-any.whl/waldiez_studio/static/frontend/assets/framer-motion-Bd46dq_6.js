import{r as t,j as n}from"./react-OZnHQ5N4.js";import{g as e,s as o,i as s,a as i,b as r,c as a,d as u,e as l,f as c,r as h,h as d,j as m,k as p,l as f,m as g,o as v,S as y,H as x,F as w,n as P,p as E,q as S,t as C,u as M,v as A,w as L,x as b,y as T,z as D,A as j,B as V,C as I,D as k,E as R,G as W,I as O,J as F,K as H,L as B,M as G,N as U,O as N}from"./motion-dom-ChK-62ft.js";import{p as X,s as Y,m as q,a as $,c as _,n as z}from"./motion-utils-DDt8zdnb.js";const J=t.createContext({});const K="undefined"!=typeof window,Z=K?t.useLayoutEffect:t.useEffect,Q=t.createContext(null),tt=t.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});const nt=t.createContext({strict:!1}),et={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let ot=!1;function st(){return function(){if(ot)return;const t={};for(const n in et)t[n]={isEnabled:t=>et[n].some(n=>!!t[n])};o(t),ot=!0}(),e()}const it=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function rt(t){return t.startsWith("while")||t.startsWith("drag")&&"draggable"!==t||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||it.has(t)}let at=t=>!rt(t);try{"function"==typeof(ut=require("@emotion/is-prop-valid").default)&&(at=t=>t.startsWith("on")?!rt(t):ut(t))}catch{}var ut;const lt=t.createContext({});function ct(n){const{initial:e,animate:o}=function(t,n){if(s(t)){const{initial:n,animate:e}=t;return{initial:!1===n||i(n)?n:void 0,animate:i(e)?e:void 0}}return!1!==t.inherit?n:{}}(n,t.useContext(lt));return t.useMemo(()=>({initial:e,animate:o}),[ht(e),ht(o)])}function ht(t){return Array.isArray(t)?t.join(" "):t}const dt=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function mt(t,n,e){for(const o in n)r(n[o])||a(o,e)||(t[o]=n[o])}function pt(n,e){const o={};return mt(o,n.style||{},n),Object.assign(o,function({transformTemplate:n},e){return t.useMemo(()=>{const t={style:{},transform:{},transformOrigin:{},vars:{}};return u(t,e,n),Object.assign({},t.vars,t.style)},[e])}(n,e)),o}function ft(t,n){const e={},o=pt(t,n);return t.drag&&!1!==t.dragListener&&(e.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=!0===t.drag?"none":"pan-"+("x"===t.drag?"y":"x")),void 0===t.tabIndex&&(t.onTap||t.onTapStart||t.whileTap)&&(e.tabIndex=0),e.style=o,e}const gt=()=>({style:{},transform:{},transformOrigin:{},vars:{},attrs:{}});function vt(n,e,o,s){const i=t.useMemo(()=>{const t={style:{},transform:{},transformOrigin:{},vars:{},attrs:{}};return l(t,e,c(s),n.transformTemplate,n.style),{...t.attrs,style:{...t.style}}},[e]);if(n.style){const t={};mt(t,n.style,n),i.style={...t,...i.style}}return i}const yt=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function xt(t){return"string"==typeof t&&!t.includes("-")&&!!(yt.indexOf(t)>-1||/[A-Z]/u.test(t))}function wt(n,e,o,{latestValues:s},i,a=!1,u){const l=(u??xt(n)?vt:ft)(e,s,i,n),c=function(t,n,e){const o={};for(const s in t)"values"===s&&"object"==typeof t.values||(at(s)||!0===e&&rt(s)||!n&&!rt(s)||t.draggable&&s.startsWith("onDrag"))&&(o[s]=t[s]);return o}(e,"string"==typeof n,a),h=n!==t.Fragment?{...c,...l,ref:o}:{},{children:d}=e,m=t.useMemo(()=>r(d)?d.get():d,[d]);return t.createElement(n,{...h,children:m})}function Pt(t,n,e,o){const i={},r=o(t,{});for(const s in r)i[s]=h(r[s]);let{initial:a,animate:u}=t;const l=s(t),c=d(t);n&&c&&!l&&!1!==t.inherit&&(void 0===a&&(a=n.initial),void 0===u&&(u=n.animate));let f=!!e&&!1===e.initial;f=f||!1===a;const g=f?u:a;if(g&&"boolean"!=typeof g&&!m(g)){const n=Array.isArray(g)?g:[g];for(let e=0;e<n.length;e++){const o=p(t,n[e]);if(o){const{transitionEnd:t,transition:n,...e}=o;for(const o in e){let t=e[o];if(Array.isArray(t)){t=t[f?t.length-1:0]}null!==t&&(i[o]=t)}for(const o in t)i[o]=t[o]}}}return i}const Et=n=>(e,o)=>{const s=t.useContext(lt),i=t.useContext(Q),r=()=>function({scrapeMotionValuesFromProps:t,createRenderState:n},e,o,s){return{latestValues:Pt(e,o,s,t),renderState:n()}}(n,e,s,i);return o?r():function(n){const e=t.useRef(null);return null===e.current&&(e.current=n()),e.current}(r)},St=Et({scrapeMotionValuesFromProps:f,createRenderState:dt}),Ct=Et({scrapeMotionValuesFromProps:g,createRenderState:gt}),Mt=Symbol.for("motionComponentSymbol");function At(n,e,o){const s=t.useRef(o);t.useInsertionEffect(()=>{s.current=o});const i=t.useRef(null);return t.useCallback(t=>{t&&n.onMount?.(t),e&&(t?e.mount(t):e.unmount());const o=s.current;if("function"==typeof o)if(t){const n=o(t);"function"==typeof n&&(i.current=n)}else i.current?(i.current(),i.current=null):o(t);else o&&(o.current=t)},[e])}const Lt=t.createContext({});function bt(t){return t&&"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"current")}function Tt(n,e,o,s,i,r){const{visualElement:a}=t.useContext(lt),u=t.useContext(nt),l=t.useContext(Q),c=t.useContext(tt).reducedMotion,h=t.useRef(null);s=s||u.renderer,!h.current&&s&&(h.current=s(n,{visualState:e,parent:a,props:o,presenceContext:l,blockInitialAnimation:!!l&&!1===l.initial,reducedMotionConfig:c,isSVG:r}));const d=h.current,m=t.useContext(Lt);!d||d.projection||!i||"html"!==d.type&&"svg"!==d.type||function(t,n,e,o){const{layoutId:s,layout:i,drag:r,dragConstraints:a,layoutScroll:u,layoutRoot:l,layoutCrossfade:c}=n;t.projection=new e(t.latestValues,n["data-framer-portal-id"]?void 0:Dt(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:Boolean(r)||a&&bt(a),visualElement:t,animationType:"string"==typeof i?i:"both",initialPromotionConfig:o,crossfade:c,layoutScroll:u,layoutRoot:l})}(h.current,o,i,m);const p=t.useRef(!1);t.useInsertionEffect(()=>{d&&p.current&&d.update(o,l)});const f=o[v],g=t.useRef(Boolean(f)&&!window.MotionHandoffIsComplete?.(f)&&window.MotionHasOptimisedAnimation?.(f));return Z(()=>{d&&(p.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),g.current&&d.animationState&&d.animationState.animateChanges())}),t.useEffect(()=>{d&&(!g.current&&d.animationState&&d.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(f)}),g.current=!1),d.enteringChildren=void 0)}),d}function Dt(t){if(t)return!1!==t.options.allowProjection?t.projection:Dt(t.parent)}function jt(e,{forwardMotionProps:s=!1,type:i}={},r,a){r&&function(t){const n=st();for(const e in t)n[e]={...n[e],...t[e]};o(n)}(r);const u=i?"svg"===i:xt(e),l=u?Ct:St;function c(o,i){let r;const c={...t.useContext(tt),...o,layoutId:Vt(o)},{isStatic:h}=c,d=ct(o),m=l(o,h);if(!h&&K){t.useContext(nt).strict;const n=function(t){const n=st(),{drag:e,layout:o}=n;if(!e&&!o)return{};const s={...e,...o};return{MeasureLayout:e?.isEnabled(t)||o?.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}(c);r=n.MeasureLayout,d.visualElement=Tt(e,m,c,a,n.ProjectionNode,u)}return n.jsxs(lt.Provider,{value:d,children:[r&&d.visualElement?n.jsx(r,{visualElement:d.visualElement,...c}):null,wt(e,o,At(m,d.visualElement,i),m,h,s,u)]})}c.displayName=`motion.${"string"==typeof e?e:`create(${e.displayName??e.name??""})`}`;const h=t.forwardRef(c);return h[Mt]=e,h}function Vt({layoutId:n}){const e=t.useContext(J).id;return e&&void 0!==n?e+"-"+n:n}function It(t,n){if("undefined"==typeof Proxy)return jt;const e=new Map,o=(e,o)=>jt(e,o,t,n);return new Proxy((t,n)=>o(t,n),{get:(s,i)=>"create"===i?o:(e.has(i)||e.set(i,jt(i,void 0,t,n)),e.get(i))})}const kt=(n,e)=>e.isSVG??xt(n)?new y(e):new x(e,{allowProjection:n!==t.Fragment});let Rt=0;const Wt={animation:{Feature:class extends w{constructor(t){super(t),t.animationState||(t.animationState=P(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();m(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}},exit:{Feature:class extends w{constructor(){super(...arguments),this.id=Rt++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:e}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===e)return;const o=this.node.animationState.setActive("exit",!t);n&&!t&&o.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}}};function Ot(t){return{point:{x:t.pageX,y:t.pageY}}}function Ft(t,n,e,o){return S(t,n,(t=>n=>E(n)&&t(n,Ot(n)))(e),o)}const Ht=({current:t})=>t?t.ownerDocument.defaultView:null,Bt=(t,n)=>Math.abs(t-n);const Gt=new Set(["auto","scroll"]);class Ut{constructor(t,n,{transformPagePoint:e,contextWindow:o=window,dragSnapToOrigin:s=!1,distanceThreshold:i=3,element:r}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=t=>{this.handleScroll(t.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const t=Yt(this.lastMoveEventInfo,this.history),n=null!==this.startEvent,e=function(t,n){const e=Bt(t.x,n.x),o=Bt(t.y,n.y);return Math.sqrt(e**2+o**2)}(t.offset,{x:0,y:0})>=this.distanceThreshold;if(!n&&!e)return;const{point:o}=t,{timestamp:s}=C;this.history.push({...o,timestamp:s});const{onStart:i,onMove:r}=this.handlers;n||(i&&i(this.lastMoveEvent,t),this.startEvent=this.lastMoveEvent),r&&r(this.lastMoveEvent,t)},this.handlePointerMove=(t,n)=>{this.lastMoveEvent=t,this.lastMoveEventInfo=Nt(n,this.transformPagePoint),M.update(this.updatePoint,!0)},this.handlePointerUp=(t,n)=>{this.end();const{onEnd:e,onSessionEnd:o,resumeAnimation:s}=this.handlers;if(!this.dragSnapToOrigin&&this.startEvent||s&&s(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const i=Yt("pointercancel"===t.type?this.lastMoveEventInfo:Nt(n,this.transformPagePoint),this.history);this.startEvent&&e&&e(t,i),o&&o(t,i)},!E(t))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=e,this.distanceThreshold=i,this.contextWindow=o||window;const a=Nt(Ot(t),this.transformPagePoint),{point:u}=a,{timestamp:l}=C;this.history=[{...u,timestamp:l}];const{onSessionStart:c}=n;c&&c(t,Yt(a,this.history)),this.removeListeners=X(Ft(this.contextWindow,"pointermove",this.handlePointerMove),Ft(this.contextWindow,"pointerup",this.handlePointerUp),Ft(this.contextWindow,"pointercancel",this.handlePointerUp)),r&&this.startScrollTracking(r)}startScrollTracking(t){let n=t.parentElement;for(;n;){const t=getComputedStyle(n);(Gt.has(t.overflowX)||Gt.has(t.overflowY))&&this.scrollPositions.set(n,{x:n.scrollLeft,y:n.scrollTop}),n=n.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const n=this.scrollPositions.get(t);if(!n)return;const e=t===window,o=e?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},s=o.x-n.x,i=o.y-n.y;0===s&&0===i||(e?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=s,this.lastMoveEventInfo.point.y+=i):this.history.length>0&&(this.history[0].x-=s,this.history[0].y-=i),this.scrollPositions.set(t,o),M.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),A(this.updatePoint)}}function Nt(t,n){return n?{point:n(t.point)}:t}function Xt(t,n){return{x:t.x-n.x,y:t.y-n.y}}function Yt({point:t},n){return{point:t,delta:Xt(t,$t(n)),offset:Xt(t,qt(n)),velocity:_t(n,.1)}}function qt(t){return t[0]}function $t(t){return t[t.length-1]}function _t(t,n){if(t.length<2)return{x:0,y:0};let e=t.length-1,o=null;const s=$t(t);for(;e>=0&&(o=t[e],!(s.timestamp-o.timestamp>Y(n)));)e--;if(!o)return{x:0,y:0};const i=q(s.timestamp-o.timestamp);if(0===i)return{x:0,y:0};const r={x:(s.x-o.x)/i,y:(s.y-o.y)/i};return r.x===1/0&&(r.x=0),r.y===1/0&&(r.y=0),r}function zt(t,n,e){return{min:void 0!==n?t.min+n:void 0,max:void 0!==e?t.max+e-(t.max-t.min):void 0}}function Jt(t,n){let e=n.min-t.min,o=n.max-t.max;return n.max-n.min<t.max-t.min&&([e,o]=[o,e]),{min:e,max:o}}const Kt=.35;function Zt(t,n,e){return{min:Qt(t,n),max:Qt(t,e)}}function Qt(t,n){return"number"==typeof t?t:t[n]||0}const tn=new WeakMap;class nn{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=T(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:e}={}){const{presenceContext:o}=this.visualElement;if(o&&!1===o.isPresent)return;const{dragSnapToOrigin:s}=this.getProps();this.panSession=new Ut(t,{onSessionStart:t=>{n?(this.stopAnimation(),this.snapToCursor(Ot(t).point)):this.pauseAnimation()},onStart:(t,n)=>{this.stopAnimation();const{drag:e,dragPropagation:o,onDragStart:s}=this.getProps();if(e&&!o&&(this.openDragLock&&this.openDragLock(),this.openDragLock=W(e),!this.openDragLock))return;this.latestPointerEvent=t,this.latestPanInfo=n,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),D(t=>{let n=this.getAxisMotionValue(t).get()||0;if(O.test(n)){const{projection:e}=this.visualElement;if(e&&e.layout){const o=e.layout.layoutBox[t];if(o){n=b(o)*(parseFloat(n)/100)}}}this.originPoint[t]=n}),s&&M.postRender(()=>s(t,n)),k(this.visualElement,"transform");const{animationState:i}=this.visualElement;i&&i.setActive("whileDrag",!0)},onMove:(t,n)=>{this.latestPointerEvent=t,this.latestPanInfo=n;const{dragPropagation:e,dragDirectionLock:o,onDirectionLock:s,onDrag:i}=this.getProps();if(!e&&!this.openDragLock)return;const{offset:r}=n;if(o&&null===this.currentDirection)return this.currentDirection=function(t,n=10){let e=null;Math.abs(t.y)>n?e="y":Math.abs(t.x)>n&&(e="x");return e}(r),void(null!==this.currentDirection&&s&&s(this.currentDirection));this.updateAxis("x",n.point,r),this.updateAxis("y",n.point,r),this.visualElement.render(),i&&i(t,n)},onSessionEnd:(t,n)=>{this.latestPointerEvent=t,this.latestPanInfo=n,this.stop(t,n),this.latestPointerEvent=null,this.latestPanInfo=null},resumeAnimation:()=>D(t=>"paused"===this.getAnimationState(t)&&this.getAxisMotionValue(t).animation?.play())},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:s,distanceThreshold:e,contextWindow:Ht(this.visualElement),element:this.visualElement.current})}stop(t,n){const e=t||this.latestPointerEvent,o=n||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!o||!e)return;const{velocity:i}=o;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&M.postRender(()=>r(e,o))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:e}=this.getProps();!e&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,e){const{drag:o}=this.getProps();if(!e||!en(t,o,this.currentDirection))return;const s=this.getAxisMotionValue(t);let i=this.originPoint[t]+e[t];this.constraints&&this.constraints[t]&&(i=function(t,{min:n,max:e},o){return void 0!==n&&t<n?t=o?L(n,t,o.min):Math.max(t,n):void 0!==e&&t>e&&(t=o?L(e,t,o.max):Math.min(t,e)),t}(i,this.constraints[t],this.elastic[t])),s.set(i)}resolveConstraints(){const{dragConstraints:t,dragElastic:n}=this.getProps(),e=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,o=this.constraints;t&&bt(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!e)&&function(t,{top:n,left:e,bottom:o,right:s}){return{x:zt(t.x,e,s),y:zt(t.y,n,o)}}(e.layoutBox,t),this.elastic=function(t=Kt){return!1===t?t=0:!0===t&&(t=Kt),{x:Zt(t,"left","right"),y:Zt(t,"top","bottom")}}(n),o!==this.constraints&&e&&this.constraints&&!this.hasMutatedConstraints&&D(t=>{!1!==this.constraints&&this.getAxisMotionValue(t)&&(this.constraints[t]=function(t,n){const e={};return void 0!==n.min&&(e.min=n.min-t.min),void 0!==n.max&&(e.max=n.max-t.min),e}(e.layoutBox[t],this.constraints[t]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!bt(t))return!1;const e=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const s=j(e,o.root,this.visualElement.getTransformPagePoint());let i=function(t,n){return{x:Jt(t.x,n.x),y:Jt(t.y,n.y)}}(o.layout.layoutBox,s);if(n){const t=n(V(i));this.hasMutatedConstraints=!!t,t&&(i=I(t))}return i}startAnimation(t){const{drag:n,dragMomentum:e,dragElastic:o,dragTransition:s,dragSnapToOrigin:i,onDragTransitionEnd:r}=this.getProps(),a=this.constraints||{},u=D(r=>{if(!en(r,n,this.currentDirection))return;let u=a&&a[r]||{};i&&(u={min:0,max:0});const l=o?200:1e6,c=o?40:1e7,h={type:"inertia",velocity:e?t[r]:0,bounceStiffness:l,bounceDamping:c,timeConstant:750,restDelta:1,restSpeed:10,...s,...u};return this.startAxisValueAnimation(r,h)});return Promise.all(u).then(r)}startAxisValueAnimation(t,n){const e=this.getAxisMotionValue(t);return k(this.visualElement,t),e.start(R(t,e,0,n,this.visualElement,!1))}stopAnimation(){D(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){D(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,e=this.visualElement.getProps(),o=e[n];return o||this.visualElement.getValue(t,(e.initial?e.initial[t]:void 0)||0)}snapToCursor(t){D(n=>{const{drag:e}=this.getProps();if(!en(n,e,this.currentDirection))return;const{projection:o}=this.visualElement,s=this.getAxisMotionValue(n);if(o&&o.layout){const{min:e,max:i}=o.layout.layoutBox[n],r=s.get()||0;s.set(t[n]-L(e,i,.5)+r)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:e}=this.visualElement;if(!bt(n)||!e||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};D(t=>{const n=this.getAxisMotionValue(t);if(n&&!1!==this.constraints){const e=n.get();o[t]=function(t,n){let e=.5;const o=b(t),s=b(n);return s>o?e=$(n.min,n.max-o,t.min):o>s&&(e=$(t.min,t.max-s,n.min)),_(0,1,e)}({min:e,max:e},this.constraints[t])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",e.root&&e.root.updateScroll(),e.updateLayout(),this.resolveConstraints(),D(n=>{if(!en(n,t,null))return;const e=this.getAxisMotionValue(n),{min:s,max:i}=this.constraints[n];e.set(L(s,i,o[n]))})}addListeners(){if(!this.visualElement.current)return;tn.set(this.visualElement,this);const t=Ft(this.visualElement.current,"pointerdown",t=>{const{drag:n,dragListener:e=!0}=this.getProps();n&&e&&!F(t.target)&&this.start(t)}),n=()=>{const{dragConstraints:t}=this.getProps();bt(t)&&t.current&&(this.constraints=this.resolveRefConstraints())},{projection:e}=this.visualElement,o=e.addEventListener("measure",n);e&&!e.layout&&(e.root&&e.root.updateScroll(),e.updateLayout()),M.read(n);const s=S(window,"resize",()=>this.scalePositionWithinConstraints()),i=e.addEventListener("didUpdate",({delta:t,hasLayoutChanged:n})=>{this.isDragging&&n&&(D(n=>{const e=this.getAxisMotionValue(n);e&&(this.originPoint[n]+=t[n].translate,e.set(e.get()+t[n].translate))}),this.visualElement.render())});return()=>{s(),t(),o(),i&&i()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:e=!1,dragPropagation:o=!1,dragConstraints:s=!1,dragElastic:i=Kt,dragMomentum:r=!0}=t;return{...t,drag:n,dragDirectionLock:e,dragPropagation:o,dragConstraints:s,dragElastic:i,dragMomentum:r}}}function en(t,n,e){return!(!0!==n&&n!==t||null!==e&&e!==t)}const on=t=>(n,e)=>{t&&M.postRender(()=>t(n,e))};let sn=!1;class rn extends t.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:e,layoutId:o}=this.props,{projection:s}=t;s&&(n.group&&n.group.add(s),e&&e.register&&o&&e.register(s),sn&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),H.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:e,drag:o,isPresent:s}=this.props,{projection:i}=e;return i?(i.isPresent=s,sn=!0,o||t.layoutDependency!==n||void 0===n||t.isPresent!==s?i.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?i.promote():i.relegate()||M.postRender(()=>{const t=i.getStack();t&&t.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),B.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:e}=this.props,{projection:o}=t;sn=!0,o&&(o.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(o),e&&e.deregister&&e.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function an(e){const[o,s]=function(n=!0){const e=t.useContext(Q);if(null===e)return[!0,null];const{isPresent:o,onExitComplete:s,register:i}=e,r=t.useId();t.useEffect(()=>{if(n)return i(r)},[n]);const a=t.useCallback(()=>n&&s&&s(r),[r,s,n]);return!o&&s?[!1,a]:[!0]}(),i=t.useContext(J);return n.jsx(rn,{...e,layoutGroup:i,switchLayoutGroup:t.useContext(Lt),isPresent:o,safeToRemove:s})}const un={pan:{Feature:class extends w{constructor(){super(...arguments),this.removePointerDownListener=z}onPointerDown(t){this.session=new Ut(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Ht(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:e,onPanEnd:o}=this.node.getProps();return{onSessionStart:on(t),onStart:on(n),onMove:e,onEnd:(t,n)=>{delete this.session,o&&M.postRender(()=>o(t,n))}}}mount(){this.removePointerDownListener=Ft(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends w{constructor(t){super(t),this.removeGroupControls=z,this.removeListeners=z,this.controls=new nn(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||z}update(){const{dragControls:t}=this.node.getProps(),{dragControls:n}=this.node.prevProps||{};t!==n&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:G,MeasureLayout:an}};function ln(t,n,e){const{props:o}=t;t.animationState&&o.whileHover&&t.animationState.setActive("whileHover","Start"===e);const s=o["onHover"+e];s&&M.postRender(()=>s(n,Ot(n)))}function cn(t,n,e){const{props:o}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&o.whileTap&&t.animationState.setActive("whileTap","Start"===e);const s=o["onTap"+("End"===e?"":e)];s&&M.postRender(()=>s(n,Ot(n)))}const hn=new WeakMap,dn=new WeakMap,mn=t=>{const n=hn.get(t.target);n&&n(t)},pn=t=>{t.forEach(mn)};function fn(t,n,e){const o=function({root:t,...n}){const e=t||document;dn.has(e)||dn.set(e,{});const o=dn.get(e),s=JSON.stringify(n);return o[s]||(o[s]=new IntersectionObserver(pn,{root:t,...n})),o[s]}(n);return hn.set(t,e),o.observe(t),()=>{hn.delete(t),o.unobserve(t)}}const gn={some:0,all:1};const vn=It({...Wt,...{inView:{Feature:class extends w{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:e,amount:o="some",once:s}=t,i={root:n?n.current:void 0,rootMargin:e,threshold:"number"==typeof o?o:gn[o]};return fn(this.node.current,i,t=>{const{isIntersecting:n}=t;if(this.isInView===n)return;if(this.isInView=n,s&&!n&&this.hasEnteredView)return;n&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",n);const{onViewportEnter:e,onViewportLeave:o}=this.node.getProps(),i=n?e:o;i&&i(t)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(function({viewport:t={}},{viewport:n={}}={}){return e=>t[e]!==n[e]}(t,n))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends w{mount(){const{current:t}=this.node;t&&(this.unmount=N(t,(t,n)=>(cn(this.node,n,"Start"),(t,{success:n})=>cn(this.node,t,n?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends w{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch(n){t=!0}t&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=X(S(this.node.current,"focus",()=>this.onFocus()),S(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends w{mount(){const{current:t}=this.node;t&&(this.unmount=U(t,(t,n)=>(ln(this.node,n,"Start"),t=>ln(this.node,t,"End"))))}unmount(){}}}},...un,...{layout:{ProjectionNode:G,MeasureLayout:an}}},kt);export{vn as m};
