contracts:
  id: ADRI_audit_log
  name: ADRI Audit Log Standard
  version: 1.0.0
  authority: ADRI Framework
  description: Standard for validating ADRI audit log JSONL structure and content
record_identification:
  primary_key_fields:
  - assessment_id
  strategy: primary_key_with_fallback
requirements:
  overall_minimum: 95.0
  field_requirements:
    assessment_id:
      type: string
      nullable: false
      pattern: ^adri_\d{8}_\d{6}_[a-f0-9]+$
      description: Unique assessment identifier
      validation_rules:
      - name: assessment_id is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: assessment_id must not be empty
      - name: assessment_id type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: assessment_id must be of type string
      - name: assessment_id pattern validation
        dimension: validity
        severity: WARNING
        rule_type: pattern
        rule_expression: REGEX_MATCH('^adri_\d{8}_\d{6}_[a-f0-9]+$')
        error_message: 'assessment_id must match pattern: ^adri_\d{8}_\d{6}_[a-f0-9]+$'
    timestamp:
      type: string
      nullable: false
      pattern: ^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+$
      description: ISO 8601 timestamp of assessment
      validation_rules:
      - name: timestamp is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: timestamp must not be empty
      - name: timestamp type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: timestamp must be of type string
      - name: timestamp pattern validation
        dimension: validity
        severity: WARNING
        rule_type: pattern
        rule_expression: REGEX_MATCH('^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+$')
        error_message: 'timestamp must match pattern: ^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+$'
    adri_version:
      type: string
      nullable: false
      description: ADRI version that performed the assessment
      validation_rules:
      - name: adri_version is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: adri_version must not be empty
      - name: adri_version type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: adri_version must be of type string
    assessment_type:
      type: string
      nullable: false
      valid_values:
      - QUALITY_CHECK
      - VALIDATION
      - PROFILING
      description: Type of assessment performed
      validation_rules:
      - name: assessment_type is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: assessment_type must not be empty
      - name: assessment_type type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: assessment_type must be of type string
    function_name:
      type: string
      nullable: false
      description: Function that triggered the assessment
      validation_rules:
      - name: function_name is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: function_name must not be empty
      - name: function_name type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: function_name must be of type string
    module_path:
      type: string
      nullable: false
      description: Module path where assessment was triggered
      validation_rules:
      - name: module_path is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: module_path must not be empty
      - name: module_path type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: module_path must be of type string
    environment:
      type: string
      nullable: false
      valid_values:
      - PRODUCTION
      - DEVELOPMENT
      - TESTING
      - STAGING
      description: Environment where assessment ran
      validation_rules:
      - name: environment is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: environment must not be empty
      - name: environment type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: environment must be of type string
    hostname:
      type: string
      nullable: false
      description: Hostname of system running assessment
      validation_rules:
      - name: hostname is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: hostname must not be empty
      - name: hostname type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: hostname must be of type string
    process_id:
      type: integer
      nullable: false
      min_value: 0
      description: Process ID of assessment execution
      validation_rules:
      - name: process_id is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: process_id must not be empty
      - name: process_id type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_INTEGER
        error_message: process_id must be of type integer
      - name: process_id numeric bounds
        dimension: validity
        severity: CRITICAL
        rule_type: numeric_bounds
        rule_expression: VALUE >= 0
        error_message: process_id must be between 0 and None
    standard_id:
      type: string
      nullable: false
      description: ID of standard used for assessment
      validation_rules:
      - name: standard_id is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: standard_id must not be empty
      - name: standard_id type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: standard_id must be of type string
    standard_version:
      type: string
      nullable: false
      description: Version of standard (may be 'unknown')
      validation_rules:
      - name: standard_version is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: standard_version must not be empty
      - name: standard_version type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: standard_version must be of type string
    standard_checksum:
      type: string
      nullable: true
      description: Checksum of standard file (optional)
      validation_rules:
      - name: standard_checksum type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: standard_checksum must be of type string
    standard_path:
      type: string
      nullable: false
      description: Full absolute path to standard file used for assessment
      validation_rules:
      - name: standard_path is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: standard_path must not be empty
      - name: standard_path type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: standard_path must be of type string
    data_row_count:
      type: integer
      nullable: false
      min_value: 0
      description: Number of rows in assessed dataset
      validation_rules:
      - name: data_row_count is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: data_row_count must not be empty
      - name: data_row_count type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_INTEGER
        error_message: data_row_count must be of type integer
      - name: data_row_count numeric bounds
        dimension: validity
        severity: CRITICAL
        rule_type: numeric_bounds
        rule_expression: VALUE >= 0
        error_message: data_row_count must be between 0 and None
    data_column_count:
      type: integer
      nullable: false
      min_value: 0
      description: Number of columns in assessed dataset
      validation_rules:
      - name: data_column_count is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: data_column_count must not be empty
      - name: data_column_count type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_INTEGER
        error_message: data_column_count must be of type integer
      - name: data_column_count numeric bounds
        dimension: validity
        severity: CRITICAL
        rule_type: numeric_bounds
        rule_expression: VALUE >= 0
        error_message: data_column_count must be between 0 and None
    data_columns:
      type: string
      nullable: false
      description: JSON array of column names
      validation_rules:
      - name: data_columns is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: data_columns must not be empty
      - name: data_columns type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: data_columns must be of type string
    data_checksum:
      type: string
      nullable: false
      description: Checksum of data
      validation_rules:
      - name: data_checksum is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: data_checksum must not be empty
      - name: data_checksum type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: data_checksum must be of type string
    overall_score:
      type: float
      nullable: false
      min_value: 0.0
      max_value: 100.0
      description: Overall quality score (0-100)
      validation_rules:
      - name: overall_score is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: overall_score must not be empty
      - name: overall_score type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_FLOAT
        error_message: overall_score must be of type float
      - name: overall_score numeric bounds
        dimension: validity
        severity: CRITICAL
        rule_type: numeric_bounds
        rule_expression: VALUE >= 0.0 AND VALUE <= 100.0
        error_message: overall_score must be between 0.0 and 100.0
    required_score:
      type: float
      nullable: false
      min_value: 0.0
      max_value: 100.0
      description: Required minimum score for passing
      validation_rules:
      - name: required_score is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: required_score must not be empty
      - name: required_score type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_FLOAT
        error_message: required_score must be of type float
      - name: required_score numeric bounds
        dimension: validity
        severity: CRITICAL
        rule_type: numeric_bounds
        rule_expression: VALUE >= 0.0 AND VALUE <= 100.0
        error_message: required_score must be between 0.0 and 100.0
    passed:
      type: boolean
      nullable: false
      description: Whether assessment passed threshold
      validation_rules:
      - name: passed is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: passed must not be empty
      - name: passed type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_BOOLEAN
        error_message: passed must be of type boolean
    execution_decision:
      type: string
      nullable: false
      valid_values:
      - ALLOWED
      - BLOCKED
      - WARNED
      description: Decision made based on assessment result
      validation_rules:
      - name: execution_decision is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: execution_decision must not be empty
      - name: execution_decision type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: execution_decision must be of type string
    failure_mode:
      type: string
      nullable: false
      valid_values:
      - raise
      - warn
      - log
      description: How failures are handled
      validation_rules:
      - name: failure_mode is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: failure_mode must not be empty
      - name: failure_mode type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_STRING
        error_message: failure_mode must be of type string
    function_executed:
      type: boolean
      nullable: false
      description: Whether protected function was executed
      validation_rules:
      - name: function_executed is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: function_executed must not be empty
      - name: function_executed type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_BOOLEAN
        error_message: function_executed must be of type boolean
    assessment_duration_ms:
      type: integer
      nullable: false
      min_value: 0
      description: Duration of assessment in milliseconds
      validation_rules:
      - name: assessment_duration_ms is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: assessment_duration_ms must not be empty
      - name: assessment_duration_ms type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_INTEGER
        error_message: assessment_duration_ms must be of type integer
      - name: assessment_duration_ms numeric bounds
        dimension: validity
        severity: CRITICAL
        rule_type: numeric_bounds
        rule_expression: VALUE >= 0
        error_message: assessment_duration_ms must be between 0 and None
    rows_per_second:
      type: float
      nullable: false
      min_value: 0.0
      description: Processing rate (rows per second)
      validation_rules:
      - name: rows_per_second is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: rows_per_second must not be empty
      - name: rows_per_second type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_FLOAT
        error_message: rows_per_second must be of type float
      - name: rows_per_second numeric bounds
        dimension: validity
        severity: CRITICAL
        rule_type: numeric_bounds
        rule_expression: VALUE >= 0.0
        error_message: rows_per_second must be between 0.0 and None
    cache_used:
      type: boolean
      nullable: false
      description: Whether cached results were used
      validation_rules:
      - name: cache_used is required
        dimension: completeness
        severity: CRITICAL
        rule_type: not_null
        rule_expression: IS_NOT_NULL
        error_message: cache_used must not be empty
      - name: cache_used type validation
        dimension: validity
        severity: CRITICAL
        rule_type: type
        rule_expression: IS_BOOLEAN
        error_message: cache_used must be of type boolean
  dimension_requirements:
    validity:
      minimum_score: 19.0
      weight: 1.0
      scoring:
        rule_weights:
          data_types: 1.0
          value_ranges: 1.0
        field_overrides: {}
    completeness:
      minimum_score: 19.0
      weight: 1.0
      scoring:
        rule_weights:
          required_fields: 1.0
        field_overrides: {}
    consistency:
      minimum_score: 19.0
      weight: 1.0
      scoring:
        rule_weights:
          field_consistency: 1.0
        field_overrides: {}
    freshness:
      minimum_score: 18.0
      weight: 1.0
      scoring:
        rule_weights:
          timestamp_validity: 1.0
        field_overrides: {}
    plausibility:
      minimum_score: 18.0
      weight: 1.0
      scoring:
        rule_weights:
          score_ranges: 1.0
          enum_values: 1.0
        field_overrides: {}
metadata:
  purpose: Self-validation of ADRI audit log outputs
  usage: 'This standard validates that ADRI audit log JSONL files contain:

    1. All required tracking fields with correct types

    2. Valid timestamps and identifiers

    3. Proper score ranges and boolean flags

    4. Valid enum values for categorical fields

    5. Complete execution and performance metrics

    '
  validation_notes: '- assessment_id must follow pattern: adri_YYYYMMDD_HHMMSS_hexhash

    - timestamp must be valid ISO 8601 format

    - overall_score and required_score must be 0-100

    - Categorical fields have specific valid values

    - All performance metrics must be non-negative

    - data_columns should be valid JSON array format

    '
  integration_notes: "This assessment log is the anchor for ADRI's audit trail and integrates with:\n\n1. Dimension Scores\
    \ (adri_dimension_scores.jsonl):\n   - Links via assessment_id\n   - Provides detailed breakdown of overall_score by dimension\n\
    \n2. Failed Validations (adri_failed_validations.jsonl):\n   - Links via assessment_id\n   - Details specific validation\
    \ failures\n\n3. View-Logs Display (see ADRI_view_logs_display.yaml):\n   - Uses data_row_count to show assessment volume\
    \ in CLI summary\n   - Aggregates failed_validations.affected_rows to show error counts\n   - Provides quick status view\
    \ for demos and troubleshooting\n\nThe data_row_count field is particularly important for:\n- Understanding assessment\
    \ scale and context\n- Calculating error rates (failed_rows / total_rows)\n- Performance metrics (rows_per_second calculation)\n\
    - Capacity planning and optimization\n"
  created_by: ADRI Framework
  created_date: 2025-10-03
  last_updated: 2025-01-09
  update_notes: Added integration notes documenting view-logs display usage
