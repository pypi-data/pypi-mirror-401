# KairoCore 项目结构详细说明

## 📁 项目整体结构

```
your_project_name/
├── main.py              # 应用程序入口文件
├── action/              # 业务逻辑层目录
│   └── user.py          # 用户相关业务逻辑实现
├── dao/                 # 数据访问层目录
│   ├── __init__.py      # DAO模块初始化文件
│   └── user.py          # 用户数据访问对象实现
├── domain/              # 领域模型层目录
│   ├── __init__.py      # 领域模型初始化文件
│   └── user.py          # 用户领域模型和业务逻辑处理
├── schema/              # 数据模式层目录
│   └── user.py          # 用户数据传输对象和验证规则
└── common/              # 公共组件目录
    ├── consts.py        # 全局常量定义
    └── errors.py        # 自定义异常和错误处理
```

## 🎯 各层详细说明

### 1. main.py - 应用入口层

**职责**：应用程序的启动文件，负责初始化和配置整个 KairoCore 应用。

**功能**：
- 加载环境变量配置
- 初始化 KairoCore 应用实例
- 启动应用服务器
- 注册路由和中间件

### 2. action/ - 业务逻辑层

**职责**：处理具体的业务逻辑，协调各组件完成业务操作

**特点**：
- 对接 API 接口与领域模型
- 实现具体的业务流程
- 调用 DAO 层进行数据操作
- 返回标准化的响应格式

**包含内容**：
- 定义 RESTful API 路由
- 处理 HTTP 请求和响应
- 参数验证和错误处理
- 用户管理的增删改查操作

### 3. schema/ - 数据模式层

**职责**：定义数据传输对象（DTO）和数据验证规则

**特点**：
- 使用 Pydantic 进行数据建模和验证
- 定义请求和响应的数据结构
- 包含字段验证规则和业务约束
- 支持枚举类型和复杂数据结构

**包含内容**：
- 用户数据的增删改查 DTO
- 数据验证规则和自定义验证器
- 枚举类型定义（如性别、会员状态等）
- 分页查询参数定义

### 4. domain/ - 领域模型层

**职责**：实现核心业务逻辑和领域规则

**特点**：
- 包含业务实体和领域服务
- 实现复杂的业务规则和计算
- 协调 DAO 层进行数据操作
- 提供领域专用的工具方法

**包含内容**：
- 用户领域模型实现
- 业务逻辑处理方法
- 数据转换和翻译工具
- 领域专用的辅助函数

### 5. dao/ - 数据访问层

**职责**：负责与数据库进行交互，处理数据持久化

**特点**：
- 封装数据库操作细节
- 提供统一的数据访问接口
- 处理数据查询、插入、更新、删除操作
- 实现分页查询和复杂查询逻辑

**包含内容**：
- 用户数据的 CRUD 操作
- 分页查询实现
- 数据过滤和排序逻辑
- 数据库连接和事务管理

### 6. common/ - 公共组件层

**职责**：提供项目范围内共享的常量、工具和配置

**特点**：
- 全局共享的配置和常量
- 统一的异常处理机制
- 可复用的工具函数和组件
- 项目级别的配置管理

**包含内容**：
- 系统常量和枚举定义
- 自定义异常类型
- 公共工具函数
- 全局配置参数

## 🔗 层间关系

```
┌─────────────┐
│   action    │ ◄── API路由和业务协调
└──────┬──────┘
       │
┌──────▼──────┐
│   domain    │ ◄── 核心业务逻辑实现
└──────┬──────┘
       │
┌──────▼──────┐
│     dao     │ ◄── 数据访问接口
└──────┬──────┘
       │
┌──────▼──────┐
│   database  │ ◄── 数据存储层
└─────────────┘

┌─────────────┐
│   schema    │ ◄── 数据验证和传输
└─────────────┘

┌─────────────┐
│   common    │ ◄── 全局共享组件
└─────────────┘
```

## 🎨 设计原则

### 分层清晰
- 各层职责明确，避免交叉调用
- 上层依赖下层，不反向依赖
- 通过接口进行层间通信

### 职责单一
- 每个模块只负责一个核心功能
- 便于测试和维护
- 降低代码耦合度

### 可扩展性
- 模块化设计，易于功能扩展
- 插件化架构，支持自定义组件
- 遵循开闭原则

### 可维护性
- 代码结构清晰，易于理解
- 命名规范统一
- 文档和注释完整

## 🚀 开发流程

1. **定义数据结构**：在 `schema/` 中定义数据传输对象
2. **实现数据访问**：在 `dao/` 中实现数据库操作
3. **编写业务逻辑**：在 `domain/` 中实现核心业务规则
4. **创建API接口**：在 `action/` 中定义和实现API路由, 路由配置 `ENABLE_ROUTER=False` 禁用路由
5. **配置共享组件**：在 `common/` 中添加常量和异常定义
6. **启动应用**：通过 `main.py` 启动服务

这种分层架构设计使得项目结构清晰、易于维护和扩展，符合现代 Web 应用开发的最佳实践。