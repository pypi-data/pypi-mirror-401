{
  "$defs": {
    "TestDefinition": {
      "description": "A single test to be executed.",
      "properties": {
        "systems_under_test": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "A list of system names (from systems.yaml) to run this test against. Can be inherited from test_suite_default.",
          "title": "Systems Under Test"
        },
        "systems": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional additional systems for the test (e.g., simulator_system, evaluator_system).",
          "title": "Systems"
        },
        "tags": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional tags for filtering and reporting.",
          "title": "Tags"
        },
        "params": {
          "anyOf": [
            {
              "additionalProperties": true,
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Parameters to be passed to the test container's entrypoint.",
          "title": "Params"
        },
        "input_datasets": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Input dataset names mapped to dataset registry references. Values must be dataset names defined in the datasets registry config (--datasets-config).",
          "title": "Input Datasets"
        },
        "volumes": {
          "anyOf": [
            {
              "additionalProperties": true,
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional input/output mounts.",
          "title": "Volumes"
        },
        "env_file": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Path to .env file containing environment variables for this test's container execution (e.g., '.env', 'test.env').",
          "title": "Env File"
        },
        "environment": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Dictionary of environment variables to pass to the test container. Supports interpolation syntax (e.g., {'OPENAI_API_KEY': '${OPENAI_API_KEY}'}).",
          "title": "Environment"
        },
        "id": {
          "description": "A unique, human-readable ID (up to 32 characters) for this test instance. Can include lowercase letters (a–z), digits (0–9) and underscore (_).",
          "pattern": "^[0-9a-z_]{1,32}$",
          "title": "Id",
          "type": "string"
        },
        "name": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "A descriptive, human-friendly name for this test instance.",
          "title": "Name"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "A short summary of the purpose of the test and what it aims to validate.",
          "title": "Description"
        },
        "image": {
          "description": "The Docker image to run for this test, e.g., 'my-registry/garak:latest'.",
          "title": "Image",
          "type": "string"
        }
      },
      "required": [
        "id",
        "image"
      ],
      "title": "TestDefinition",
      "type": "object"
    },
    "TestSuiteDefault": {
      "description": "Default values that apply to all tests in the suite unless overridden.",
      "properties": {
        "systems_under_test": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "A list of system names (from systems.yaml) to run this test against. Can be inherited from test_suite_default.",
          "title": "Systems Under Test"
        },
        "systems": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional additional systems for the test (e.g., simulator_system, evaluator_system).",
          "title": "Systems"
        },
        "tags": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional tags for filtering and reporting.",
          "title": "Tags"
        },
        "params": {
          "anyOf": [
            {
              "additionalProperties": true,
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Parameters to be passed to the test container's entrypoint.",
          "title": "Params"
        },
        "input_datasets": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Input dataset names mapped to dataset registry references. Values must be dataset names defined in the datasets registry config (--datasets-config).",
          "title": "Input Datasets"
        },
        "volumes": {
          "anyOf": [
            {
              "additionalProperties": true,
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Optional input/output mounts.",
          "title": "Volumes"
        },
        "env_file": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Path to .env file containing environment variables for this test's container execution (e.g., '.env', 'test.env').",
          "title": "Env File"
        },
        "environment": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Dictionary of environment variables to pass to the test container. Supports interpolation syntax (e.g., {'OPENAI_API_KEY': '${OPENAI_API_KEY}'}).",
          "title": "Environment"
        }
      },
      "title": "TestSuiteDefault",
      "type": "object"
    }
  },
  "description": "Schema for the top-level Test Suite configuration file.",
  "properties": {
    "suite_name": {
      "description": "Name of this test suite.",
      "title": "Suite Name",
      "type": "string"
    },
    "test_suite_default": {
      "anyOf": [
        {
          "$ref": "#/$defs/TestSuiteDefault"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Default values that apply to all tests in the suite unless overridden"
    },
    "description": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "A short summary of the test suite and what it aims to evaluate.",
      "title": "Description"
    },
    "test_suite": {
      "description": "List of individual focused tests.",
      "items": {
        "$ref": "#/$defs/TestDefinition"
      },
      "title": "Test Suite",
      "type": "array"
    }
  },
  "required": [
    "suite_name",
    "test_suite"
  ],
  "title": "ASQI SuiteConfig",
  "type": "object",
  "$schema": "https://json-schema.org/draft/2020-12/schema"
}