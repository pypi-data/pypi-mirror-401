import{a3 as I,i as c,l as V,n as C,p as x,r as j,o as D,q as N,A as F,I as H,_ as J}from"./_plugin-vue_export-helper-DIV_95uD.js";import{L as O,V as Q}from"./VSelect-0SukG3gG.js";import{V as L,a as B}from"./LoadingSpinner.vue_vue_type_style_index_0_scoped_0c8a0411_lang-D_MGrIbP.js";import{e as X,f as T,g as Y,h as K,V as W}from"./VMenu-CRN2gxfd.js";import{V as k,a as Z}from"./VContainer-Dp3Q7MEs.js";import{V as U}from"./VDialog-BRH2VoLb.js";import{V as S}from"./VSpacer-DC1r4rXe.js";import{J as ee,r as o,o as ae,a8 as te,N as w,Q as u,R as a,c as e,b as r,W as n,S as G,H as le,U as ne,Y as i,X as se,b7 as ie,b8 as oe}from"./index-DMKqdLaf.js";import{V as re}from"./VAlert-lJiK8Tm2.js";import"./VTextField-Bjfd5Be9.js";import"./forwardRefs-DYN4dGLY.js";const de={class:"d-flex align-center justify-space-between flex-wrap ga-4"},ce={class:"text-h5 text-sm-h4 font-weight-bold mb-1"},ue={class:"text-body-2 text-medium-emphasis mb-0"},me={class:"d-none d-sm-inline ml-2"},pe={class:"text-caption"},fe={key:2,class:"text-center py-12"},ve={class:"text-h6 text-medium-emphasis"},ge={class:"text-body-2 text-medium-emphasis mb-4"},Ve={class:"d-flex align-center"},we=ee({__name:"warnings",setup(ye){const y=o([]),$=o(!1),m=o(!1),f=o(!1),v=o([]),_=o(!1),p=o(null),R=o(!1),g=o(null),A=o(!1);ae(async()=>{await b()}),te(async()=>{await b()});const b=async()=>{$.value=!0;try{const t=await I.listRecipientsApiV1WarningsRecipientsGet({});y.value=t.items||[]}catch(t){console.error(t)}finally{$.value=!1}},z=async()=>{m.value=!0,p.value=null,_.value=!0;try{const t=await F.listAdaptersApiV1AdaptersGet(),s=new Set((t||[]).filter(d=>d.type==="pusher").map(d=>d.name)),h=(await H.listInstancesApiV1InstancesGet({})).items||[],M=new Set(y.value.map(d=>d.id));v.value=h.filter(d=>s.has(d.adapter_name)&&!M.has(d.id))}catch(t){console.error(t)}finally{_.value=!1}},P=async()=>{if(p.value){R.value=!0;try{await I.addRecipientApiV1WarningsRecipientsPost({requestBody:{adapter_instance_id:p.value}}),m.value=!1,await b()}catch(t){console.error(t)}finally{R.value=!1}}},q=t=>{g.value=t,f.value=!0},E=async()=>{if(g.value){A.value=!0;try{await I.deleteRecipientApiV1WarningsRecipientsAdapterInstanceIdDelete({adapterInstanceId:g.value.id}),f.value=!1,g.value=null,await b()}catch(t){console.error(t)}finally{A.value=!1}}};return(t,s)=>(u(),w(Z,{fluid:""},{default:a(()=>[e(L,{class:"mb-6"},{default:a(()=>[e(B,{cols:"12"},{default:a(()=>[r("div",de,[r("div",null,[r("h1",ce,n(t.$t("warnings.title")),1),r("p",ue,n(t.$t("warnings.description")),1)]),e(c,{color:"primary",icon:t.$vuetify.display.xs,onClick:z},{default:a(()=>[e(V,{icon:"mdi-plus"}),r("span",me,n(t.$t("warnings.addRecipient")),1)]),_:1},8,["icon"])])]),_:1})]),_:1}),e(L,null,{default:a(()=>[e(B,{cols:"12"},{default:a(()=>[e(C,{class:"card-outlined"},{default:a(()=>[$.value?(u(),w(x,{key:0},{default:a(()=>[e(O,{text:t.$t("warnings.loadingRecipients")},null,8,["text"])]),_:1})):y.value.length>0?(u(),w(X,{key:1,lines:"two",class:"bg-transparent"},{default:a(()=>[(u(!0),G(le,null,ne(y.value,l=>(u(),w(T,{key:l.id,rounded:"lg",class:"mx-2 my-1",border:""},{prepend:a(()=>[e(j,{color:"warning",variant:"tonal",size:"48"},{default:a(()=>[e(V,{icon:"mdi-bell-outline"})]),_:1})]),append:a(()=>[e(c,{icon:"mdi-delete-outline",variant:"text",color:"error",size:"small",onClick:h=>q(l)},null,8,["onClick"])]),default:a(()=>[e(Y,{class:"font-weight-bold"},{default:a(()=>[i(n(l.identifier),1)]),_:2},1024),e(K,null,{default:a(()=>[e(k,{size:"x-small",color:"primary",variant:"tonal",label:"",class:"mr-2"},{default:a(()=>[i(n(l.adapter_name),1)]),_:2},1024),r("span",pe,n(l.id),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(u(),G("div",fe,[e(V,{icon:"mdi-bell-off-outline",size:"64",color:"medium-emphasis",class:"mb-4"}),r("div",ve,n(t.$t("warnings.noRecipientsConfigured")),1),r("div",ge,n(t.$t("warnings.addAdapterInstancesToReceiveWarningNotifications")),1),e(c,{color:"primary","prepend-icon":"mdi-plus",onClick:z},{default:a(()=>[i(n(t.$t("warnings.addRecipient")),1)]),_:1})]))]),_:1})]),_:1})]),_:1}),e(U,{modelValue:m.value,"onUpdate:modelValue":s[3]||(s[3]=l=>m.value=l),"max-width":"500px",persistent:"",fullscreen:t.$vuetify.display.smAndDown},{default:a(()=>[e(C,{rounded:t.$vuetify.display.smAndDown?"0":"xl"},{default:a(()=>[e(D,{class:"d-flex align-center pa-4"},{default:a(()=>[e(V,{icon:"mdi-bell-plus",class:"mr-2"}),i(" "+n(t.$t("warnings.addRecipient"))+" ",1),e(S),e(c,{icon:"mdi-close",variant:"text",size:"small",onClick:s[0]||(s[0]=l=>m.value=!1)})]),_:1}),e(W),e(x,{class:"pa-4"},{default:a(()=>[e(Q,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=l=>p.value=l),items:v.value,"item-title":"identifier","item-value":"id",label:t.$t("warnings.selectAdapterInstance"),"prepend-inner-icon":"mdi-server",loading:_.value,hint:v.value.length>0?t.$t("warnings.instancesAvailable",{count:v.value.length}):t.$t("warnings.noInstancesAvailable"),"persistent-hint":""},{item:a(({props:l,item:h})=>[e(T,ie(oe(l)),{subtitle:a(()=>[e(k,{size:"x-small",color:"primary",variant:"tonal",label:""},{default:a(()=>[i(n(h.raw.adapter_name),1)]),_:2},1024)]),_:2},1040)]),selection:a(({item:l})=>[r("div",Ve,[r("span",null,n(l.raw.identifier),1),e(k,{size:"x-small",color:"primary",variant:"tonal",label:"",class:"ml-2"},{default:a(()=>[i(n(l.raw.adapter_name),1)]),_:2},1024)])]),_:1},8,["modelValue","items","label","loading","hint"]),v.value.length===0&&!_.value?(u(),w(re,{key:0,type:"info",variant:"tonal",density:"compact",class:"mt-4"},{default:a(()=>[i(n(t.$t("warnings.allInstancesAlreadyConfiguredOrNotExist")),1)]),_:1})):se("",!0)]),_:1}),e(W),e(N,{class:"pa-2 pa-sm-4"},{default:a(()=>[e(S),e(c,{variant:"text",onClick:s[2]||(s[2]=l=>m.value=!1)},{default:a(()=>[i(n(t.$t("common.cancel")),1)]),_:1}),e(c,{color:"primary",onClick:P,disabled:!p.value,loading:R.value},{default:a(()=>[i(n(t.$t("common.add")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["rounded"])]),_:1},8,["modelValue","fullscreen"]),e(U,{modelValue:f.value,"onUpdate:modelValue":s[5]||(s[5]=l=>f.value=l),"max-width":"400px",persistent:""},{default:a(()=>[e(C,{rounded:"xl"},{default:a(()=>[e(D,{class:"d-flex align-center pa-4"},{default:a(()=>[e(V,{icon:"mdi-alert-circle",color:"error",class:"mr-2"}),i(" "+n(t.$t("warnings.removeRecipient")),1)]),_:1}),e(x,null,{default:a(()=>[i(n(t.$t("warnings.confirmRemoveMessage",{identifier:g.value?.identifier})),1)]),_:1}),e(N,{class:"pa-4"},{default:a(()=>[e(S),e(c,{variant:"text",onClick:s[4]||(s[4]=l=>f.value=!1)},{default:a(()=>[i(n(t.$t("common.cancel")),1)]),_:1}),e(c,{color:"error",variant:"tonal",onClick:E,loading:A.value},{default:a(()=>[i(n(t.$t("common.remove")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),ze=J(we,[["__scopeId","data-v-d1e0ddb8"]]);export{ze as default};
