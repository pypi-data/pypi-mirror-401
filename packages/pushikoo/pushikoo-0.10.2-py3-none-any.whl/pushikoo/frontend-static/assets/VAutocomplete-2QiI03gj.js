import{e as De,f as Pe,d as Y,g as Fe}from"./VTextField-Bjfd5Be9.js";import{u as Ae,b as Re,c as _e,a as Me,d as Oe}from"./VSelect-0SukG3gG.js";import{D as Ee,l as Q,r as Le,g as Te,K as Be}from"./_plugin-vue_export-helper-DIV_95uD.js";import{u as Ne,h as Ke,m as je}from"./VDataTable-cALBmuad.js";import{f as ze}from"./forwardRefs-DYN4dGLY.js";import{l as Ue,d as He,e as $e,f as X,V as qe,n as Ge}from"./VMenu-CRN2gxfd.js";import{g as Je,p as We,a2 as Ye,r as L,s as D,q,a3 as Qe,f as V,t as Xe,w as T,F as Z,af as Ze,u as el,c as m,b as P,aG as ll,H as G,z as b,aH as tl,n as al,a as ul,Y as nl,B as ol,aI as ee,aJ as le}from"./index-DMKqdLaf.js";import{V as te}from"./VContainer-Dp3Q7MEs.js";function hl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function gl(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var S=e.default;if(typeof S=="function"){var u=function C(){var r=!1;try{r=this instanceof C}catch{}return r?Reflect.construct(S,arguments,this.constructor):S.apply(this,arguments)};u.prototype=S.prototype}else u={};return Object.defineProperty(u,"__esModule",{value:!0}),Object.keys(e).forEach(function(C){var r=Object.getOwnPropertyDescriptor(e,C);Object.defineProperty(u,C,r.get?r:{enumerable:!0,get:function(){return e[C]}})}),u}const sl=We({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...je({filterKeys:["title"]}),...Oe(),...ol(Fe({modelValue:null,role:"combobox"}),["validationValue","dirty"])},"VAutocomplete"),yl=Je()({name:"VAutocomplete",props:sl(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,S){let{slots:u}=S;const{t:C}=Ye(),r=L(),g=D(!1),h=D(!0),B=D(!1),J=L(),N=L(),s=D(-1),I=D(null),{items:K,transformIn:ae,transformOut:ue}=Ue(e),{textColorClasses:ne,textColorStyles:oe}=Ee(()=>r.value?.color),{InputIcon:se}=De(e),c=q(e,"search",""),t=q(e,"modelValue",[],l=>ae(l===null?[null]:Qe(l)),l=>{const n=ue(l);return e.multiple?n:n[0]??null}),ie=V(()=>typeof e.counterValue=="function"?e.counterValue(t.value):typeof e.counterValue=="number"?e.counterValue:t.value.length),x=Pe(e),{filteredItems:j,getMatches:re}=Ne(e,K,()=>I.value??(h.value?"":c.value)),k=V(()=>e.hideSelected&&I.value===null?j.value.filter(l=>!t.value.some(n=>n.value===l.value)):j.value),W=Xe(()=>e.closableChips&&!x.isReadonly.value&&!x.isDisabled.value),M=V(()=>!!(e.chips||u.chip)),F=V(()=>M.value||!!u.selection),ce=V(()=>t.value.map(l=>l.props.value)),A=V(()=>k.value.find(l=>l.type==="item"&&!l.props.disabled)),z=V(()=>(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&c.value===A.value?.title)&&k.value.length>0&&!h.value&&!B.value),O=V(()=>e.hideNoData&&!k.value.length||x.isReadonly.value||x.isDisabled.value),U=q(e,"menu"),v=V({get:()=>U.value,set:l=>{U.value&&!l&&J.value?.Î¨openChildren.size||l&&O.value||(U.value=l)}}),{menuId:ve,ariaExpanded:de,ariaControls:fe}=Ae(e,v),H=L(),me=Re(H,r);function pe(l){e.openOnClear&&(v.value=!0),c.value=""}function he(){O.value||(v.value=!0)}function ge(l){O.value||(g.value&&(l.preventDefault(),l.stopPropagation()),v.value=!v.value)}function ye(l){(ee(l)||l.key==="Backspace")&&r.value?.focus()}function Ve(l){if(x.isReadonly.value)return;const n=r.value?.selectionStart,d=t.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(l.key)&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(v.value=!0),["Escape"].includes(l.key)&&(v.value=!1),z.value&&["Enter","Tab"].includes(l.key)&&A.value&&!t.value.some(o=>{let{value:f}=o;return f===A.value.value})&&w(A.value),l.key==="ArrowDown"&&z.value&&H.value?.focus("next"),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&F.value&&t.value.length>0&&!c.value)return w(t.value[0],!1);if(~s.value){l.preventDefault();const o=s.value;w(t.value[s.value],!1),s.value=o>=d-1?d-2:o}else l.key==="Backspace"&&!c.value&&(s.value=d-1);return}if(e.multiple)if(l.key==="ArrowLeft"){if(s.value<0&&n&&n>0)return;const o=s.value>-1?s.value-1:d-1;if(t.value[o])s.value=o;else{const f=c.value?.length??null;s.value=-1,r.value?.setSelectionRange(f,f)}}else if(l.key==="ArrowRight"){if(s.value<0)return;const o=s.value+1;t.value[o]?s.value=o:(s.value=-1,r.value?.setSelectionRange(0,0))}else~s.value&&ee(l)&&(s.value=-1)}function be(l){if(le(r.value,":autofill")||le(r.value,":-webkit-autofill")){const n=K.value.find(d=>d.title===l.target.value);n&&w(n)}}function ke(){e.eager&&N.value?.calculateVisibleItems()}function Ce(){g.value&&(h.value=!0,r.value?.focus()),I.value=null}function we(l){g.value=!0,setTimeout(()=>{B.value=!0})}function Se(l){B.value=!1}function Ie(l){(l==null||l===""&&!e.multiple&&!F.value)&&(t.value=[])}const $=D(!1);function w(l){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!l||l.props.disabled))if(e.multiple){const d=t.value.findIndex(f=>(e.valueComparator||Be)(f.value,l.value)),o=n??!~d;if(~d){const f=o?[...t.value,l]:[...t.value];f.splice(d,1),t.value=f}else o&&(t.value=[...t.value,l]);e.clearOnSelect&&(c.value="")}else{const d=n!==!1;t.value=d?[l]:[],I.value=h.value?"":c.value??"",c.value=d&&!F.value?l.title:"",Z(()=>{v.value=!1,h.value=!0})}}return T(g,(l,n)=>{l!==n&&(l?($.value=!0,c.value=e.multiple||F.value?"":String(t.value.at(-1)?.props.title??""),h.value=!0,Z(()=>$.value=!1)):(!e.multiple&&c.value==null&&(t.value=[]),v.value=!1,!h.value&&c.value&&(I.value=c.value),c.value="",s.value=-1))}),T(c,l=>{!g.value||$.value||(l&&(v.value=!0),h.value=!l)}),T(v,l=>{if(!e.hideSelected&&l&&t.value.length&&h.value){const n=k.value.findIndex(d=>t.value.some(o=>d.value===o.value));Ze&&window.requestAnimationFrame(()=>{n>=0&&N.value?.scrollToIndex(n)})}l&&(I.value=null)}),T(K,(l,n)=>{v.value||g.value&&!n.length&&l.length&&(v.value=!0)}),el(()=>{const l=!!(!e.hideNoData||k.value.length||u["prepend-item"]||u["append-item"]||u["no-data"]),n=t.value.length>0,d=Y.filterProps(e);return m(Y,b({ref:r},d,{modelValue:c.value,"onUpdate:modelValue":[o=>c.value=o,Ie],focused:g.value,"onUpdate:focused":o=>g.value=o,validationValue:t.externalValue,counterValue:ie.value,dirty:n,onChange:be,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":v.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!F.value,"v-autocomplete--selecting-index":s.value>-1},e.class],style:e.style,readonly:x.isReadonly.value,placeholder:n?void 0:e.placeholder,"onClick:clear":pe,"onMousedown:control":he,onKeydown:Ve,"aria-expanded":de.value,"aria-controls":fe.value}),{...u,default:o=>{let{id:f}=o;return P(G,null,[m(He,b({id:ve.value,ref:J,modelValue:v.value,"onUpdate:modelValue":i=>v.value=i,activator:"parent",contentClass:"v-autocomplete__content",disabled:O.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,onAfterEnter:ke,onAfterLeave:Ce},e.menuProps),{default:()=>[l&&m($e,b({ref:H,filterable:!0,selected:ce.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:i=>i.preventDefault(),onKeydown:ye,onFocusin:we,onFocusout:Se,tabindex:"-1",selectable:!0,"aria-live":"polite","aria-labelledby":`${f.value}-label`,"aria-multiselectable":e.multiple,color:e.itemColor??e.color},me,e.listProps),{default:()=>[u["prepend-item"]?.(),!k.value.length&&!e.hideNoData&&(u["no-data"]?.()??m(X,{key:"no-data",title:C(e.noDataText)},null)),m(_e,{ref:N,renderless:!0,items:k.value,itemKey:"value"},{default:i=>{let{item:a,index:y,itemRef:E}=i;const R=b(a.props,{ref:E,key:a.value,active:z.value&&a===A.value?!0:void 0,onClick:()=>w(a,null),"aria-posinset":y+1,"aria-setsize":k.value.length});return a.type==="divider"?u.divider?.({props:a.raw,index:y})??m(qe,b(a.props,{key:`divider-${y}`}),null):a.type==="subheader"?u.subheader?.({props:a.raw,index:y})??m(Ge,b(a.props,{key:`subheader-${y}`}),null):u.item?.({item:a,index:y,props:R})??m(X,b(R,{role:"option"}),{prepend:_=>{let{isSelected:p}=_;return P(G,null,[e.multiple&&!e.hideSelected?m(Me,{key:a.value,modelValue:p,ripple:!1,tabindex:"-1","aria-hidden":!0,onClick:xe=>xe.preventDefault()},null):void 0,a.props.prependAvatar&&m(Le,{image:a.props.prependAvatar},null),a.props.prependIcon&&m(Q,{icon:a.props.prependIcon},null)])},title:()=>h.value?a.title:Ke("v-autocomplete",a.title,re(a)?.title)})}}),u["append-item"]?.()]})]}),t.value.map((i,a)=>{function y(p){p.stopPropagation(),p.preventDefault(),w(i,!1)}const E=b(te.filterProps(i.props),{"onClick:close":y,onKeydown(p){p.key!=="Enter"&&p.key!==" "||(p.preventDefault(),p.stopPropagation(),y(p))},onMousedown(p){p.preventDefault(),p.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0}),R=M.value?!!u.chip:!!u.selection,_=R?tl(M.value?u.chip({item:i,index:a,props:E}):u.selection({item:i,index:a})):void 0;if(!(R&&!_))return P("div",{key:i.value,class:ul(["v-autocomplete__selection",a===s.value&&["v-autocomplete__selection--selected",ne.value]]),style:al(a===s.value?oe.value:{})},[M.value?u.chip?m(Te,{key:"chip-defaults",defaults:{VChip:{closable:W.value,size:"small",text:i.title}}},{default:()=>[_]}):m(te,b({key:"chip",closable:W.value,size:"small",text:i.title,disabled:i.props.disabled},E),null):_??P("span",{class:"v-autocomplete__selection-text"},[i.title,e.multiple&&a<t.value.length-1&&P("span",{class:"v-autocomplete__selection-comma"},[nl(",")])])])})])},"append-inner":function(){for(var o=arguments.length,f=new Array(o),i=0;i<o;i++)f[i]=arguments[i];return P(G,null,[u["append-inner"]?.(...f),e.menuIcon?m(Q,{class:"v-autocomplete__menu-icon",color:r.value?.fieldIconColor,icon:e.menuIcon,onMousedown:ge,onClick:ll,"aria-hidden":!0,tabindex:"-1"},null):void 0,e.appendInnerIcon&&m(se,{key:"append-icon",name:"appendInner",color:f[0].iconColor.value},null)])}})}),ze({isFocused:g,isPristine:h,menu:v,search:c,filteredItems:j,select:w},r)}});export{yl as V,gl as a,hl as g};
