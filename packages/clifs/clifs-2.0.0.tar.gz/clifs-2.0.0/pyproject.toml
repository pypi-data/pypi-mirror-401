[project]
name = "clifs"
description = "Command line interface for basic file system operations."
readme = "README.md"
authors = [{ email = "don.felice@gmx.net", name = "Felix Segerer" }]
license-files = ["LICENSE"]
classifiers = ["Programming Language :: Python :: 3"]
keywords = ["file system", "command line"]
dependencies = [
    "rich>=13.7.0",
    "python-dateutil",
    "tomli>=2.3.0 ; python_full_version < '3.11'",
]
requires-python = ">=3.10"
version = "2.0.0"

[build-system]
requires = ["uv_build"]
build-backend = "uv_build"

[tool.uv.build-backend]
module-root = "."

[project.urls]
"Source code" = "https://github.com/Don-Felice/clifs"

[project.scripts]
clifs = "clifs.__main__:main"

[project.entry-points."clifs.plugins"]
tree = "clifs.plugins.tree:DirectoryTree"
du = "clifs.plugins.disc_usage:DiscUsageExplorer"
cp = "clifs.plugins.como:FileCopier"
mv = "clifs.plugins.como:FileMover"
del = "clifs.plugins.delete:FileDeleter"
ren = "clifs.plugins.rename:Renamer"
backup = "clifs.plugins.backup:FileSaver"
sed = "clifs.plugins.edit:StreamingEditor"

[dependency-groups]
dev = [
    "pytest",
    "pytest-cov",
    "pylint",
    "ruff>=0.8.2",
    "ty",
    "types-python-dateutil",
    "poethepoet",
]

[tool.pytest.ini_options]
minversion = "7.0"
addopts = "-v --cov --cov-report term-missing --cov-config=pyproject.toml --cov=clifs"

[tool.coverage.run]
branch = true
parallel = true
source = ['clifs']

[tool.coverage.report]
exclude_lines = ["no cov", "if __name__ == .__main__.:", "if TYPE_CHECKING:"]

[tool.pylint.'MESSAGES CONTROL']
disable = ["missing-function-docstring", "duplicate-code"]

[tool.ruff]
lint.extend-select = [
    "I",   # sorting of imports 
    "W",   # pycodestyle warnings
    "S",   # flake8-bandit security testing
    "SIM", # simplify
    "B",   # Bugbear
    "UP",  # Upgrade
]
target-version = "py310"

[tool.ruff.lint.per-file-ignores]
"tests/**/*.py" = [
    "S101",    # allow asserts
    "ARG",     # allow unused function args -> fixtures
    "FBT",     # allow boolean as positionals
    "PLR2004", # allow magic values
]

[tool.poe.tasks]
test = "pytest --cov=my_app"
ruff_fmt_check = "ruff format --check ."
ruff_check = "ruff check ."
pylint = "pylint clifs"
ty_check = "ty check ."
lint = ["ruff_fmt_check", "ruff_check", "pylint", "ty_check"]
