import{_ as V}from"./Di_95mgX.js";import{_ as K}from"./C-jt9Ih2.js";import{_ as $,a as R,b as B,c as N,d as F}from"./C9XbPd6k.js";import{h as D,e as I,E as h,k as T,m as j,v as E,o as u,w as _,b as m,g as o,a as i,d as f,t as a,c as d,I as x,J as U,K as q,y as A,i as b}from"./BzhixHsn.js";import{L as H}from"./B9I6JWJy.js";import{U as O}from"./2RVX2kid.js";import{B as z}from"./jFGXCmwn.js";import{M as J}from"./BeItb1S1.js";import"./4isL45Eu.js";import"./BTANIQ8V.js";import"./Di109XjC.js";import"./CRjpF7qy.js";import"./IgXGHcdR.js";import"./COjiOs1v.js";import"./Bp3-KBkO.js";import"./DKMWZZOl.js";import"./XCOtPLqC.js";import"./Bi0Cqvs9.js";import"./C56gk0qC.js";import"./BmCC6msl.js";import"./vJ3Jskde.js";import"./BYr6U6oc.js";import"./C-zlyDS5.js";import"./KyMCIHQI.js";import"./C8B8ONuC.js";import"./CW7RC7pq.js";import"./DhvzP0AS.js";import"./DzpHhHXI.js";import"./Le8goM6p.js";import"./_XME2JEy.js";import"./BkS3akZz.js";import"./BLw_G03o.js";import"./CHh9YBUH.js";import"./zIw-xwcH.js";import"./BVAf69h5.js";import"./EdM3CJ8e.js";import"./C-xhCs27.js";import"./C-9Ampo3.js";const P={key:0,class:"flex gap-4 text-xs"},Y={class:"text-muted-foreground"},G={class:"text-foreground font-medium"},Q={class:"text-muted-foreground"},W={class:"text-foreground font-medium"},X={class:"text-muted-foreground"},Z={class:"text-foreground font-medium"},ee={class:"min-h-0 flex-1 overflow-y-auto"},te={key:0,class:"flex items-center justify-center py-12"},se={key:1,class:"text-destructive flex items-center justify-center py-12"},ne={key:2,class:"pr-4"},ae={class:"space-y-4"},oe={class:"flex items-start gap-3"},ie={class:"mt-1 flex-shrink-0"},re={class:"flex-1 space-y-2"},le={class:"flex items-center gap-2"},ce={class:"text-muted-foreground text-xs"},ue={class:"text-sm break-words whitespace-pre-wrap"},de={class:"text-muted-foreground flex flex-wrap gap-3 text-xs"},pe={key:0},me={key:1},ve={key:0},ge={key:0,class:"text-muted-foreground py-8 text-center"},_e=D({__name:"ConversationMessagesDialog",props:{open:{type:Boolean},conversationId:{},conversationTitle:{},inputTokens:{},outputTokens:{},totalTokens:{}},emits:["update:open"],setup(L,{emit:t}){const{t:c}=I(),r=L,M=t,p=h([]),y=h(!1),v=h(null),S=T({get:()=>r.open,set:l=>M("update:open",l)}),w=async()=>{if(r.conversationId){y.value=!0,v.value=null;try{const l=await $fetch(`/api/v1/admin/conversations/${r.conversationId}/messages`,{params:{page:1,size:100}});p.value=l.items||[]}catch(l){v.value=l.message||c("components.conversationMessages.loadMessagesFailed"),p.value=[]}finally{y.value=!1}}};j(()=>r.open,l=>{l&&r.conversationId&&w()});const e=l=>new Date(l).toLocaleString("en-US"),s=l=>{const k=l.toLowerCase();return c(`components.conversationMessages.messageTypes.${k}`,l)},C=l=>({USER:"default",ASSISTANT:"secondary",SYSTEM:"outline"})[l]||"default",g=T(()=>({inputTokens:r.inputTokens||0,outputTokens:r.outputTokens||0,totalTokens:r.totalTokens||0}));return(l,k)=>(u(),E(o(F),{open:S.value,"onUpdate:open":k[0]||(k[0]=n=>S.value=n)},{default:_(()=>[m(o($),{class:"flex max-h-[85vh] max-w-4xl flex-col"},{default:_(()=>[m(o(R),null,{default:_(()=>[m(o(B),null,{default:_(()=>[f(a(o(c)("components.conversationMessages.title")),1)]),_:1}),m(o(N),{class:"space-y-2"},{default:_(()=>[i("div",null,a(L.conversationTitle)+" - "+a(o(c)("components.conversationMessages.totalMessages",{count:p.value.length})),1),g.value.totalTokens>0?(u(),d("div",P,[i("span",Y,[f(a(o(c)("components.conversationMessages.totalTokens"))+": ",1),i("span",G,a(g.value.totalTokens.toLocaleString()),1)]),i("span",Q,[f(a(o(c)("components.conversationMessages.inputTokens"))+": ",1),i("span",W,a(g.value.inputTokens.toLocaleString()),1)]),i("span",X,[f(a(o(c)("components.conversationMessages.outputTokens"))+": ",1),i("span",Z,a(g.value.outputTokens.toLocaleString()),1)])])):x("",!0)]),_:1})]),_:1}),i("div",ee,[y.value?(u(),d("div",te,[m(o(H),{class:"text-muted-foreground h-8 w-8 animate-spin"})])):v.value?(u(),d("div",se,a(v.value),1)):(u(),d("div",ne,[i("div",ae,[(u(!0),d(U,null,q(p.value,n=>(u(),d("div",{key:n.id,class:A(["rounded-lg border p-4",{"bg-muted/50":n.message_type==="ASSISTANT","bg-background":n.message_type==="USER"}])},[i("div",oe,[i("div",ie,[i("div",{class:A(["flex h-8 w-8 items-center justify-center rounded-full",{"bg-primary text-primary-foreground":n.message_type==="USER","bg-secondary text-secondary-foreground":n.message_type==="ASSISTANT"}])},[n.message_type==="USER"?(u(),E(o(O),{key:0,class:"h-4 w-4"})):(u(),E(o(z),{key:1,class:"h-4 w-4"}))],2)]),i("div",re,[i("div",le,[m(o(V),{variant:C(n.message_type)},{default:_(()=>[f(a(s(n.message_type)),1)]),_:2},1032,["variant"]),i("span",ce,a(e(n.created_at)),1)]),i("div",ue,a(n.content),1),i("div",de,[n.extra_data?.model?(u(),d("span",pe,a(o(c)("components.conversationMessages.model"))+": "+a(n.extra_data.model),1)):x("",!0),n.total_tokens?(u(),d("span",me,[f(a(o(c)("components.conversationMessages.tokens"))+": "+a(n.total_tokens.toLocaleString())+" ",1),n.input_tokens&&n.output_tokens?(u(),d("span",ve," ("+a(n.input_tokens.toLocaleString())+" + "+a(n.output_tokens.toLocaleString())+") ",1)):x("",!0)])):x("",!0)])])])],2))),128)),p.value.length===0?(u(),d("div",ge,a(o(c)("components.conversationMessages.noMessages")),1)):x("",!0)])]))])]),_:1})]),_:1},8,["open"]))}}),fe=Object.assign(_e,{__name:"AdminConversationMessagesDialog"}),st=D({__name:"conversations",setup(L){const{t}=I(),c=h(!1),r=h(null),M=e=>{r.value=e,c.value=!0},p=T(()=>[{label:t("admin.pages.conversations.statusLabels.active"),value:"ACTIVE"},{label:t("admin.pages.conversations.statusLabels.archived"),value:"ARCHIVED"},{label:t("admin.pages.conversations.statusLabels.deleted"),value:"DELETED"}]),y={ACTIVE:"default",ARCHIVED:"secondary",DELETED:"destructive"},v=T(()=>({ACTIVE:t("admin.pages.conversations.statusLabels.active"),ARCHIVED:t("admin.pages.conversations.statusLabels.archived"),DELETED:t("admin.pages.conversations.statusLabels.deleted")})),S=T(()=>({title:t("admin.pages.conversations.title"),description:t("admin.pages.conversations.description"),apiEndpoint:"/v1/admin/conversations",showFilters:!0,filters:{status:{type:"select",label:t("admin.pages.conversations.status"),options:p.value}},customActions:[{key:"view-messages",label:t("admin.pages.conversations.viewMessages"),icon:b(J,{class:"h-4 w-4"}),variant:"default"}],columns:[{accessorKey:"title",header:t("admin.pages.conversations.columns.title"),cell:e=>{const s=e.getValue()||t("admin.pages.conversations.untitledConversation");return b("div",{class:"max-w-[240px] truncate",title:s},s)}},{accessorKey:"assistant_name",header:t("admin.pages.conversations.columns.assistant")},{accessorKey:"message_count",header:t("admin.pages.conversations.columns.messageCount"),cell:e=>e.getValue().toLocaleString()},{accessorKey:"input_tokens",header:t("admin.pages.conversations.columns.inputTokens"),cell:e=>{const s=e.getValue();return s?s.toLocaleString():"-"}},{accessorKey:"output_tokens",header:t("admin.pages.conversations.columns.outputTokens"),cell:e=>{const s=e.getValue();return s?s.toLocaleString():"-"}},{accessorKey:"total_tokens",header:t("admin.pages.conversations.columns.totalTokens"),cell:e=>{const s=e.getValue();return s?s.toLocaleString():"-"}},{accessorKey:"status",header:t("admin.pages.conversations.columns.status"),cell:e=>{const s=e.getValue();return b(V,{variant:y[s]},()=>v.value[s]||s)}},{accessorKey:"last_message_at",header:t("admin.pages.conversations.columns.lastMessageAt"),cell:e=>{const s=e.getValue();return s?new Date(s).toLocaleString("en-US"):"-"}},{accessorKey:"created_at",header:t("admin.pages.conversations.columns.createdAt"),cell:e=>{const s=e.getValue();return new Date(s).toLocaleString("en-US")}}],detailFields:[{name:"id",label:t("admin.pages.conversations.fields.id"),type:"text"},{name:"title",label:t("admin.pages.conversations.fields.title"),type:"text",render:e=>{const s=e||t("admin.pages.conversations.untitledConversation");return b("div",{class:"max-w-[320px] truncate",title:s},s)}},{name:"assistant_name",label:t("admin.pages.conversations.fields.assistant"),type:"text"},{name:"user_id",label:t("admin.pages.conversations.fields.userId"),type:"text"},{name:"status",label:t("admin.pages.conversations.columns.status"),type:"text",render:e=>v.value[e]||e},{name:"message_count",label:t("admin.pages.conversations.columns.messageCount"),type:"text",render:e=>e.toLocaleString()},{name:"input_tokens",label:t("admin.pages.conversations.columns.inputTokens"),type:"text",render:e=>e?e.toLocaleString():"-"},{name:"output_tokens",label:t("admin.pages.conversations.columns.outputTokens"),type:"text",render:e=>e?e.toLocaleString():"-"},{name:"total_tokens",label:t("admin.pages.conversations.columns.totalTokens"),type:"text",render:e=>e?e.toLocaleString():"-"},{name:"last_message_at",label:t("admin.pages.conversations.columns.lastMessageAt"),type:"datetime",render:e=>e?new Date(e).toLocaleString("en-US"):t("admin.pages.conversations.noLastMessage")},{name:"created_at",label:t("admin.pages.conversations.columns.createdAt"),type:"datetime"},{name:"updated_at",label:t("admin.pages.conversations.columns.updatedAt"),type:"datetime"}],formFields:[{name:"title",label:t("admin.pages.conversations.fields.conversationTitle"),type:"text",required:!0,placeholder:t("admin.pages.conversations.fields.titlePlaceholder")},{name:"status",label:t("admin.pages.conversations.columns.status"),type:"select",required:!0,options:p.value,defaultValue:"ACTIVE"}],canCreate:!1,canEdit:!1,canDuplicate:!1,canDelete:!0})),w=(e,s)=>{e.key==="view-messages"&&M(s)};return(e,s)=>{const C=K;return u(),d(U,null,[m(C,{config:S.value,onRowAction:w},null,8,["config"]),m(fe,{open:c.value,"onUpdate:open":s[0]||(s[0]=g=>c.value=g),"conversation-id":r.value?.id||null,"conversation-title":r.value?.title||o(t)("admin.pages.conversations.untitledConversation"),"input-tokens":r.value?.input_tokens,"output-tokens":r.value?.output_tokens,"total-tokens":r.value?.total_tokens},null,8,["open","conversation-id","conversation-title","input-tokens","output-tokens","total-tokens"])],64)}}});export{st as default};
