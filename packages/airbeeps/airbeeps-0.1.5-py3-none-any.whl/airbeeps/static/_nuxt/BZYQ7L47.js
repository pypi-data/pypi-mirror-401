import{e as ie,_ as Q,a as k,b as C,c as re,d as le,f as de,g as ce,h as ue,i as pe}from"./CUahoEQi.js";import{u as X,_ as _e}from"./Dosvfmhb.js";import{R as Y,h as N,v as l,o as s,g as e,ae as Z,y as ee,N as te,w as t,x as F,S as ae,e as fe,B as se,bQ as me,E as K,H as he,m as ge,b as a,d as E,t as n,c as h,I as z,a as r,K as ve,$ as be,a0 as ye,a6 as W,X as $e,J as ke,k as G,s as Ce,L as V,O as q,bN as xe}from"./BzhixHsn.js";import{_ as ne}from"./hcYt5xb6.js";import{_ as Se,a as we,b as Le,c as J}from"./COjiOs1v.js";import{u as Me}from"./2JFTuhAN.js";import{E as ze}from"./KyMCIHQI.js";import{T as Ne}from"./C-xhCs27.js";import{C as Be}from"./C56gk0qC.js";import{_ as Te}from"./CMS48I6h.js";import{_ as Re}from"./6PIUWI5X.js";import{u as He}from"./BLw_G03o.js";import{S as Ie}from"./BVAf69h5.js";import"./DjusaS8W.js";import"./Bp3-KBkO.js";import"./DKMWZZOl.js";import"./CCA1r4XF.js";import"./CG_BwZdW.js";import"./XCOtPLqC.js";import"./D01W4VS-.js";const je=Y("chevrons-right",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);const Oe=Y("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),Ae=N({__name:"SidebarGroupLabel",props:{asChild:{type:Boolean},as:{},class:{}},setup(c){const u=c;return(p,b)=>(s(),l(e(Z),{"data-slot":"sidebar-group-label","data-sidebar":"group-label",as:c.as,"as-child":c.asChild,class:ee(e(te)("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",u.class))},{default:t(()=>[F(p.$slots,"default")]),_:3},8,["as","as-child","class"]))}}),Pe=N({__name:"SidebarMenuAction",props:{asChild:{type:Boolean},as:{default:"button"},showOnHover:{type:Boolean},class:{}},setup(c){const u=c;return(p,b)=>(s(),l(e(Z),{"data-slot":"sidebar-menu-action","data-sidebar":"menu-action",class:ee(e(te)("text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 md:after:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",c.showOnHover&&"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0",u.class)),as:c.as,"as-child":c.asChild},{default:t(()=>[F(p.$slots,"default")]),_:3},8,["class","as","as-child"]))}}),Ue={key:1,class:"flex w-full items-center"},De=["onKeyup","onBlur","placeholder"],Ve={key:1,class:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"},qe={key:2},Ee={key:3},Fe={key:4},Ke=N({__name:"HistoryList",setup(c){const u=ae(),{isMobile:p}=X(),{t:b}=fe(),y=se(),g=Me(),{conversations:m,isLoading:I,isLoadingMore:$,error:j,hasConversations:B,hasNextPage:x,totalCount:_,currentPage:S}=me(g),{removeConversation:T,fetchConversations:O,loadMore:A,updateConversationTitle:P}=g,w=o=>{const d=o?.title?.trim();return d&&d.length>0?d:b("pages.conversations.untitledConversation","Untitled Conversation")},v=K(null),f=K(""),U=o=>{v.value=o.id,f.value=o.title},L=()=>{v.value=null,f.value=""},R=async o=>{const d=f.value.trim();if(!d){L();return}const D=m.value.find(i=>i.id===o)?.title;if(d===D){L();return}try{await P(o,d),v.value=null,f.value=""}catch(i){console.error("Failed to rename conversation:",i)}},H=()=>{u.user&&O()};he(()=>{H()}),ge(()=>u.user?.id,()=>H(),{immediate:!0});const oe=async()=>{x.value&&!$.value&&await A()};return(o,d)=>{const D=ne;return s(),l(e(ie),{class:"group-data-[collapsible=icon]:hidden"},{default:t(()=>[a(e(Ae),null,{default:t(()=>[E(n(o.$t("nav.history")),1)]),_:1}),a(e(Q),null,{default:t(()=>[e(I)?(s(),l(e(k),{key:0},{default:t(()=>[a(e(C),{class:"text-sidebar-foreground/70"},{default:t(()=>[r("span",null,n(o.$t("nav.loadingHistory")),1)]),_:1})]),_:1})):e(j)?(s(),l(e(k),{key:1},{default:t(()=>[a(e(C),{class:"text-sidebar-foreground/70"},{default:t(()=>[r("span",null,n(o.$t("nav.errorLoadingHistory")),1)]),_:1})]),_:1})):e(B)?(s(!0),h(ke,{key:3},ve(e(m),i=>(s(),l(e(k),{key:i.id},{default:t(()=>[a(e(C),{"as-child":"","is-active":e(y).path===`/chat/${i.id}`},{default:t(()=>[e(v)!==i.id?(s(),l(D,{key:0,to:`/chat/${i.id}`,title:w(i)},{default:t(()=>[r("span",null,n(w(i)),1)]),_:2},1032,["to","title"])):(s(),h("div",Ue,[be(r("input",{"onUpdate:modelValue":d[0]||(d[0]=M=>$e(f)?f.value=M:null),onKeyup:[W(M=>R(i.id),["enter"]),W(L,["escape"])],onBlur:M=>R(i.id),class:"flex-1 border-none bg-transparent text-sm outline-none",placeholder:w(i),autofocus:""},null,40,De),[[ye,e(f)]])]))]),_:2},1032,["is-active"]),e(v)!==i.id?(s(),l(e(Se),{key:0},{default:t(()=>[a(e(we),{"as-child":""},{default:t(()=>[a(e(Pe),{"show-on-hover":""},{default:t(()=>[a(e(ze)),d[1]||(d[1]=r("span",{class:"sr-only"},"More",-1))]),_:1})]),_:1}),a(e(Le),{class:"w-56 rounded-lg",side:e(p)?"bottom":"right",align:e(p)?"end":"start"},{default:t(()=>[a(e(J),{onClick:M=>U(i)},{default:t(()=>[a(e(Oe),{class:"text-muted-foreground"}),r("span",null,n(o.$t("common.rename")),1)]),_:1},8,["onClick"]),a(e(J),{onClick:M=>e(T)(i.id)},{default:t(()=>[a(e(Ne),{class:"text-muted-foreground"}),r("span",null,n(o.$t("common.delete")),1)]),_:1},8,["onClick"])]),_:2},1032,["side","align"])]),_:2},1024)):z("",!0)]),_:2},1024))),128)):(s(),l(e(k),{key:2},{default:t(()=>[a(e(C),{class:"text-sidebar-foreground/70"},{default:t(()=>[r("span",null,n(o.$t("nav.noConversations")),1)]),_:1})]),_:1})),e(B)&&e(_)>e(m).length?(s(),l(e(k),{key:4},{default:t(()=>[a(e(C),{onClick:oe,disabled:e($)||!e(x),class:"text-sidebar-foreground/70 hover:text-sidebar-foreground"},{default:t(()=>[e($)?(s(),h("div",Ve)):(s(),l(e(Be),{key:0})),e($)?(s(),h("span",qe,n(o.$t("nav.loading")),1)):e(x)?(s(),h("span",Ee,n(o.$t("nav.loadMore"))+" ("+n(e(m).length)+"/"+n(e(_))+")",1)):(s(),h("span",Fe,n(o.$t("nav.allLoaded"))+" ("+n(e(_))+")",1))]),_:1},8,["disabled"])]),_:1})):z("",!0)]),_:1})]),_:1})}}}),We=Object.assign(Ke,{__name:"NavHistoryList"}),Ge={class:"grid flex-1 text-left text-sm leading-tight"},Je={class:"truncate font-bold"},Qe={key:0,class:"space-y-2 p-2"},Xe={key:0,class:"mt-2 flex justify-center"},Ye={class:"sr-only"},Ze=N({__name:"AppSidebar",setup(c){const u=se(),p=G(()=>u.path.startsWith("/chat")||u.path.startsWith("/assistants")),b=Ce(),y=ae(),g=He(),{state:m,toggleSidebar:I}=X(),$=G(()=>m.value==="collapsed"),j=()=>q("/sign-in"),B=()=>q("/sign-up"),x=async()=>{if(g.isDirty){if(!window.confirm("You have unsaved changes. Leave this page and go to Chat?"))return;g.clearAll()}await q("/chat")};return(_,S)=>{const T=C,O=ne,A=k,P=Q,w=le,v=We,f=Te,U=de,L=ce,R=ue,H=re;return s(),l(H,{collapsible:"icon"},{default:t(()=>[a(w,null,{default:t(()=>[a(T,{size:"lg",class:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",onClick:x},{default:t(()=>[S[1]||(S[1]=r("div",{class:"text-sidebar-primary-foreground flex aspect-square size-8 items-center justify-center rounded-lg"},[r("img",{src:Re,alt:"Logo"})],-1)),r("div",Ge,[r("span",Je,n(e(b).public.appName),1),S[0]||(S[0]=r("span",{class:"text-sidebar-foreground/70 truncate text-xs"}," Chat ",-1))])]),_:1}),a(P,null,{default:t(()=>[a(A,null,{default:t(()=>[a(T,{"as-child":"","is-active":p.value},{default:t(()=>[a(O,{to:"/chat"},{default:t(()=>[a(e(Ie)),r("span",null,n(_.$t("nav.newChat")),1)]),_:1})]),_:1},8,["is-active"])]),_:1})]),_:1})]),_:1}),a(U,null,{default:t(()=>[a(f,null,{default:t(()=>[e(y).user?(s(),l(v,{key:0})):z("",!0)]),_:1})]),_:1}),a(L,null,{default:t(()=>[a(f,null,{default:t(()=>[e(y).user?z("",!0):(s(),h("div",Qe,[a(e(V),{class:"w-full",onClick:j},{default:t(()=>[E(n(_.$t("auth.signIn")),1)]),_:1}),a(e(V),{variant:"outline",class:"w-full",onClick:B},{default:t(()=>[E(n(_.$t("auth.signUp")),1)]),_:1})]))]),_:1}),$.value?(s(),h("div",Xe,[a(e(V),{variant:"ghost",size:"icon",title:_.$t("nav.expandSidebar"),onClick:e(I)},{default:t(()=>[a(e(je),{class:"size-4"}),r("span",Ye,n(_.$t("nav.expandSidebar")),1)]),_:1},8,["title","onClick"])])):z("",!0)]),_:1}),a(R)]),_:1})}}}),et=Object.assign(Ze,{__name:"AppSidebar"}),$t=N({__name:"default",setup(c){const u=xe("sidebar_state");return(p,b)=>{const y=et,g=pe,m=_e;return s(),l(m,{"default-open":e(u)},{default:t(()=>[a(y),a(g,null,{default:t(()=>[F(p.$slots,"default")]),_:3})]),_:3},8,["default-open"])}}});export{$t as default};
