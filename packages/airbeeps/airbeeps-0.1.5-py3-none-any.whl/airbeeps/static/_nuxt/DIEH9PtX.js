import{_ as M}from"./Di_95mgX.js";import{R as Je,h as Le,D as Ne,e as Ke,B as He,a7 as We,E as v,k as I,H as Qe,c as m,o as r,a as d,b as l,v as w,I as U,w as a,g as t,L as p,d as o,y as ve,J as P,K as S,t as f,Q as g}from"./BzhixHsn.js";import{_ as H}from"./Di109XjC.js";import{_ as y}from"./4isL45Eu.js";import{_ as W}from"./Le8goM6p.js";import{_ as j}from"./B_FRSInF.js";import{_ as Q,a as Y,d as Z,b as G,c as k}from"./Bi0Cqvs9.js";import{_ as X,a as ee}from"./CRjpF7qy.js";import{_ as ge}from"./Co_Pqrtl.js";import{_ as ye,a as we}from"./DfqdNhl2.js";import{_ as te,a as le,b as ae,c as se,d as ne}from"./C9XbPd6k.js";import{_ as oe}from"./CHPRih2d.js";import{_ as ie,a as de,b as E,c as _,d as ue,e as c}from"./IgXGHcdR.js";import{_ as Ye,a as Ze}from"./BYr6U6oc.js";import{_ as Ge}from"./CawQPbYo.js";import{A as Xe}from"./CYrYAm7v.js";import{R as et}from"./A-tu-Llp.js";import{P as re}from"./C-zlyDS5.js";import{I as tt}from"./DU0NpF9R.js";import{S as lt}from"./3ywC1724.js";import{S as at}from"./BVAf69h5.js";import{T as xe}from"./C-xhCs27.js";import{C as st}from"./C56gk0qC.js";import{U as nt}from"./C-9Ampo3.js";import{E as ot}from"./zIw-xwcH.js";import{S as it}from"./CHh9YBUH.js";import"./vJ3Jskde.js";import"./Bp3-KBkO.js";import"./DKMWZZOl.js";import"./XCOtPLqC.js";import"./BkS3akZz.js";import"./BmCC6msl.js";const ke=Je("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),dt={class:"space-y-6"},ut={class:"flex items-center justify-between"},rt={class:"flex items-center gap-4"},ft={class:"flex gap-2"},mt={key:0,class:"py-8 text-center"},pt={class:"font-medium"},_t={key:0,class:"text-muted-foreground max-w-xs truncate text-xs"},ct={class:"flex gap-1"},vt={class:"text-muted-foreground"},gt={class:"flex justify-end gap-1"},yt={class:"flex items-center gap-2"},wt={class:"divide-y"},xt={class:"min-w-0 flex-1"},kt={class:"flex items-center gap-2"},bt={class:"font-medium"},Ct={key:0,class:"text-muted-foreground mt-0.5 text-xs"},$t={class:"flex items-center gap-2"},ht={class:"flex gap-1"},Vt={class:"text-muted-foreground text-xs"},Ut={class:"space-y-6 py-4"},Pt={class:"grid gap-4 sm:grid-cols-2"},St={class:"space-y-2"},Ft={class:"space-y-2"},Dt={class:"space-y-2"},Mt={class:"bg-muted/30 rounded-lg border p-4"},jt={class:"flex items-center justify-between"},Et={class:"space-y-3"},Tt={class:"flex items-center justify-between"},qt={class:"flex gap-2"},At={key:0,class:"text-muted-foreground rounded-lg border border-dashed p-6 text-center text-sm"},Rt={key:1,class:"overflow-hidden rounded-lg border"},zt={class:"flex items-center gap-2"},Bt={class:"space-y-3"},It={class:"grid gap-4 sm:grid-cols-2"},Ot={class:"space-y-2"},Jt={class:"space-y-2"},Lt={key:0,class:"space-y-2"},Nt={class:"flex items-center gap-6"},Kt={class:"flex items-center gap-2"},Ht={class:"flex items-center gap-2"},Wt={class:"flex items-center gap-2"},Qt={class:"max-h-[400px] overflow-y-auto"},Yt={key:1,class:"text-muted-foreground"},Zt={class:"space-y-4"},Gt={class:"bg-muted mt-2 max-h-[300px] overflow-y-auto rounded-lg p-4 text-sm whitespace-pre-wrap"},Xt={key:0},el={class:"bg-muted mt-2 rounded-lg p-4"},tl={class:"font-medium"},Al=Le({__name:"profiles",setup(ll){const{$api:C}=Ne(),{t:al}=Ke(),be=He(),Ce=We(),A=be.params.id,$e=n=>n.toLowerCase().trim().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),$=v(!1),O=v([]),F=v(!1),T=v(!1),q=v(!1),R=v(!1),J=v(!1),h=v(null),fe=v(null),V=v([]),L=v(0),me=v(""),N=v({}),i=v({name:"",description:"",file_types:["csv","xlsx"],is_default:!1,config:{columns:[],metadata_fields:{},content_fields:[],required_fields:[],validation_mode:"warn",row_template:{format:"key_value",include_labels:!0,omit_empty:!0,field_order:null,custom_template:null}}}),he=I(()=>{const n=new Map;return V.value.forEach(e=>n.set(e.name,e)),n}),z=()=>{if(i.value.config.columns.length>0)return;const n=new Set([...Object.keys(i.value.config.metadata_fields||{}),...i.value.config.content_fields||[],...i.value.config.required_fields||[]]);i.value.config.columns=Array.from(n).sort((e,s)=>e.localeCompare(s)).map(e=>({name:e,type:"string",aliases:[]}))},Ve=()=>{const n=window.prompt("Column name");if(!n)return;const e=n.trim();if(e){if(i.value.config.columns.some(s=>s.name===e)){g.error("Column already exists");return}i.value.config.columns.push({name:e,type:"string",aliases:[]}),i.value.config.content_fields.includes(e)||i.value.config.content_fields.push(e)}},Ue=n=>{i.value.config.columns=i.value.config.columns.filter(u=>u.name!==n);const e={...i.value.config.metadata_fields||{}};delete e[n],i.value.config.metadata_fields=e,i.value.config.content_fields=(i.value.config.content_fields||[]).filter(u=>u!==n),i.value.config.required_fields=(i.value.config.required_fields||[]).filter(u=>u!==n);const s=i.value.config.row_template.field_order||null;if(s){const u=s.filter(x=>x!==n);i.value.config.row_template.field_order=u.length?u:null}},Pe=(n,e)=>{const s=new Set(i.value.config.content_fields||[]);e?s.add(n):s.delete(n),i.value.config.content_fields=Array.from(s)},Se=(n,e)=>{const s={...i.value.config.metadata_fields||{}};e?s[n]||(s[n]=$e(n)):delete s[n],i.value.config.metadata_fields=s},Fe=(n,e)=>{const s={...i.value.config.metadata_fields||{}};s[n]=e,i.value.config.metadata_fields=s},De=(n,e)=>{const s=new Set(i.value.config.required_fields||[]);e?s.add(n):s.delete(n),i.value.config.required_fields=Array.from(s)},Me=n=>(n.aliases||[]).join(", "),je=(n,e)=>{n.aliases=e.split(",").map(s=>s.trim()).filter(Boolean)},pe=I({get:()=>(i.value.config.row_template.field_order||[]).join(`
`),set:n=>{const e=n.split(`
`).map(s=>s.trim()).filter(Boolean);i.value.config.row_template.field_order=e.length?e:null}}),_e=I(()=>O.value.filter(n=>n.knowledge_base_id===A&&!n.is_builtin)),K=I(()=>O.value.filter(n=>n.is_builtin)),D=async()=>{$.value=!0;try{const n=await C(`/v1/admin/rag/knowledge-bases/${A}/ingestion-profiles`);O.value=n}catch(n){console.error("Failed to load profiles:",n),g.error("Failed to load ingestion profiles")}finally{$.value=!1}},Ee=async()=>{try{z(),await C(`/v1/admin/rag/knowledge-bases/${A}/ingestion-profiles`,{method:"POST",body:JSON.stringify(i.value)}),g.success("Profile created successfully"),F.value=!1,B(),await D()}catch(n){console.error("Failed to create profile:",n),g.error("Failed to create profile")}},Te=async()=>{if(h.value)try{z(),await C(`/v1/admin/rag/ingestion-profiles/${h.value.id}`,{method:"PUT",body:JSON.stringify(i.value)}),g.success("Profile updated successfully"),T.value=!1,B(),await D()}catch(n){console.error("Failed to update profile:",n),g.error("Failed to update profile")}},qe=async n=>{if(confirm(`Delete profile "${n.name}"?`))try{await C(`/v1/admin/rag/ingestion-profiles/${n.id}`,{method:"DELETE"}),g.success("Profile deleted successfully"),await D()}catch(e){console.error("Failed to delete profile:",e),g.error("Failed to delete profile")}},Ae=async n=>{try{await C(`/v1/admin/rag/ingestion-profiles/${n.id}`,{method:"PUT",body:JSON.stringify({is_default:!0})}),g.success(`"${n.name}" set as default`),await D()}catch(e){console.error("Failed to set default:",e),g.error("Failed to set default profile")}},Re=n=>{h.value=n,i.value={name:n.name,description:n.description||"",file_types:n.file_types,is_default:n.is_default,config:{columns:n.config.columns||[],metadata_fields:n.config.metadata_fields||{},content_fields:n.config.content_fields||[],required_fields:n.config.required_fields||[],validation_mode:n.config.validation_mode||"warn",row_template:{format:n.config.row_template?.format||"key_value",include_labels:n.config.row_template?.include_labels??!0,omit_empty:n.config.row_template?.omit_empty??!0,field_order:n.config.row_template?.field_order||null,custom_template:n.config.row_template?.custom_template||null}}},z(),T.value=!0},B=()=>{i.value={name:"",description:"",file_types:["csv","xlsx"],is_default:!1,config:{columns:[],metadata_fields:{},content_fields:[],required_fields:[],validation_mode:"warn",row_template:{format:"key_value",include_labels:!0,omit_empty:!0,field_order:null,custom_template:null}}},h.value=null,V.value=[],L.value=0},ze=async n=>{const e=n.target;if(!e.files?.length)return;const s=e.files[0],u=new FormData;u.append("file",s);try{$.value=!0;const x=await C("/v1/admin/rag/ingestion-profiles/infer-from-upload",{method:"POST",body:u});V.value=x.columns,L.value=x.row_count;const Oe=new Map(i.value.config.columns.map(b=>[b.name,b]));i.value.config.columns=(x.columns||[]).map(b=>{const ce=Oe.get(b.name);return{name:b.name,type:ce?.type||b.inferred_type||"string",aliases:ce?.aliases||[]}}),!(Object.keys(i.value.config.metadata_fields||{}).length>0||(i.value.config.content_fields||[]).length>0)&&x.suggested_profile&&(i.value.config.metadata_fields=x.suggested_profile.metadata_fields||{},i.value.config.content_fields=(x.columns||[]).map(b=>b.name)),q.value=!0}catch(x){console.error("Failed to infer profile:",x),g.error("Failed to analyze file")}finally{$.value=!1,e.value=""}},Be=()=>{const n={};V.value.forEach(e=>{e.suggested_metadata_key&&(n[e.name]=e.suggested_metadata_key)}),i.value.config.metadata_fields=n,i.value.config.content_fields=V.value.map(e=>e.name),q.value=!1,g.success("Column mappings applied")},Ie=async()=>{const n={};z(),i.value.config.columns.forEach(e=>{const s=he.value.get(e.name);n[e.name]=s?.sample_values?.[0]??""});try{const e=await C("/v1/admin/rag/ingestion-profiles/preview-row-render",{method:"POST",body:JSON.stringify({profile_config:i.value.config,row_data:n})});me.value=e.row_text,N.value=e.extracted_metadata,R.value=!0}catch(e){console.error("Failed to preview:",e),g.error("Failed to generate preview")}};return Qe(()=>{D()}),(n,e)=>(r(),m("div",dt,[d("div",ut,[d("div",rt,[l(t(p),{variant:"ghost",size:"icon",onClick:e[0]||(e[0]=s=>t(Ce).push(`/admin/kbs/${t(A)}`))},{default:a(()=>[l(t(Xe),{class:"h-5 w-5"})]),_:1}),e[21]||(e[21]=d("div",null,[d("h1",{class:"text-2xl font-bold"},"Ingestion Profiles"),d("p",{class:"text-muted-foreground text-sm"}," Configure how CSV/Excel files are processed into searchable chunks ")],-1))]),d("div",ft,[l(t(p),{variant:"outline",onClick:D,disabled:$.value},{default:a(()=>[l(t(et),{class:ve(["mr-2 h-4 w-4",{"animate-spin":$.value}])},null,8,["class"]),e[22]||(e[22]=o(" Refresh ",-1))]),_:1},8,["disabled"]),l(t(p),{onClick:e[1]||(e[1]=s=>F.value=!0)},{default:a(()=>[l(t(re),{class:"mr-2 h-4 w-4"}),e[23]||(e[23]=o(" Create Profile ",-1))]),_:1})])]),l(t(ee),{class:"bg-muted/30 border-muted"},{default:a(()=>[l(t(X),{class:"flex items-start gap-3 py-4"},{default:a(()=>[l(t(tt),{class:"text-muted-foreground mt-0.5 h-5 w-5 shrink-0"}),e[24]||(e[24]=d("div",{class:"text-sm"},[d("p",null,[d("strong",null,"Ingestion profiles"),o(" define how structured files (CSV, Excel) are converted into searchable text chunks. Each profile specifies: ")]),d("ul",{class:"text-muted-foreground mt-1 list-inside list-disc"},[d("li",null,"Which columns become searchable content"),d("li",null,"Which columns become filterable metadata"),d("li",null,"How each row is formatted as text")])],-1))]),_:1})]),_:1}),l(t(ee),null,{default:a(()=>[l(t(ye),null,{default:a(()=>[l(t(we),{class:"flex items-center gap-2"},{default:a(()=>[l(t(ke),{class:"h-5 w-5"}),e[25]||(e[25]=o(" Your Profiles ",-1))]),_:1}),l(t(ge),null,{default:a(()=>[...e[26]||(e[26]=[o(" Custom profiles for this knowledge base ",-1)])]),_:1})]),_:1}),l(t(X),null,{default:a(()=>[_e.value.length===0?(r(),m("div",mt,[l(t(ke),{class:"text-muted-foreground mx-auto h-12 w-12 opacity-50"}),e[28]||(e[28]=d("p",{class:"text-muted-foreground mt-2"},"No custom profiles yet",-1)),e[29]||(e[29]=d("p",{class:"text-muted-foreground mt-1 text-sm"}," Create a profile to customize how CSV/Excel files are processed ",-1)),l(t(p),{class:"mt-4",onClick:e[2]||(e[2]=s=>F.value=!0)},{default:a(()=>[l(t(re),{class:"mr-2 h-4 w-4"}),e[27]||(e[27]=o(" Create Profile ",-1))]),_:1})])):(r(),w(t(ie),{key:1},{default:a(()=>[l(t(de),null,{default:a(()=>[l(t(E),null,{default:a(()=>[l(t(_),null,{default:a(()=>[...e[30]||(e[30]=[o("Name",-1)])]),_:1}),l(t(_),null,{default:a(()=>[...e[31]||(e[31]=[o("File Types",-1)])]),_:1}),l(t(_),null,{default:a(()=>[...e[32]||(e[32]=[o("Fields",-1)])]),_:1}),l(t(_),null,{default:a(()=>[...e[33]||(e[33]=[o("Default",-1)])]),_:1}),l(t(_),{class:"text-right"},{default:a(()=>[...e[34]||(e[34]=[o("Actions",-1)])]),_:1})]),_:1})]),_:1}),l(t(ue),null,{default:a(()=>[(r(!0),m(P,null,S(_e.value,s=>(r(),w(t(E),{key:s.id},{default:a(()=>[l(t(c),null,{default:a(()=>[d("div",pt,f(s.name),1),s.description?(r(),m("div",_t,f(s.description),1)):U("",!0)]),_:2},1024),l(t(c),null,{default:a(()=>[d("div",ct,[(r(!0),m(P,null,S(s.file_types,u=>(r(),w(t(M),{key:u,variant:"secondary"},{default:a(()=>[o(f(u),1)]),_:2},1024))),128))])]),_:2},1024),l(t(c),null,{default:a(()=>[d("span",vt,f(Object.keys(s.config.metadata_fields||{}).length)+" metadata, "+f((s.config.content_fields||[]).length)+" content ",1)]),_:2},1024),l(t(c),null,{default:a(()=>[s.is_default?(r(),w(t(M),{key:0,variant:"default"},{default:a(()=>[l(t(lt),{class:"mr-1 h-3 w-3"}),e[35]||(e[35]=o(" Default ",-1))]),_:1})):(r(),w(t(p),{key:1,variant:"ghost",size:"sm",onClick:u=>Ae(s)},{default:a(()=>[...e[36]||(e[36]=[o(" Set default ",-1)])]),_:1},8,["onClick"]))]),_:2},1024),l(t(c),{class:"text-right"},{default:a(()=>[d("div",gt,[l(t(p),{variant:"ghost",size:"icon",onClick:u=>Re(s)},{default:a(()=>[l(t(at),{class:"h-4 w-4"})]),_:1},8,["onClick"]),l(t(p),{variant:"ghost",size:"icon",onClick:u=>qe(s)},{default:a(()=>[l(t(xe),{class:"h-4 w-4"})]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))]),_:1})]),_:1}),K.value.length>0?(r(),w(t(Ze),{key:0,open:J.value,"onUpdate:open":e[3]||(e[3]=s=>J.value=s)},{default:a(()=>[l(t(ee),null,{default:a(()=>[l(t(ye),{class:"py-3"},{default:a(()=>[l(t(Ge),{asChild:""},{default:a(()=>[l(t(p),{variant:"ghost",class:"w-full justify-between px-0 hover:bg-transparent"},{default:a(()=>[d("div",yt,[l(t(we),{class:"text-sm font-medium"},{default:a(()=>[...e[37]||(e[37]=[o(" Built-in Templates ",-1)])]),_:1}),l(t(M),{variant:"outline",class:"text-xs"},{default:a(()=>[o(f(K.value.length),1)]),_:1})]),l(t(st),{class:ve(["text-muted-foreground h-4 w-4 transition-transform",{"rotate-180":J.value}])},null,8,["class"])]),_:1})]),_:1}),l(t(ge),{class:"mt-0"},{default:a(()=>[...e[38]||(e[38]=[o(" Pre-configured templates for common data formats (read-only) ",-1)])]),_:1})]),_:1}),l(t(Ye),null,{default:a(()=>[l(t(X),{class:"pt-0"},{default:a(()=>[d("div",wt,[(r(!0),m(P,null,S(K.value,s=>(r(),m("div",{key:s.id,class:"flex items-center justify-between py-3 first:pt-0 last:pb-0"},[d("div",xt,[d("div",kt,[d("span",bt,f(s.name),1),l(t(M),{variant:"secondary",class:"text-xs"},{default:a(()=>[...e[39]||(e[39]=[o("Built-in",-1)])]),_:1})]),s.description?(r(),m("p",Ct,f(s.description),1)):U("",!0)]),d("div",$t,[d("div",ht,[(r(!0),m(P,null,S(s.file_types,u=>(r(),w(t(M),{key:u,variant:"outline",class:"text-xs"},{default:a(()=>[o(f(u),1)]),_:2},1024))),128))]),d("span",Vt,f(Object.keys(s.config.metadata_fields||{}).length)+" fields ",1)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])):U("",!0),l(t(ne),{open:F.value||T.value,"onUpdate:open":e[16]||(e[16]=s=>{F.value=s,T.value=s,s||B()})},{default:a(()=>[l(t(te),{class:"max-h-[90vh] max-w-3xl overflow-y-auto"},{default:a(()=>[l(t(le),null,{default:a(()=>[l(t(ae),null,{default:a(()=>[o(f(h.value?"Edit Profile":"Create Profile"),1)]),_:1}),l(t(se),null,{default:a(()=>[...e[40]||(e[40]=[o(" Configure column mappings and row rendering for structured files ",-1)])]),_:1})]),_:1}),d("div",Ut,[d("div",Pt,[d("div",St,[l(t(y),{for:"name"},{default:a(()=>[...e[41]||(e[41]=[o("Profile Name",-1)])]),_:1}),l(t(H),{id:"name",modelValue:i.value.name,"onUpdate:modelValue":e[4]||(e[4]=s=>i.value.name=s),placeholder:"e.g., Customer Feedback"},null,8,["modelValue"])]),d("div",Ft,[l(t(y),{for:"validation"},{default:a(()=>[...e[42]||(e[42]=[o("Validation Mode",-1)])]),_:1}),l(t(Q),{modelValue:i.value.config.validation_mode,"onUpdate:modelValue":e[5]||(e[5]=s=>i.value.config.validation_mode=s)},{default:a(()=>[l(t(Y),null,{default:a(()=>[l(t(Z))]),_:1}),l(t(G),null,{default:a(()=>[l(t(k),{value:"warn"},{default:a(()=>[...e[43]||(e[43]=[o("Warn (log issues)",-1)])]),_:1}),l(t(k),{value:"skip"},{default:a(()=>[...e[44]||(e[44]=[o("Skip (skip invalid rows)",-1)])]),_:1}),l(t(k),{value:"fail"},{default:a(()=>[...e[45]||(e[45]=[o("Fail (stop on first error)",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),d("div",Dt,[l(t(y),{for:"description"},{default:a(()=>[...e[46]||(e[46]=[o("Description",-1)])]),_:1}),l(t(W),{id:"description",modelValue:i.value.description,"onUpdate:modelValue":e[6]||(e[6]=s=>i.value.description=s),placeholder:"Describe what data this profile is designed for..."},null,8,["modelValue"])]),d("div",Mt,[d("div",jt,[e[48]||(e[48]=d("div",null,[d("h4",{class:"font-medium"},"Auto-detect Columns"),d("p",{class:"text-muted-foreground text-sm"}," Upload a sample file to automatically detect columns ")],-1)),d("div",null,[d("input",{ref_key:"fileInput",ref:fe,type:"file",accept:".csv,.xlsx,.xls",class:"hidden",onChange:ze},null,544),l(t(p),{variant:"outline",onClick:e[7]||(e[7]=s=>fe.value?.click()),disabled:$.value},{default:a(()=>[l(t(nt),{class:"mr-2 h-4 w-4"}),e[47]||(e[47]=o(" Upload Sample ",-1))]),_:1},8,["disabled"])])])]),d("div",Et,[d("div",Tt,[l(t(y),null,{default:a(()=>[...e[49]||(e[49]=[o("Column Mappings",-1)])]),_:1}),d("div",qt,[l(t(p),{variant:"outline",size:"sm",onClick:Ve},{default:a(()=>[l(t(re),{class:"mr-2 h-4 w-4"}),e[50]||(e[50]=o(" Add column ",-1))]),_:1}),i.value.config.columns.length>0?(r(),w(t(p),{key:0,variant:"outline",size:"sm",onClick:Ie},{default:a(()=>[l(t(ot),{class:"mr-2 h-4 w-4"}),e[51]||(e[51]=o(" Preview ",-1))]),_:1})):U("",!0)])]),i.value.config.columns.length===0?(r(),m("div",At," Upload a sample file to auto-detect columns, or add them manually. ")):(r(),m("div",Rt,[l(t(ie),null,{default:a(()=>[l(t(de),null,{default:a(()=>[l(t(E),null,{default:a(()=>[l(t(_),null,{default:a(()=>[...e[52]||(e[52]=[o("Column",-1)])]),_:1}),l(t(_),null,{default:a(()=>[...e[53]||(e[53]=[o("Type",-1)])]),_:1}),l(t(_),null,{default:a(()=>[...e[54]||(e[54]=[o("Aliases",-1)])]),_:1}),l(t(_),{class:"text-center"},{default:a(()=>[...e[55]||(e[55]=[o("Content",-1)])]),_:1}),l(t(_),null,{default:a(()=>[...e[56]||(e[56]=[o("Metadata",-1)])]),_:1}),l(t(_),{class:"text-center"},{default:a(()=>[...e[57]||(e[57]=[o("Required",-1)])]),_:1}),l(t(_),{class:"w-10"})]),_:1})]),_:1}),l(t(ue),null,{default:a(()=>[(r(!0),m(P,null,S(i.value.config.columns,s=>(r(),w(t(E),{key:s.name},{default:a(()=>[l(t(c),{class:"font-medium"},{default:a(()=>[o(f(s.name),1)]),_:2},1024),l(t(c),null,{default:a(()=>[l(t(Q),{modelValue:s.type,"onUpdate:modelValue":u=>s.type=u},{default:a(()=>[l(t(Y),{class:"h-8 w-24"},{default:a(()=>[l(t(Z))]),_:1}),l(t(G),null,{default:a(()=>[l(t(k),{value:"string"},{default:a(()=>[...e[58]||(e[58]=[o("string",-1)])]),_:1}),l(t(k),{value:"number"},{default:a(()=>[...e[59]||(e[59]=[o("number",-1)])]),_:1}),l(t(k),{value:"date"},{default:a(()=>[...e[60]||(e[60]=[o("date",-1)])]),_:1}),l(t(k),{value:"boolean"},{default:a(()=>[...e[61]||(e[61]=[o("boolean",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(t(c),null,{default:a(()=>[l(t(H),{class:"h-8","model-value":Me(s),"onUpdate:modelValue":u=>je(s,String(u)),placeholder:"alt_name, AltName"},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),l(t(c),{class:"text-center"},{default:a(()=>[l(t(j),{checked:i.value.config.content_fields.includes(s.name),"onUpdate:checked":u=>Pe(s.name,!!u)},null,8,["checked","onUpdate:checked"])]),_:2},1024),l(t(c),null,{default:a(()=>[d("div",zt,[l(t(j),{checked:s.name in i.value.config.metadata_fields,"onUpdate:checked":u=>Se(s.name,!!u)},null,8,["checked","onUpdate:checked"]),s.name in i.value.config.metadata_fields?(r(),w(t(H),{key:0,class:"h-8 w-28","model-value":i.value.config.metadata_fields[s.name],"onUpdate:modelValue":u=>Fe(s.name,String(u))},null,8,["model-value","onUpdate:modelValue"])):U("",!0)])]),_:2},1024),l(t(c),{class:"text-center"},{default:a(()=>[l(t(j),{checked:i.value.config.required_fields.includes(s.name),"onUpdate:checked":u=>De(s.name,!!u)},null,8,["checked","onUpdate:checked"])]),_:2},1024),l(t(c),null,{default:a(()=>[l(t(p),{variant:"ghost",size:"icon",class:"h-8 w-8",onClick:u=>Ue(s.name)},{default:a(()=>[l(t(xe),{class:"h-4 w-4"})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]),d("div",Bt,[l(t(y),null,{default:a(()=>[...e[62]||(e[62]=[o("Row Template",-1)])]),_:1}),d("div",It,[d("div",Ot,[l(t(y),{class:"text-muted-foreground text-xs font-normal"},{default:a(()=>[...e[63]||(e[63]=[o("Format",-1)])]),_:1}),l(t(Q),{modelValue:i.value.config.row_template.format,"onUpdate:modelValue":e[8]||(e[8]=s=>i.value.config.row_template.format=s)},{default:a(()=>[l(t(Y),null,{default:a(()=>[l(t(Z))]),_:1}),l(t(G),null,{default:a(()=>[l(t(k),{value:"key_value"},{default:a(()=>[...e[64]||(e[64]=[o("Key-Value Pairs",-1)])]),_:1}),l(t(k),{value:"custom"},{default:a(()=>[...e[65]||(e[65]=[o("Custom Template",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),d("div",Jt,[l(t(y),{class:"text-muted-foreground text-xs font-normal"},{default:a(()=>[...e[66]||(e[66]=[o("Field order (one per line)",-1)])]),_:1}),l(t(W),{modelValue:pe.value,"onUpdate:modelValue":e[9]||(e[9]=s=>pe.value=s),placeholder:`Subject
Description
Resolution`,class:"min-h-[80px]"},null,8,["modelValue"])])]),i.value.config.row_template.format==="custom"?(r(),m("div",Lt,[l(t(y),{class:"text-muted-foreground text-xs font-normal"},{default:a(()=>[...e[67]||(e[67]=[o("Custom template (Jinja2)",-1)])]),_:1}),l(t(W),{modelValue:i.value.config.row_template.custom_template,"onUpdate:modelValue":e[10]||(e[10]=s=>i.value.config.row_template.custom_template=s),placeholder:`Subject: {{ Subject }}
Description: {{ Description }}`,class:"min-h-[100px] font-mono text-sm"},null,8,["modelValue"])])):U("",!0),d("div",Nt,[d("div",Kt,[l(t(j),{id:"include-labels",checked:i.value.config.row_template.include_labels,"onUpdate:checked":e[11]||(e[11]=s=>i.value.config.row_template.include_labels=s)},null,8,["checked"]),l(t(y),{for:"include-labels",class:"font-normal"},{default:a(()=>[...e[68]||(e[68]=[o("Include labels",-1)])]),_:1})]),d("div",Ht,[l(t(j),{id:"omit-empty",checked:i.value.config.row_template.omit_empty,"onUpdate:checked":e[12]||(e[12]=s=>i.value.config.row_template.omit_empty=s)},null,8,["checked"]),l(t(y),{for:"omit-empty",class:"font-normal"},{default:a(()=>[...e[69]||(e[69]=[o("Omit empty values",-1)])]),_:1})])])]),d("div",Wt,[l(t(j),{id:"is-default",checked:i.value.is_default,"onUpdate:checked":e[13]||(e[13]=s=>i.value.is_default=s)},null,8,["checked"]),l(t(y),{for:"is-default",class:"font-normal"},{default:a(()=>[...e[70]||(e[70]=[o(" Set as default profile for this knowledge base ",-1)])]),_:1})])]),l(t(oe),null,{default:a(()=>[l(t(p),{variant:"outline",onClick:e[14]||(e[14]=s=>{F.value=!1,T.value=!1,B()})},{default:a(()=>[...e[71]||(e[71]=[o(" Cancel ",-1)])]),_:1}),l(t(p),{onClick:e[15]||(e[15]=s=>h.value?Te():Ee())},{default:a(()=>[l(t(it),{class:"mr-2 h-4 w-4"}),o(" "+f(h.value?"Update":"Create"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(t(ne),{open:q.value,"onUpdate:open":e[18]||(e[18]=s=>q.value=s)},{default:a(()=>[l(t(te),{class:"max-w-2xl"},{default:a(()=>[l(t(le),null,{default:a(()=>[l(t(ae),null,{default:a(()=>[...e[72]||(e[72]=[o("Column Analysis",-1)])]),_:1}),l(t(se),null,{default:a(()=>[o(" Detected "+f(V.value.length)+" columns from "+f(L.value)+" rows ",1)]),_:1})]),_:1}),d("div",Qt,[l(t(ie),null,{default:a(()=>[l(t(de),null,{default:a(()=>[l(t(E),null,{default:a(()=>[l(t(_),null,{default:a(()=>[...e[73]||(e[73]=[o("Column",-1)])]),_:1}),l(t(_),null,{default:a(()=>[...e[74]||(e[74]=[o("Type",-1)])]),_:1}),l(t(_),null,{default:a(()=>[...e[75]||(e[75]=[o("Non-null",-1)])]),_:1}),l(t(_),null,{default:a(()=>[...e[76]||(e[76]=[o("Suggested",-1)])]),_:1})]),_:1})]),_:1}),l(t(ue),null,{default:a(()=>[(r(!0),m(P,null,S(V.value,s=>(r(),w(t(E),{key:s.name},{default:a(()=>[l(t(c),{class:"font-medium"},{default:a(()=>[o(f(s.name),1)]),_:2},1024),l(t(c),null,{default:a(()=>[o(f(s.inferred_type),1)]),_:2},1024),l(t(c),null,{default:a(()=>[o(f(s.non_null_count),1)]),_:2},1024),l(t(c),null,{default:a(()=>[s.suggested_metadata_key?(r(),w(t(M),{key:0,variant:"secondary"},{default:a(()=>[o(f(s.suggested_metadata_key),1)]),_:2},1024)):(r(),m("span",Yt,"content"))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),l(t(oe),null,{default:a(()=>[l(t(p),{variant:"outline",onClick:e[17]||(e[17]=s=>q.value=!1)},{default:a(()=>[...e[77]||(e[77]=[o(" Cancel ",-1)])]),_:1}),l(t(p),{onClick:Be},{default:a(()=>[...e[78]||(e[78]=[o(" Apply Mappings ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),l(t(ne),{open:R.value,"onUpdate:open":e[20]||(e[20]=s=>R.value=s)},{default:a(()=>[l(t(te),{class:"max-w-2xl"},{default:a(()=>[l(t(le),null,{default:a(()=>[l(t(ae),null,{default:a(()=>[...e[79]||(e[79]=[o("Row Render Preview",-1)])]),_:1}),l(t(se),null,{default:a(()=>[...e[80]||(e[80]=[o(" Preview of how a row would be rendered ",-1)])]),_:1})]),_:1}),d("div",Zt,[d("div",null,[l(t(y),null,{default:a(()=>[...e[81]||(e[81]=[o("Chunk Text",-1)])]),_:1}),d("pre",Gt,f(me.value),1)]),Object.keys(N.value).length>0?(r(),m("div",Xt,[l(t(y),null,{default:a(()=>[...e[82]||(e[82]=[o("Extracted Metadata",-1)])]),_:1}),d("div",el,[(r(!0),m(P,null,S(N.value,(s,u)=>(r(),m("div",{key:u,class:"flex gap-2 text-sm"},[d("span",tl,f(u)+":",1),d("span",null,f(s),1)]))),128))])])):U("",!0)]),l(t(oe),null,{default:a(()=>[l(t(p),{onClick:e[19]||(e[19]=s=>R.value=!1)},{default:a(()=>[...e[83]||(e[83]=[o(" Close ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]))}});export{Al as default};
