(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8922],{58095:function(e,t,s){var n=s(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,s){for(var n=-1,a=null==e?0:e.length;++n<a;)if(s(t,e[n]))return!0;return!1}},8817:function(e,t,s){var n=s(95372),a=s(1129),l=s(58263);e.exports=function(e,t,s){return t==t?l(e,t,s):n(e,a,s)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,s){var n=s(52485),a=s(58095),l=s(21796),o=s(65581),i=s(47111),r=s(43735);e.exports=function(e,t,s){var d=-1,c=a,u=e.length,m=!0,p=[],h=p;if(s)m=!1,c=l;else if(u>=200){var y=t?null:i(e);if(y)return r(y);m=!1,c=o,h=new n}else h=t?[]:p;e:for(;++d<u;){var g=e[d],v=t?t(g):g;if(g=s||0!==g?g:0,m&&v==v){for(var f=h.length;f--;)if(h[f]===v)continue e;t&&h.push(v),p.push(g)}else c(h,v,s)||(h!==p&&h.push(v),p.push(g))}return p}},47111:function(e,t,s){var n=s(46151),a=s(50344),l=s(43735),o=n&&1/l(new n([,-0]))[1]==1/0?function(e){return new n(e)}:a;e.exports=o},58263:function(e){e.exports=function(e,t,s){for(var n=s-1,a=e.length;++n<a;)if(e[n]===t)return n;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,s){var n=s(92198);e.exports=function(e){return e&&e.length?n(e):[]}},14599:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/website/[monitorId]/[systemId]",function(){return s(26363)}])},79283:function(e,t,s){"use strict";s.d(t,{l:function(){return c}});var n=s(24246),a=s(41725),l=s(72707),o=s.n(l);let i=e=>{let{data:{formattedTitle:t,description:s,name:l,primaryName:o}}=e;return(0,n.jsxs)(a.kCb,{gap:12,title:"".concat(t," - ").concat(s),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:o||l}),o&&": ".concat(l)]}),(0,n.jsx)("em",{className:"overflow-hidden text-ellipsis",children:s})]})},r=e=>"options"in e&&Array.isArray(e.options),d=e=>({...e,className:o().option,formattedTitle:e.formattedTitle||[e.primaryName,e.name].filter(e=>e).join(": ")}),c=e=>{let{options:t,...s}=e,l=null==t?void 0:t.map(e=>r(e)?{...e,options:e.options.map(d)}:d(e));return(0,n.jsx)(a.PhF,{options:l,filterOption:(e,t)=>{var s,n;return(null==t?void 0:null===(s=t.formattedTitle)||void 0===s?void 0:s.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:null===(n=t.value)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase()))||!1},optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:i,styles:{popup:{root:{minWidth:"500px"}}},className:"w-full p-0","data-testid":"taxonomy-select",...s})}},45938:function(e,t,s){"use strict";s.d(t,{Gt:function(){return m},eB:function(){return p},oI:function(){return u}});var n=s(24246),a=s(34090),l=s(27378),o=s(16134),i=s(38602),r=s(58452);let d=(0,l.createRef)(),c=(0,l.createRef)(),u=()=>{let e=(0,o.T)(),t=(0,o.C)(i.DB),s=(0,l.useCallback)(()=>{c.current=void 0,d.current=void 0},[]),n=(0,l.useCallback)(()=>{e((0,i.Mr)()),c.current&&(c.current(!0),s())},[e,s]),a=(0,l.useCallback)(()=>{e((0,i.Mr)()),c.current&&(c.current(!1),s())},[e,s]);return{attemptAction:(0,l.useCallback)(()=>t?(e((0,i.h7)()),d.current||(d.current=new Promise(e=>{c.current=e})),d.current):Promise.resolve(!0),[t,e]),onConfirm:n,onClose:a}},m=e=>{let{id:t,name:s}=e,{dirty:n}=(0,a.u6)(),r=(0,o.T)();return(0,l.useEffect)(()=>(r((0,i.Zu)({id:t,name:s})),()=>{r((0,i.dz)({id:t}))}),[r,t,s]),(0,l.useEffect)(()=>{r((0,i.$p)({id:t,isDirty:n}))},[n,r,t]),null},p=()=>{let{onConfirm:e,onClose:t}=u(),s=(0,o.C)(i.uv);return(0,n.jsx)(r.Z,{isOpen:s,onClose:t,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},94770:function(e,t,s){"use strict";s.d(t,{r:function(){return l}});var n=s(24246),a=s(41725);let l=e=>{let{children:t,...s}=e;return t&&"string"==typeof t?(0,n.jsx)(a.Typography.Text,{ellipsis:{tooltip:t},...s,children:t}):t}},26363:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ed}});var n=s(24246),a=s(86677),l=s(27378),o=s(35287),i=s(77830),r=s(58754),d=s(37059),c=s(41725),u=s(25415),m=s(60240),p=s(30952),h=s(8133),y=s(79283),g=s(34929),v=s(78238),f=e=>{let{selectedTaxonomies:t,...s}=e,{getDataUseDisplayNameProps:a,getDataUses:o}=(0,g.Z)(),i=[...o()].filter(e=>!(null==t?void 0:t.includes(e.fides_key))).sort(),r=i.filter(e=>e.active&&v.g.includes(e.fides_key)),d=i.map(e=>{let{name:t,primaryName:s}=a(e.fides_key);return{value:e.fides_key,name:t,primaryName:s,description:e.description||""}}),u=(0,l.useMemo)(()=>{let e=[],t=[];return d.forEach(s=>{r.some(e=>e.fides_key===s.value)?e.push(s):t.push(s)}),{suggested:e,all:t}},[d,r]),m=u.suggested.length?[{label:(0,n.jsxs)(c.TaI,{children:[(0,n.jsx)(c.QMR,{size:14}),(0,n.jsx)("span",{children:"Categories of consent"}),(0,n.jsx)("em",{className:"font-normal",children:"Recommended"})]}),options:u.suggested},{label:(0,n.jsxs)(c.TaI,{children:[(0,n.jsx)(c.PJP.BBB,{}),(0,n.jsx)("span",{children:"Other data uses"})]}),options:u.all}]:u.all;return(0,n.jsx)(y.l,{options:m,...s})};let{Text:x}=c.Typography;var b=e=>{let{onSave:t,isSaving:s,onClose:a,...o}=e,[i,r]=(0,l.useState)([]),d=()=>{r([]),a()};return(0,n.jsxs)(h.Z,{title:"Add consent category",...o,onClose:d,children:[(0,n.jsxs)(c.kCb,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(x,{children:"Assign consent categories to selected assets. This configures the system for consent management. Consent categories apply to both individual assets and the system."}),(0,n.jsx)(f,{mode:"tags",onSelect:(e,t)=>r([...i,t.value]),variant:"outlined"})]}),(0,n.jsxs)(c.kCb,{justify:"space-between",children:[(0,n.jsx)(c.zxk,{htmlType:"reset",onClick:d,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(c.zxk,{htmlType:"submit",type:"primary",disabled:!i.length,loading:s,onClick:()=>{t(i),d()},"data-testid":"save-btn",children:"Save"})]})]})},C=s(29850),k=s(77685);let{Text:j}=c.Typography,_=e=>{let{onSave:t,isSaving:s,...a}=e,[o,i]=(0,l.useState)(),[r,d]=(0,l.useState)(!1),u=(0,l.useCallback)(e=>{e.preventDefault(),d(!0)},[]),m=()=>{d(!1)},p=()=>{i(void 0),a.onClose()};return(0,n.jsxs)(h.Z,{title:"Assign system",...a,onClose:p,children:[(0,n.jsxs)(c.kCb,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(j,{children:"Assign a system to the selected assets. If no system exists, select 'Add new system' to create one."}),(0,n.jsx)(C.R,{placeholder:"Search or select...",onSelect:(e,t)=>{i(t)},onAddSystem:u,value:o})]})," ",(0,n.jsxs)(c.kCb,{justify:"space-between",children:[(0,n.jsx)(c.zxk,{htmlType:"reset",onClick:p,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(c.zxk,{htmlType:"submit",type:"primary",disabled:!o,loading:s,onClick:()=>{t(o),p()},"data-testid":"save-btn",children:"Save"})]}),r&&(0,n.jsx)(k.i,{isOpen:!0,onClose:m,onSuccessfulSubmit:(e,t)=>{m(),i({label:t,value:e})},toastOnSuccess:!0})]})};var S=s(8411),w=s(94770),E=s(32735),T=s(8125),A=s(16394),I=s(98145);let{Link:N}=c.Typography,D=e=>{let{stagedResource:t}=e,s=(0,T.o)({pagination:{defaultPageSize:10,pageSizeOptions:[10,...E.VZ]},disableUrlState:!0}),{pageIndex:a,pageSize:o}=s,{data:i,isFetching:r,isError:u}=(0,d.mi)({stagedResourceUrn:t.urn,statuses:I.LM,page:a,size:o}),{items:m,total:p}=(0,l.useMemo)(()=>i||{items:[],total:0,pages:0,filterOptions:{assigned_users:[],systems:[]}},[i]),h=(0,l.useMemo)(()=>({enableSelection:!1,getRowKey:e=>"".concat(e.location,"-").concat(e.page),isLoading:r,dataSource:m,totalRows:null!=p?p:0,customTableProps:{scroll:{scrollToFirstRowOnChange:!0},tableLayout:"fixed"}}),[r,m,p]),y=(0,T.V)(s,h);return{columns:(0,l.useMemo)(()=>[{title:"Location",dataIndex:I.EI.LOCATION,key:I.EI.LOCATION,render:e=>{var t;let s=(0,c.QCN)(e),a=s?(0,c.c1K)({isoEntry:s,showFlag:!0}):null!==(t=null===S.Z8||void 0===S.Z8?void 0:S.Z8[e])&&void 0!==t?t:e;return(0,n.jsx)(w.r,{children:a})},width:180},{title:"Page",dataIndex:I.EI.PAGE,key:I.EI.PAGE,render:e=>{let t=(0,A.hL)(e,50);return(0,n.jsx)(N,{href:e,target:"_blank",rel:"noopener noreferrer",variant:"primary",children:(0,n.jsx)(w.r,{unStyled:!0,children:t})})},minWidth:100},{title:"Compliance",dataIndex:I.EI.STATUS,key:I.EI.STATUS,width:160,render:e=>{let t=I.Vq[e];return(0,n.jsx)(c.ua7,{title:t,children:(0,n.jsx)(c.Vp9,{color:"error","data-testid":"status-badge_".concat(e.replace(/_/g,"-")),children:I.X1[e]})})}}],[]),data:i,isLoading:r,isError:u,totalRows:p,tableProps:y.tableProps,hasData:m.length>0}},{Paragraph:L,Text:O}=c.Typography,P=e=>{var t,s,a;let{isOpen:l,stagedResource:o,onCancel:i,onDownload:r}=e,{columns:d,tableProps:u,isError:m}=D({stagedResource:o});return(0,n.jsx)(c.u_l,{title:"Compliance issues",width:768,open:l,onCancel:i,footer:[(0,n.jsx)(c.zxk,{onClick:i,children:"Cancel"},"cancel"),!!r&&(0,n.jsx)(c.zxk,{type:"primary",onClick:r,children:"Download"},"download")],"data-testid":"consent-breakdown-modal",children:(0,n.jsxs)(c.kCb,{vertical:!0,className:"gap-6","data-testid":"consent-breakdown-modal-content",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(L,{children:"View all instances where this asset was detected with consent compliance issues, organized by location and page. This includes assets loaded without consent, before consent, or when CMP failed."}),(0,n.jsxs)(L,{children:[(0,n.jsx)(O,{strong:!0,children:"Asset name:"})," ",null!==(t=o.name)&&void 0!==t?t:(0,n.jsx)(O,{italic:!0,children:"Unknown"}),","," ",(0,n.jsx)(O,{strong:!0,children:"System:"})," ",null!==(s=o.system)&&void 0!==s?s:(0,n.jsx)(O,{italic:!0,children:"Unassigned"}),","," ",(0,n.jsx)(O,{strong:!0,children:"Domain:"})," ",null!==(a=o.domain)&&void 0!==a?a:(0,n.jsx)(O,{italic:!0,children:"Unknown"})]})]}),m?(0,n.jsx)(c.bZj,{type:"error",message:"Error fetching data",description:"Please try again later.",showIcon:!0}):(0,n.jsx)(c.iA_,{...u,columns:d,"data-testid":"consent-breakdown-modal-table"})]})})};var R=s(83766),z=s.n(R),V=s(62165),M=s(812),U=s(24813),G=s(3110),Z=s(46628),B=s(54762),K=s(9320),Y=s(26092),$=s.n(Y),F=s(88708),q=e=>!!e&&I.LM.includes(e);let W=e=>{let{asset:t,onTabChange:s,showComplianceIssueDetails:l}=e,{flags:o}=(0,V.hz)(),{assetConsentStatusLabels:r}=o,[u,{isLoading:p}]=(0,d.EY)(),[h,{isLoading:y}]=(0,d.nS)(),[g,{isLoading:v}]=(0,d.Tj)(),f=(0,c.p8r)(),x=(0,a.useRouter)(),b=p||y||v,{urn:C,name:k,resource_type:j,diff_status:_,system_key:S,user_assigned_system_key:w,consent_aggregated:E}=t,T=$()(k||"",{length:50}),A=q(E),I=async()=>{let e=await u({urnList:[C]});if((0,M.D4)(e))f((0,Z.Vo)((0,M.e$)(e.error)));else{let e=w||S,t="".concat(i.So,"/configure/").concat(e,"#assets");f((0,Z.t5)((0,K._)("".concat(j,' "').concat(T,'" has been added to the system inventory.'),e?()=>x.push(t):void 0)))}},N=async()=>{let e=await h({urnList:[C]});(0,M.D4)(e)?f((0,Z.Vo)((0,M.e$)(e.error))):f((0,Z.t5)((0,K._)("".concat(j,' "').concat(T,'" has been ignored and will not appear in future scans.'),async()=>{await s(F.A.IGNORED)})))},D=async()=>{let e=await g({urnList:[C]});(0,M.D4)(e)?f((0,Z.Vo)((0,M.e$)(e.error))):f((0,Z.t5)("".concat(j,' "').concat(T,'" is no longer ignored and will appear in future scans.')))};return(0,n.jsxs)(c.TaI,{children:[_!==m.LL.MUTED&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.ua7,{title:t.system?void 0:"This asset requires a system before you can add it to the inventory.",children:(0,n.jsx)(c.zxk,{"data-testid":"add-btn",size:"small",onClick:I,disabled:!t.system||b,loading:p,children:"Add"})}),(0,n.jsx)(c.zxk,{"data-testid":"ignore-btn",size:"small",onClick:N,disabled:b,loading:y,children:"Ignore"}),A&&r&&(0,n.jsx)(c.zxk,{"data-testid":"view-compliance-details-btn",size:"small",onClick:()=>{null==l||l(t)},disabled:b,loading:v,icon:(0,n.jsx)(c.PJP.OdJ,{style:{color:"var(--fidesui-error)",width:14}}),title:"View compliance issue","aria-label":"View compliance issue"})]}),_===m.LL.MUTED&&(0,n.jsx)(c.zxk,{"data-testid":"restore-btn",size:"small",onClick:D,disabled:b,loading:v,children:"Restore"})]})};var J=s(17245),Q=s(18992),X=s.n(Q),H=s(2525),ee=s(31883),et=e=>{let{asset:t,readonly:s,columnState:a,onChange:o}=e,[i,r]=(0,l.useState)(!1),[u,m]=(0,l.useState)((null==a?void 0:a.isExpanded)||!1),[p]=(0,d.Ak)(),{successAlert:h,errorAlert:y}=(0,J.VY)(),{getDataUseDisplayName:v}=(0,g.Z)(),x=[...t.preferred_data_uses||[]].sort(),b=$()(t.name||"",{length:50}),C=async e=>{let s=await p({monitorId:t.monitor_config_id,urnList:[t.urn],dataUses:[...x,e]});(0,ee.D4)(s)?y((0,M.e$)(s.error)):(h("Consent category added to ".concat(t.resource_type,' "').concat(b,'".'),"Confirmed"),null==o||o([...x,e])),r(!1)},k=async e=>{let s=await p({monitorId:t.monitor_config_id,urnList:[t.urn],dataUses:x.filter(t=>t!==e)});(0,ee.D4)(s)?y((0,M.e$)(s.error)):(h("Consent category removed from ".concat(t.resource_type,' "').concat(b,'".'),"Confirmed"),null==o||o(x.filter(t=>t!==e)))};return((0,l.useEffect)(()=>{m((null==a?void 0:a.isExpanded)||!1)},[null==a?void 0:a.isExpanded]),s)?(0,n.jsx)(H.Q,{values:null==x?void 0:x.map(e=>({label:v(e),key:e})),columnState:a,onStateChange:m}):(0,n.jsxs)(n.Fragment,{children:[!i&&(0,n.jsxs)(c.TaI,{align:"start",children:[(0,n.jsx)(c.Vp9,{onClick:()=>r(!0),"data-testid":"taxonomy-add-btn",addable:!0,"aria-label":"Add data use"}),(0,n.jsx)(H.Q,{values:null==x?void 0:x.map(e=>({label:v(e),key:e})),columnState:{...a,isExpanded:u},tagProps:{closable:!0,closeButtonLabel:"Remove data use"},onTagClose:k,onStateChange:m})]}),i&&(0,n.jsx)("div",{className:X().cellBleed,style:{backgroundColor:"var(--fides-color-white)"},children:(0,n.jsx)(f,{selectedTaxonomies:x,onSelect:C,onBlur:()=>r(!1),onKeyDown:e=>{"Escape"===e.key&&r(!1)},open:!0})})]})};let es=e=>{let{consentAggregated:t,stagedResource:s}=e,a=I.LM.includes(t);if(!(a||t===m.lg.UNKNOWN))return null;let l=!!s.data_uses&&s.data_uses.length>0,o=I.Vq[t];return t!==m.lg.UNKNOWN||l||(o="Add a category of consent to this asset to find consent information."),(0,n.jsx)(c.ua7,{title:o,children:(0,n.jsx)(c.Vp9,{color:a?"error":void 0,"data-testid":"status-badge_".concat(t.replace(/_/g,"-")),children:I.X1[t]})})};var en=s(70675);let ea=e=>{let{aggregateSystem:t,monitorConfigId:s,readonly:a,onChange:o}=e,{resource_type:i,name:r,urn:d,system:u,user_assigned_system_key:m,system_key:p}=t,h=$()(r||"",{length:50}),[y,g]=(0,l.useState)(!1),[v,f]=(0,l.useState)(!1),[x,{isLoading:b}]=(0,en.NA)(),{successAlert:j,errorAlert:_}=(0,J.VY)(),S=(0,l.useCallback)(e=>{e.preventDefault(),f(!0)},[]),w=async(e,t,n)=>{let a=await x({staged_resource_urn:d,monitor_config_id:s,user_assigned_system_key:e}),l=$()(t,{length:50});(0,M.D4)(a)?_((0,M.e$)(a.error)):(j(n?"".concat(l," has been added to your system inventory and the ").concat(i,' "').concat(h,'" has been assigned to that system.'):"".concat(i,' "').concat(h,'" has been assigned to ').concat(l,"."),"Confirmed"),null==o||o(e)),g(!1)};return a?u?(0,n.jsx)(c.Vp9,{"data-testid":"system-badge",color:"white",children:u}):null:(0,n.jsxs)(n.Fragment,{children:[!y&&(u?(0,n.jsxs)(c.Vp9,{onClick:()=>g(!0),"data-testid":"system-badge",children:[u,(0,n.jsx)(c.PJP.I8b,{})]}):(0,n.jsx)(c.Vp9,{onClick:()=>g(!0),"data-testid":"add-system-btn",addable:!0})),!!y&&(0,n.jsx)("div",{className:X().cellBleed,children:(0,n.jsx)(C.R,{variant:"borderless",autoFocus:!0,defaultOpen:!0,defaultValue:m||p,onBlur:e=>{var t;(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("id"))!=="add-new-system"&&g(!1)},onAddSystem:S,onSelect:(e,t)=>w(e,t.label),loading:b})}),v&&(0,n.jsx)(k.i,{isOpen:!0,onClose:()=>{f(!1)},onSuccessfulSubmit:(e,t)=>w(e,t,!0)})]})},el=e=>{let{monitorId:t,systemId:s,consentStatus:o,onShowComplianceIssueDetails:r}=e,u=(0,a.useRouter)(),p=(0,c.p8r)(),[h,y]=(0,l.useState)(s),[g,f]=(0,l.useState)(!1),[x,b]=(0,l.useState)(!1),[C,k]=(0,l.useState)(!1),[j,_]=(0,l.useState)(0),[w,E]=(0,l.useState)(0),[N,D]=(0,l.useState)(0),{flags:L}=(0,V.hz)(),{assetConsentStatusLabels:O}=L,{filterTabs:P,activeTab:R,onTabChange:Y,activeParams:$,actionsDisabled:q}=(0,F.Z)(s),J=(0,T.o)({sorting:{validColumns:Object.values(I.r6)}}),{columnFilters:Q,pageIndex:X,pageSize:H,resetState:ee,sortKey:en,sortOrder:el,searchQuery:eo,updateSearch:ei,updateFilters:er,updateSorting:ed,updatePageIndex:ec,updatePageSize:eu}=J,{data:em,isLoading:ep,isFetching:eh}=(0,d.WJ)({key:t,page:X,size:H,search:eo,sort_by:en?[en]:[I.r6.NAME],sort_asc:"descend"!==el,...$,...Q}),[ey,{isLoading:eg}]=(0,d.EY)(),[ev,{isLoading:ef}]=(0,d.nS)(),[ex,{isLoading:eb}]=(0,d.rs)(),[eC,{isLoading:ek}]=(0,d.sX)(),[ej,{isLoading:e_}]=(0,d.Vr)(),[eS,{isLoading:ew}]=(0,d.Tj)(),eE=eg||ef||eb||ek||ew||e_,eT=eE||s===i.Kl,{data:eA}=(0,d.ut)({monitor_config_id:t,resolved_system_id:s,diff_status:null==$?void 0:$.diff_status,search:eo,...Q}),eI=(0,l.useMemo)(()=>({enableSelection:R!==F.A.ADDED,getRowKey:e=>e.urn,isLoading:ep,isFetching:eh,dataSource:(null==em?void 0:em.items)||[],totalRows:(null==em?void 0:em.total)||0,sortBy:[I.r6.NAME],sortAsc:!0,customTableProps:{locale:{emptyText:(0,n.jsx)("div",{children:(0,n.jsx)("div",{children:"All caught up!"})})},sticky:{offsetHeader:40}}}),[R,ep,eh,null==em?void 0:em.items,null==em?void 0:em.total]),eN=(0,T.V)(J,eI),{selectedKeys:eD,selectedRows:eL,resetSelections:eO}=eN,eP=(0,l.useMemo)(()=>{var e;let t=[{title:"Asset",dataIndex:I.r6.NAME,key:I.r6.NAME,sorter:!0,sortOrder:en===I.r6.NAME?el:null,render:e=>(0,n.jsx)(c.xvT,{ellipsis:{tooltip:!0},style:{maxWidth:300},children:e}),fixed:"left",width:200},{title:"Type",dataIndex:I.r6.RESOURCE_TYPE,key:I.r6.RESOURCE_TYPE,sorter:!0,sortOrder:en===I.r6.RESOURCE_TYPE?el:null,filters:(0,A.nZ)(null==eA?void 0:eA.resource_type),filteredValue:(null==Q?void 0:Q.resource_type)||null},{title:"System",dataIndex:I.r6.SYSTEM,key:I.r6.SYSTEM,render:(e,t)=>!!t.monitor_config_id&&(0,n.jsx)(ea,{aggregateSystem:t,monitorConfigId:t.monitor_config_id,readonly:q||R===F.A.IGNORED,onChange:()=>{eO()}}),width:200},{title:"Categories of consent",key:I.r6.DATA_USES,menu:{items:G.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(k(!0),D(e=>e+1)):"collapse-all"===e.key&&(k(!1),D(e=>e+1))}},filters:(0,A.nZ)(null==eA?void 0:null===(e=eA.data_uses)||void 0===e?void 0:e.filter(e=>(0,v.Z)(e))),filteredValue:(null==Q?void 0:Q.data_uses)||null,render:(e,t)=>(0,n.jsx)(et,{asset:t,readonly:q||R===F.A.IGNORED,columnState:{isExpanded:C,version:N},onChange:()=>{eO()}}),width:200},{title:"Locations",dataIndex:I.r6.LOCATIONS,key:I.r6.LOCATIONS,menu:{items:G.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(f(!0),_(e=>e+1)):"collapse-all"===e.key&&(f(!1),_(e=>e+1))}},filters:(0,A.nZ)(null==eA?void 0:eA.locations,e=>{var t;let s=(0,c.QCN)(e);return s?(0,c.c1K)({isoEntry:s}):null!==(t=S.Z8[e])&&void 0!==t?t:e}),filteredValue:(null==Q?void 0:Q.locations)||null,render:e=>{var t;return(0,n.jsx)(U.Q3,{values:null!==(t=null==e?void 0:e.map(e=>{var t;let s=(0,c.QCN)(e);return{label:s?(0,c.c1K)({isoEntry:s}):null!==(t=S.Z8[e])&&void 0!==t?t:e,key:e}}))&&void 0!==t?t:[],columnState:{isExpanded:g,version:j}})}},{title:"Domain",dataIndex:I.r6.DOMAIN,key:I.r6.DOMAIN},{title:"Detected on",dataIndex:I.r6.PAGE,menu:{items:G.DI,onClick:e=>{e.domEvent.stopPropagation(),"expand-all"===e.key?(b(!0),E(e=>e+1)):"collapse-all"===e.key&&(b(!1),E(e=>e+1))}},key:I.r6.PAGE,render:e=>(0,n.jsx)(U.vx,{values:e,valueSuffix:"pages",columnState:{isExpanded:x,version:w}})}];return O&&t.push({title:()=>(0,n.jsxs)(c.TaI,{children:[(0,n.jsx)("div",{children:"Compliance"}),(null==o?void 0:o.status)===m.pF.ALERT&&(0,n.jsx)(B.l,{consentStatus:o})]}),dataIndex:I.r6.CONSENT_AGGREGATED,key:I.r6.CONSENT_AGGREGATED,sorter:!0,sortOrder:en===I.r6.CONSENT_AGGREGATED?el:null,filters:(0,A.nZ)(null==eA?void 0:eA[I.r6.CONSENT_AGGREGATED],e=>{var t;return null!==(t=I.X1[e])&&void 0!==t?t:e}),filteredValue:(null==Q?void 0:Q[I.r6.CONSENT_AGGREGATED])||null,render:(e,t)=>(0,n.jsx)(es,{consentAggregated:null!=e?e:m.lg.UNKNOWN,stagedResource:t}),width:160}),q||t.push({title:"Actions",key:I.r6.ACTIONS,fixed:"right",render:(e,t)=>(0,n.jsx)(W,{asset:t,onTabChange:Y,showComplianceIssueDetails:r})}),t},[en,el,eA,Q,O,q,R,C,N,eO,g,j,x,w,o,Y,r]);(0,l.useEffect)(()=>{if(em){var e;y((null===(e=em.items[0])||void 0===e?void 0:e.system)||h||s||"")}},[em,s,h]);let eR=(0,l.useCallback)(async()=>{var e,t;let s=await ey({urnList:eD}),n=(null===(e=eL[0])||void 0===e?void 0:e.user_assigned_system_key)||(null===(t=eL[0])||void 0===t?void 0:t.system_key),a=eL.every(e=>(e.user_assigned_system_key||e.system_key)===n)?n:void 0;(0,M.D4)(s)?p((0,Z.Vo)((0,M.e$)(s.error))):(p((0,Z.t5)((0,K._)("".concat(eD.length," assets from ").concat(h," have been added to the system inventory."),a?()=>u.push("".concat(i.So,"/configure/").concat(a,"#assets")):()=>u.push(i.So)))),eO())},[ey,eD,eL,h,p,u,eO]),ez=(0,l.useCallback)(async e=>{if("string"==typeof(null==e?void 0:e.value)){let s=await eC({monitorId:t,urnList:eD,systemKey:e.value});(0,M.D4)(s)?p((0,Z.Vo)((0,M.e$)(s.error))):(p((0,Z.t5)("".concat(eD.length," assets have been assigned to ").concat(e.label,"."),"Confirmed")),eO())}},[eC,t,eD,p,eO]),eV=(0,l.useCallback)(async e=>{if(!eL.length)return;let s=eL.map(t=>{let s=z()([...t.preferred_data_uses||[],...e]);return{urn:t.urn,user_assigned_data_uses:s}}),n=await ej({monitorId:t,assets:s});(0,M.D4)(n)?p((0,Z.Vo)((0,M.e$)(n.error))):(p((0,Z.t5)("Consent categories added to ".concat(eD.length," assets").concat(h?" from ".concat(h):"","."),"Confirmed")),eO())},[eL,ej,t,eD,h,p,eO]),eM=(0,l.useCallback)(async()=>{let e=await ev({urnList:eD});(0,M.D4)(e)?p((0,Z.Vo)((0,M.e$)(e.error))):(p((0,Z.t5)(h===i.Kl?"".concat(eD.length," uncategorized assets have been ignored and will not appear in future scans."):"".concat(eD.length," assets from ").concat(h," have been ignored and will not appear in future scans."),"Confirmed")),eO())},[ev,eD,h,p,eO]),eU=(0,l.useCallback)(async()=>{let e=await eS({urnList:eD});(0,M.D4)(e)?p((0,Z.Vo)((0,M.e$)(e.error))):(p((0,Z.t5)("".concat(eD.length," assets have been restored and will appear in future scans."),"Confirmed")),eO())},[eS,eD,p,eO]),eG=(0,l.useCallback)(async()=>{let e=(null==em?void 0:em.items.length)||0,n=await ex({monitor_config_key:t,resolved_system_ids:[s]});(0,M.D4)(n)?p((0,Z.Vo)((0,M.e$)(n.error))):(u.push({pathname:i.lA,query:{monitorId:encodeURIComponent(t)}}),p((0,Z.t5)("".concat(e," assets from ").concat(h," have been added to the system inventory."),"Confirmed")),eO())},[null==em?void 0:em.items.length,ex,t,s,u,p,h,eO]),eZ=(0,l.useCallback)(async e=>{await Y(e),ee(),eO()},[Y,ee,eO]);return{columns:eP,data:em,isLoading:ep,isFetching:eh,tableState:J,searchQuery:eo,updateSearch:ei,updateFilters:er,updateSorting:ed,updatePageIndex:ec,updatePageSize:eu,resetState:ee,tableProps:eN.tableProps,selectionProps:eN.selectionProps,filterTabs:P,activeTab:R,handleTabChange:eZ,activeParams:$,actionsDisabled:q,selectedRows:eL,selectedUrns:eD,hasSelectedRows:eN.hasSelectedRows,resetSelections:eO,systemName:h,consentStatus:o,handleBulkAdd:eR,handleBulkAssignSystem:ez,handleBulkAddDataUse:eV,handleBulkIgnore:eM,handleBulkRestore:eU,handleAddAll:eG,anyBulkActionIsLoading:eE,isAddingResults:eg,isIgnoringResults:ef,isAddingAllResults:eb,isBulkUpdatingSystem:ek,isBulkAddingDataUses:e_,isRestoringResults:ew,disableAddAll:eT}},eo=e=>{var t;let{monitorId:s,systemId:a,consentStatus:o}=e,[i,r]=(0,l.useState)(!1),[d,h]=(0,l.useState)(!1),[y,g]=(0,l.useState)(null),{columns:v,searchQuery:f,updateSearch:x,resetState:C,tableProps:k,selectionProps:j,filterTabs:S,activeTab:w,handleTabChange:E,activeParams:T,actionsDisabled:A,selectedUrns:I,hasSelectedRows:N,resetSelections:D,handleBulkAdd:L,handleBulkAssignSystem:O,handleBulkAddDataUse:R,handleBulkIgnore:z,handleBulkRestore:V,handleAddAll:M,anyBulkActionIsLoading:U,isAddingAllResults:G,isBulkUpdatingSystem:Z,isBulkAddingDataUses:B,disableAddAll:K}=el({monitorId:s,systemId:a,consentStatus:o,onShowComplianceIssueDetails:e=>{g(e)}}),Y=async e=>{await O(e),r(!1)},$=async e=>{await R(e),h(!1)};return s&&a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.v2r,{"aria-label":"Asset state filter",mode:"horizontal",items:S.map(e=>({key:e.hash,label:e.label})),selectedKeys:[w],onClick:async e=>{await E(e.key)},className:"mb-4","data-testid":"asset-state-filter"}),(0,n.jsxs)(c.kCb,{justify:"space-between",align:"center",className:"sticky -top-6 z-10 mb-4 bg-white py-4",children:[(0,n.jsx)(p.f,{value:f,onChange:x,placeholder:"Search by asset name..."}),(0,n.jsxs)(c.TaI,{size:"large",children:[N&&(0,n.jsx)(u.a,{count:I.length}),(0,n.jsxs)(c.TaI,{size:"small",children:[(0,n.jsx)(c.zxk,{onClick:()=>{C(),D()},"data-testid":"clear-filters",children:"Clear filters"}),(0,n.jsx)(c.Ltx,{overlayClassName:"bulk-actions-menu-dropdown",menu:{items:[...(null==T?void 0:null===(t=T.diff_status)||void 0===t?void 0:t.includes(m.LL.MUTED))?[{key:"restore",label:"Restore",onClick:V}]:[{key:"add",label:"Add",onClick:L},{key:"add-data-use",label:"Add consent category",onClick:()=>h(!0)},{key:"assign-system",label:"Assign system",onClick:()=>r(!0)},{type:"divider"},{key:"ignore",label:"Ignore",onClick:z}]]},trigger:["click"],children:(0,n.jsx)(c.zxk,{icon:(0,n.jsx)(c.PJP._ME,{}),iconPosition:"end",loading:U,"data-testid":"bulk-actions-menu",disabled:!N||U||A,type:"primary",children:"Actions"})}),(0,n.jsx)(c.ua7,{title:K?"These assets require a system before you can add them to the inventory.":void 0,children:(0,n.jsx)(c.zxk,{onClick:M,disabled:K,loading:G,type:"primary",icon:(0,n.jsx)(c.PJP.MCw,{}),iconPosition:"end","data-testid":"add-all",children:"Add all"})})]})]})]}),(0,n.jsx)(c.iA_,{...k,columns:v,rowSelection:j,locale:{emptyText:(0,n.jsx)(c.HYy,{image:c.HYy.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})},"aria-labelledby":"breadcrumb-current-page"}),(0,n.jsx)(_,{isOpen:i,onClose:()=>{r(!1)},onSave:Y,isSaving:Z}),(0,n.jsx)(b,{isOpen:d,onClose:()=>{h(!1)},onSave:$,isSaving:B}),y&&(0,n.jsx)(P,{isOpen:!!y,stagedResource:y,onCancel:()=>{g(null)}})]}):null};var ei=s(71985),er=s(98243),ed=()=>{let e=(0,a.useRouter)(),t=decodeURIComponent(e.query.monitorId),s=decodeURIComponent(e.query.systemId),{data:c}=(0,d.wi)({key:t,page:1,size:1,search:"",diff_status:[er.L.ADDITION],resolved_system_id:s}),u=null==c?void 0:c.items[0];return(0,l.useEffect)(()=>{c&&0===c.items.length&&e.push({pathname:i.lA,query:{monitorId:encodeURIComponent(t)}})},[c,e,t]),(0,n.jsxs)(o.Z,{title:"Action center - Discovered assets",children:[(0,n.jsx)(r.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:i.vi},{title:t,href:"".concat(i.vi,"/").concat(ei.w.WEBSITE,"/").concat(t)},{title:s===i.Kl?"Uncategorized assets":null==u?void 0:u.name}],isSticky:!1}),(0,n.jsx)(eo,{monitorId:t,systemId:s,consentStatus:null==u?void 0:u.consent_status})]})}},31883:function(e,t,s){"use strict";s.d(t,{Bw:function(){return n.Bw},D4:function(){return n.D4}});var n=s(19043)},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},18992:function(e){e.exports={cellBleed:"Cells_cellBleed__dik43"}}},function(e){e.O(0,[431,7245,3931,401,4589,8149,884,2888,9774,179],function(){return e(e.s=14599)}),_N_E=e.O()}]);