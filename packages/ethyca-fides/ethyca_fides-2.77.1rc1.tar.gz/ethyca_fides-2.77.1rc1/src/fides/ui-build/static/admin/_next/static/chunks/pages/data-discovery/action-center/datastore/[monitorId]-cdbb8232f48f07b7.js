(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6721],{58095:function(e,t,n){var r=n(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,n){for(var r=-1,l=null==e?0:e.length;++r<l;)if(n(t,e[r]))return!0;return!1}},95372:function(e){e.exports=function(e,t,n,r){for(var l=e.length,i=n+(r?1:-1);r?i--:++i<l;)if(t(e[i],i,e))return i;return -1}},8817:function(e,t,n){var r=n(95372),l=n(1129),i=n(58263);e.exports=function(e,t,n){return t==t?i(e,t,n):r(e,l,n)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,n){var r=n(52485),l=n(58095),i=n(21796),a=n(65581),s=n(47111),o=n(43735);e.exports=function(e,t,n){var c=-1,d=l,u=e.length,p=!0,f=[],h=f;if(n)p=!1,d=i;else if(u>=200){var y=t?null:s(e);if(y)return o(y);p=!1,d=a,h=new r}else h=t?[]:f;e:for(;++c<u;){var g=e[c],m=t?t(g):g;if(g=n||0!==g?g:0,p&&m==m){for(var _=h.length;_--;)if(h[_]===m)continue e;t&&h.push(m),f.push(g)}else d(h,m,n)||(h!==f&&h.push(m),f.push(g))}return f}},56632:function(e,t,n){var r=n(89278),l=n(80068),i=n(50098);e.exports=function(e){return function(t,n,a){var s=Object(t);if(!l(t)){var o=r(n,3);t=i(t),n=function(e){return o(s[e],e,s)}}var c=e(t,n,a);return c>-1?s[o?t[c]:c]:void 0}}},47111:function(e,t,n){var r=n(46151),l=n(50344),i=n(43735),a=r&&1/i(new r([,-0]))[1]==1/0?function(e){return new r(e)}:l;e.exports=a},58263:function(e){e.exports=function(e,t,n){for(var r=n-1,l=e.length;++r<l;)if(e[r]===t)return r;return -1}},64925:function(e,t,n){var r=n(56632)(n(66259));e.exports=r},66259:function(e,t,n){var r=n(95372),l=n(89278),i=n(47991),a=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return -1;var o=null==n?0:i(n);return o<0&&(o=a(s+o,0)),r(e,l(t,3),o)}},50344:function(e){e.exports=function(){}},94919:function(e,t,n){var r=n(91936),l=1/0;e.exports=function(e){return e?(e=r(e))===l||e===-l?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}},47991:function(e,t,n){var r=n(94919);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},83766:function(e,t,n){var r=n(92198);e.exports=function(e){return e&&e.length?r(e):[]}},83806:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/datastore/[monitorId]",function(){return n(73662)}])},20987:function(e,t,n){"use strict";var r,l,i,a;n.d(t,{H:function(){return r},J:function(){return l}}),(i=r||(r={})).STRING="string",i.STRING_ARRAY="string[]",(a=l||(l={})).SYSTEM="system",a.DATA_USE="data use",a.DATA_CATEGORY="data category",a.DATA_SUBJECT="data subject",a.PRIVACY_DECLARATION="privacy declaration"},12627:function(e,t,n){"use strict";var r=n(24246),l=n(79283),i=n(34929);t.Z=e=>{let{selectedTaxonomies:t,showDisabled:n=!1,...a}=e,{getDataCategoryDisplayNameProps:s,getDataCategories:o}=(0,i.Z)(),c=(n?o():o().filter(e=>e.active)).filter(e=>!(null==t?void 0:t.includes(e.fides_key))).map(e=>{let{name:t,primaryName:n}=s(e.fides_key);return{value:e.fides_key,name:t,primaryName:n,description:e.description||"",label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("strong",{children:n||t}),n&&": ".concat(t)]}),title:e.fides_key}});return(0,r.jsx)(l.l,{options:c,...a})}},79283:function(e,t,n){"use strict";n.d(t,{l:function(){return d}});var r=n(24246),l=n(49617),i=n(72707),a=n.n(i);let s=e=>{let{data:{formattedTitle:t,description:n,name:i,primaryName:a}}=e;return(0,r.jsxs)(l.jqI,{gap:12,title:"".concat(t," - ").concat(n),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:a||i}),a&&": ".concat(i)]}),(0,r.jsx)("em",{className:"overflow-hidden text-ellipsis",children:n})]})},o=e=>"options"in e&&Array.isArray(e.options),c=e=>({...e,className:a().option,formattedTitle:e.formattedTitle||[e.primaryName,e.name].filter(e=>e).join(": ")}),d=e=>{let{options:t,...n}=e,i=null==t?void 0:t.map(e=>o(e)?{...e,options:e.options.map(c)}:c(e));return(0,r.jsx)(l.WPr,{options:i,filterOption:(e,t)=>{var n,r;return(null==t?void 0:null===(n=t.formattedTitle)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:null===(r=t.value)||void 0===r?void 0:r.toLowerCase().includes(e.toLowerCase()))||!1},optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:s,styles:{popup:{root:{minWidth:"500px"}}},className:"w-full p-0","data-testid":"taxonomy-select",...n})}},34929:function(e,t,n){"use strict";var r=n(24246),l=n(64925),i=n.n(l),a=n(27378),s=n(16134),o=n(30002),c=n(28079),d=n(57072);let u=()=>{let{isLoading:e}=(0,c.fd)(),t=(0,s.C)(c.U3),{isLoading:n}=(0,d.MO)(),r=(0,s.C)(d.qb),{isLoading:l}=(0,o.te)();return{dataUses:t,dataSubjects:(0,s.C)(o.ZL),dataCategories:r,isLoading:e||n||l}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:n,isLoading:l}=u(),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=t(e);if(!r)return{};let l=t(s(e,n)),i=!!r.parent_key;return{name:r.name||void 0,primaryName:i&&(null==l?void 0:l.name)!==r.name&&(null==l?void 0:l.name)||void 0}},c=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:l,primaryName:i}=o(e,t,n);return l?i?(0,r.jsxs)(a.Fragment,{children:[(0,r.jsxs)("strong",{children:[i,":"]})," ",l]},e):(0,r.jsx)("strong",{children:l},e):e},d=t=>i()(e,{fides_key:t}),p=e=>i()(t,{fides_key:e}),f=e=>i()(n,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:d,getDataUseDisplayName:e=>c(e,d,1),getDataUseDisplayNameProps:e=>o(e,d,1),getDataCategories:()=>t,getDataCategoryByKey:p,getDataCategoryDisplayName:e=>c(e,p,2),getDataCategoryDisplayNameProps:e=>o(e,p,2),getDataSubjects:()=>n,getDataSubjectByKey:f,getDataSubjectDisplayName:e=>{let t=f(e);return t?t.name:e},getDataSubjectDisplayNameProps:e=>{let t=f(e);return t?{name:t.name||e}:{}},getPrimaryKey:s,isLoading:l}}},84418:function(e,t,n){"use strict";n.d(t,{d:function(){return c}});var r=n(24246),l=n(49617),i=n(98784),a=n.n(i);let s=e=>{let{itemKey:t,actions:n}=e;return a().isEmpty(n)?null:(0,r.jsx)(l.jqI,{gap:"small",justify:"flex-end",children:n.map((e,i)=>{let{callback:a,label:s,disabled:o}=e;return(0,r.jsx)(l.wpx,{onClick:()=>a(t),type:i===n.length-1?"primary":"default",disabled:o,children:s},s)})})},o=e=>{let{title:t,titleIcon:n,titleTag:i}=e;return(0,r.jsxs)(l.jqI,{align:"center",gap:"small",children:[n,(0,r.jsx)("span",{children:t}),i&&(0,r.jsx)(l.j8w,{...i})]})},c=e=>{let{title:t,titleIcon:n,titleTag:i,actions:a,width:c=480,...d}=e;return(0,r.jsx)(l.To0,{title:(0,r.jsx)(o,{title:t,titleIcon:n,titleTag:i}),footer:d.footer||!a?d.footer:(0,r.jsx)(s,{itemKey:d.itemKey,actions:a}),width:c,...d})}},59001:function(e,t,n){"use strict";n.d(t,{Ch:function(){return o},Lo:function(){return a},_g:function(){return c},ac:function(){return i},aq:function(){return d}});var r,l,i,a,s=n(60240);let o="root";(r=i||(i={})).DATA_CATEGORY="data_category",r.DATA_USE="data_use",r.DATA_SUBJECT="data_subject",r.SYSTEM_GROUP="system_group",(l=a||(a={})).DATA_CATEGORIES="Data categories",l.DATA_USES="Data uses",l.DATA_SUBJECTS="Data subjects",l.SYSTEM_GROUPS="System groups";let c=e=>{switch(e){case"data_category":return"Data categories";case"data_use":return"Data uses";case"data_subject":return"Data subjects";case"system_group":return"System groups";default:return e}},d=e=>{switch(e){case"data_category":return{UPDATE:s.Sh.DATA_CATEGORY_UPDATE,CREATE:s.Sh.DATA_CATEGORY_CREATE,DELETE:s.Sh.DATA_CATEGORY_DELETE,READ:s.Sh.DATA_CATEGORY_READ};case"data_use":return{UPDATE:s.Sh.DATA_USE_UPDATE,CREATE:s.Sh.DATA_USE_CREATE,DELETE:s.Sh.DATA_USE_DELETE,READ:s.Sh.DATA_USE_READ};case"data_subject":return{UPDATE:s.Sh.DATA_SUBJECT_UPDATE,CREATE:s.Sh.DATA_SUBJECT_CREATE,DELETE:s.Sh.DATA_SUBJECT_DELETE,READ:s.Sh.DATA_SUBJECT_READ};case"system_group":return{UPDATE:s.Sh.SYSTEM_GROUP_UPDATE,CREATE:s.Sh.SYSTEM_GROUP_CREATE,DELETE:s.Sh.SYSTEM_GROUP_DELETE,READ:s.Sh.SYSTEM_GROUP_READ};default:return{UPDATE:s.Sh.TAXONOMY_UPDATE,CREATE:s.Sh.TAXONOMY_CREATE,DELETE:s.Sh.TAXONOMY_DELETE,READ:s.Sh.TAXONOMY_READ}}}},90673:function(e,t,n){"use strict";n.d(t,{Cd:function(){return i},Xl:function(){return a}});var r=n(20987),l=n(59001);let i=(e,t)=>{let n;if(null==t&&e.every(e=>void 0===e.parent_key))n=e;else{let r=null!=t?t:null;n=e.filter(e=>e.parent_key===r)}return n.map(t=>{var n,r;let l=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:i(e,l),is_default:null!==(n=t.is_default)&&void 0!==n&&n,active:null!==(r=t.active)&&void 0!==r&&r}})},a=e=>{switch(e){case l.ac.DATA_CATEGORY:return r.J.DATA_CATEGORY;case l.ac.DATA_SUBJECT:return r.J.DATA_SUBJECT;case l.ac.DATA_USE:return r.J.DATA_USE;default:return e}}},57072:function(e,t,n){"use strict";n.d(t,{Bd:function(){return r.Bd},L5:function(){return r.L5},MO:function(){return r.MO},qb:function(){return r.qb}});var r=n(5785)},39864:function(e,t,n){"use strict";n.d(t,{Cy:function(){return s},EO:function(){return u},Hb:function(){return c},J1:function(){return a},Jy:function(){return l},Km:function(){return d},MU:function(){return r},ci:function(){return i},d9:function(){return o},jW:function(){return p}});let{useGetCustomTaxonomiesQuery:r,useGetTaxonomyQuery:l,useLazyGetTaxonomyQuery:i,useCreateTaxonomyMutation:a,useUpdateTaxonomyMutation:s,useDeleteTaxonomyMutation:o,useCreateCustomTaxonomyMutation:c,useUpdateCustomTaxonomyMutation:d,useDeleteCustomTaxonomyMutation:u,useGetTaxonomyHistoryQuery:p}=n(78780).u.injectEndpoints({endpoints:e=>({getTaxonomy:e.query({query:e=>({url:"taxonomies/".concat(e,"/elements")}),providesTags:(e,t,n)=>[{type:"Taxonomy",id:n}],transformResponse:e=>{let t=[],n=[...e],r=n.filter(e=>null===e.parent_key);r.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)),t.push(...r);let l=n.filter(e=>null!==e.parent_key);for(;l.length>0;){let e=l.filter(e=>t.some(t=>t.fides_key===e.parent_key));if(0===e.length){t.push(...l.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)));break}e.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)),t.push(...e),l=l.filter(t=>!e.includes(t))}return t}}),getCustomTaxonomies:e.query({query:()=>({url:"taxonomies"}),providesTags:()=>[{type:"Taxonomy"}]}),createTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,...n}=e;return{url:"taxonomies/".concat(t,"/elements"),method:"POST",body:n}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r},{type:"Taxonomy History",id:r}]}}),updateTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,...n}=e;return{url:"taxonomies/".concat(t,"/elements/").concat(n.fides_key),method:"PUT",body:n}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r},{type:"Taxonomy History",id:r}]}}),deleteTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,key:n}=e;return{url:"taxonomies/".concat(t,"/elements/").concat(n),method:"DELETE"}},invalidatesTags:(e,t,n)=>{let{taxonomyType:r}=n;return[{type:"Taxonomy",id:r},{type:"Taxonomy History",id:r}]}}),createCustomTaxonomy:e.mutation({query:e=>({url:"taxonomies",method:"POST",body:e}),invalidatesTags:()=>[{type:"Taxonomy"}]}),updateCustomTaxonomy:e.mutation({query:e=>{let{fides_key:t,...n}=e;return{url:"taxonomies/".concat(t),method:"PUT",body:n}},invalidatesTags:(e,t,n)=>{let{fides_key:r}=n;return[{type:"Taxonomy"},{type:"Taxonomy History",id:r}]}}),deleteCustomTaxonomy:e.mutation({query:e=>({url:"taxonomies/".concat(e),method:"DELETE"}),invalidatesTags:()=>[{type:"Taxonomy"}]}),getTaxonomyHistory:e.query({query:e=>{let{fides_key:t,page:n,size:r}=e;return{url:"/plus/taxonomies/".concat(t,"/history"),params:{page:n,size:r}}},providesTags:(e,t,n)=>{let{fides_key:r}=n;return[{type:"Taxonomy History",id:r}]}})})})},73662:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return e$}});var r=n(24246),l=n(49617),i=n(25980),a=n(98784),s=n.n(a),o=n(79894),c=n.n(o),d=n(86677),u=n(27378),p=n(43929),f=n(30952),h=n(35287),y=n(17245),g=n(77830),m=n(58754),_=n(9270),v=n(37059),E=n(60240),T=n(62678),x=n(99824),A=n(26917);let S="space",b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"inclusive",{activeListItem:r=null,enableKeyboardShortcuts:l=!1}=t,[i,a]=(0,u.useState)(n),[o,c]=(0,u.useState)([]),d=(e,t)=>{(("inclusive"===i?t:!t)?"add":"remove")=="add"?c([...o,e]):c(o.filter(t=>t!==e))},f=e=>{a(e),c([])},h=s().difference(e,o),y="inclusive"===i?o:h,g="exclusive"===i?o:h;return(0,p.y1)("h",()=>{f("exclusive")},{enabled:l}),(0,p.y1)("l",()=>{f("inclusive")},{enabled:l}),(0,p.y1)(S,e=>{if(r){e.preventDefault();let t=y.includes(r.key);d(r.key,!t)}},{enabled:l},[r,y,d]),{checkboxProps:{checked:"inclusive"===i?y.length>0&&(null==e?void 0:e.length)===y.length:0===g.length,indeterminate:"inclusive"===i?y.length>0&&(null==e?void 0:e.length)!==y.length:g.length>0,onChange:e=>f(e.target.checked?"exclusive":"inclusive")},excludedKeys:g,listSelectMode:i,resetListSelect:()=>{c([]),a("inclusive")},selectedKeys:y,updateListSelectMode:f,updateSelectedListItem:d}},j=e=>{let{...t}=e;return(0,r.jsx)(l.$zI,{title:"Keyboard shortcuts",footer:null,...t,children:(0,r.jsx)(l.Yfl,{bordered:!0,column:1,items:[{key:"".concat(l.dHR.NAVIGATE_UP,"-").concat(l.dHR.NAVIGATE_DOWN),label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:l.dHR.NAVIGATE_DOWN})," ","/"," ",(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:l.dHR.NAVIGATE_UP})]}),children:"Activate the next/previous field"},{key:S,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:S}),children:"Toggle checkbox of the active field"},{key:"h",label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"h"}),children:"Select all fields"},{key:"l",label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"l"}),children:"Deselect all fields"},{key:l.dHR.CLEAR_FOCUS,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:l.dHR.CLEAR_FOCUS}),children:"Clear the active field"},{key:x.b_.TOGGLE_DRAWER,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:x.b_.TOGGLE_DRAWER}),children:"Open/close details drawer for active field"},{key:x.b_.REVIEW,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:x.b_.REVIEW}),children:"Mark the active field as reviewed"},{key:x.b_.PROMOTE,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:x.b_.PROMOTE}),children:"Approve the active field"},{key:x.b_.MUTE,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:x.b_.MUTE}),children:"Ignore the active field"},{key:x.b_.UN_MUTE,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:x.b_.UN_MUTE}),children:"Restore the active field"},{key:x.b_.OPEN_CLASSIFICATION_SELECT,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:x.b_.OPEN_CLASSIFICATION_SELECT}),children:"Edit data categories for the active field"},{key:x.b_.REFRESH,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:x.b_.REFRESH}),children:"Refresh the list"},{key:x.b_.REFRESH,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:x.b_.REFRESH}),children:"Refresh the list"},{key:A.M,label:(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"/"}),children:"Focus the search input"},{key:"?",label:(0,r.jsxs)("div",{className:"whitespace-nowrap",children:[(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"?"})," (",(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"shift"}),"+",(0,r.jsx)(l.AntTypography.Text,{keyboard:!0,children:"/"}),")"]}),children:"Open/close this modal"}]})})};var k=n(99089),D=n(83766),R=n.n(D),C=n(16394),I=n(59001),w=n(90673),O=n(39864),M=n(83158),L=n(3124),N=n.n(L);let U="load_more",P="skeleton",F=["Unlabeled","Classifying...","Classified","Reviewed","Approving...","Approved","Removed","Ignored","Error","Removing..."],q=["Approved","Ignored","Approving...","Removing..."],G=e=>e.filter(e=>!q.includes(e)),Y={addition:{label:"Unlabeled"},reviewed:{label:"Reviewed",color:l.tAb.ALERT},classification_addition:{label:"Classified",color:l.tAb.CAUTION},classification_error:{label:"Error",color:l.tAb.ERROR},classification_queued:{label:"Classifying...",color:l.tAb.INFO},classification_update:{label:"Classified",color:l.tAb.CAUTION},classifying:{label:"Classifying...",color:l.tAb.INFO},monitored:{label:"Approved",color:l.tAb.SUCCESS},muted:{label:"Ignored",color:l.tAb.DEFAULT},promoting:{label:"Approving...",color:l.tAb.DEFAULT},promotion_error:{label:"Error",color:l.tAb.ERROR},removal:{label:"Removed",color:l.tAb.ERROR},removing:{label:"Removing...",color:l.tAb.DEFAULT},removal_promotion_error:{label:"Error",color:l.tAb.ERROR}},$={[E.D$.DATABASE]:l.PJP.S9g,[E.D$.FIELD]:l.PJP.sgG,[E.D$.SCHEMA]:l.PJP.ehp,[E.D$.TABLE]:l.PJP.iA_},z={STATUS:"status-section",DATA_CATEGORY:"data-category-section",CONFIDENCE:"confidence-section"},H={[E.Ag.ADDITION]:{color:N().FIDESUI_SUCCESS,tooltip:"This resource was added in the latest scan"},[E.Ag.REMOVAL]:{color:N().FIDESUI_ERROR,tooltip:"This resource was removed in the latest scan"},[E.Ag.CHANGE]:{color:N().FIDESUI_WARNING,tooltip:"This resource was modified in the latest scan"}},W=[M.$.HIGH,M.$.MEDIUM,M.$.LOW,M.$.MANUAL],J=(e,t)=>{if(!e||0===e.length)return[];let n=(e,t)=>{let r=t=>{if(t.value===e)return{title:t.label||e,children:t.children||[]};if(t.children&&t.children.length>0){let r=n(e,t.children);if(r)return r}return null};return t.reduce((e,t)=>null!=e?e:r(t),null)},r=new Map;e.forEach(e=>{let l=e.split(".");l.forEach((e,i)=>{let a=l.slice(0,i+1).join(".");if(!r.has(a)){let e=n(a,t);r.set(a,{title:(null==e?void 0:e.title)||(0,C.kC)(a.split(".").pop()||a),key:a,checkable:!0,selectable:!1})}})});let l=Array.from(r.values()),i=new Map;l.forEach(e=>{let t=e.key.toString().split(".");if(t.length>1){let n=t.slice(0,-1).join(".");i.has(n)||i.set(n,[]),i.get(n).push(e)}});let a=e=>(i.get(e)||[]).map(e=>{let t=a(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}});return l.filter(e=>1===e.key.toString().split(".").length).map(e=>{let t=a(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}})},B=e=>{let{resourceStatus:t,setResourceStatus:n,dataCategory:i,confidenceBucket:a,setDataCategory:s,setConfidenceBucket:o,resetToInitialState:c,monitorId:d,stagedResourceUrn:p}=e,[f,h]=(0,u.useState)(t),[y,g]=(0,u.useState)(i),[m,_]=(0,u.useState)(a),[E,T]=(0,u.useState)([z.STATUS]);(0,u.useEffect)(()=>{h(t)},[t]),(0,u.useEffect)(()=>{_(a)},[a]),(0,u.useEffect)(()=>{g(i)},[i]);let x=p.join(","),A=(0,u.useRef)(!0);(0,u.useEffect)(()=>{if(A.current){A.current=!1;return}c()},[x]);let{data:S,refetch:b}=(0,v.S0)({monitor_config_id:d,staged_resource_urn:p},{refetchOnMountOrArgChange:!0}),[j,{data:k=[]}]=(0,O.ci)();(0,u.useEffect)(()=>{j(I.ac.DATA_CATEGORY)},[j]);let D=(0,u.useMemo)(()=>(0,w.Cd)(k),[k]),L=W.filter(e=>{var t;return null==S?void 0:null===(t=S.confidence_bucket)||void 0===t?void 0:t.includes(e)}),N=(0,u.useMemo)(()=>F.map(e=>({title:e.replace(/\.{3}$/,""),key:e,checkable:!0,selectable:!1,isLeaf:!0})),[]),U=(0,u.useMemo)(()=>(null==S?void 0:S.data_category)&&0!==S.data_category.length?J(S.data_category,D):[],[null==S?void 0:S.data_category,D]),P=[...N.length>0?[{title:"Status",key:z.STATUS,checkable:!0,selectable:!1,isLeaf:!1,children:N}]:[],...L.length>0?[{title:"Confidence",key:z.CONFIDENCE,checkable:!0,selectable:!1,isLeaf:!1,children:L.map(e=>({title:(0,C.kC)(e),key:e,checkable:!0,selectable:!1,isLeaf:!0}))}]:[],...U.length>0?[{title:"Data category",key:z.DATA_CATEGORY,checkable:!0,selectable:!1,isLeaf:!1,children:U}]:[]],q=(0,u.useMemo)(()=>R()([...null!=f?f:[],...null!=y?y:[],...null!=m?m:[]]),[f,y,m]),Y=(0,u.useMemo)(()=>{let e=0;return t&&(e+=new Set(t).size),i&&(e+=new Set(i).size),a&&(e+=new Set(a).size),e},[t,i,a]);return(0,r.jsx)(l.wn$,{treeProps:{checkable:!0,checkedKeys:q,onCheck:e=>{let t=Array.isArray(e)?e:e.checked,n=[],r=[],l=[],i=Object.values(z),a=(e,t)=>t.some(t=>t!==e&&t.startsWith("".concat(e,"."))),s=t.map(e=>e.toString());t.forEach(e=>{let t=e.toString();if(i.some(e=>e===t))return;let o=F.find(e=>e===t),c=Object.values(M.$).find(e=>e===t);o?n.push(o):c?r.push(c):a(t,s)||l.push(t)}),h(n.length>0?n:[]),g(l.length>0?l:[]),_(r.length>0?r:[])},treeData:P,expandedKeys:E,onExpand:e=>{T(e)}},onApply:()=>{n(f&&f.length>0?Array.from(new Set(f)):f),s(y&&y.length>0?Array.from(new Set(y)):y),o(m&&m.length>0?Array.from(new Set(m)):m)},onReset:()=>{c(),h(G([...F])),_([]),g([])},onClear:()=>{h([]),_([]),g([])},onOpenChange:e=>{if(e){b();return}h(t),_(a),g(i)},activeFiltersCount:Y})};var V=n(9110);let K=e=>{switch(e){case 1:return E.D$.DATABASE;case 2:return E.D$.SCHEMA;case 3:return E.D$.TABLE;default:return E.D$.FIELD}},Z=e=>{if(!e||"string"!=typeof e)return[];let t=e.trim();if(!t)return[];let n=t.split(".");if(n.length<2)return[];let r=n.filter(e=>e&&e.trim().length>0);return r.length<2?[]:(r.shift(),r.length>0&&r.pop(),0===r.length)?[]:r.map((e,t)=>{let n=$[K(t+1)];return{title:e.trim(),IconComponent:n}})};var Q=n(79283),X=n(34929),ee=e=>{let{onSelectDataCategory:t,urn:n,...i}=e,{getDataCategoryDisplayNameProps:a,getDataCategories:s}=(0,X.Z)(),o=s().filter(e=>e.active),[c,d]=(0,u.useState)(!1),p=o.map(e=>{let{name:t,primaryName:n}=a(e.fides_key);return{value:e.fides_key,label:(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:n||t}),n&&": ".concat(t)]}),name:t,primaryName:n,description:e.description||""}});return(0,r.jsx)(Q.l,{options:p,prefix:(0,r.jsx)(l.wpx,{"aria-label":"Add Data Category",type:"text",size:"small",icon:(0,r.jsx)(l.PJP.mm_,{}),disabled:i.disabled}),placeholder:"",suffixIcon:null,classNames:{root:"w-full max-w-full overflow-hidden p-0 cursor-pointer -ml-5"},style:{"--ant-select-multiple-selector-bg-disabled":"transparent"},variant:"borderless",autoFocus:!1,maxTagCount:"responsive",open:c,onOpenChange:e=>d(e),onSelect:e=>{t(e),d(!1)},"data-classification-select":n,popupMatchSelectWidth:600,...i})},et=n(97947),en=n.n(et),er=n(63537);let el=e=>{let{label:t,closable:n,onClose:i,isFromClassifier:a}=e;return(0,r.jsx)(l.j8w,{color:"white",bordered:!0,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},closable:n,onClose:i,style:{marginInlineEnd:"calc((var(--ant-padding-xs) * 0.5))"},icon:a&&(0,r.jsx)(l.QMR,{}),children:(0,r.jsx)(l.lKn,{size:"sm",children:t})})},ei=e=>{let{title:t,IconComponent:n}=e;return{title:n?(0,r.jsxs)(l.jqI,{gap:3,align:"center",children:[(0,r.jsx)(n,{}),(0,r.jsx)("span",{children:t})]}):t}};var ea=e=>{let{urn:t,name:n,diff_status:i,selected:a,onSelect:o,onSetDataCategories:c,dataCategoriesDisabled:d,onNavigate:u,actions:p,classifications:f,...h}=e,y="preferred_data_categories"in h?h.preferred_data_categories:[],g=s()(null==f?void 0:f.flatMap(e=>{let{confidence_bucket:t}=e,n=t?(0,er.Oq)(t):void 0;return n?[n]:[]})).thru(er.io).value();return(0,r.jsx)(l.krs.Item,{actions:[g&&(0,r.jsx)(V.D,{severity:g,className:"mr-2"}),...null!=p?p:[]],children:(0,r.jsx)(l.krs.Item.Meta,{avatar:(0,r.jsx)("div",{className:"ml-2",children:(0,r.jsx)(l.E_O,{checked:a,onChange:e=>o&&o(t,e.target.checked)})}),title:(0,r.jsxs)(l.jqI,{gap:12,align:"center",className:en()["monitor-field__title"],children:[(0,r.jsx)(l.wpx,{type:"text",size:"small",className:"-mx-2",onClick:()=>u&&u(t),children:n}),i&&i!==E.LL.ADDITION&&(0,r.jsx)(l.j8w,{bordered:!1,color:Y[i].color,children:Y[i].label}),(0,r.jsx)(l.esZ,{title:t,mouseEnterDelay:.5,children:(0,r.jsx)(l.zrq,{className:en()["monitor-field__breadcrumb"],items:Z(t).map(ei),role:"presentation",style:{overflow:"hidden"}})})]}),description:(0,r.jsx)(ee,{mode:"multiple",value:null!=y?y:[],urn:t,tagRender:e=>{let n=!!(null==f?void 0:f.find(t=>t.label===e.value));return el({...e,isFromClassifier:n,onClose:()=>{var n;c(t,null!==(n=null==y?void 0:y.filter(t=>t!==e.value))&&void 0!==n?n:[])}})},onSelectDataCategory:e=>{(null==y?void 0:y.includes(e))||c(t,[...null!=y?y:[],e])},disabled:d})})},t)},es=n(812),eo=n(32500),ec=n.n(eo);let ed=(e,t)=>e.find(e=>{let{children:n}=e;return n&&!!n.find(e=>e.key.toString()===t)}),eu=(e,t)=>{var n;return null!==(n=ed(e,t))&&void 0!==n?n:e.reduce((e,n)=>{if(n.children){var r;return null!==(r=ed(n.children,t))&&void 0!==r?r:eu(n.children,t)}return e},null)},ep=e=>{let{node:t,treeData:n,onLoadMore:i,actions:a}=e;if(!t.title)return null;if(t.key.toString().startsWith(U)){let e=eu(n,t.key.toString());return(0,r.jsx)(l.wpx,{type:"link",block:!0,onClick:()=>{(null==e?void 0:e.key)&&i(e.key.toString())},className:"p-0",children:t.title})}if(t.key.toString().startsWith(P))return(0,r.jsx)(l.N_L,{paragraph:!1,title:{width:"80px"},active:!0,children:t.title});let s=t.diffStatus===E.LL.MUTED;return(0,r.jsxs)(l.jqI,{gap:4,align:"center",className:"group ml-1 flex grow ".concat(s?"opacity-40":""),"aria-label":s?"".concat(t.title," (ignored)"):void 0,children:[(0,r.jsx)(l.lKn,{ellipsis:{tooltip:t.title},className:"grow select-none",children:t.title}),(0,r.jsx)(l.S0p,{menu:{items:a?Object.entries(a).map(e=>{let[n,{disabled:r,...l}]=e;return{key:n,disabled:r([t]),...l}}):[],onClick:e=>{var n;let{key:r,domEvent:l}=e;l.preventDefault(),l.stopPropagation(),null===(n=a[r])||void 0===n||n.callback([t.key],[t])}},destroyOnHidden:!0,className:"group mr-1 flex-none group-[.multi-select]/monitor-tree:pointer-events-none group-[.multi-select]/monitor-tree:opacity-0",children:(0,r.jsx)(l.wpx,{"aria-label":"Show More Resource Actions",icon:(0,r.jsx)(l.PJP.r43,{className:"opacity-0 group-hover:opacity-100 group-[.ant-dropdown-open]:opacity-100"}),type:"text",size:"small",className:"self-end"})})]})},ef=(e,t,n,r)=>e.map(e=>e.key===t?{...e,status:n,diffStatus:r}:e.children?{...e,children:ef(e.children,t,n,r)}:e),eh=(e,t)=>e.map(e=>{if(e.key===t){let{children:t,...n}=e;return n}return e.children?{...e,children:eh(e.children,t)}:e}),ey=e=>{let t=[];return e.children&&e.children.length>0&&e.children.forEach(e=>{"string"==typeof e.key&&(t.push(e.key),t.push(...ey(e)))}),t},eg=(e,t)=>{for(let n of e){if(n.key===t)return n;if(n.children){let e=eg(n.children,t);if(e)return e}}},em=e=>!!e.update_status&&e.diff_status!==E.LL.MUTED,e_=(e,t)=>{var n;let i=e.items.map(e=>{let t=e.resource_type?$[e.resource_type]:void 0,n=e.update_status?H[e.update_status]:void 0;return{title:e.name,key:e.urn,selectable:!0,icon:t?()=>(0,r.jsx)(l.esZ,{title:null==n?void 0:n.tooltip,children:(0,r.jsx)(l.y4X,{className:"h-full",offset:[0,5],color:null==n?void 0:n.color,dot:em(e),children:(0,r.jsx)(t,{className:"h-full"})})}):void 0,status:e.update_status,diffStatus:e.diff_status,isLeaf:e.resource_type===E.D$.FIELD||!e.has_grandchildren,classifyable:[E.D$.SCHEMA,E.D$.TABLE,E.D$.ENDPOINT,E.D$.FIELD].includes(e.resource_type)}});return(null!==(n=null==i?void 0:i.length)&&void 0!==n?n:0)<100?i:[...i,{title:"Load more...",key:"".concat(U,"-").concat(e.page,"-").concat(t),selectable:!1,isLeaf:!0}]},ev=(e,t,n)=>e.map(e=>{if(e.key===t){var r,l;return{...e,children:[...null!==(l=null===(r=e.children)||void 0===r?void 0:r.filter(e=>!(e.key.toString().startsWith(U)||e.key.toString().startsWith(P))))&&void 0!==l?l:[],...n]}}return e.children?{...e,children:ev(e.children,t,n)}:e}),eE=(e,t,n)=>e.map(e=>e.key===t?{...e,children:n}:e.children?{...e,children:eE(e.children,t,n)}:e),eT=(e,t,n)=>e.map(e=>{if(e.key===t){var r;let t=(null!==(r=e.children)&&void 0!==r?r:[]).filter(e=>!(e.key.toString().startsWith(U)||e.key.toString().startsWith(P))),l=new Map(n.map(e=>[e.key,e])),i=new Map(t.map(e=>[e.key,e])),a=t.map(e=>{let t=l.get(e.key);return null!=t?t:e});return n.forEach(e=>{i.has(e.key)||a.push(e)}),{...e,children:a}}return e.children?{...e,children:eT(e.children,t,n)}:e}),ex=(0,u.forwardRef)((e,t)=>{let{setSelectedNodeKeys:n,selectedNodeKeys:i,nodeActions:a,primaryAction:s}=e,o=(0,d.useRouter)(),{errorAlert:c}=(0,y.VY)(),p=decodeURIComponent(o.query.monitorId),[f]=(0,v.RV)(),[h]=(0,v.M8)(),[g,m]=(0,u.useState)({}),[_,E]=(0,u.useState)([]),[T,x]=(0,u.useState)([]),A=(0,u.useRef)({}),S=(0,u.useRef)({}),b=(0,u.useCallback)(async e=>{var t;let{nodeKey:n,queryParams:r,fastUpdateFn:l,detailedUpdateFn:i}=e,a=(null!==(t=A.current[n])&&void 0!==t?t:0)+1;A.current[n]=a;let s=f({...r,include_descendant_details:!1}),o=f({...r,include_descendant_details:!0});s.then(e=>{let{data:t}=e;t&&A.current[n]===a&&S.current[n]!==a&&l(t)}),o.then(e=>{let{data:t}=e;t&&A.current[n]===a&&(S.current[n]=a,(null!=i?i:l)(t))})},[f]),j=(0,u.useCallback)(e=>new Promise(t=>{let{children:n,key:r}=e;if(n){t();return}let l=r.toString();b({nodeKey:l,queryParams:{monitor_config_id:p,staged_resource_urn:l,size:100},fastUpdateFn:e=>{E(t=>eE(t,r,e_(e,l))),m(e=>({...e,[l]:{pageSize:100,pageIndex:1}}))}}),t()}),[b,p]),k=(0,u.useCallback)(e=>{let t=g[e];t&&(E(t=>ev(t,e,[...Array(100)].map((t,n)=>({key:"".concat(P,"-").concat(e,"-").concat(n),title:"SKELETON",isLeaf:!0})))),b({nodeKey:e,queryParams:{monitor_config_id:p,staged_resource_urn:e,size:100,page:t.pageIndex+1},fastUpdateFn:t=>{E(n=>ev(n,e,e_(t,e)))},detailedUpdateFn:t=>{E(n=>eT(n,e,e_(t,e))),m(t=>{var n,r;return{...t,[e]:{pageSize:100,pageIndex:(null!==(r=null===(n=t[e])||void 0===n?void 0:n.pageIndex)&&void 0!==r?r:0)+1}}})}}))},[g,b,p]),D=(0,u.useCallback)(e=>{E(t=>{let n=eg(t,e),r=[e];return n&&r.push(...ey(n)),x(e=>e.filter(e=>!r.includes(e.toString()))),m(e=>{let t={...e};return r.forEach(e=>{delete t[e]}),t}),r.forEach(e=>{delete A.current[e],delete S.current[e]}),eh(t,e)})},[]),R=(0,u.useCallback)(async e=>{let t=async e=>{try{let t=await h({monitor_config_id:p,...e&&{staged_resource_urn:e}});if(t.error){c((0,es.e$)(t.error),"Failed to get schema explorer ancestors statuses");return}let n=t.data;if(!n)return;e?D(e):n.forEach(e=>{D(e.urn)}),E(e=>n.reduce((e,t)=>ef(e,t.urn,t.update_status,t.diff_status),e))}catch(e){c("An unexpected error occurred while refreshing the schema explorer")}};if(0===e.length){await t();return}await Promise.all(e.map(e=>t(e)))},[h,p,D,c]),I=(0,u.useCallback)((e,t)=>{x(e),t.expanded&&!t.node.children&&j&&j(t.node)},[j]);return(0,u.useImperativeHandle)(t,()=>({refreshResourcesAndAncestors:R})),(0,u.useEffect)(()=>{(async()=>{_.length>0||b({nodeKey:"root",queryParams:{monitor_config_id:p,size:100},fastUpdateFn:e=>{E(e_(e))}})})()},[b,p,E,_.length]),(0,r.jsxs)(l.jqI,{gap:"middle",vertical:!0,className:"h-full",children:[(0,r.jsx)(l.lQT,{level:3,className:"sticky top-0",ellipsis:!0,children:"Schema explorer"}),(0,r.jsx)(l.a$q.DirectoryTree,{loadData:j,treeData:_,expandedKeys:T,onExpand:I,onSelect:e=>{n(e)},showIcon:!0,showLine:!0,blockNode:!0,multiple:!0,rootClassName:"h-full overflow-x-hidden ".concat(ec()["monitor-tree"]," group/monitor-tree ").concat(i.length>1?"multi-select":""),expandAction:"doubleClick",titleRender:e=>(0,r.jsx)(ep,{node:e,treeData:_,onLoadMore:k,actions:a})}),i.length>0&&(0,r.jsxs)(l.jqI,{justify:"space-between",align:"center",gap:"small",children:[(0,r.jsx)(l.wpx,{"aria-label":"Classify ".concat(i.length," Selected Nodes"),icon:(0,r.jsx)(l.QMR,{size:12}),size:"small",onClick:()=>{var e;return null===(e=a[s])||void 0===e?void 0:e.callback(i,i.flatMap(e=>{let t=eg(_,e.toString());return t?[t]:[]}))},className:"flex-none"}),(0,r.jsx)(l.lKn,{ellipsis:!0,children:"".concat(i.length," ").concat((0,C._6)(i.length,"resource","resources")," selected")}),(0,r.jsx)(l.S0p,{menu:{items:a?Object.entries(a).map(e=>{let[t,{label:n,disabled:r}]=e;return{key:t,label:n,disabled:r(i.flatMap(e=>{let t=eg(_,e.toString());return t?[t]:[]}))}}):[],onClick:e=>{var t;let{key:n,domEvent:r}=e;r.preventDefault(),r.stopPropagation(),null===(t=a[n])||void 0===t||t.callback(i,i.flatMap(e=>{let t=eg(_,e.toString());return t?[t]:[]}))}},destroyOnHidden:!0,className:"group mr-1 flex-none",children:(0,r.jsx)(l.wpx,{"aria-label":"Show More Resource Actions",icon:(0,r.jsx)(l.PJP.r43,{}),size:"small",className:"self-end"})})]})]})});ex.displayName="MonitorTree";var eA=n(12627),eS=n(84418);let eb=(e,t)=>(0,r.jsx)(t,{...e,className:"!sticky top-0 z-[2] bg-white"}),ej=e=>{var t;let{resource:n,fieldActions:i,...a}=e,s=(0,u.useMemo)(()=>{var e;if(!(null==n?void 0:n.classifications))return[];let t="preferred_data_categories"in n&&null!==(e=n.preferred_data_categories)&&void 0!==e?e:[];return n.classifications.filter(e=>t.includes(e.label))},[n]);return(0,r.jsx)(eS.d,{...a,classNames:{body:"!pt-0 !mt-[var(--ant-padding-lg)] max-h-full"},children:n?(0,r.jsx)(l.A5g,{defaultActiveKey:"details",renderTabBar:eb,items:[{key:"details",label:"Details",children:(0,r.jsxs)(l.jqI,{gap:"middle",vertical:!0,children:[(0,r.jsx)(l.Yfl,{bordered:!0,size:"small",column:1,items:[..."system_key"in n&&n.system_key?[{key:"system",label:"System",children:n.system_key}]:[],{key:"path",label:"Path",children:n.urn},{key:"data-type",label:"Data type",children:"source_data_type"in n?n.source_data_type:void 0},{key:"description",label:"Description",children:n.description}]}),(0,r.jsx)(l.PPS,{layout:"vertical",children:(0,r.jsx)(l.PPS.Item,{label:"Data categories",children:(0,r.jsx)(eA.Z,{variant:"outlined",mode:"multiple",maxTagCount:"responsive",value:"preferred_data_categories"in n?n.preferred_data_categories:[],autoFocus:!1,disabled:null==n||!n.diff_status||!x.$k["assign-categories"].some(e=>e===n.diff_status),onChange:e=>i["assign-categories"]([n.urn],!0,{user_assigned_data_categories:e})})})}),s.length>0&&(0,r.jsx)(l.krs,{"data-testid":"classifications-reasoning-list",dataSource:s,renderItem:e=>{let t=e.confidence_bucket?(0,er.Oq)(e.confidence_bucket):void 0;return(0,r.jsx)(l.krs.Item,{children:(0,r.jsx)(l.krs.Item.Meta,{avatar:(0,r.jsx)(l.t3Z,{icon:(0,r.jsx)(l.QMR,{color:"black"})}),title:(0,r.jsxs)(l.jqI,{align:"center",gap:"middle",children:[(0,r.jsx)("div",{children:e.label}),t&&(0,r.jsx)(V.D,{severity:t})]}),description:e.rationale})})}})]})},{key:"activity",label:"Activity",children:(0,r.jsx)(l.krs,{dataSource:"errors"in n&&n.errors?null===(t=n.errors)||void 0===t?void 0:t.map((e,t)=>({key:t,title:e.phase,description:new Date(e.timestamp).toLocaleString(),content:e.message})):[],renderItem:(e,t)=>(0,r.jsxs)(l.krs.Item,{children:[(0,r.jsx)(l.krs.Item.Meta,{title:e.title,description:e.description}),(0,r.jsx)(l.FUI,{ellipsis:{expandable:"collapsible",rows:3},copyable:{icon:(0,r.jsx)(l.PJP.CKM,{className:"pt-1",size:18})},children:e.content})]},t),itemLayout:"vertical"})}]}):null})};var ek=n(31883);let eD=(e,t)=>{let[n]=(0,k.rL)(),r=(0,l.UD8)(),i=(0,l.S37)(),a=l=>async(a,s,o)=>{let c=Date.now();if(!await i.confirm((0,er.nB)(x.Me[l],x.e_[l](o))))return;r.open({key:c,type:"loading",content:"".concat(x.T0[l]," ").concat(o," ").concat((0,C._6)(o,"resource","resources"),"..."),duration:0});let d=await n({query:{...a.query},path:{monitor_config_id:e,action_type:l},body:{excluded_resource_urns:s}});if((0,ek.D4)(d)){r.open({key:c,type:"error",content:(0,er.v_)(l),duration:5});return}if(r.open({key:c,type:"success",content:(0,er.NM)(l,o),duration:5}),t&&l!==T.FieldActionType.REVIEW){let e=a.query.staged_resource_urn||[];await t(e)}};return{"assign-categories":a(T.FieldActionType.ASSIGN_CATEGORIES),"promote-removals":a(T.FieldActionType.PROMOTE_REMOVALS),"un-review":a(T.FieldActionType.UN_REVIEW),"un-mute":a(T.FieldActionType.UN_MUTE),review:a(T.FieldActionType.REVIEW),classify:a(T.FieldActionType.CLASSIFY),mute:a(T.FieldActionType.MUTE),promote:a(T.FieldActionType.PROMOTE)}},eR={DRAWER_OPEN:".ant-drawer-open",DRAWER_SELECT:".ant-drawer-open .ant-select",SELECT:".ant-select",SELECT_SELECTOR:".ant-select-selector",SELECT_DISABLED:"ant-select-disabled",INPUT:"input",LIST_ITEM_SELECT:"[data-classification-select]"},eC=(e,t,n,r,i,a)=>{let s=(0,l.UD8)(),o=e=>{let t=e.querySelector(eR.SELECT_SELECTOR);if(!t)return!1;if(e.classList.contains(eR.SELECT_DISABLED))return s.warning("You cannot assign categories to this resource in its current state"),!1;let n=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(n);let r=e.querySelector(eR.INPUT);return r&&r.focus(),!0},c=n=>{var r;e&&(e.diff_status&&(null===(r=x.$k[n])||void 0===r?void 0:r.includes(e.diff_status))?t[n]([e.urn]):s.warning(x.Z8[n]))};(0,p.y1)(x.b_.REVIEW,()=>c(T.FieldActionType.REVIEW),[e,t]),(0,p.y1)(x.b_.PROMOTE,()=>c(T.FieldActionType.PROMOTE),[e,t]),(0,p.y1)(x.b_.MUTE,()=>c(T.FieldActionType.MUTE),[e,t]),(0,p.y1)(x.b_.UN_MUTE,()=>c(T.FieldActionType.UN_MUTE),[e,t]),(0,p.y1)(x.b_.REFRESH,()=>a(),[a]),(0,p.y1)(x.b_.TOGGLE_DRAWER,()=>{e&&i?r(void 0):e&&!i&&r(e.urn)},[e,r,i]),(0,p.y1)(x.b_.OPEN_CLASSIFICATION_SELECT,t=>{if(t.preventDefault(),!e)return;let n=null;if(i){let e=document.querySelector(eR.DRAWER_OPEN);e&&(n=e.querySelector(eR.SELECT))}else{let t=CSS.escape(e.urn);n=document.querySelector('[data-classification-select="'.concat(t,'"]'))}n&&o(n)},[e,s,i]),(0,p.y1)("escape",e=>{let t=document.activeElement;if((null==t?void 0:t.tagName)!=="INPUT")return;let n=t.closest(eR.LIST_ITEM_SELECT),r=t.closest(eR.DRAWER_SELECT);(n||r)&&(e.preventDefault(),e.stopPropagation(),t.blur())},{enableOnFormTags:["INPUT"]},[i])};var eI=n(70675);let ew=e=>{let[t,...n]=e.map(e=>Object.values(T.FieldActionType).flatMap(t=>x.$k[t].some(t=>t===e)?[t]:[]));return n.reduce((e,t)=>s().intersection(e,[...t]),null!=t?t:[])},eO=(e,t)=>{let[n]=(0,eI.qb)(),[r]=(0,v.Av)(),[i]=(0,eI.zV)(),[a]=(0,eI.Hf)(),[s]=(0,eI._J)(),[o]=(0,eI.NA)(),[c]=(0,v.n7)(),d=(0,l.UD8)(),u=(0,l.S37)(),p=(e,n)=>async function(r){let l=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2?arguments[2]:void 0,a=Date.now();if(!(1===r.length&&l||await u.confirm((0,er.nB)(x.Me[e],x.e_[e](r.length)))))return;d.open({key:a,type:"loading",content:"".concat(x.T0[e]," ").concat(r.length," ").concat((0,C._6)(r.length,"resource","resources"),"..."),duration:0});let s=await n(r,i);if((0,ek.D4)(s)){d.open({key:a,type:"error",content:(0,er.v_)(e),duration:5});return}d.open({key:a,type:"success",content:(0,er.NM)(e,r.length),duration:5}),e!==T.FieldActionType.PROMOTE_REMOVALS&&t&&await t(r)},f=async e=>i({staged_resource_urns:e}),h=async e=>s({staged_resource_urns:e}),y=async e=>a({staged_resource_urns:e}),g=async t=>r({monitor_config_key:e,staged_resource_urns:t}),m=async(t,n)=>{var r;let[l]=t;return o({monitor_config_id:e,staged_resource_urn:l,user_assigned_data_categories:null!==(r=null==n?void 0:n.user_assigned_data_categories)&&void 0!==r?r:void 0})},_=async t=>n({monitor_config_key:e,staged_resource_urns:t}),E=async t=>c({monitor_config_key:e,staged_resource_urns:t});return{"assign-categories":p(T.FieldActionType.ASSIGN_CATEGORIES,m),"promote-removals":p(T.FieldActionType.PROMOTE_REMOVALS,E),"un-review":()=>{},"un-mute":p(T.FieldActionType.UN_MUTE,h),review:p(T.FieldActionType.REVIEW,_),classify:p(T.FieldActionType.CLASSIFY,g),mute:p(T.FieldActionType.MUTE,f),promote:p(T.FieldActionType.PROMOTE,y)}};var eM=n(40431);let eL=()=>{let[e,t]=(0,eM.v1)("resourceStatus",(0,eM.S$)((0,eM.km)(F))),[n,r]=(0,eM.v1)("confidenceBucket",(0,eM.S$)((0,eM.jx)(Object.values(M.$)))),[l,i]=(0,eM.v1)("dataCategory",(0,eM.S$)(eM.Oi));return(0,u.useEffect)(()=>{if(null===e){let e=G([...F]);t(e.length>0?e:[])}},[]),{resourceStatus:e,setResourceStatus:t,confidenceBucket:n,setConfidenceBucket:r,dataCategory:l,setDataCategory:i,reset:()=>{t([]),r([]),i([])},resetToInitialState:()=>{t(G([...F])),r(null),i(null)}}},eN=e=>new Map(e.map(e=>[e.key,e])),eU=(e,t)=>s()([...new Map([...e,...t]).entries()]).map(t=>{let[n,r]=t;return s().chain(e.get(n)).defaultTo(r).cloneDeep().merge(r).value()}).thru(eN).value();var eP=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[t,n]=(0,u.useState)(new Map);return{nodes:t,update:r=>{let l=e?eU(t,r):r;s()([...l.entries()]).some(e=>{let[n,r]=e;return!s().isEqual(t.get(n),r)})&&n(e=>new Map([...e,...r]))},reset:()=>{n(new Map)}}},eF=(e,t)=>{var n,r;let l=(0,k.Fp)(e),i=(0,v.IC)(t,{skip:!t.stagedResourceUrn}),{update:a,nodes:o,reset:c}=eP();return(null===(n=l.data)||void 0===n?void 0:n.items)&&a(eN(l.data.items.map(e=>({key:e.urn,...e})))),{listQuery:{...l,nodes:s().chain(null===(r=l.data)||void 0===r?void 0:r.items).defaultTo([]).flatMap(e=>s().chain(o.get(e.urn)).thru(e=>e?[e]:[]).value()).thru(eN).value(),refetch:()=>{c(),l.refetch()}},detailsQuery:{...i,node:t.stagedResourceUrn?o.get(t.stagedResourceUrn):void 0,refetch:()=>{c(),i.refetch()}},nodes:o}};let eq=e=>Object.values(E.LL).flatMap(t=>Y[t].label===e?[t]:[]);var eG=()=>{var e,t,n,i,a,o,A,S;let D=(0,d.useRouter)(),R=decodeURIComponent(D.query.monitorId),C=(0,u.useRef)(null),[I,w]=(0,u.useState)(!1),{paginationProps:O,pageIndex:M,pageSize:L,resetPagination:N}=(0,_.S)({defaultPageSize:25}),U=(0,y.Rx)(),{resourceStatus:P,confidenceBucket:F,dataCategory:G,...$}=eL(),{data:z}=(0,v.vc)({monitor_config_id:R}),[H,W]=(0,u.useState)([]),J={path:{monitor_config_id:R},query:{staged_resource_urn:H.map(e=>e.toString()),search:U.searchProps.value,diff_status:P?P.flatMap(eq):void 0,confidence_bucket:F||void 0,data_category:G||void 0}},[V,K]=(0,u.useState)(),[Z,Q]=(0,u.useState)(),[X,ee]=(0,u.useState)(null),[et,{data:en,isFetching:er}]=(0,k.Nz)(),el=eD(R,async e=>{var t;await (null===(t=C.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),ei=eO(R,async e=>{var t;await (null===(t=C.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),{listQuery:{nodes:es,...eo},detailsQuery:{data:ec},nodes:ed}=eF({...J,query:{...J.query,size:L,page:M}},{stagedResourceUrn:V}),{excludedKeys:eu,listSelectMode:ep,resetListSelect:ef,selectedKeys:eh,updateSelectedListItem:ey,checkboxProps:eg}=b(Array.from(es.keys()),{activeListItem:Z?{...Z,key:null==Z?void 0:Z.key.toString()}:void 0,enableKeyboardShortcuts:!0}),em=async e=>{if((null==Z?void 0:Z.urn)&&e&&X){let t=[...es.values()].findIndex(t=>t.urn===e);-1!==t&&X(t)}K(e)};(0,p.y1)("?",()=>w(!I),{useKey:!0},[I]);let e_="exclusive"===ep?null==en?void 0:en.allowed_actions:ew(eh.flatMap(e=>{let t=ed.get(e);return(null==t?void 0:t.diff_status)?[t.diff_status]:[]})),ev=null!==(o=null===(e=eo.data)||void 0===e?void 0:e.total)&&void 0!==o?o:0,eE="exclusive"===ep&&(null===(t=eo.data)||void 0===t?void 0:t.total)?ev-eu.length:eh.length;return(0,u.useEffect)(()=>{N(),ef()},[P,F,H,U.searchQuery,G]),eC(Z,ei,ey,em,!!V,()=>eo.refetch()),(0,r.jsxs)(h.Z,{title:"Action center - Discovered assets by system",mainProps:{overflow:"hidden"},fullHeight:!0,children:[(0,r.jsx)(m.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:g.vi},{title:R}],isSticky:!1}),(0,r.jsxs)(l.LgQ,{className:"h-[calc(100%-48px)] overflow-hidden",children:[(0,r.jsx)(l.LgQ.Panel,{defaultSize:250,style:{paddingRight:"var(--ant-padding-md)"},children:(0,r.jsx)(ex,{ref:C,setSelectedNodeKeys:W,selectedNodeKeys:H,primaryAction:T.FieldActionType.CLASSIFY,nodeActions:Object.fromEntries(x.km.map(e=>[e,{label:x.Me[e],disabled:t=>s()(t).map(t=>(e!==T.FieldActionType.PROMOTE_REMOVALS||t.status!==E.Ag.REMOVAL)&&(e!==T.FieldActionType.CLASSIFY||!t.classifyable||t.diffStatus===E.LL.MUTED)&&(e!==T.FieldActionType.MUTE||t.diffStatus===E.LL.MUTED)&&(e!==T.FieldActionType.UN_MUTE||t.diffStatus!==E.LL.MUTED)).some(e=>!0===e),callback:t=>{ei[e](t,!1)}}]))})}),(0,r.jsx)(l.LgQ.Panel,{style:{paddingLeft:"var(--ant-padding-md)"},children:(0,r.jsxs)(l.jqI,{vertical:!0,gap:"middle",className:"h-full",children:[(0,r.jsxs)(l.jqI,{justify:"space-between",children:[(0,r.jsx)(l.lQT,{level:2,ellipsis:!0,children:"Monitor results"}),(0,r.jsx)(l.jqI,{align:"center",children:(null==z?void 0:z.last_monitored)&&(0,r.jsxs)(l.lKn,{type:"secondary",children:["Last scan:"," ",new Date(null==z?void 0:z.last_monitored).toLocaleString()]})})]}),(0,r.jsxs)(l.jqI,{justify:"space-between",wrap:"wrap",gap:"small",children:[(0,r.jsxs)(l.jqI,{gap:"small",children:[(0,r.jsx)(f.f,{value:U.searchQuery,onChange:U.updateSearch,placeholder:"Search"}),(0,r.jsx)(l.esZ,{title:"Display keyboard shortcuts",children:(0,r.jsx)(l.wpx,{"aria-label":"Display keyboard shortcuts",icon:(0,r.jsx)(l.PJP.N1d,{}),onClick:()=>w(!0)})})]}),(0,r.jsxs)(l.jqI,{gap:"small",children:[(0,r.jsx)(B,{resourceStatus:P,confidenceBucket:F,dataCategory:G,...$,monitorId:R,stagedResourceUrn:H.map(e=>e.toString())}),(0,r.jsx)(l.S0p,{onOpenChange:e=>{e&&"exclusive"===ep&&et({...J,query:{...J.query},body:{excluded_resource_urns:eu.map(e=>e.toString())}})},menu:{items:[...x.aK.map(e=>({key:e,label:!er&&(null==e_?void 0:e_.includes(e))?x.Me[e]:(0,r.jsx)(l.esZ,{title:x.Z8[e],children:x.Me[e]}),disabled:er||!(null==e_?void 0:e_.includes(e)),onClick:async()=>{"exclusive"===ep?await el[e](J,eu.map(e=>e.toString()),eE):await ei[e](eh.map(e=>e.toString())),ef()}}))]},disabled:eh.length<=0,children:(0,r.jsx)(l.wpx,{type:"primary",icon:(0,r.jsx)(l.PJP._ME,{}),iconPosition:"end",loading:er,children:"Actions"})}),(0,r.jsx)(l.esZ,{title:"Refresh",children:(0,r.jsx)(l.wpx,{icon:(0,r.jsx)(l.PJP.CQM,{}),onClick:()=>eo.refetch(),"aria-label":"Refresh"})})]})]}),(0,r.jsxs)(l.jqI,{gap:"middle",align:"center",children:[(0,r.jsx)(l.E_O,{id:"select-all",...eg}),(0,r.jsx)("label",{htmlFor:"select-all",children:"Select all"}),!!eE&&(0,r.jsxs)(l.lKn,{strong:!0,children:[eE.toLocaleString()," selected"]})]}),(0,r.jsx)(l.krs,{dataSource:[...es.values()],className:"-ml-3 h-full overflow-y-scroll pl-1",loading:eo.isFetching,enableKeyboardShortcuts:!0,locale:!U.searchProps.value&&s()(P).intersection(q).isEmpty()?{emptyText:(0,r.jsx)(l.oj8,{image:l.oj8.PRESENTED_IMAGE_SIMPLE,description:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:"All resources have been approved."}),(0,r.jsx)("div",{children:"You'll now find this data in Managed Datasets\n                                view."}),(0,r.jsx)("div",{children:"To see approved or ignored resources, adjust\n                                your filters"})]}),children:(0,r.jsxs)(l.jqI,{gap:"middle",justify:"center",children:[(0,r.jsx)(c(),{href:g.$m,passHref:!0,legacyBehavior:!0,children:(0,r.jsx)(l.wpx,{children:"Manage datasets view"})}),(0,r.jsx)(l.wpx,{type:"primary","aria-label":"Refresh page",onClick:()=>{$.resetToInitialState(),D.reload()},children:"Refresh page"})]})})}:void 0,onActiveItemChange:(e,t,n)=>{ee(()=>n),(null==e?void 0:e.urn)?(Q({...e,key:e.urn}),V&&e.urn!==V&&K(e.urn)):Q(void 0)},renderItem:e=>ea({...e,selected:eh.includes(e.urn),onSelect:ey,onNavigate:em,onSetDataCategories:(e,t)=>ei["assign-categories"]([e],!0,{user_assigned_data_categories:t}),dataCategoriesDisabled:null==e||!e.diff_status||!x.$k["assign-categories"].some(t=>t===e.diff_status),actions:(null==e?void 0:e.diff_status)?x.Vr[e.diff_status].map(t=>(0,r.jsx)(l.esZ,{title:x.Me[t],children:(0,r.jsx)(l.wpx,{"aria-label":x.Me[t],icon:x.W3[t],onClick:()=>ei[t]([e.urn]),disabled:null==e||!e.diff_status||!x.$k[t].some(t=>t===e.diff_status),style:{fontSize:"var(--ant-button-content-font-size-lg)"}})},t)):[]})}),(0,r.jsx)(l.B7X,{...O,showSizeChanger:{suffixIcon:(0,r.jsx)(l.PJP._ME,{})},total:(null===(n=eo.data)||void 0===n?void 0:n.total)||0,hideOnSinglePage:(null===(i=O.pageSize)||void 0===i?void 0:i.toString())===(null===(a=O.pageSizeOptions)||void 0===a?void 0:a[0])})]})})]}),(0,r.jsx)(ej,{itemKey:null!==(A=null==ec?void 0:ec.urn)&&void 0!==A?A:"",title:null!==(S=null==ec?void 0:ec.name)&&void 0!==S?S:null,titleIcon:(0,r.jsx)(l.PJP.sgG,{}),titleTag:{bordered:!1,color:(null==ec?void 0:ec.diff_status)?Y[ec.diff_status].color:void 0,className:"font-normal text-[var(--ant-font-size-sm)]",children:(null==ec?void 0:ec.diff_status)?Y[ec.diff_status].label:null},actions:((null==ec?void 0:ec.diff_status)?x.Zu[ec.diff_status]:x.sB).map(e=>({label:x.Me[e],callback:t=>ei[e]([t]),disabled:null==ec||!ec.diff_status||!x.$k[e].some(e=>e===ec.diff_status)})),open:!!V,onClose:()=>K(void 0),resource:ec,fieldActions:ei,mask:!Z}),(0,r.jsx)(j,{open:I,onCancel:()=>w(!1)})]})};let eY=()=>(0,r.jsx)(r.Fragment,{children:"Attempting to access monitor results without the required feature flag enabled"});var e$=()=>{let{flags:e}=(0,i.hz)();return e.heliosV2?(0,r.jsx)(eG,{}):(0,r.jsx)(l.ux6,{status:"error",title:(0,r.jsx)(eY,{})})}},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},97947:function(e){e.exports={"monitor-field__title":"MonitorFieldListItem_monitor-field__title__YrxOU","monitor-field__breadcrumb":"MonitorFieldListItem_monitor-field__breadcrumb__Rn4vE"}},32500:function(e){e.exports={"monitor-tree":"MonitorTree_monitor-tree__QKz6T"}}},function(e){e.O(0,[431,7245,4589,8023,2888,9774,179],function(){return e(e.s=83806)}),_N_E=e.O()}]);