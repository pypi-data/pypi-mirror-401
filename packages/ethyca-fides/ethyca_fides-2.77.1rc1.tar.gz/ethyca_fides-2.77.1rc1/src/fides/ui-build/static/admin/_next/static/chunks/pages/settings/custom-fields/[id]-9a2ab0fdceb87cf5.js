(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[845],{56141:function(e,t,i){var s=i(32866);e.exports=function(e,t){return s(e,t)}},13910:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/custom-fields/[id]",function(){return i(63730)}])},34435:function(e,t,i){"use strict";var s=i(24246),n=i(49617),l=i(86677),r=i(812),a=i(77830),o=i(19904),d=i(8917),u=i(67522),c=i(66006),p=i(66236),m=i(32885),P=i(60240),x=i(31883);let _=()=>(0,s.jsxs)(n.N_L,{active:!0,children:[(0,s.jsx)(n.N_L.Input,{}),(0,s.jsx)(n.N_L.Input,{}),(0,s.jsx)(n.N_L.Input,{}),(0,s.jsx)(n.N_L.Input,{}),(0,s.jsx)(n.N_L.Button,{})]}),h=e=>d.uP.has(e)?d.uP.get(e):e.startsWith("taxonomy:")||e.startsWith("system:")?e:"taxonomy:".concat(e);t.Z=e=>{var t;let{initialField:i,isLoading:y}=e,[v]=n.PPS.useForm(),f=n.PPS.useWatch("value_type",v),j=n.PPS.useWatch("name",v),E=(0,l.useRouter)(),{resource_type:S}=E.query,g=(0,n.UD8)(),T=(0,n.S37)(),{createOrUpdate:L}=(0,u.Z)(),{data:b,isLoading:I}=(0,m.vA)(null==i?void 0:i.allow_list_id,{skip:!(null==i?void 0:i.allow_list_id)}),[C,{isLoading:w}]=(0,m.UF)(),{data:N,isLoading:U}=(0,m.Az)(),{valueTypeOptions:k}=(0,c.Z)(),F=(0,o.Tg)([P.Sh.CUSTOM_FIELD_DELETE])&&!!i,A=async()=>{if(!i)return;let{id:e,resource_type:t,field_type:s}=i,n=await C({id:e,resource_type:t,field_type:s});if((0,x.D4)(n)){g.error((0,r.e$)(n.error));return}g.success("Custom field deleted successfully"),E.push(a.WC)},q=async e=>{let t=await L(e,i,b);if(!t){g.error("An unexpected error occurred");return}if((0,x.D4)(t)){g.error((0,r.e$)(t.error));return}g.success("Custom field ".concat(i?"updated":"created"," successfully")),E.push(a.WC)},W=(e=>{var t;if(e)return{...e,value_type:e.field_type,field_type:(0,p._)(e),resource_type:h(e.resource_type),options:null!==(t=null==b?void 0:b.allowed_values)&&void 0!==t?t:[]}})(i),D=S?{...W,resource_type:"taxonomy:".concat(S)}:W;if(y||I||U)return(0,s.jsx)(_,{});let O=k.some(e=>e.value===f);return(0,s.jsxs)(n.PPS,{form:v,layout:"vertical",initialValues:D||{},validateTrigger:["onBlur","onChange"],onFinish:q,children:[(0,s.jsx)(n.PPS.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please enter a name"}],children:(0,s.jsx)(n.I6N,{options:k,onSelect:(e,t)=>{v.setFieldsValue({name:t.label,value_type:t.value})},disabled:O,"data-testid":"input-name-autocomplete",children:(0,s.jsx)(n.uFc,{"data-testid":"input-name",suffix:O?(0,s.jsx)(n.wpx,{size:"small",type:"text",icon:(0,s.jsx)(n.PJP.x8P,{}),onClick:()=>{v.setFieldsValue({name:void 0,value_type:void 0})}}):void 0})})}),(0,s.jsx)(n.PPS.Item,{label:"Type",name:"value_type",hidden:!0,children:(0,s.jsx)(n.WPr,{options:k,getPopupContainer:e=>e.parentElement||document.body,"data-testid":"select-value-type"})}),!!j&&!O&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.PPS.Item,{label:"Description",name:"description",children:(0,s.jsx)(n.uFc.TextArea,{rows:2,"data-testid":"input-description"})}),(0,s.jsx)(n.PPS.Item,{label:"Field type",name:"field_type",rules:[{required:!0,message:"Please select a field type"}],children:(0,s.jsx)(n.WPr,{options:d.TY,getPopupContainer:e=>e.parentElement||document.body,"data-testid":"select-field-type"})}),(0,s.jsx)(n.PPS.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.field_type!==t.field_type,children:e=>{let{getFieldValue:t}=e,i=t("field_type");return(i===d.Uv.SINGLE_SELECT||i===d.Uv.MULTIPLE_SELECT)&&(0,s.jsx)(n.PPS.List,{name:"options",rules:[{validator:async(e,t)=>!t||t.length<1?Promise.reject(Error("At least one option is required for selects")):Promise.resolve()}],children:(e,i,l)=>{let{add:r,remove:a}=i,{errors:o}=l;return(0,s.jsxs)(s.Fragment,{children:[e.map((i,l)=>(0,s.jsx)(n.PPS.Item,{required:!1,label:0===l?"Options":"","data-testid":"options-form-item",children:(0,s.jsxs)(n.jqI,{gap:"middle",children:[(0,s.jsx)(n.PPS.Item,{...i,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Options cannot be empty"},()=>({validator:(e,i)=>t("options").filter(e=>e===i).length>1?Promise.reject(Error("Option values must be unique")):Promise.resolve()})],noStyle:!0,children:(0,s.jsx)(n.uFc,{placeholder:"Enter option value","data-testid":"input-option-".concat(l)})}),e.length>1&&(0,s.jsx)(n.wpx,{icon:(0,s.jsx)(n.PJP.ZNm,{}),onClick:()=>a(i.name),"aria-label":"Remove option"})]})},i.key)),(0,s.jsx)(n.PPS.Item,{children:(0,s.jsx)(n.wpx,{type:"dashed",onClick:()=>r(),icon:(0,s.jsx)(n.PJP.mm_,{}),"data-testid":"add-option-btn",children:"Add select option"})}),(0,s.jsx)(n.PPS.ErrorList,{errors:o,className:"-mt-4 mb-4"})]})}})}})]}),(0,s.jsx)(n.PPS.Item,{label:"Applies to",name:"resource_type",rules:[{required:!0,message:"Please select a location"}],tooltip:"Choose where this field applies, including taxonomies",children:(0,s.jsx)(n.WPr,{options:null!==(t=null==N?void 0:N.map(e=>({label:e,value:e})))&&void 0!==t?t:[],getPopupContainer:e=>e.parentElement||document.body,disabled:!!i,"data-testid":"select-resource-type"})}),(0,s.jsxs)(n.jqI,{justify:"space-between",children:[F&&(0,s.jsx)(n.wpx,{danger:!0,onClick:()=>{var e;T.confirm({title:"Delete custom field?",content:(0,s.jsxs)(n.AntTypography.Paragraph,{children:["Are you sure you want to delete"," ",(0,s.jsx)("strong",{children:null!==(e=null==i?void 0:i.name)&&void 0!==e?e:"this custom field"}),"? This action cannot be undone."]}),onOk:A,okType:"primary",okText:"Delete",centered:!0})},loading:w,"data-testid":"delete-btn",children:"Delete"}),(0,s.jsx)(n.wpx,{type:"primary",htmlType:"submit","data-testid":"save-btn",children:"Save"})]})]})}},66236:function(e,t,i){"use strict";i.d(t,{S:function(){return r},_:function(){return l}});var s=i(20987),n=i(8917);let l=e=>e.field_type===s.H.STRING_ARRAY?n.Uv.MULTIPLE_SELECT:e.allow_list_id?n.Uv.SINGLE_SELECT:e.field_type===s.H.STRING?n.Uv.OPEN_TEXT:e.field_type,r=e=>{let t=l(e);return t===n.Uv.OPEN_TEXT||t===n.Uv.SINGLE_SELECT||t===n.Uv.MULTIPLE_SELECT?n.P3[t]:t}},63730:function(e,t,i){"use strict";i.r(t);var s=i(24246),n=i(86677),l=i(77213),r=i(77830),a=i(58754),o=i(34435),d=i(32885);t.default=()=>{var e;let{id:t}=(0,n.useRouter)().query,{data:i,isLoading:u}=(0,d.s0)({id:t});return(0,s.jsxs)(l.Z,{title:"Edit custom field",mainProps:{maxWidth:"720px"},children:[(0,s.jsx)(a.Z,{heading:"Custom fields",breadcrumbItems:[{title:"All custom fields",href:r.WC},{title:null!==(e=null==i?void 0:i.name)&&void 0!==e?e:t}]}),(0,s.jsx)(o.Z,{initialField:i,isLoading:u})]})}}},function(e){e.O(0,[590,2888,9774,179],function(){return e(e.s=13910)}),_N_E=e.O()}]);