(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9914],{56141:function(e,t,s){var i=s(32866);e.exports=function(e,t){return i(e,t)}},92973:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/custom-fields/new",function(){return s(85127)}])},34435:function(e,t,s){"use strict";var i=s(24246),n=s(49617),l=s(86677),r=s(812),a=s(77830),o=s(19904),d=s(8917),u=s(67522),c=s(66006),p=s(66236),m=s(32885),P=s(60240),x=s(31883);let _=()=>(0,i.jsxs)(n.N_L,{active:!0,children:[(0,i.jsx)(n.N_L.Input,{}),(0,i.jsx)(n.N_L.Input,{}),(0,i.jsx)(n.N_L.Input,{}),(0,i.jsx)(n.N_L.Input,{}),(0,i.jsx)(n.N_L.Button,{})]}),h=e=>d.uP.has(e)?d.uP.get(e):e.startsWith("taxonomy:")||e.startsWith("system:")?e:"taxonomy:".concat(e);t.Z=e=>{var t;let{initialField:s,isLoading:y}=e,[f]=n.PPS.useForm(),v=n.PPS.useWatch("value_type",f),j=n.PPS.useWatch("name",f),E=(0,l.useRouter)(),{resource_type:S}=E.query,g=(0,n.UD8)(),T=(0,n.S37)(),{createOrUpdate:L}=(0,u.Z)(),{data:b,isLoading:C}=(0,m.vA)(null==s?void 0:s.allow_list_id,{skip:!(null==s?void 0:s.allow_list_id)}),[I,{isLoading:w}]=(0,m.UF)(),{data:N,isLoading:U}=(0,m.Az)(),{valueTypeOptions:k}=(0,c.Z)(),A=(0,o.Tg)([P.Sh.CUSTOM_FIELD_DELETE])&&!!s,F=async()=>{if(!s)return;let{id:e,resource_type:t,field_type:i}=s,n=await I({id:e,resource_type:t,field_type:i});if((0,x.D4)(n)){g.error((0,r.e$)(n.error));return}g.success("Custom field deleted successfully"),E.push(a.WC)},W=async e=>{let t=await L(e,s,b);if(!t){g.error("An unexpected error occurred");return}if((0,x.D4)(t)){g.error((0,r.e$)(t.error));return}g.success("Custom field ".concat(s?"updated":"created"," successfully")),E.push(a.WC)},q=(e=>{var t;if(e)return{...e,value_type:e.field_type,field_type:(0,p._)(e),resource_type:h(e.resource_type),options:null!==(t=null==b?void 0:b.allowed_values)&&void 0!==t?t:[]}})(s),D=S?{...q,resource_type:"taxonomy:".concat(S)}:q;if(y||C||U)return(0,i.jsx)(_,{});let O=k.some(e=>e.value===v);return(0,i.jsxs)(n.PPS,{form:f,layout:"vertical",initialValues:D||{},validateTrigger:["onBlur","onChange"],onFinish:W,children:[(0,i.jsx)(n.PPS.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please enter a name"}],children:(0,i.jsx)(n.I6N,{options:k,onSelect:(e,t)=>{f.setFieldsValue({name:t.label,value_type:t.value})},disabled:O,"data-testid":"input-name-autocomplete",children:(0,i.jsx)(n.uFc,{"data-testid":"input-name",suffix:O?(0,i.jsx)(n.wpx,{size:"small",type:"text",icon:(0,i.jsx)(n.PJP.x8P,{}),onClick:()=>{f.setFieldsValue({name:void 0,value_type:void 0})}}):void 0})})}),(0,i.jsx)(n.PPS.Item,{label:"Type",name:"value_type",hidden:!0,children:(0,i.jsx)(n.WPr,{options:k,getPopupContainer:e=>e.parentElement||document.body,"data-testid":"select-value-type"})}),!!j&&!O&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.PPS.Item,{label:"Description",name:"description",children:(0,i.jsx)(n.uFc.TextArea,{rows:2,"data-testid":"input-description"})}),(0,i.jsx)(n.PPS.Item,{label:"Field type",name:"field_type",rules:[{required:!0,message:"Please select a field type"}],children:(0,i.jsx)(n.WPr,{options:d.TY,getPopupContainer:e=>e.parentElement||document.body,"data-testid":"select-field-type"})}),(0,i.jsx)(n.PPS.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.field_type!==t.field_type,children:e=>{let{getFieldValue:t}=e,s=t("field_type");return(s===d.Uv.SINGLE_SELECT||s===d.Uv.MULTIPLE_SELECT)&&(0,i.jsx)(n.PPS.List,{name:"options",rules:[{validator:async(e,t)=>!t||t.length<1?Promise.reject(Error("At least one option is required for selects")):Promise.resolve()}],children:(e,s,l)=>{let{add:r,remove:a}=s,{errors:o}=l;return(0,i.jsxs)(i.Fragment,{children:[e.map((s,l)=>(0,i.jsx)(n.PPS.Item,{required:!1,label:0===l?"Options":"","data-testid":"options-form-item",children:(0,i.jsxs)(n.jqI,{gap:"middle",children:[(0,i.jsx)(n.PPS.Item,{...s,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Options cannot be empty"},()=>({validator:(e,s)=>t("options").filter(e=>e===s).length>1?Promise.reject(Error("Option values must be unique")):Promise.resolve()})],noStyle:!0,children:(0,i.jsx)(n.uFc,{placeholder:"Enter option value","data-testid":"input-option-".concat(l)})}),e.length>1&&(0,i.jsx)(n.wpx,{icon:(0,i.jsx)(n.PJP.ZNm,{}),onClick:()=>a(s.name),"aria-label":"Remove option"})]})},s.key)),(0,i.jsx)(n.PPS.Item,{children:(0,i.jsx)(n.wpx,{type:"dashed",onClick:()=>r(),icon:(0,i.jsx)(n.PJP.mm_,{}),"data-testid":"add-option-btn",children:"Add select option"})}),(0,i.jsx)(n.PPS.ErrorList,{errors:o,className:"-mt-4 mb-4"})]})}})}})]}),(0,i.jsx)(n.PPS.Item,{label:"Applies to",name:"resource_type",rules:[{required:!0,message:"Please select a location"}],tooltip:"Choose where this field applies, including taxonomies",children:(0,i.jsx)(n.WPr,{options:null!==(t=null==N?void 0:N.map(e=>({label:e,value:e})))&&void 0!==t?t:[],getPopupContainer:e=>e.parentElement||document.body,disabled:!!s,"data-testid":"select-resource-type"})}),(0,i.jsxs)(n.jqI,{justify:"space-between",children:[A&&(0,i.jsx)(n.wpx,{danger:!0,onClick:()=>{var e;T.confirm({title:"Delete custom field?",content:(0,i.jsxs)(n.AntTypography.Paragraph,{children:["Are you sure you want to delete"," ",(0,i.jsx)("strong",{children:null!==(e=null==s?void 0:s.name)&&void 0!==e?e:"this custom field"}),"? This action cannot be undone."]}),onOk:F,okType:"primary",okText:"Delete",centered:!0})},loading:w,"data-testid":"delete-btn",children:"Delete"}),(0,i.jsx)(n.wpx,{type:"primary",htmlType:"submit","data-testid":"save-btn",children:"Save"})]})]})}},66236:function(e,t,s){"use strict";s.d(t,{S:function(){return r},_:function(){return l}});var i=s(20987),n=s(8917);let l=e=>e.field_type===i.H.STRING_ARRAY?n.Uv.MULTIPLE_SELECT:e.allow_list_id?n.Uv.SINGLE_SELECT:e.field_type===i.H.STRING?n.Uv.OPEN_TEXT:e.field_type,r=e=>{let t=l(e);return t===n.Uv.OPEN_TEXT||t===n.Uv.SINGLE_SELECT||t===n.Uv.MULTIPLE_SELECT?n.P3[t]:t}},85127:function(e,t,s){"use strict";s.r(t);var i=s(24246),n=s(77213),l=s(77830),r=s(58754),a=s(34435);t.default=()=>(0,i.jsxs)(n.Z,{title:"New custom field",mainProps:{maxWidth:"720px"},children:[(0,i.jsx)(r.Z,{heading:"Custom fields",breadcrumbItems:[{title:"All custom fields",href:l.WC},{title:"Create new"}]}),(0,i.jsx)(a.Z,{})]})}},function(e){e.O(0,[590,2888,9774,179],function(){return e(e.s=92973)}),_N_E=e.O()}]);