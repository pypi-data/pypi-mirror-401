(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8090],{79806:function(e,t,l){"use strict";l.d(t,{Gn:function(){return r},zR:function(){return s}});var n=l(24246),i=l(49617),a=l(56358);let s=e=>{let{title:t}=e;return(0,n.jsx)(i.OXI,{py:0,display:"flex",alignItems:"flex-start",children:(0,n.jsx)(i.xvT,{mr:"2",color:"gray.700",fontSize:"lg",lineHeight:1.8,children:t})})},r=e=>{let{onDelete:t,onEditYaml:l,formId:s,isSaving:r}=e;return(0,n.jsxs)(i.zeN,{justifyContent:"space-between",children:[t?(0,n.jsx)(i.wpx,{"aria-label":"delete",icon:(0,n.jsx)(a.q,{fontSize:"small"}),onClick:t,"data-testid":"delete-btn"}):null,(0,n.jsxs)("div",{className:"flex gap-2",children:[l&&(0,n.jsx)(i.wpx,{onClick:l,"data-testid":"edit-yaml-btn",children:"Edit YAML"}),(0,n.jsx)(i.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:s,loading:r,children:"Save"})]})]})};t.ZP=e=>{let{header:t,description:l,isOpen:a,onClose:s,children:r,footer:o}=e;return(0,n.jsxs)(i.dys,{placement:"right",isOpen:a,onClose:s,size:"md",children:[(0,n.jsx)(i.P1B,{}),(0,n.jsxs)(i.scA,{"data-testid":"edit-drawer-content",py:2,children:[(0,n.jsxs)(i.xuv,{display:"flex",justifyContent:"space-between",alignItems:"top",mr:2,py:2,gap:2,children:[(0,n.jsx)(i.xuv,{flex:1,minH:8,children:t}),(0,n.jsx)(i.xuv,{display:"flex",justifyContent:"flex-end",mr:2,children:(0,n.jsx)(i.wpx,{"aria-label":"Close editor",onClick:s,"data-testid":"close-drawer-btn",icon:(0,n.jsx)(i.Two,{fontSize:"smaller"})})})]}),(0,n.jsxs)(i.Ng0,{pt:1,children:[l?(0,n.jsx)(i.xvT,{fontSize:"sm",mb:4,color:"gray.600",children:l}):null,r]}),o]})]})}},18225:function(e,t,l){"use strict";var n=l(24246),i=l(49617);t.Z=e=>{let{alignment:t="center",...l}=e;return(0,n.jsx)(i.kCb,{boxSize:"full",align:"center",justify:t,children:(0,n.jsx)(i.$jN,{color:"primary",...l})})}},56358:function(e,t,l){"use strict";l.d(t,{q:function(){return i}});var n=l(24246);let i=(0,l(49617).IUT)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,n.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},94799:function(e,t,l){"use strict";l.d(t,{k:function(){return a}});var n=l(76649);let i=e=>(0,n.Ln)({id:"string"},e),a=e=>(null!=e?e:[]).filter(i)},30320:function(e,t,l){"use strict";l.d(t,{m:function(){return o}});var n=l(27378),i=l(25980),a=l(17245),s=l(32885),r=l(94799);let o=e=>{let{resourceFidesKey:t,resourceType:l}=e,{errorAlert:o}=(0,a.VY)(),{plus:d}=(0,i.hz)(),u=(0,n.useMemo)(()=>null!=t?t:"",[]),c=(0,s.YU)(!0,{skip:!d}),m=(0,s.VN)(l,{skip:!d}),{data:x,isLoading:y,error:p,isError:h}=(0,s.PV)(null!=t?t:"",{skip:""!==u&&!(d&&u)}),[f]=(0,s._D)(),j=c.isLoading||m.isLoading||y,v=(0,n.useMemo)(()=>new Map((0,r.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),g=(0,n.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),_=(0,n.useMemo)(()=>new Map((0,r.k)(g).map(e=>[e.id,e])),[g]),T=(0,n.useMemo)(()=>h&&p&&"status"in p&&404===p.status?new Map:new Map((0,r.k)(x).map(e=>[e.custom_field_definition_id,e])),[x,h,p]),E=(0,n.useMemo)(()=>{let e=[..._.keys()];return e.sort(),e},[_]),b=(0,n.useMemo)(()=>{let e={};return g&&T&&g.forEach(t=>{let l=T.get(t.id||"");l&&(t.allow_list_id&&"string[]"===t.field_type?e[l.custom_field_definition_id]=l.value:e[l.custom_field_definition_id]=l.value.toString())}),e},[g,T]),C=(0,n.useCallback)(async e=>{if(!d)return;let n="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!n)return;let{customFieldValues:i}=e;if(!i||0===Object.keys(i).length)return;let a=[],s=[];E.forEach(e=>{let t=T.get(e),l=i[e];void 0===l||""===l||Array.isArray(l)&&0===l.length?(null==t?void 0:t.id)&&s.push(t.id):a.push({custom_field_definition_id:e,resource_id:n,id:null==t?void 0:t.id,value:l})});try{await f({resource_type:l,resource_id:n,upsert:a,delete:s})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,T,o,t,E,f,l]);return{customFieldValues:b,definitionIdToCustomField:T,idToAllowListWithOptions:v,idToCustomFieldDefinition:_,isEnabled:d,isLoading:j,sortedCustomFieldDefinitionIds:E,upsertCustomFields:C}}},33162:function(e,t,l){"use strict";l.d(t,{uc:function(){return c},mZ:function(){return u.m}});var n=l(24246),i=l(49617),a=l(34090),s=l(20987),r=l(30234),o=l(97181),d=l(40324),u=l(30320);let c=e=>{let{resourceFidesKey:t,resourceType:l}=e,{idToAllowListWithOptions:c,idToCustomFieldDefinition:m,isEnabled:x,isLoading:y,sortedCustomFieldDefinitionIds:p}=(0,u.m)({resourceFidesKey:t,resourceType:l});return x&&0!==p.length?(0,n.jsx)(r.Z,{heading:"Custom fields",children:(0,n.jsx)(i.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,n.jsx)(i.kCb,{flexDir:"column",gap:"24px",children:y?(0,n.jsx)(i.M5Y,{children:(0,n.jsx)(i.$jN,{})}):p.length>0&&(0,n.jsx)(i.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:p.map(e=>{let t=m.get(e);if(!t)return null;let l="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===s.H.STRING)return(0,n.jsx)(a.gN,{name:l,children:e=>{let{field:l}=e;return(0,n.jsx)(d.j0,{...l,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let i=c.get(t.allow_list_id);if(!i)return null;let{options:r}=i;return(0,n.jsx)(o.d,{name:l,allowClear:!0,mode:t.field_type!==s.H.STRING?"multiple":void 0,label:t.name,options:r,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};l(94799)},97181:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var n=l(24246),i=l(49617),a=l(34090),s=l(27378),r=l(46238),o=l(40324);let d=e=>{let{name:t,label:l,labelProps:d,tooltip:u,isRequired:c,layout:m="inline",helperText:x,...y}=e,[p,h,{setValue:f}]=(0,a.U$)(t),j=!!(h.touched&&h.error),[v,g]=(0,s.useState)("");p.value||"tags"!==y.mode&&"multiple"!==y.mode||(p.value=[]),"tags"===y.mode&&"string"==typeof p.value&&(p.value=[p.value]);let _="tags"===y.mode?(e,t)=>e?e.value!==v||p.value.includes(v)?y.optionRender?y.optionRender(e,t):e.label:'Create "'.concat(v,'"'):void 0:y.optionRender||void 0,T=e=>{g(e),y.onSearch&&y.onSearch(e)},E=(e,t)=>{f(e),y.onChange&&y.onChange(e,t)};return"inline"===m?(0,n.jsx)(i.NIc,{isInvalid:j,isRequired:c,children:(0,n.jsxs)(i.rjZ,{templateColumns:l?"1fr 3fr":"1fr",children:[l?(0,n.jsx)(o.__,{htmlFor:y.id||t,...d,children:l}):null,(0,n.jsxs)(i.jqI,{align:"center",children:[(0,n.jsxs)(i.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,n.jsx)(i.WPr,{...p,id:y.id||t,"data-testid":"controlled-select-".concat(p.name),...y,optionRender:_,onSearch:"tags"===y.mode?T:void 0,onChange:E,value:p.value||void 0,status:j?"error":void 0}),x&&(0,n.jsx)(i.Q6r,{children:x}),(0,n.jsx)(o.Bc,{isInvalid:j,message:h.error,fieldName:p.name})]}),(0,n.jsx)(r.b,{label:u,className:j?"mt-2 self-start":void 0})]})]})}):(0,n.jsx)(i.NIc,{isInvalid:j,isRequired:c,children:(0,n.jsxs)(i.gCW,{alignItems:"start",children:[(0,n.jsxs)(i.jqI,{align:"center",children:[l?(0,n.jsx)(o.__,{htmlFor:y.id||t,fontSize:"xs",my:0,mr:1,...d,children:l}):null,(0,n.jsx)(r.b,{label:u})]}),(0,n.jsx)(i.WPr,{...p,id:y.id||t,"data-testid":"controlled-select-".concat(p.name),...y,optionRender:_,onSearch:"tags"===y.mode?T:void 0,onChange:E,value:p.value||void 0,status:j?"error":void 0}),x&&(0,n.jsx)(i.Q6r,{style:{marginTop:0},children:x}),(0,n.jsx)(o.Bc,{isInvalid:j,message:h.error,fieldName:p.name})]})})}},9270:function(e,t,l){"use strict";l.d(t,{S:function(){return a}});var n=l(27378),i=l(36866);let a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.h)(e),{pageIndex:l,pageSize:a,updatePageIndex:s,updatePageSize:r,pageSizeOptions:o,showSizeChanger:d}=t,u=(0,n.useMemo)(()=>({current:l,pageSize:a,showSizeChanger:d,pageSizeOptions:o.map(String),onChange:s,onShowSizeChange:(e,t)=>{r(t)}}),[l,a,d,o,s,r]);return{...t,paginationProps:u}}},84418:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var n=l(24246),i=l(49617),a=l(98784),s=l.n(a);let r=e=>{let{itemKey:t,actions:l}=e;return s().isEmpty(l)?null:(0,n.jsx)(i.jqI,{gap:"small",justify:"flex-end",children:l.map((e,a)=>{let{callback:s,label:r,disabled:o}=e;return(0,n.jsx)(i.wpx,{onClick:()=>s(t),type:a===l.length-1?"primary":"default",disabled:o,children:r},r)})})},o=e=>{let{title:t,titleIcon:l,titleTag:a}=e;return(0,n.jsxs)(i.jqI,{align:"center",gap:"small",children:[l,(0,n.jsx)("span",{children:t}),a&&(0,n.jsx)(i.j8w,{...a})]})},d=e=>{let{title:t,titleIcon:l,titleTag:a,actions:s,width:d=480,...u}=e;return(0,n.jsx)(i.To0,{title:(0,n.jsx)(o,{title:t,titleIcon:l,titleTag:a}),footer:u.footer||!s?u.footer:(0,n.jsx)(r,{itemKey:u.itemKey,actions:s}),width:d,...u})}},33335:function(e,t,l){"use strict";l.d(t,{E:function(){return n}});let n=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},30234:function(e,t,l){"use strict";var n=l(24246),i=l(49617);t.Z=e=>{let{heading:t,HeadingButton:l,children:a}=e;return(0,n.jsx)(i.Kqy,{spacing:4,children:(0,n.jsxs)(i.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,n.jsxs)(i.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,n.jsx)(i.X6q,{as:"h3",size:"xs",children:t}),l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.LZC,{}),l]})]}),(0,n.jsx)(i.Kqy,{spacing:4,px:6,py:6,children:a})]})})}},22583:function(e,t,l){"use strict";l.d(t,{j:function(){return a}});var n=l(49617),i=l(60240);let a={[i.Ej.TAXONOMY_WHITE]:n.tAb.DEFAULT,[i.Ej.TAXONOMY_RED]:n.tAb.ERROR,[i.Ej.TAXONOMY_ORANGE]:n.tAb.WARNING,[i.Ej.TAXONOMY_YELLOW]:n.tAb.CAUTION,[i.Ej.TAXONOMY_GREEN]:n.tAb.SUCCESS,[i.Ej.TAXONOMY_BLUE]:n.tAb.INFO,[i.Ej.TAXONOMY_PURPLE]:n.tAb.ALERT,[i.Ej.SANDSTONE]:n.tAb.SANDSTONE,[i.Ej.MINOS]:n.tAb.MINOS}},92818:function(e,t,l){"use strict";l.d(t,{r:function(){return o}});var n=l(24246),i=l(27378),a=l(97181),s=l(22583),r=l(60240);let o={[r.Ej.TAXONOMY_WHITE]:"White",[r.Ej.TAXONOMY_RED]:"Red",[r.Ej.TAXONOMY_ORANGE]:"Orange",[r.Ej.TAXONOMY_YELLOW]:"Yellow",[r.Ej.TAXONOMY_GREEN]:"Green",[r.Ej.TAXONOMY_BLUE]:"Blue",[r.Ej.TAXONOMY_PURPLE]:"Purple",[r.Ej.SANDSTONE]:"Sandstone",[r.Ej.MINOS]:"Minos"},d=e=>{let{color:t,...l}=e;return(0,n.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(s.j[t],")"),border:t===r.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})},u=e=>{let t=null==e?void 0:e.value,l=null==e?void 0:e.label;return(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)(d,{color:t}),(0,n.jsx)("span",{children:l})]})};t.Z=e=>{let t=Object.values(r.Ej).map(e=>({value:e,label:o[e]})),[l,s]=(0,i.useState)(void 0);return(0,n.jsx)(a.d,{...e,options:t,optionRender:u,layout:"stacked",value:l,onChange:e=>{s(e)},prefix:(0,n.jsx)(d,{color:null!=l?l:r.Ej.TAXONOMY_WHITE,style:{marginBottom:"2px"}})})}},58090:function(e,t,l){"use strict";l.d(t,{Z:function(){return eL}});var n,i,a,s,r=l(24246),o=l(49617),d=l(69238),u=l.n(d),c=l(86677),m=l(27378),x=l(25980),y=l(812),p=l(77213),h=l(58754),f=l(19904),j=l(32885),v=l(33335),g=l(39864),_=e=>{let{onClose:t}=e,[l,{isLoading:n}]=(0,g.Hb)(),i=(0,o.UD8)(),a=async e=>{var n;let a={...e,taxonomy_type:(0,v.E)(null!==(n=e.name)&&void 0!==n?n:"")},s=await l(a);if((0,y.D4)(s)){i.error((0,y.e$)(s.error));return}i.success("Taxonomy created successfully"),t()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.AntTypography.Paragraph,{children:"Create and organize the core terminology your team uses to describe data and how it's handled. Custom taxonomies let you define domain-specific concepts and then apply them to other privacy objects throughout the platform"}),(0,r.jsxs)(o.PPS,{layout:"vertical",onFinish:a,validateTrigger:["onBlur","onChange"],children:[(0,r.jsx)(o.PPS.Item,{label:"Taxonomy name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,r.jsx)(o.uFc,{"data-testid":"input-name"})}),(0,r.jsx)(o.PPS.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.uFc.TextArea,{rows:2,"data-testid":"input-description"})}),(0,r.jsxs)(o.jqI,{gap:"small",justify:"space-between",children:[(0,r.jsx)(o.wpx,{onClick:t,disabled:n,children:"Cancel"}),(0,r.jsx)(o.wpx,{type:"primary",htmlType:"submit",loading:n,disabled:n,"data-testid":"save-btn",children:"Create taxonomy"})]})]})]})},T=l(33162),E=l(84418),b=l(67522),C=l(66006),A=l(60240),S=l(31883),k=e=>{let{taxonomy:t,onSubmit:l,formId:n,customFields:i}=e,{fides_key:a,...s}=null!=t?t:{},[d,u]=(0,m.useState)(!1),{valueTypeOptions:c}=(0,C.Z)(),x=(0,f.Tg)([A.Sh.CUSTOM_FIELD_DELETE]),[p,h]=o.$zI.useModal(),v=(0,o.UD8)(),[g]=(0,j.UF)(),{createOrUpdate:_}=(0,b.Z)(),T=async e=>{let{id:t,resource_type:l,field_type:n}=e,i=await g({id:t,resource_type:l,field_type:n});if((0,S.D4)(i)){v.error((0,y.e$)(i.error));return}v.success("Attribute removed successfully")},E=e=>{p.confirm({title:"Remove attribute",content:"Are you sure you want to remove this attribute?",onOk:()=>T(e),okText:"Remove",centered:!0})},k=async e=>{var t;let l=null==c?void 0:c.find(t=>t.value===e);if(!l||!a){v.error("Taxonomy type not found");return}let n=await _({name:null!==(t=l.label)&&void 0!==t?t:l.value,value_type:l.value,resource_type:a},void 0,void 0);if((0,S.D4)(n)){v.error((0,y.e$)(n.error));return}v.success("Attribute added successfully"),u(!1)};return(0,r.jsxs)(o.jqI,{vertical:!0,gap:"large",children:[h,(0,r.jsx)(o.Yfl,{children:(0,r.jsx)(o.Yfl.Item,{label:"Fides key",children:a})}),(0,r.jsxs)(o.PPS,{id:n,layout:"vertical",initialValues:s,onFinish:l,children:[(0,r.jsx)(o.PPS.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,r.jsx)(o.uFc,{})}),(0,r.jsx)(o.PPS.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.uFc.TextArea,{})})]}),d&&(0,r.jsx)(o.WPr,{options:c,defaultOpen:!0,"aria-label":"Attribute type",onSelect:k}),!d&&(0,r.jsx)(o.wpx,{onClick:()=>u(!0),icon:(0,r.jsx)(o.PJP.mm_,{}),children:"Add attribute"}),(0,r.jsx)(o.krs,{children:i.map(e=>(0,r.jsx)(o.krs.Item,{actions:x?[(0,r.jsx)(o.wpx,{type:"link",onClick:()=>E(e),children:"Remove"},"remove")]:void 0,children:(0,r.jsx)(o.krs.Item.Meta,{title:e.name,description:e.description})},e.id))})]})},I=l(51980),N=l(9270),O=l(16394);(n=a||(a={})).USAGE_DELETED="taxonomy.usage.deleted",n.USAGE_ADDED="taxonomy.usage.updated",n.ELEMENT_CREATED="taxonomy.element.created",n.ELEMENT_UPDATED="taxonomy.element.updated",n.ELEMENT_DELETED="taxonomy.element.deleted",n.CREATED="taxonomy.created";let P={"taxonomy.usage.deleted":"Usage removed","taxonomy.usage.updated":"Usage added","taxonomy.element.created":"Element created","taxonomy.element.deleted":"Element deleted","taxonomy.element.updated":"Element updated","taxonomy.created":"Taxonomy created"};var w=e=>{var t;let{taxonomyKey:l}=e,{paginationProps:n,pageIndex:i,pageSize:a}=(0,N.S)({defaultPageSize:10,disableUrlState:!0,showSizeChanger:!1}),{data:s,isLoading:d}=(0,g.jW)({fides_key:l,page:i,size:a});if(d)return(0,r.jsx)(o.krs,{size:"small",itemLayout:"vertical",children:Array.from({length:5}).map((e,t)=>(0,r.jsx)(o.krs.Item,{children:(0,r.jsx)(o.N_L,{active:!0,children:(0,r.jsx)(o.krs.Item.Meta,{})})},t))});let u=null!==(t=null==s?void 0:s.items)&&void 0!==t?t:[];return(0,r.jsxs)(o.jqI,{vertical:!0,gap:"middle",children:[(0,r.jsx)(o.krs,{size:"small",itemLayout:"vertical",children:u.map(e=>{var t;let l=(0,I.B)(new Date(e.created_at),new Date,{addSuffix:!0}),n=(0,O.p6)(new Date(e.created_at)),i=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.esZ,{title:n,children:"".concat((0,O.G8)(l))}),e.user_id?(0,r.jsxs)("span",{children:[" by ",e.user_id]}):null]});return(0,r.jsxs)(o.krs.Item,{children:[(0,r.jsx)(o.krs.Item.Meta,{title:null!==(t=P[e.event_type])&&void 0!==t?t:e.event_type,description:i}),(0,r.jsx)(o.AntTypography.Text,{children:e.description})]},e.id)})}),(0,r.jsx)(o.jqI,{justify:"middle",children:(null==s?void 0:s.total)&&(0,r.jsx)(o.B7X,{...n,total:s.total,hideOnSinglePage:!0})})]})};let D="custom-taxonomy-form";var L=e=>{let{taxonomy:t,onClose:l,onDelete:n,...i}=e,[a,{isLoading:s}]=(0,g.Km)(),d=(0,o.UD8)(),{sortedCustomFieldDefinitionIds:u,idToCustomFieldDefinition:c}=(0,T.mZ)({resourceType:t.fides_key}),m=u.map(e=>c.get(e)).sort((e,t)=>{var l,n;return(null!==(l=e.created_at)&&void 0!==l?l:"").localeCompare(null!==(n=t.created_at)&&void 0!==n?n:"")}),x=async e=>{if(!t.fides_key){d.error("Taxonomy not found");return}let l=await a({fides_key:t.fides_key,...e});if((0,y.D4)(l)){d.error((0,y.e$)(l.error));return}d.success("Taxonomy updated successfully")};return(0,r.jsx)(E.d,{title:"Edit ".concat(null==t?void 0:t.name),...i,itemKey:"",open:!!t,onClose:l,destroyOnHidden:!0,footer:(0,r.jsxs)(o.jqI,{justify:"space-between",className:"w-full",children:[(0,r.jsx)(o.wpx,{onClick:n,children:"Delete"}),(0,r.jsx)(o.wpx,{type:"primary",htmlType:"submit",form:D,loading:s,children:"Save"})]}),children:(0,r.jsx)(o.A5g,{items:[{label:"Details",key:"details",children:(0,r.jsx)(k,{taxonomy:t,onSubmit:x,formId:D,customFields:m})},{label:"History",key:"history",children:(0,r.jsx)(w,{taxonomyKey:t.fides_key})}]})})},R=l(79806),M=l(56358),F=l(46628),V=l(59001),H=l(90673),U=l(30002),z=l(28079),Y=l(69353),q=l(5785),Z=e=>{let{taxonomyType:t}=e,[l,n]=(0,q.Vj)(),[i,a]=(0,U.nC)(),[s,r]=(0,z.dk)(),[o,d]=(0,Y.cw)(),[u,c]=(0,q.Ti)(),[x,y]=(0,z.Ql)(),[p,h]=(0,U.wG)(),[f,j]=(0,Y.Nr)(),[v]=(0,q.jU)(),[_]=(0,z.LG)(),[T]=(0,U.h8)(),[E]=(0,Y.Xz)(),[b]=(0,q.K9)(),[C]=(0,z.gu)(),[A]=(0,U.Kv)(),[S]=(0,Y.Uv)(),[k,I]=(0,g.ci)(),[N,O]=(0,g.J1)(),[P]=(0,g.Cy)(),[w]=(0,g.d9)(),D=(0,m.useCallback)(()=>t?k(t):Promise.resolve(void 0),[t,k]),L=(0,m.useCallback)(e=>t?N({taxonomyType:t,...e}):Promise.resolve(void 0),[t,N]),R=(0,m.useCallback)(e=>t?P({taxonomyType:t,...e}):Promise.resolve(void 0),[t,P]),M=(0,m.useCallback)(e=>t?w({taxonomyType:t,key:e}):Promise.resolve(void 0),[t,w]);return t===V.ac.DATA_CATEGORY?{getAllTrigger:l,taxonomyItems:n.data||[],updateTrigger:v,deleteTrigger:b,createTrigger:u,isLoading:n.isLoading,isError:n.isError,isCreating:c.isLoading}:t===V.ac.DATA_USE?{getAllTrigger:s,taxonomyItems:r.data||[],updateTrigger:_,deleteTrigger:C,createTrigger:x,isLoading:r.isLoading,isError:r.isError,isCreating:y.isLoading}:t===V.ac.DATA_SUBJECT?{getAllTrigger:i,taxonomyItems:a.data||[],updateTrigger:T,deleteTrigger:A,createTrigger:p,isLoading:a.isLoading,isError:a.isError,isCreating:h.isLoading}:t===V.ac.SYSTEM_GROUP?{getAllTrigger:o,taxonomyItems:d.data||[],updateTrigger:E,deleteTrigger:S,createTrigger:f,isLoading:d.isLoading,isError:d.isError,isCreating:j.isLoading}:{getAllTrigger:D,taxonomyItems:(null==I?void 0:I.data)||[],updateTrigger:R,deleteTrigger:M,createTrigger:L,isLoading:(null==I?void 0:I.isLoading)||!1,isError:(null==I?void 0:I.isError)||!1,isCreating:O.isLoading}},G=l(90104),W=l.n(G),B=l(20987),X=l(18225),K=e=>{let{taxonomyKey:t,...l}=e,{data:n,isLoading:i}=(0,g.Jy)(t);return n?(0,r.jsx)(o.WPr,{options:n.map(e=>{var t;return{value:e.fides_key,label:null!==(t=e.name)&&void 0!==t?t:e.fides_key}}),loading:i,...l}):null},J=e=>{let{customFields:t,formId:l,form:n}=e,{idToAllowListWithOptions:i,idToCustomFieldDefinition:a,isEnabled:s,isLoading:d,sortedCustomFieldDefinitionIds:u}=t;return s&&0!==u.length?(0,r.jsx)(o.PPS,{form:n,name:l,initialValues:t.customFieldValues,layout:"vertical","data-testid":"custom-fields-form",children:d?(0,r.jsx)(X.Z,{}):(0,r.jsx)("div",{children:!W()(u)&&(0,r.jsx)("div",{children:u.map(e=>{let l=a.get(e);if(!l)return null;let{id:n,name:s,description:d,allow_list_id:u,field_type:c}=l;if(!u)return(0,r.jsx)(o.PPS.Item,{name:n,label:s,tooltip:d,children:c===B.H.STRING?(0,r.jsx)(o.uFc,{}):(0,r.jsx)(K,{taxonomyKey:c,defaultValue:t.customFieldValues[n]})},e);let m=i.get(l.allow_list_id);if(!m)return null;let{options:x}=m;return(0,r.jsx)(o.PPS.Item,{name:n,label:s,tooltip:d,children:(0,r.jsx)(o.WPr,{mode:c!==B.H.STRING?"multiple":void 0,allowClear:!0,options:x})},e)})})})}):null},$=l(43551),Q=l.n($),ee=()=>{let e=o.PPS.useFormInstance(),t=o.PPS.useWatch(["rights","values"],e);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.PPS.Item,{label:"Automated Decisions or Profiling",name:"automated_decisions_or_profiling",layout:"horizontal",valuePropName:"checked",children:(0,r.jsx)(o.E_O,{"data-testid":"edit-taxonomy-form_automated-decisions"})}),(0,r.jsx)(o.PPS.Item,{name:["rights","values"],label:"Rights",children:(0,r.jsx)(o.WPr,{mode:"multiple",options:(0,y.MM)(A.ts),"data-testid":"edit-taxonomy-form_rights"})}),t&&!W()(t)&&(0,r.jsx)(o.PPS.Item,{name:["rights","strategy"],label:"Strategy",required:!0,rules:[{required:!0,message:"Please select a strategy"}],children:(0,r.jsx)(o.WPr,{options:(0,y.MM)(A.jX),"data-testid":"edit-taxonomy-form_strategy"})})]})},et=l(83766),el=l.n(et),en=l(1315),ei=l(22583),ea=l(92818);let es=e=>{let{color:t,...l}=e;return(0,r.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(ei.j[t],")"),border:t===A.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})};var er=e=>{let t=Object.values(A.Ej).map(e=>({value:e,label:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(es,{color:e}),(0,r.jsx)("span",{children:ea.r[e]})]})}));return(0,r.jsx)(o.WPr,{...e,options:t,placeholder:"Select color"})};let eo="all-suggested";var ed=e=>{let{initialValues:t,onSubmit:l,form:n,formId:i,isDisabled:a}=e,{data:s=[],isLoading:d}=(0,z.fd)(),{data:u,isLoading:c}=(0,en.K3)(),x=(0,m.useMemo)(()=>s.map(e=>({label:e.name||e.fides_key,value:e.fides_key})),[s]),y=o.PPS.useWatch("systems",n),p=(0,m.useMemo)(()=>{var e;let t=y||[];if(!u||0===t.length)return[];let l=null!==(e=null==u?void 0:u.filter(e=>t.includes(e.fides_key)))&&void 0!==e?e:[];return el()(null==l?void 0:l.flatMap(e=>e.privacy_declarations.map(e=>e.data_use)))},[u,y]),h=(0,m.useMemo)(()=>{var e;return null!==(e=null==u?void 0:u.map(e=>({label:e.name||e.fides_key,value:e.fides_key})))&&void 0!==e?e:[]},[u]),f=(0,m.useMemo)(()=>{let e=[],t=[];return(x.forEach(l=>{p.includes(l.value)?e.push(l):t.push(l)}),0===e.length)?t:[{label:"Select all suggested",value:eo},{label:(0,r.jsxs)(o.vyj,{children:[(0,r.jsx)(o.QMR,{size:14}),(0,r.jsx)("span",{children:"Suggested data uses"})]}),options:e},{label:(0,r.jsxs)(o.vyj,{children:[(0,r.jsx)(o.PJP.BBB,{}),(0,r.jsx)("span",{children:"All data uses"})]}),options:t}]},[x,p]);return(0,r.jsxs)(o.PPS,{name:i,initialValues:t,onFinish:e=>{var n,i;let a={...t,...e};(!(null==a?void 0:null===(n=a.rights)||void 0===n?void 0:n.values)||W()(null==a?void 0:null===(i=a.rights)||void 0===i?void 0:i.values))&&Q()(a,"rights"),l(a)},layout:"vertical",form:n,children:[(0,r.jsx)(o.PPS.Item,{label:"Name",name:"name",children:(0,r.jsx)(o.uFc,{"data-testid":"edit-taxonomy-form_name",disabled:a})}),(0,r.jsx)(o.PPS.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.uFc.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:a})}),(0,r.jsx)(o.PPS.Item,{label:"Systems",name:"systems",children:(0,r.jsx)(o.WPr,{mode:"multiple",placeholder:"Select systems",options:h,allowClear:!0,loading:c,disabled:a,"data-testid":"edit-taxonomy-form_systems"})}),(0,r.jsx)(o.PPS.Item,{label:"Color",name:"label_color",children:(0,r.jsx)(er,{disabled:a,"data-testid":"edit-taxonomy-form_color"})}),(0,r.jsx)(o.PPS.Item,{label:"Data uses",name:"data_uses",children:(0,r.jsx)(o.WPr,{mode:"multiple",placeholder:"Select data uses",options:f,allowClear:!0,loading:d,disabled:a,onChange:e=>{if(e.includes(eo)){let t=el()([...p,...e.filter(e=>e!==eo)]);n.setFieldsValue({data_uses:t})}else n.setFieldsValue({data_uses:e})},"data-testid":"edit-taxonomy-form_data_uses"})})]})},eu=e=>{let{initialValues:t,onSubmit:l,form:n,formId:i,taxonomyType:a,isDisabled:s}=e,d=a===V.ac.DATA_SUBJECT;return a===V.ac.SYSTEM_GROUP?(0,r.jsx)(ed,{initialValues:t,onSubmit:l,form:n,formId:i,isDisabled:s}):(0,r.jsxs)(o.PPS,{name:i,initialValues:t,onFinish:e=>{var n,i;let a={...t,...e};(!(null==a?void 0:null===(n=a.rights)||void 0===n?void 0:n.values)||W()(null==a?void 0:null===(i=a.rights)||void 0===i?void 0:i.values))&&Q()(a,"rights"),l(a)},layout:"vertical",form:n,children:[(0,r.jsx)(o.PPS.Item,{label:"Name",name:"name",children:(0,r.jsx)(o.uFc,{"data-testid":"edit-taxonomy-form_name",disabled:s})}),(0,r.jsx)(o.PPS.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.uFc.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:s})}),d&&(0,r.jsx)(ee,{})]})},ec=e=>{let{taxonomyItem:t,taxonomyType:l,onClose:n}=e,i="edit-taxonomy-form",[a]=o.PPS.useForm(),[s]=o.PPS.useForm(),d=(0,o.pmc)(),{isOpen:u,onOpen:c,onClose:m}=(0,o.qY0)(),{updateTrigger:x,deleteTrigger:p}=Z({taxonomyType:l}),h=(0,H.Xl)(l),j=(0,T.mZ)({resourceFidesKey:null==t?void 0:t.fides_key,resourceType:h}),v=(0,f.Tg)([(0,V.aq)(l).UPDATE]),g=(0,f.Tg)([(0,V.aq)(l).DELETE]),_=async e=>{let l=await x(e);if((0,S.D4)(l)){d((0,F.Vo)((0,y.e$)(l.error)));return}if(j.isEnabled){let e=s.getFieldsValue();await j.upsertCustomFields({fides_key:null==t?void 0:t.fides_key,customFieldValues:e})}d((0,F.t5)("Taxonomy successfully updated")),n()},E=async()=>{await p(t.fides_key),m(),n()},b=async()=>{await x({...t,active:!0}),m(),n()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(R.ZP,{isOpen:!!t,onClose:n,header:(0,r.jsx)(R.zR,{title:(null==t?void 0:t.name)||""}),footer:(0,r.jsxs)(o.zeN,{justifyContent:"space-between",children:[(null==t?void 0:t.active)&&g&&(0,r.jsx)(o.esZ,{title:"Delete label",children:(0,r.jsx)(o.wpx,{"aria-label":"delete",icon:(0,r.jsx)(M.q,{fontSize:"small"}),onClick:c,"data-testid":"delete-btn"})}),!(null==t?void 0:t.active)&&v&&(0,r.jsx)(o.esZ,{title:"Enable label",children:(0,r.jsx)(o.wpx,{"aria-label":"enable",onClick:b,"data-testid":"enable-btn",icon:(0,r.jsx)(o.tEF,{fontSize:"small"})})}),(0,r.jsx)("div",{className:"flex gap-2",children:v&&(0,r.jsx)(o.wpx,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:i,children:"Save"})})]}),children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(o.AntTypography.Title,{level:3,children:"Details"})}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-1/3 shrink-0 text-sm text-gray-500",children:"Fides key:"}),(0,r.jsx)(o.esZ,{title:null==t?void 0:t.fides_key,trigger:"click",children:(0,r.jsx)("span",{className:"flex-1 truncate","data-testid":"edit-drawer-fides-key",children:null==t?void 0:t.fides_key})})]})]}),!!t&&(0,r.jsx)(eu,{initialValues:t,onSubmit:_,form:a,formId:i,taxonomyType:l,isDisabled:!v}),j.isEnabled&&!j.isLoading&&(0,r.jsx)(J,{form:s,formId:"custom-fields-form",customFields:j})]}),(0,r.jsx)(o.cVQ,{isOpen:u,onClose:m,onConfirm:E,title:"Delete ".concat(l),message:(0,r.jsx)(o.Kqy,{children:(0,r.jsxs)(o.xvT,{children:["You are about to permanently delete the ",l," ",(0,r.jsx)(o.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:null==t?void 0:t.name})," ","from your taxonomy. Are you sure you would like to continue?"]})})})]})};l(51901);var em=l(86298),ex=l(3124),ey=l.n(ex);(i=s||(s={})).DEFAULT="DEFAULT",i.ACTIVE_HOVER="ACTIVE_HOVER",i.PARENT_OF_HOVER="PARENT_OF_HOVER",i.CHILD_OF_HOVER="CHILD_OF_HOVER",i.SIBLING_OF_HOVER="SIBLING_OF_HOVER",i.INACTIVE="INACTIVE";let ep=(0,m.createContext)({activeNodeKey:null,setActiveNodeKey:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},getNodeHoverStatus:()=>"DEFAULT"}),eh=e=>{let{children:t}=e,[l,n]=(0,m.useState)(null),i=(0,m.useCallback)(e=>{e!==l&&n(e)},[l]),a=(0,m.useCallback)(()=>{n(null)},[]),s=(0,m.useCallback)(e=>l?e===l?"ACTIVE_HOVER":l.startsWith("".concat(e,"."))||e===V.Ch?"PARENT_OF_HOVER":e.startsWith("".concat(l,"."))||l===V.Ch?"CHILD_OF_HOVER":l.split(".").slice(0,-1).join(".")===e.split(".").slice(0,-1).join(".")?"SIBLING_OF_HOVER":"INACTIVE":"DEFAULT",[l]),o=(0,m.useMemo)(()=>({activeNodeKey:l,setActiveNodeKey:n,onMouseEnter:i,onMouseLeave:a,getNodeHoverStatus:s}),[l,n,i,a,s]);return(0,r.jsx)(ep.Provider,{value:o,children:t})};var ef=l(62266),ej=l(79658);let ev=(0,ef.Z)();var eg=e=>{let{nodes:t,edges:l,options:n}=e;return(0,m.useMemo)(()=>{if(0===t.length)return{nodes:t,edges:l};let e=(0,ej.Z)().id(e=>e.id).parentId(e=>{var t;return null===(t=l.find(t=>t.target===e.id))||void 0===t?void 0:t.source})(t),i="LR"===n.direction?[35,320]:[320,35];return{nodes:ev.nodeSize(i).separation((e,t)=>e.parent===t.parent?1:1.5)(e).descendants().map(e=>{let t;return t="LR"===n.direction?{x:e.y,y:e.x}:{x:e.x,y:e.y},{...e.data,position:t}}),edges:l}},[t,l,n])},e_=e=>{let{positionAbsoluteX:t,positionAbsoluteY:l,nodeWidth:n}=e,{setCenter:i,getZoom:a}=(0,em._K)();return{centerScreenOnNode:(0,m.useCallback)(()=>i(t+n/2,l,{duration:500,zoom:a()}),[a,t,l,n,i])}},eT=l(1945),eE=l.n(eT),eb=l(8335),eC=e=>{let{type:t,inactive:l=!1}=e;return(0,r.jsx)(em.HH,{type:t,position:"source"===t?eb.Ly.Right:eb.Ly.Left,style:{width:8,height:8,backgroundColor:l?ey().FIDESUI_NEUTRAL_400:ey().FIDESUI_MINOS},className:"transition-colors duration-300 ease-in"})},eA=e=>{let{data:t,positionAbsoluteX:l,positionAbsoluteY:n}=e,{onCancel:i,onSubmit:a,parentKey:s,isLoading:d=!1}=t,u=(0,m.useRef)(null),[c,x]=(0,m.useState)(""),{centerScreenOnNode:y}=e_({positionAbsoluteX:l,positionAbsoluteY:n,nodeWidth:200});(0,m.useEffect)(()=>{x("");let e=()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.focus({cursor:"start",preventScroll:!0})};(async()=>{await y(),e()})()},[s,y,l,n]);let p=()=>{!d&&c.trim()&&a(c)},h=()=>{d||i()};return(0,r.jsxs)("div",{style:{width:200},"data-testid":"taxonomy-text-input-node",children:[(0,r.jsx)(o.uFc,{placeholder:"Type label name...",ref:u,onBlur:h,onSubmit:p,value:c,onChange:e=>x(e.target.value),onKeyUp:e=>{"Escape"===e.key&&h()},onPressEnter:p,className:eE().input,suffix:d&&(0,r.jsx)(o.ZJQ,{size:"small"})}),(0,r.jsx)(eC,{type:"target"})]})},eS=e=>{let{getNodeHoverStatus:t}=(0,m.useContext)(ep),{target:l}=e,n=t(l),i=(0,m.useCallback)(()=>{switch(n){case s.ACTIVE_HOVER:case s.PARENT_OF_HOVER:return ey().FIDESUI_MINOS;case s.INACTIVE:return ey().NEUTRAL_400;default:return ey().FIDESUI_SANDSTONE}},[n]),a=(0,m.useCallback)(()=>{switch(n){case s.ACTIVE_HOVER:case s.PARENT_OF_HOVER:return 2;default:return 1}},[n]);return(0,r.jsx)(em.Jd,{...e,style:{stroke:i(),strokeWidth:a(),transition:"stroke 0.3s ease 0s"}})},ek=l(34770),eI=l.n(ek),eN=e=>{let{data:t,positionAbsoluteX:l,positionAbsoluteY:n}=e,{onMouseEnter:i,onMouseLeave:a,getNodeHoverStatus:d}=(0,m.useContext)(ep),{taxonomyType:u,taxonomyItem:c,onAddButtonClick:x,onTaxonomyItemClick:y,label:p,hasChildren:h,isLastCreatedItem:f,resetLastCreatedItemKey:j,userCanAddLabels:v}=t,{centerScreenOnNode:g}=e_({positionAbsoluteX:l,positionAbsoluteY:n,nodeWidth:200});(0,m.useEffect)(()=>{let e=async()=>{await g(),i(null==c?void 0:c.fides_key)};f&&(e(),j())},[f,i,null==c?void 0:c.fides_key,j,g]);let _=d(null==c?void 0:c.fides_key),T=(0,m.useCallback)(()=>{switch(_){case s.ACTIVE_HOVER:return eI()["button--hover"];case s.PARENT_OF_HOVER:return eI()["button--parent-hover"];case s.INACTIVE:return eI()["button--inactive"];case s.DEFAULT:case s.CHILD_OF_HOVER:case s.SIBLING_OF_HOVER:default:return""}},[_]),E=(null==c?void 0:c.fides_key)===V.Ch,b=u===V.ac.DATA_SUBJECT;return(0,r.jsxs)("div",{className:eI().container,onMouseEnter:()=>i(null==c?void 0:c.fides_key),onMouseLeave:()=>a(null==c?void 0:c.fides_key),"data-testid":"taxonomy-node-".concat(null==c?void 0:c.fides_key),children:[(0,r.jsx)(o.wpx,{className:"".concat(eI().button," ").concat(T()),onClick:()=>null==y?void 0:y(c),disabled:!y,type:"text",children:(0,r.jsxs)(o.AntTypography.Text,{ellipsis:!0,style:{color:"inherit"},children:[(null==c?void 0:c.active)===!1?"(disabled) ":"",p]})}),!E&&(0,r.jsx)(eC,{type:"target",inactive:_===s.INACTIVE}),h&&(0,r.jsx)(eC,{type:"source",inactive:_===s.INACTIVE}),v&&(!b||E)&&(0,r.jsx)("div",{className:eI()["add-button-container"],children:(0,r.jsx)(o.wpx,{type:"default",className:"".concat(eI()["add-button"]," ").concat(_===s.ACTIVE_HOVER?eI()["add-button--visible"]:""),icon:(0,r.jsx)(o.PJP.mm_,{size:20}),onClick:()=>null==x?void 0:x(c),size:"middle","data-testid":"taxonomy-add-child-label-button","aria-label":"Add child label to ".concat(p)})})]})};let eO=e=>{let{taxonomyType:t,taxonomyItems:l,draftNewItem:n,lastCreatedItemKey:i,resetLastCreatedItemKey:a,onRootItemClick:s,onTaxonomyItemClick:o,onAddButtonClick:d,onCancelDraftItem:u,onSubmitDraftItem:c,userCanAddLabels:x,isCreating:y=!1,rootNodeLabel:p}=e,{fitView:h}=(0,em._K)();(0,m.useEffect)(()=>{setTimeout(()=>h(),150)},[h,t,l.length]);let f=[(0,m.useMemo)(()=>({id:V.Ch,position:{x:0,y:0},data:{label:p||t,taxonomyItem:{fides_key:V.Ch},taxonomyType:t,onTaxonomyItemClick:s,onAddButtonClick:d,hasChildren:0!==l.length,userCanAddLabels:x},type:"taxonomyTreeNode"}),[p,t,s,d,l.length,x])],j=[];if(l.forEach(e=>{let l=e.name||e.fides_key.split(".").pop()||"",n={id:e.fides_key,position:{x:0,y:0},data:{label:l,taxonomyType:t,taxonomyItem:e,onTaxonomyItemClick:o,onAddButtonClick:d,hasChildren:!1,isLastCreatedItem:i===e.fides_key,resetLastCreatedItemKey:a,userCanAddLabels:x},type:"taxonomyTreeNode"};f.push(n);let s=e.parent_key?f.find(t=>t.id===e.parent_key):null,r=s?s.id:V.Ch,u=e.fides_key,c={id:"".concat(r,"-").concat(u),source:r,target:u,type:"taxonomyTreeEdge"};j.push(c),s&&(s.data.hasChildren=!0)}),n){let e=n.parent_key||V.Ch;f.push({id:"draft-node",position:{x:0,y:0},type:"textInputNode",data:{parentKey:e,onCancel:u,onSubmit:c,isLoading:y},hidden:!n}),j.push({id:"draft-line",source:e,target:"draft-node",animated:!0});let t=f.find(t=>t.id===e);t&&(t.data.hasChildren=!0)}let{nodes:v,edges:g}=eg({nodes:f,edges:j,options:{direction:"LR"}}),_=(0,m.useMemo)(()=>({taxonomyTreeNode:eN,textInputNode:eA}),[]),T=(0,m.useMemo)(()=>({taxonomyTreeEdge:eS}),[]);return(0,r.jsx)("div",{className:"size-full",style:{backgroundColor:ey().FIDESUI_BG_CORINTH},"data-testid":"taxonomy-interactive-tree",children:(0,r.jsx)(eh,{children:(0,r.jsxs)(em.x$,{nodes:v,edges:g,nodeTypes:_,edgeTypes:T,maxZoom:2,minZoom:.3,nodesConnectable:!1,edgesFocusable:!1,elementsSelectable:!1,proOptions:{hideAttribution:!0},children:[(0,r.jsx)(em.Aq,{color:ey().FIDESUI_NEUTRAL_100,variant:em.T7.Dots,size:3}),(0,r.jsx)(em.a9,{nodeStrokeWidth:3,pannable:!0}),(0,r.jsx)(em.ZX,{showInteractive:!1})]})})})};var eP=e=>(0,r.jsx)(em.tV,{children:(0,r.jsx)(eO,{...e})});let ew="add new item",eD=V.ac.DATA_CATEGORY;var eL=e=>{let{initialTaxonomy:t}=e,l=(0,c.useRouter)(),n=null!=t?t:eD,i=!Object.values(V.ac).includes(n),a=(0,x.hz)().plus,{isLoading:s}=(0,j.x8)(),{data:d}=(0,g.MU)(void 0,{skip:!a}),{createTrigger:v,getAllTrigger:T,taxonomyItems:E=[],isCreating:b}=Z({taxonomyType:n}),C="true"===l.query.showDisabledItems,A=(0,o.UD8)();(0,m.useEffect)(()=>{T()},[T,n]);let[S,k]=(0,m.useState)(null),[I,N]=(0,m.useState)(null),[O,P]=(0,m.useState)(null),[w,D]=(0,m.useState)(null),R=(0,o.S37)(),[M]=(0,g.EO)(),F=async()=>{if(!(null==I?void 0:I.fides_key)){A.error("Taxonomy not found");return}let e=await M(I.fides_key);if((0,y.D4)(e)){A.error((0,y.e$)(e.error));return}A.success("Taxonomy deleted successfully"),N(null);let t={...l.query};delete t.key,l.replace({pathname:"/taxonomy",query:t},void 0,{shallow:!0})},H=(0,m.useMemo)(()=>{var e;if(!d)return null;let t=d.find(e=>e.fides_key===n);return null!==(e=null==t?void 0:t.name)&&void 0!==e?e:null==t?void 0:t.fides_key},[d,n]),[U,z]=(0,m.useState)(!1);(0,m.useEffect)(()=>{P(null),D(null),k(null)},[n]),(0,m.useEffect)(()=>{if(n===V.ac.SYSTEM_GROUP&&!s&&!a){let e={...l.query};delete e.key,l.replace({pathname:"/taxonomy",query:e},void 0,{shallow:!0})}},[n,a,s,l]);let Y=(0,m.useCallback)(async e=>{if(!O)return;let t=(null==O?void 0:O.parent_key)===V.Ch,l={...O,name:e,parent_key:t?null:O.parent_key},n=await v(l);if((0,y.D4)(n)){A.error((0,y.e$)(n.error));return}D(n.data.fides_key),A.success("New label successfully created"),P(null)},[v,O,A]),q=u()(E,"active"),G=(0,f.Tg)([(0,V.aq)(n).CREATE]);return(0,r.jsxs)(p.Z,{title:"Taxonomy",children:[(0,r.jsxs)(o.jqI,{vertical:!0,className:"h-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h.Z,{heading:"Taxonomy"}),(0,r.jsx)("div",{className:"hidden",children:(0,r.jsx)("div",{className:"mb-5 flex justify-between",children:(0,r.jsxs)(o.vyj.Compact,{children:[(0,r.jsx)(o.uFc,{className:"min-w-[350px]",placeholder:"Search",allowClear:!0}),(0,r.jsx)(o.wpx,{type:"default",children:"Clear"})]})})})]}),(0,r.jsxs)("div",{className:"relative grow",children:[(0,r.jsx)("div",{className:"absolute left-2 top-2 z-[1]",children:(0,r.jsx)(o.AHg,{selectedKeys:[n],onSelect:e=>{let{key:t}=e;if(t===ew){z(!0);return}let n={...l.query};delete n.key,l.replace({pathname:"/taxonomy/".concat(t),query:n},void 0,{shallow:!0})},items:(()=>{let e={[V.Lo.DATA_CATEGORIES]:V.ac.DATA_CATEGORY,[V.Lo.DATA_USES]:V.ac.DATA_USE,[V.Lo.DATA_SUBJECTS]:V.ac.DATA_SUBJECT,[V.Lo.SYSTEM_GROUPS]:V.ac.SYSTEM_GROUP},t=(0,y.MM)(V.Lo).filter(e=>a||e.value!==V.Lo.SYSTEM_GROUPS).map(t=>({label:t.label,key:e[t.value]}));return(null==d?void 0:d.length)&&d.forEach(e=>{t.push({label:e.name,key:e.fides_key})}),a&&(t.push({type:"divider"}),t.push({label:"+ Create new",key:ew})),t})(),"data-testid":"taxonomy-type-selector"})}),(0,r.jsx)(o.$zI,{open:U,destroyOnHidden:!0,onCancel:()=>z(!1),width:768,footer:null,centered:!0,title:"Create new taxonomy",children:(0,r.jsx)(_,{onClose:()=>z(!1)})}),(0,r.jsx)(eP,{userCanAddLabels:G,taxonomyItems:C?E:q,draftNewItem:O,lastCreatedItemKey:w,resetLastCreatedItemKey:()=>D(null),onTaxonomyItemClick:e=>{k(e)},onRootItemClick:i?()=>{let e=null==d?void 0:d.find(e=>e.fides_key===n);e&&N(e)}:null,onAddButtonClick:e=>{var t;P({parent_key:null!==(t=null==e?void 0:e.fides_key)&&void 0!==t?t:null,is_default:!1,description:""})},taxonomyType:n,onCancelDraftItem:()=>P(null),onSubmitDraftItem:Y,isCreating:b,rootNodeLabel:null!=H?H:(0,V._g)(n)})]})]}),S&&(0,r.jsx)(ec,{taxonomyItem:S,taxonomyType:n,onClose:()=>k(null)}),a&&I&&(0,r.jsx)(L,{title:H?"Edit ".concat(H):"Edit taxonomy",onClose:()=>N(null),onDelete:()=>{R.confirm({title:"Delete ".concat(null==I?void 0:I.name,"?"),icon:null,content:(0,r.jsx)(o.AntTypography.Paragraph,{children:"Are you sure you want to delete this taxonomy? This action cannot be undone."}),okText:"Delete",okType:"primary",onOk:F,centered:!0})},taxonomy:I})]})}},90673:function(e,t,l){"use strict";l.d(t,{Cd:function(){return a},Xl:function(){return s}});var n=l(20987),i=l(59001);let a=(e,t)=>{let l;if(null==t&&e.every(e=>void 0===e.parent_key))l=e;else{let n=null!=t?t:null;l=e.filter(e=>e.parent_key===n)}return l.map(t=>{var l,n;let i=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:a(e,i),is_default:null!==(l=t.is_default)&&void 0!==l&&l,active:null!==(n=t.active)&&void 0!==n&&n}})},s=e=>{switch(e){case i.ac.DATA_CATEGORY:return n.J.DATA_CATEGORY;case i.ac.DATA_SUBJECT:return n.J.DATA_SUBJECT;case i.ac.DATA_USE:return n.J.DATA_USE;default:return e}}},1945:function(e){e.exports={input:"TaxonomyTextInputNode_input__P9czz"}},34770:function(e){e.exports={container:"TaxonomyTreeNode_container__T4KpF",button:"TaxonomyTreeNode_button__mcbOd","button--hover":"TaxonomyTreeNode_button--hover__oycXY","button--parent-hover":"TaxonomyTreeNode_button--parent-hover__pwAPl","button--inactive":"TaxonomyTreeNode_button--inactive__Fjdpe","add-button-container":"TaxonomyTreeNode_add-button-container__eEoRN","add-button":"TaxonomyTreeNode_add-button__oM2vI","add-button--visible":"TaxonomyTreeNode_add-button--visible__Ojqqf"}}}]);