"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4589],{30952:function(e,t,r){r.d(t,{f:function(){return o}});var n=r(24246),s=r(26917);let o=e=>{let{...t}=e;return(0,n.jsx)(s.Z,{debounce:!0,...t})}},35287:function(e,t,r){var n=r(24246),s=r(49617),o=r(88038),i=r.n(o);r(27378),t.Z=e=>{let{children:t,title:r,fullHeight:o,fullWidth:a,mainProps:u}=e;return(0,n.jsxs)(s.kCb,{"data-testid":r,direction:"column",height:o?"100vh":"calc(100vh - 48px)",width:a?"100vw":"calc(100vw - 240px)",children:[(0,n.jsxs)(i(),{children:[(0,n.jsxs)("title",{children:["Fides Admin UI - ",r]}),(0,n.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)(s.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...u,children:t})]})}},14908:function(e,t,r){var n=r(86677),s=r(27378);let o=e=>e.startsWith("#")?e.slice(1):e;t.Z=e=>{let{tabKeys:t,initialTab:r}=e,i=(0,n.useRouter)(),a=i.asPath.split("#")[1]||t[0],[u,c]=(0,s.useState)(a);return(0,s.useEffect)(()=>{r&&t.includes(r)&&c(r)},[r,t,i.isReady]),{activeTab:u,onTabChange:(0,s.useCallback)(async e=>{if(!t.includes(e)){await i.replace({pathname:i.pathname,query:i.query,hash:void 0}),c(t[0]);return}i.isReady&&(await i.replace({pathname:i.pathname,query:i.query,hash:o(e)},void 0,{shallow:!0}),c(e))},[i,t]),setActiveTab:c}}},37059:function(e,t,r){r.d(t,{$h:function(){return h},Ak:function(){return p},Av:function(){return w},EY:function(){return y},IC:function(){return C},M8:function(){return D},QC:function(){return A},RV:function(){return O},S0:function(){return N},Tj:function(){return g},Ud:function(){return u},Vr:function(){return f},WJ:function(){return l},mL:function(){return R},mi:function(){return _},n7:function(){return P},nP:function(){return m},nS:function(){return v},rs:function(){return d},sX:function(){return T},ut:function(){return E},vc:function(){return I},wi:function(){return c}});var n=r(78780),s=r(16394),o=r(60240),i=r(98145),a=r(71985);let{useGetAggregateMonitorResultsQuery:u,useGetDiscoveredSystemAggregateQuery:c,useGetDiscoveredAssetsQuery:l,useAddMonitorResultSystemsMutation:d,useIgnoreMonitorResultSystemsMutation:m,useAddMonitorResultAssetsMutation:y,useIgnoreMonitorResultAssetsMutation:v,useRestoreMonitorResultAssetsMutation:g,useUpdateAssetsSystemMutation:T,useUpdateAssetsDataUseMutation:p,useUpdateAssetsMutation:f,useGetConsentBreakdownQuery:_,useGetWebsiteMonitorResourceFiltersQuery:E,useGetInProgressMonitorTasksQuery:h,useRetryMonitorTaskMutation:R,useDismissMonitorTaskMutation:A,useUndismissMonitorTaskMutation:S,useGetMonitorTreeQuery:M,useLazyGetMonitorTreeQuery:O,useLazyGetMonitorTreeAncestorsStatusesQuery:D,useGetMonitorConfigQuery:I,useGetDatastoreFiltersQuery:N,useClassifyStagedResourcesMutation:w,useGetStagedResourceDetailsQuery:C,useLazyGetStagedResourceDetailsQuery:q,usePromoteRemovalStagedResourcesMutation:P}=n.u.injectEndpoints({endpoints:e=>({getAggregateMonitorResults:e.query({query:e=>{let{page:t=1,size:r=20,search:n,monitor_type:o}=e,i=(0,s.$J)({monitor_type:o});return{url:"/plus/discovery-monitor/aggregate-results?".concat(i.toString()),params:{page:t,size:r,search:n,diff_status:"addition"}}},transformResponse:e=>({...e,items:e.items.map(e=>({...e,monitorType:(0,a.G)(e.connection_type),isTestMonitor:e.connection_type===o.Rj.TEST_WEBSITE||e.connection_type===o.Rj.TEST_DATASTORE}))}),providesTags:["Discovery Monitor Results"]}),getMonitorConfig:e.query({query:e=>{let{monitor_config_id:t}=e;return{url:"/plus/discovery-monitor/".concat(t)}}}),getDatastoreFilters:e.query({query:e=>{let{monitor_config_id:t,staged_resource_urn:r}=e;return{url:"/plus/filters/datastore_monitor_resources?monitor_config_id=".concat(t,"&").concat((0,s.du)(r,"staged_resource_urn"))}}}),getMonitorTree:e.query({query:e=>{let{page:t=1,size:r=20,monitor_config_id:n,staged_resource_urn:s,include_descendant_details:o}=e;return{url:"/plus/discovery-monitor/".concat(n,"/tree"),params:{staged_resource_urn:s,include_descendant_details:o,page:t,size:r}}}}),getMonitorTreeAncestorsStatuses:e.query({query:e=>{let{monitor_config_id:t,staged_resource_urn:r}=e;return{url:"/plus/discovery-monitor/".concat(t,"/tree/ancestors-statuses"),params:{staged_resource_urn:r}}}}),getDiscoveredSystemAggregate:e.query({query:e=>{let{key:t,resolved_system_id:r,page:n=1,size:s=20,search:o,diff_status:i}=e;return{url:"/plus/discovery-monitor/system-aggregate-results",params:{monitor_config_id:t,resolved_system_id:r,page:n,size:s,search:o,diff_status:i}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredAssets:e.query({query:e=>{let{key:t,system:r,page:n=1,size:a=20,search:u,diff_status:c=[o.LL.ADDITION],sort_by:l=[i.r6.NAME],sort_asc:d=!0,resource_type:m,data_uses:y,locations:v,consent_aggregated:g}=e,T=Array.isArray(l)?l:[l],p=(0,s.$J)({sort_by:T,resource_type:m,data_uses:y,locations:v,consent_aggregated:g});return{url:"/plus/discovery-monitor/".concat(t,"/results?").concat(p.toString()),params:{resolved_system_id:r,page:n,size:a,search:u,diff_status:c,sort_asc:d}}},providesTags:()=>["Discovery Monitor Results"]}),addMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:r}=e,n=(0,s.du)(r,"resolved_system_ids");return{url:"/plus/discovery-monitor/".concat(t,"/promote"),method:"POST",params:n?new URLSearchParams(n):new URLSearchParams}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:r}=e,n=(0,s.du)(r,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/mute?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),addMonitorResultAssets:e.mutation({query:e=>{var t;let r=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>r.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/promote?".concat(r)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultAssets:e.mutation({query:e=>({method:"POST",url:"/plus/discovery-monitor/mute",body:{staged_resource_urns:e.urnList}}),invalidatesTags:["Discovery Monitor Results","Monitor Field Results","Monitor Field Details"]}),restoreMonitorResultAssets:e.mutation({query:e=>{var t;let r=new URLSearchParams({status_to_set:o.LL.ADDITION});return null===(t=e.urnList)||void 0===t||t.forEach(e=>r.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/un-mute?".concat(r)}},invalidatesTags:["Discovery Monitor Results"]}),updateAssetsSystem:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_system_key:e.systemKey}))}),invalidatesTags:["Discovery Monitor Results","System Assets"]}),updateAssetsDataUse:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_data_uses:e.dataUses}))}),invalidatesTags:["Discovery Monitor Results"]}),updateAssets:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.assets}),invalidatesTags:["Discovery Monitor Results"]}),getConsentBreakdown:e.query({query:e=>{let{stagedResourceUrn:t,statuses:r,page:n=1,size:s=20}=e,o=new URLSearchParams;return o.append("page",String(n)),o.append("size",String(s)),r.forEach(e=>{o.append("status",e)}),{url:"/plus/discovery-monitor/staged_resource/".concat(encodeURIComponent(t),"/consent"),params:o}}}),getStagedResourceDetails:e.query({query:e=>{let{stagedResourceUrn:t}=e;return{url:"/plus/discovery-monitor/staged_resource/".concat(t?encodeURIComponent(t):"")}},providesTags:["Monitor Field Details"]}),getWebsiteMonitorResourceFilters:e.query({query:e=>{let{monitor_config_id:t,resolved_system_id:r,diff_status:n=[o.LL.ADDITION],search:i,resource_type:a,data_uses:u,locations:c,consent_aggregated:l}=e,d={monitor_config_id:t,resolved_system_id:r,diff_status:n};i&&(d.search=i);let m=(0,s.$J)({resource_type:a,data_uses:u,locations:c,consent_aggregated:l}).toString();return{url:m?"/plus/filters/website_monitor_resources?".concat(m):"/plus/filters/website_monitor_resources",params:d}},providesTags:["Discovery Monitor Results"]}),getInProgressMonitorTasks:e.query({query:e=>{let{page:t=1,size:r=20,search:n,task_types:s,statuses:o,return_dismissed:i=!1}=e,a=new URLSearchParams({page:t.toString(),size:r.toString(),return_dismissed:i.toString()});return n&&a.append("search",n),(null==s?void 0:s.length)&&s.forEach(e=>a.append("action_type",e)),(null==o?void 0:o.length)&&o.forEach(e=>a.append("status",e)),{url:"/plus/discovery-monitor/tasks?".concat(a.toString())}},providesTags:["Monitor Tasks"]}),retryMonitorTask:e.mutation({query:e=>{let{taskId:t}=e;return{url:"/plus/discovery-monitor/tasks/".concat(t,"/retry"),method:"POST"}},invalidatesTags:["Monitor Tasks"]}),dismissMonitorTask:e.mutation({query:e=>{let{taskId:t}=e;return{url:"/plus/discovery-monitor/tasks/".concat(t,"/dismissed"),method:"POST"}},invalidatesTags:["Monitor Tasks"]}),undismissMonitorTask:e.mutation({query:e=>{let{taskId:t}=e;return{url:"/plus/discovery-monitor/tasks/".concat(t,"/dismissed"),method:"DELETE"}},invalidatesTags:["Monitor Tasks"]}),classifyStagedResources:e.mutation({query:e=>{let{monitor_config_key:t,...r}=e;return{url:"/plus/discovery-monitor/".concat(t,"/classify"),method:"POST",body:r}},invalidatesTags:["Monitor Field Results","Monitor Field Details","Discovery Monitor Results"]}),promoteRemovalStagedResources:e.mutation({query:e=>{let{monitor_config_key:t,...r}=e;return{url:"/plus/discovery-monitor/".concat(t,"/promote-removal"),method:"POST",body:r}},invalidatesTags:["Monitor Field Results","Monitor Field Details"]})})})},98145:function(e,t,r){r.d(t,{$Q:function(){return M},EI:function(){return l},EP:function(){return f},H6:function(){return E},LM:function(){return p},Lh:function(){return O},Qk:function(){return m},Vq:function(){return T},X1:function(){return g},bE:function(){return A},bI:function(){return d},hc:function(){return h},oq:function(){return S},r6:function(){return u},sv:function(){return R},v8:function(){return _},vQ:function(){return c}});var n,s,o,i,a,u,c,l,d,m,y=r(60240),v=r(88708);let g={[y.lg.WITH_CONSENT]:"Consent respected",[y.lg.WITHOUT_CONSENT]:"Consent ignored",[y.lg.EXEMPT]:"Exempt",[y.lg.UNKNOWN]:"Unknown",[y.lg.PRE_CONSENT]:"Pre-Consent",[y.lg.CMP_ERROR]:"CMP failure",[y.lg.NOT_APPLICABLE]:"Not applicable"},T={[y.lg.WITH_CONSENT]:"Asset was detected after the user gave consent",[y.lg.WITHOUT_CONSENT]:"The user explicitly opted out, but this asset still loaded. This is a serious compliance issue and may indicate that consent settings are not being enforced.",[y.lg.EXEMPT]:"Asset is valid regardless of consent",[y.lg.UNKNOWN]:"Did not find consent information for this asset. You may need to re-run the monitor.",[y.lg.PRE_CONSENT]:"Assets loaded before the user had a chance to give consent. This violates opt-in compliance requirements if your CMP is configured for explicit consent.",[y.lg.CMP_ERROR]:"The Consent Management Platform (CMP) was not detected when the service ran. It likely failed to load or wasn't available.",[y.lg.NOT_APPLICABLE]:"No privacy notices apply to this asset"},p=[y.lg.WITHOUT_CONSENT,y.lg.PRE_CONSENT,y.lg.CMP_ERROR];(n=u||(u={})).NAME="name",n.RESOURCE_TYPE="resource_type",n.SYSTEM="system",n.DATA_USES="data_uses",n.LOCATIONS="locations",n.DOMAIN="domain",n.PAGE="page",n.CONSENT_AGGREGATED="consent_aggregated",n.ACTIONS="actions",(s=c||(c={})).SYSTEM_NAME="system_name",s.TOTAL_UPDATES="total_updates",s.DATA_USE="data_use",s.LOCATIONS="locations",s.DOMAINS="domains",s.ACTIONS="actions",(o=l||(l={})).LOCATION="location",o.PAGE="page",o.STATUS="status";let f=["classified_low_confidence","classified_medium_confidence","classified_high_confidence"],_=new Map([["cookie",["Cookie","Cookies"]],["browser_request",["Browser request","Browser requests"]],["image",["Image","Images"]],["iframe",["iFrame","iFrames"]],["javascript_tag",["JavaScript tag","JavaScript tags"]],["unlabeled",["Unlabeled","Unlabeled"]],["in_review",["Classified","Classified"]],["classifying",["Classifying","Classifying"]],["removals",["Removal","Removals"]],["reviewed",["Reviewed","Reviewed"]]]),E=["cookie","image","javascript_tag","iframe","browser_request","unlabeled","classifying","in_review","reviewed","removals"];(i=d||(d={})).HIGH="High confidence",i.MEDIUM="Medium confidence",i.LOW="Low confidence",(a=m||(m={})).ADD="add",a.IGNORE="ignore",a.RESTORE="restore";let h=[{key:v.A.ATTENTION_REQUIRED,label:"Attention required"},{key:v.A.ADDED,label:"Activity"},{key:v.A.IGNORED,label:"Ignored"}],R=["all","new","active","inactive","known","unknown","removed"],A={all:"All apps",new:"New apps",active:"Active",inactive:"Inactive",known:"Known Vendors",unknown:"Unknown Vendors",removed:"Removed"},S={STATUS:"status-section",VENDOR:"vendor-section"},M=e=>{switch(e){case"new":return y.LL.ADDITION;case"removed":return y.LL.REMOVAL;default:return null}},O=e=>{switch(e){case"active":return"ACTIVE";case"inactive":return"INACTIVE";default:return null}}},88708:function(e,t,r){r.d(t,{A:function(){return s}});var n,s,o=r(27378),i=r(14908),a=r(60240);(n=s||(s={})).ATTENTION_REQUIRED="attention-required",n.ADDED="added",n.IGNORED="ignored",t.Z=e=>{let{activeTab:t,onTabChange:r}=(0,i.Z)({tabKeys:Object.values(s)}),n=(0,o.useMemo)(()=>[{label:"Attention required",params:{diff_status:[a.LL.ADDITION],system:e},hash:"attention-required"},{label:"Added",params:{diff_status:[a.LL.MONITORED]},hash:"added"},{label:"Ignored",params:{diff_status:[a.LL.MUTED],system:e},hash:"ignored"}],[e]),{diff_status:u,system:c}=(0,o.useMemo)(()=>{var e;return null!==(e=n.find(e=>e.hash===t))&&void 0!==e?e:n[0]},[n,t]).params,l=(0,o.useMemo)(()=>u.includes(a.LL.MONITORED),[u]);return{filterTabs:n,activeTab:t,onTabChange:r,activeParams:(0,o.useMemo)(()=>e?{diff_status:u,system:c}:{diff_status:u},[e,u,c]),actionsDisabled:l}}},71985:function(e,t,r){r.d(t,{G:function(){return i},w:function(){return s}});var n,s,o=r(60240);(n=s||(s={})).WEBSITE="website",n.DATASTORE="datastore",n.INFRASTRUCTURE="infrastructure";let i=e=>e===o.Rj.WEBSITE||e===o.Rj.TEST_WEBSITE?"website":e===o.Rj.OKTA?"infrastructure":"datastore"}}]);