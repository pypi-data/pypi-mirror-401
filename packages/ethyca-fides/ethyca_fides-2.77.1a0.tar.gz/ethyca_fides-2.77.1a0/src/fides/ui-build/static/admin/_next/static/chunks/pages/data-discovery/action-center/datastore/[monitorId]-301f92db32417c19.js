(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6721],{58095:function(e,t,r){var n=r(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,r){for(var n=-1,l=null==e?0:e.length;++n<l;)if(r(t,e[n]))return!0;return!1}},95372:function(e){e.exports=function(e,t,r,n){for(var l=e.length,a=r+(n?1:-1);n?a--:++a<l;)if(t(e[a],a,e))return a;return -1}},8817:function(e,t,r){var n=r(95372),l=r(1129),a=r(58263);e.exports=function(e,t,r){return t==t?a(e,t,r):n(e,l,r)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,r){var n=r(52485),l=r(58095),a=r(21796),i=r(65581),o=r(47111),s=r(43735);e.exports=function(e,t,r){var c=-1,d=l,u=e.length,p=!0,f=[],h=f;if(r)p=!1,d=a;else if(u>=200){var y=t?null:o(e);if(y)return s(y);p=!1,d=i,h=new n}else h=t?[]:f;e:for(;++c<u;){var m=e[c],g=t?t(m):m;if(m=r||0!==m?m:0,p&&g==g){for(var v=h.length;v--;)if(h[v]===g)continue e;t&&h.push(g),f.push(m)}else d(h,g,r)||(h!==f&&h.push(g),f.push(m))}return f}},56632:function(e,t,r){var n=r(89278),l=r(80068),a=r(50098);e.exports=function(e){return function(t,r,i){var o=Object(t);if(!l(t)){var s=n(r,3);t=a(t),r=function(e){return s(o[e],e,o)}}var c=e(t,r,i);return c>-1?o[s?t[c]:c]:void 0}}},47111:function(e,t,r){var n=r(46151),l=r(50344),a=r(43735),i=n&&1/a(new n([,-0]))[1]==1/0?function(e){return new n(e)}:l;e.exports=i},58263:function(e){e.exports=function(e,t,r){for(var n=r-1,l=e.length;++n<l;)if(e[n]===t)return n;return -1}},64925:function(e,t,r){var n=r(56632)(r(66259));e.exports=n},66259:function(e,t,r){var n=r(95372),l=r(89278),a=r(47991),i=Math.max;e.exports=function(e,t,r){var o=null==e?0:e.length;if(!o)return -1;var s=null==r?0:a(r);return s<0&&(s=i(o+s,0)),n(e,l(t,3),s)}},50344:function(e){e.exports=function(){}},94919:function(e,t,r){var n=r(91936),l=1/0;e.exports=function(e){return e?(e=n(e))===l||e===-l?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}},47991:function(e,t,r){var n=r(94919);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},83766:function(e,t,r){var n=r(92198);e.exports=function(e){return e&&e.length?n(e):[]}},83806:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/datastore/[monitorId]",function(){return r(73662)}])},20987:function(e,t,r){"use strict";var n,l,a,i;r.d(t,{H:function(){return n},J:function(){return l}}),(a=n||(n={})).STRING="string",a.STRING_ARRAY="string[]",(i=l||(l={})).SYSTEM="system",i.DATA_USE="data use",i.DATA_CATEGORY="data category",i.DATA_SUBJECT="data subject",i.PRIVACY_DECLARATION="privacy declaration"},12627:function(e,t,r){"use strict";var n=r(24246),l=r(79283),a=r(34929);t.Z=e=>{let{selectedTaxonomies:t,showDisabled:r=!1,...i}=e,{getDataCategoryDisplayNameProps:o,getDataCategories:s}=(0,a.Z)(),c=(r?s():s().filter(e=>e.active)).filter(e=>!(null==t?void 0:t.includes(e.fides_key))).map(e=>{let{name:t,primaryName:r}=o(e.fides_key);return{value:e.fides_key,name:t,primaryName:r,description:e.description||"",label:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("strong",{children:r||t}),r&&": ".concat(t)]}),title:e.fides_key}});return(0,n.jsx)(l.l,{options:c,...i})}},79283:function(e,t,r){"use strict";r.d(t,{l:function(){return d}});var n=r(24246),l=r(41725),a=r(72707),i=r.n(a);let o=e=>{let{data:{formattedTitle:t,description:r,name:a,primaryName:i}}=e;return(0,n.jsxs)(l.kCb,{gap:12,title:"".concat(t," - ").concat(r),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:i||a}),i&&": ".concat(a)]}),(0,n.jsx)("em",{className:"overflow-hidden text-ellipsis",children:r})]})},s=e=>"options"in e&&Array.isArray(e.options),c=e=>({...e,className:i().option,formattedTitle:e.formattedTitle||[e.primaryName,e.name].filter(e=>e).join(": ")}),d=e=>{let{options:t,...r}=e,a=null==t?void 0:t.map(e=>s(e)?{...e,options:e.options.map(c)}:c(e));return(0,n.jsx)(l.PhF,{options:a,filterOption:(e,t)=>{var r,n;return(null==t?void 0:null===(r=t.formattedTitle)||void 0===r?void 0:r.toLowerCase().includes(e.toLowerCase()))||(null==t?void 0:null===(n=t.value)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase()))||!1},optionFilterProp:"label",autoFocus:!0,variant:"borderless",optionRender:o,styles:{popup:{root:{minWidth:"500px"}}},className:"w-full p-0","data-testid":"taxonomy-select",...r})}},34929:function(e,t,r){"use strict";var n=r(24246),l=r(64925),a=r.n(l),i=r(27378),o=r(16134),s=r(30002),c=r(28079),d=r(57072);let u=()=>{let{isLoading:e}=(0,c.fd)(),t=(0,o.C)(c.U3),{isLoading:r}=(0,d.MO)(),n=(0,o.C)(d.qb),{isLoading:l}=(0,s.te)();return{dataUses:t,dataSubjects:(0,o.C)(s.ZL),dataCategories:n,isLoading:e||r||l}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:r,isLoading:l}=u(),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},s=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t(e);if(!n)return{};let l=t(o(e,r)),a=!!n.parent_key;return{name:n.name||void 0,primaryName:a&&(null==l?void 0:l.name)!==n.name&&(null==l?void 0:l.name)||void 0}},c=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:l,primaryName:a}=s(e,t,r);return l?a?(0,n.jsxs)(i.Fragment,{children:[(0,n.jsxs)("strong",{children:[a,":"]})," ",l]},e):(0,n.jsx)("strong",{children:l},e):e},d=t=>a()(e,{fides_key:t}),p=e=>a()(t,{fides_key:e}),f=e=>a()(r,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:d,getDataUseDisplayName:e=>c(e,d,1),getDataUseDisplayNameProps:e=>s(e,d,1),getDataCategories:()=>t,getDataCategoryByKey:p,getDataCategoryDisplayName:e=>c(e,p,2),getDataCategoryDisplayNameProps:e=>s(e,p,2),getDataSubjects:()=>r,getDataSubjectByKey:f,getDataSubjectDisplayName:e=>{let t=f(e);return t?t.name:e},getDataSubjectDisplayNameProps:e=>{let t=f(e);return t?{name:t.name||e}:{}},getPrimaryKey:o,isLoading:l}}},84418:function(e,t,r){"use strict";r.d(t,{d:function(){return c}});var n=r(24246),l=r(41725),a=r(98784),i=r.n(a);let o=e=>{let{itemKey:t,actions:r}=e;return i().isEmpty(r)?null:(0,n.jsx)(l.kCb,{gap:"small",justify:"flex-end",children:r.map((e,a)=>{let{callback:i,label:o,disabled:s}=e;return(0,n.jsx)(l.zxk,{onClick:()=>i(t),type:a===r.length-1?"primary":"default",disabled:s,children:o},o)})})},s=e=>{let{title:t,titleIcon:r,titleTag:a}=e;return(0,n.jsxs)(l.kCb,{align:"center",gap:"small",children:[r,(0,n.jsx)("span",{children:t}),a&&(0,n.jsx)(l.Vp9,{...a})]})},c=e=>{let{title:t,titleIcon:r,titleTag:a,actions:i,width:c=480,...d}=e;return(0,n.jsx)(l.dys,{title:(0,n.jsx)(s,{title:t,titleIcon:r,titleTag:a}),footer:d.footer||!i?d.footer:(0,n.jsx)(o,{itemKey:d.itemKey,actions:i}),width:c,...d})}},59001:function(e,t,r){"use strict";r.d(t,{Ch:function(){return s},Lo:function(){return i},_g:function(){return c},ac:function(){return a},aq:function(){return d}});var n,l,a,i,o=r(60240);let s="root";(n=a||(a={})).DATA_CATEGORY="data_category",n.DATA_USE="data_use",n.DATA_SUBJECT="data_subject",n.SYSTEM_GROUP="system_group",(l=i||(i={})).DATA_CATEGORIES="Data categories",l.DATA_USES="Data uses",l.DATA_SUBJECTS="Data subjects",l.SYSTEM_GROUPS="System groups";let c=e=>{switch(e){case"data_category":return"Data categories";case"data_use":return"Data uses";case"data_subject":return"Data subjects";case"system_group":return"System groups";default:return e}},d=e=>{switch(e){case"data_category":return{UPDATE:o.Sh.DATA_CATEGORY_UPDATE,CREATE:o.Sh.DATA_CATEGORY_CREATE,DELETE:o.Sh.DATA_CATEGORY_DELETE,READ:o.Sh.DATA_CATEGORY_READ};case"data_use":return{UPDATE:o.Sh.DATA_USE_UPDATE,CREATE:o.Sh.DATA_USE_CREATE,DELETE:o.Sh.DATA_USE_DELETE,READ:o.Sh.DATA_USE_READ};case"data_subject":return{UPDATE:o.Sh.DATA_SUBJECT_UPDATE,CREATE:o.Sh.DATA_SUBJECT_CREATE,DELETE:o.Sh.DATA_SUBJECT_DELETE,READ:o.Sh.DATA_SUBJECT_READ};case"system_group":return{UPDATE:o.Sh.SYSTEM_GROUP_UPDATE,CREATE:o.Sh.SYSTEM_GROUP_CREATE,DELETE:o.Sh.SYSTEM_GROUP_DELETE,READ:o.Sh.SYSTEM_GROUP_READ};default:return{UPDATE:o.Sh.TAXONOMY_UPDATE,CREATE:o.Sh.TAXONOMY_CREATE,DELETE:o.Sh.TAXONOMY_DELETE,READ:o.Sh.TAXONOMY_READ}}}},90673:function(e,t,r){"use strict";r.d(t,{Cd:function(){return a},Xl:function(){return i}});var n=r(20987),l=r(59001);let a=(e,t)=>{let r;if(null==t&&e.every(e=>void 0===e.parent_key))r=e;else{let n=null!=t?t:null;r=e.filter(e=>e.parent_key===n)}return r.map(t=>{var r,n;let l=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:a(e,l),is_default:null!==(r=t.is_default)&&void 0!==r&&r,active:null!==(n=t.active)&&void 0!==n&&n}})},i=e=>{switch(e){case l.ac.DATA_CATEGORY:return n.J.DATA_CATEGORY;case l.ac.DATA_SUBJECT:return n.J.DATA_SUBJECT;case l.ac.DATA_USE:return n.J.DATA_USE;default:return e}}},57072:function(e,t,r){"use strict";r.d(t,{Bd:function(){return n.Bd},L5:function(){return n.L5},MO:function(){return n.MO},qb:function(){return n.qb}});var n=r(5785)},39864:function(e,t,r){"use strict";r.d(t,{Cy:function(){return o},EO:function(){return u},Hb:function(){return c},J1:function(){return i},Jy:function(){return l},Km:function(){return d},MU:function(){return n},ci:function(){return a},d9:function(){return s},jW:function(){return p}});let{useGetCustomTaxonomiesQuery:n,useGetTaxonomyQuery:l,useLazyGetTaxonomyQuery:a,useCreateTaxonomyMutation:i,useUpdateTaxonomyMutation:o,useDeleteTaxonomyMutation:s,useCreateCustomTaxonomyMutation:c,useUpdateCustomTaxonomyMutation:d,useDeleteCustomTaxonomyMutation:u,useGetTaxonomyHistoryQuery:p}=r(78780).u.injectEndpoints({endpoints:e=>({getTaxonomy:e.query({query:e=>({url:"taxonomies/".concat(e,"/elements")}),providesTags:(e,t,r)=>[{type:"Taxonomy",id:r}],transformResponse:e=>{let t=[],r=[...e],n=r.filter(e=>null===e.parent_key);n.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)),t.push(...n);let l=r.filter(e=>null!==e.parent_key);for(;l.length>0;){let e=l.filter(e=>t.some(t=>t.fides_key===e.parent_key));if(0===e.length){t.push(...l.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)));break}e.sort((e,t)=>e.fides_key.localeCompare(t.fides_key)),t.push(...e),l=l.filter(t=>!e.includes(t))}return t}}),getCustomTaxonomies:e.query({query:()=>({url:"taxonomies"}),providesTags:()=>[{type:"Taxonomy"}]}),createTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,...r}=e;return{url:"taxonomies/".concat(t,"/elements"),method:"POST",body:r}},invalidatesTags:(e,t,r)=>{let{taxonomyType:n}=r;return[{type:"Taxonomy",id:n},{type:"Taxonomy History",id:n}]}}),updateTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,...r}=e;return{url:"taxonomies/".concat(t,"/elements/").concat(r.fides_key),method:"PUT",body:r}},invalidatesTags:(e,t,r)=>{let{taxonomyType:n}=r;return[{type:"Taxonomy",id:n},{type:"Taxonomy History",id:n}]}}),deleteTaxonomy:e.mutation({query:e=>{let{taxonomyType:t,key:r}=e;return{url:"taxonomies/".concat(t,"/elements/").concat(r),method:"DELETE"}},invalidatesTags:(e,t,r)=>{let{taxonomyType:n}=r;return[{type:"Taxonomy",id:n},{type:"Taxonomy History",id:n}]}}),createCustomTaxonomy:e.mutation({query:e=>({url:"taxonomies",method:"POST",body:e}),invalidatesTags:()=>[{type:"Taxonomy"}]}),updateCustomTaxonomy:e.mutation({query:e=>{let{fides_key:t,...r}=e;return{url:"taxonomies/".concat(t),method:"PUT",body:r}},invalidatesTags:(e,t,r)=>{let{fides_key:n}=r;return[{type:"Taxonomy"},{type:"Taxonomy History",id:n}]}}),deleteCustomTaxonomy:e.mutation({query:e=>({url:"taxonomies/".concat(e),method:"DELETE"}),invalidatesTags:()=>[{type:"Taxonomy"}]}),getTaxonomyHistory:e.query({query:e=>{let{fides_key:t,page:r,size:n}=e;return{url:"/plus/taxonomies/".concat(t,"/history"),params:{page:r,size:n}}},providesTags:(e,t,r)=>{let{fides_key:n}=r;return[{type:"Taxonomy History",id:n}]}})})})},73662:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return eV}});var n=r(24246),l=r(41725),a=r(25980),i=r(98784),o=r.n(i),s=r(79894),c=r.n(s),d=r(86677),u=r(27378),p=r(43929),f=r(30952),h=r(35287),y=r(17245),m=r(77830),g=r(58754),v=r(9270),_=r(37059),E=r(60240),T=r(62678),x=r(99824),A=r(26917);let b="space",S=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"inclusive",{activeListItem:n=null,enableKeyboardShortcuts:l=!1}=t,[a,i]=(0,u.useState)(r),[s,c]=(0,u.useState)([]),d=(e,t)=>{(("inclusive"===a?t:!t)?"add":"remove")=="add"?c([...s,e]):c(s.filter(t=>t!==e))},f=e=>{i(e),c([])},h=o().difference(e,s),y="inclusive"===a?s:h,m="exclusive"===a?s:h;return(0,p.y1)("h",()=>{f("exclusive")},{enabled:l}),(0,p.y1)("l",()=>{f("inclusive")},{enabled:l}),(0,p.y1)(b,e=>{if(n){e.preventDefault();let t=y.includes(n.key);d(n.key,!t)}},{enabled:l},[n,y,d]),{checkboxProps:{checked:"inclusive"===a?y.length>0&&(null==e?void 0:e.length)===y.length:0===m.length,indeterminate:"inclusive"===a?y.length>0&&(null==e?void 0:e.length)!==y.length:m.length>0,onChange:e=>f(e.target.checked?"exclusive":"inclusive")},excludedKeys:m,listSelectMode:a,resetListSelect:()=>{c([]),i("inclusive")},selectedKeys:y,updateListSelectMode:f,updateSelectedListItem:d}},k=e=>{let{...t}=e;return(0,n.jsx)(l.u_l,{title:"Keyboard shortcuts",footer:null,...t,children:(0,n.jsx)(l.w5n,{bordered:!0,column:1,items:[{key:"".concat(l.dHR.NAVIGATE_UP,"-").concat(l.dHR.NAVIGATE_DOWN),label:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:l.dHR.NAVIGATE_DOWN})," ","/"," ",(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:l.dHR.NAVIGATE_UP})]}),children:"Activate the next/previous field"},{key:b,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:b}),children:"Toggle checkbox of the active field"},{key:"h",label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:"h"}),children:"Select all fields"},{key:"l",label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:"l"}),children:"Deselect all fields"},{key:l.dHR.CLEAR_FOCUS,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:l.dHR.CLEAR_FOCUS}),children:"Clear the active field"},{key:x.b_.TOGGLE_DRAWER,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:x.b_.TOGGLE_DRAWER}),children:"Open/close details drawer for active field"},{key:x.b_.REVIEW,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:x.b_.REVIEW}),children:"Mark the active field as reviewed"},{key:x.b_.PROMOTE,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:x.b_.PROMOTE}),children:"Approve the active field"},{key:x.b_.MUTE,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:x.b_.MUTE}),children:"Ignore the active field"},{key:x.b_.UN_MUTE,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:x.b_.UN_MUTE}),children:"Restore the active field"},{key:x.b_.OPEN_CLASSIFICATION_SELECT,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:x.b_.OPEN_CLASSIFICATION_SELECT}),children:"Edit data categories for the active field"},{key:x.b_.REFRESH,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:x.b_.REFRESH}),children:"Refresh the list"},{key:x.b_.REFRESH,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:x.b_.REFRESH}),children:"Refresh the list"},{key:A.M,label:(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:"/"}),children:"Focus the search input"},{key:"?",label:(0,n.jsxs)("div",{className:"whitespace-nowrap",children:[(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:"?"})," (",(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:"shift"}),"+",(0,n.jsx)(l.Typography.Text,{keyboard:!0,children:"/"}),")"]}),children:"Open/close this modal"}]})})};var j=r(99089),C=r(83766),D=r.n(C),R=r(16394),O=r(59001),M=r(90673),L=r(39864),w=r(83158),N=r(3124),I=r.n(N);let U="load_more",P="skeleton",F=["Unlabeled","Classifying...","Classified","Reviewed","Approving...","Approved","Removed","Ignored","Error","Removing..."],z=["Approved","Ignored","Approving...","Removing..."],q=e=>e.filter(e=>!z.includes(e)),G={addition:{label:"Unlabeled"},reviewed:{label:"Reviewed",color:l.tAb.ALERT},classification_addition:{label:"Classified",color:l.tAb.CAUTION},classification_error:{label:"Error",color:l.tAb.ERROR},classification_queued:{label:"Classifying...",color:l.tAb.INFO},classification_update:{label:"Classified",color:l.tAb.CAUTION},classifying:{label:"Classifying...",color:l.tAb.INFO},monitored:{label:"Approved",color:l.tAb.SUCCESS},muted:{label:"Ignored",color:l.tAb.DEFAULT},promoting:{label:"Approving...",color:l.tAb.DEFAULT},promotion_error:{label:"Error",color:l.tAb.ERROR},removal:{label:"Removed",color:l.tAb.ERROR},removing:{label:"Removing...",color:l.tAb.DEFAULT},removal_promotion_error:{label:"Error",color:l.tAb.ERROR}},V={[E.D$.DATABASE]:l.PJP.S9g,[E.D$.FIELD]:l.PJP.sgG,[E.D$.SCHEMA]:l.PJP.ehp,[E.D$.TABLE]:l.PJP.iA_},Y={STATUS:"status-section",DATA_CATEGORY:"data-category-section",CONFIDENCE:"confidence-section"},H={[E.Ag.ADDITION]:{color:I().FIDESUI_SUCCESS,tooltip:"This resource was added in the latest scan"},[E.Ag.REMOVAL]:{color:I().FIDESUI_ERROR,tooltip:"This resource was removed in the latest scan"},[E.Ag.CHANGE]:{color:I().FIDESUI_WARNING,tooltip:"This resource was modified in the latest scan"}},$=[w.$.HIGH,w.$.MEDIUM,w.$.LOW,w.$.MANUAL],J=(e,t)=>{if(!e||0===e.length)return[];let r=(e,t)=>{let n=t=>{if(t.value===e)return{title:t.label||e,children:t.children||[]};if(t.children&&t.children.length>0){let n=r(e,t.children);if(n)return n}return null};return t.reduce((e,t)=>null!=e?e:n(t),null)},n=new Map;e.forEach(e=>{let l=e.split(".");l.forEach((e,a)=>{let i=l.slice(0,a+1).join(".");if(!n.has(i)){let e=r(i,t);n.set(i,{title:(null==e?void 0:e.title)||(0,R.kC)(i.split(".").pop()||i),key:i,checkable:!0,selectable:!1})}})});let l=Array.from(n.values()),a=new Map;l.forEach(e=>{let t=e.key.toString().split(".");if(t.length>1){let r=t.slice(0,-1).join(".");a.has(r)||a.set(r,[]),a.get(r).push(e)}});let i=e=>(a.get(e)||[]).map(e=>{let t=i(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}});return l.filter(e=>1===e.key.toString().split(".").length).map(e=>{let t=i(e.key.toString());return{...e,children:t.length>0?t:void 0,isLeaf:0===t.length}})},W=e=>{let{resourceStatus:t,setResourceStatus:r,dataCategory:a,confidenceBucket:i,setDataCategory:o,setConfidenceBucket:s,resetToInitialState:c,monitorId:d,stagedResourceUrn:p}=e,[f,h]=(0,u.useState)(t),[y,m]=(0,u.useState)(a),[g,v]=(0,u.useState)(i),[E,T]=(0,u.useState)([Y.STATUS]);(0,u.useEffect)(()=>{h(t)},[t]),(0,u.useEffect)(()=>{v(i)},[i]),(0,u.useEffect)(()=>{m(a)},[a]);let x=p.join(","),A=(0,u.useRef)(!0);(0,u.useEffect)(()=>{if(A.current){A.current=!1;return}c()},[x]);let{data:b,refetch:S}=(0,_.S0)({monitor_config_id:d,staged_resource_urn:p},{refetchOnMountOrArgChange:!0}),[k,{data:j=[]}]=(0,L.ci)();(0,u.useEffect)(()=>{k(O.ac.DATA_CATEGORY)},[k]);let C=(0,u.useMemo)(()=>(0,M.Cd)(j),[j]),N=$.filter(e=>{var t;return null==b?void 0:null===(t=b.confidence_bucket)||void 0===t?void 0:t.includes(e)}),I=(0,u.useMemo)(()=>F.map(e=>({title:e.replace(/\.{3}$/,""),key:e,checkable:!0,selectable:!1,isLeaf:!0})),[]),U=(0,u.useMemo)(()=>(null==b?void 0:b.data_category)&&0!==b.data_category.length?J(b.data_category,C):[],[null==b?void 0:b.data_category,C]),P=[...I.length>0?[{title:"Status",key:Y.STATUS,checkable:!0,selectable:!1,isLeaf:!1,children:I}]:[],...N.length>0?[{title:"Confidence",key:Y.CONFIDENCE,checkable:!0,selectable:!1,isLeaf:!1,children:N.map(e=>({title:(0,R.kC)(e),key:e,checkable:!0,selectable:!1,isLeaf:!0}))}]:[],...U.length>0?[{title:"Data category",key:Y.DATA_CATEGORY,checkable:!0,selectable:!1,isLeaf:!1,children:U}]:[]],z=(0,u.useMemo)(()=>D()([...null!=f?f:[],...null!=y?y:[],...null!=g?g:[]]),[f,y,g]),G=(0,u.useMemo)(()=>{let e=0;return t&&(e+=new Set(t).size),a&&(e+=new Set(a).size),i&&(e+=new Set(i).size),e},[t,a,i]);return(0,n.jsx)(l.wn$,{treeProps:{checkable:!0,checkedKeys:z,onCheck:e=>{let t=Array.isArray(e)?e:e.checked,r=[],n=[],l=[],a=Object.values(Y),i=(e,t)=>t.some(t=>t!==e&&t.startsWith("".concat(e,"."))),o=t.map(e=>e.toString());t.forEach(e=>{let t=e.toString();if(a.some(e=>e===t))return;let s=F.find(e=>e===t),c=Object.values(w.$).find(e=>e===t);s?r.push(s):c?n.push(c):i(t,o)||l.push(t)}),h(r.length>0?r:[]),m(l.length>0?l:[]),v(n.length>0?n:[])},treeData:P,expandedKeys:E,onExpand:e=>{T(e)}},onApply:()=>{r(f&&f.length>0?Array.from(new Set(f)):f),o(y&&y.length>0?Array.from(new Set(y)):y),s(g&&g.length>0?Array.from(new Set(g)):g)},onReset:()=>{c(),h(q([...F])),v([]),m([])},onClear:()=>{h([]),v([]),m([])},onOpenChange:e=>{if(e){S();return}h(t),v(i),m(a)},activeFiltersCount:G})};var B=r(9110);let K=e=>{switch(e){case 1:return E.D$.DATABASE;case 2:return E.D$.SCHEMA;case 3:return E.D$.TABLE;default:return E.D$.FIELD}},Z=e=>{if(!e||"string"!=typeof e)return[];let t=e.trim();if(!t)return[];let r=t.split(".");if(r.length<2)return[];let n=r.filter(e=>e&&e.trim().length>0);return n.length<2?[]:(n.shift(),n.length>0&&n.pop(),0===n.length)?[]:n.map((e,t)=>{let r=V[K(t+1)];return{title:e.trim(),IconComponent:r}})};var Q=r(79283),X=r(34929),ee=e=>{let{onSelectDataCategory:t,urn:r,...a}=e,{getDataCategoryDisplayNameProps:i,getDataCategories:o}=(0,X.Z)(),s=o().filter(e=>e.active),[c,d]=(0,u.useState)(!1),p=s.map(e=>{let{name:t,primaryName:r}=i(e.fides_key);return{value:e.fides_key,label:(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:r||t}),r&&": ".concat(t)]}),name:t,primaryName:r,description:e.description||""}});return(0,n.jsx)(Q.l,{options:p,prefix:(0,n.jsx)(l.zxk,{"aria-label":"Add Data Category",type:"text",size:"small",icon:(0,n.jsx)(l.PJP.mm_,{}),disabled:a.disabled}),placeholder:"",suffixIcon:null,classNames:{root:"w-full max-w-full overflow-hidden p-0 cursor-pointer -ml-5"},style:{"--ant-select-multiple-selector-bg-disabled":"transparent"},variant:"borderless",autoFocus:!1,maxTagCount:"responsive",open:c,onOpenChange:e=>d(e),onSelect:e=>{t(e),d(!1)},"data-classification-select":r,popupMatchSelectWidth:600,...a})},et=r(97947),er=r.n(et),en=r(63537);let el=e=>{let{label:t,closable:r,onClose:a,isFromClassifier:i}=e;return(0,n.jsx)(l.Vp9,{color:"white",bordered:!0,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},closable:r,onClose:a,style:{marginInlineEnd:"calc((var(--ant-padding-xs) * 0.5))"},icon:i&&(0,n.jsx)(l.QMR,{}),children:(0,n.jsx)(l.xvT,{size:"sm",children:t})})},ea=e=>{let{title:t,IconComponent:r}=e;return{title:r?(0,n.jsxs)(l.kCb,{gap:3,align:"center",children:[(0,n.jsx)(r,{}),(0,n.jsx)("span",{children:t})]}):t}};var ei=e=>{let{urn:t,name:r,diff_status:a,selected:i,onSelect:s,onSetDataCategories:c,dataCategoriesDisabled:d,onNavigate:u,actions:p,classifications:f,...h}=e,y="preferred_data_categories"in h?h.preferred_data_categories:[],m=o()(null==f?void 0:f.flatMap(e=>{let{confidence_bucket:t}=e,r=t?(0,en.Oq)(t):void 0;return r?[r]:[]})).thru(en.io).value();return(0,n.jsx)(l.aVo.Item,{actions:[m&&(0,n.jsx)(B.D,{severity:m,className:"mr-2"}),...null!=p?p:[]],children:(0,n.jsx)(l.aVo.Item.Meta,{avatar:(0,n.jsx)("div",{className:"ml-2",children:(0,n.jsx)(l.XZJ,{checked:i,onChange:e=>s&&s(t,e.target.checked)})}),title:(0,n.jsxs)(l.kCb,{gap:12,align:"center",className:er()["monitor-field__title"],children:[(0,n.jsx)(l.zxk,{type:"text",size:"small",className:"-mx-2",onClick:()=>u&&u(t),children:r}),a&&a!==E.LL.ADDITION&&(0,n.jsx)(l.Vp9,{bordered:!1,color:G[a].color,children:G[a].label}),(0,n.jsx)(l.ua7,{title:t,mouseEnterDelay:.5,children:(0,n.jsx)(l.aGc,{className:er()["monitor-field__breadcrumb"],items:Z(t).map(ea),role:"presentation",style:{overflow:"hidden"}})})]}),description:(0,n.jsx)(ee,{mode:"multiple",value:null!=y?y:[],urn:t,tagRender:e=>{let r=!!(null==f?void 0:f.find(t=>t.label===e.value));return el({...e,isFromClassifier:r,onClose:()=>{var r;c(t,null!==(r=null==y?void 0:y.filter(t=>t!==e.value))&&void 0!==r?r:[])}})},onSelectDataCategory:e=>{(null==y?void 0:y.includes(e))||c(t,[...null!=y?y:[],e])},disabled:d})})},t)},eo=r(812),es=r(32500),ec=r.n(es);let ed=(e,t)=>e.find(e=>{let{children:r}=e;return r&&!!r.find(e=>e.key.toString()===t)}),eu=(e,t)=>{var r;return null!==(r=ed(e,t))&&void 0!==r?r:e.reduce((e,r)=>{if(r.children){var n;return null!==(n=ed(r.children,t))&&void 0!==n?n:eu(r.children,t)}return e},null)},ep=e=>{let{node:t,treeData:r,onLoadMore:a,actions:i}=e;if(!t.title)return null;if(t.key.toString().startsWith(U)){let e=eu(r,t.key.toString());return(0,n.jsx)(l.zxk,{type:"link",block:!0,onClick:()=>{(null==e?void 0:e.key)&&a(e.key.toString())},className:"p-0",children:t.title})}if(t.key.toString().startsWith(P))return(0,n.jsx)(l.OdW,{paragraph:!1,title:{width:"80px"},active:!0,children:t.title});let o=t.diffStatus===E.LL.MUTED;return(0,n.jsxs)(l.kCb,{gap:4,align:"center",className:"group ml-1 flex grow ".concat(o?"opacity-40":""),"aria-label":o?"".concat(t.title," (ignored)"):void 0,children:[(0,n.jsx)(l.xvT,{ellipsis:{tooltip:t.title},className:"grow select-none",children:t.title}),(0,n.jsx)(l.Ltx,{menu:{items:i?Object.entries(i).map(e=>{let[r,{disabled:n,...l}]=e;return{key:r,disabled:n([t]),...l}}):[],onClick:e=>{var r;let{key:n,domEvent:l}=e;l.preventDefault(),l.stopPropagation(),null===(r=i[n])||void 0===r||r.callback([t.key],[t])}},destroyOnHidden:!0,className:"group mr-1 flex-none group-[.multi-select]/monitor-tree:pointer-events-none group-[.multi-select]/monitor-tree:opacity-0",children:(0,n.jsx)(l.zxk,{"aria-label":"Show More Resource Actions",icon:(0,n.jsx)(l.PJP.r43,{className:"opacity-0 group-hover:opacity-100 group-[.ant-dropdown-open]:opacity-100"}),type:"text",size:"small",className:"self-end"})})]})},ef=(e,t,r,n)=>e.map(e=>e.key===t?{...e,status:r,diffStatus:n}:e.children?{...e,children:ef(e.children,t,r,n)}:e),eh=(e,t)=>e.map(e=>{if(e.key===t){let{children:t,...r}=e;return r}return e.children?{...e,children:eh(e.children,t)}:e}),ey=e=>{let t=[];return e.children&&e.children.length>0&&e.children.forEach(e=>{"string"==typeof e.key&&(t.push(e.key),t.push(...ey(e)))}),t},em=(e,t)=>{for(let r of e){if(r.key===t)return r;if(r.children){let e=em(r.children,t);if(e)return e}}},eg=e=>!!e.update_status&&e.diff_status!==E.LL.MUTED,ev=(e,t)=>{var r;let a=e.items.map(e=>{let t=e.resource_type?V[e.resource_type]:void 0,r=e.update_status?H[e.update_status]:void 0;return{title:e.name,key:e.urn,selectable:!0,icon:t?()=>(0,n.jsx)(l.ua7,{title:null==r?void 0:r.tooltip,children:(0,n.jsx)(l.Cts,{className:"h-full",offset:[0,5],color:null==r?void 0:r.color,dot:eg(e),children:(0,n.jsx)(t,{className:"h-full"})})}):void 0,status:e.update_status,diffStatus:e.diff_status,isLeaf:e.resource_type===E.D$.FIELD||!e.has_grandchildren,classifyable:[E.D$.SCHEMA,E.D$.TABLE,E.D$.ENDPOINT,E.D$.FIELD].includes(e.resource_type)}});return(null!==(r=null==a?void 0:a.length)&&void 0!==r?r:0)<100?a:[...a,{title:"Load more...",key:"".concat(U,"-").concat(e.page,"-").concat(t),selectable:!1,isLeaf:!0}]},e_=(e,t,r)=>e.map(e=>{if(e.key===t){var n,l;return{...e,children:[...null!==(l=null===(n=e.children)||void 0===n?void 0:n.filter(e=>!(e.key.toString().startsWith(U)||e.key.toString().startsWith(P))))&&void 0!==l?l:[],...r]}}return e.children?{...e,children:e_(e.children,t,r)}:e}),eE=(e,t,r)=>e.map(e=>e.key===t?{...e,children:r}:e.children?{...e,children:eE(e.children,t,r)}:e),eT=(e,t,r)=>e.map(e=>{if(e.key===t){var n;let t=(null!==(n=e.children)&&void 0!==n?n:[]).filter(e=>!(e.key.toString().startsWith(U)||e.key.toString().startsWith(P))),l=new Map(r.map(e=>[e.key,e])),a=new Map(t.map(e=>[e.key,e])),i=t.map(e=>{let t=l.get(e.key);return null!=t?t:e});return r.forEach(e=>{a.has(e.key)||i.push(e)}),{...e,children:i}}return e.children?{...e,children:eT(e.children,t,r)}:e}),ex=(0,u.forwardRef)((e,t)=>{let{setSelectedNodeKeys:r,selectedNodeKeys:a,nodeActions:i,primaryAction:o}=e,s=(0,d.useRouter)(),{errorAlert:c}=(0,y.VY)(),p=decodeURIComponent(s.query.monitorId),[f]=(0,_.RV)(),[h]=(0,_.M8)(),[m,g]=(0,u.useState)({}),[v,E]=(0,u.useState)([]),[T,x]=(0,u.useState)([]),A=(0,u.useRef)({}),b=(0,u.useRef)({}),S=(0,u.useCallback)(async e=>{var t;let{nodeKey:r,queryParams:n,fastUpdateFn:l,detailedUpdateFn:a}=e,i=(null!==(t=A.current[r])&&void 0!==t?t:0)+1;A.current[r]=i;let o=f({...n,include_descendant_details:!1}),s=f({...n,include_descendant_details:!0});o.then(e=>{let{data:t}=e;t&&A.current[r]===i&&b.current[r]!==i&&l(t)}),s.then(e=>{let{data:t}=e;t&&A.current[r]===i&&(b.current[r]=i,(null!=a?a:l)(t))})},[f]),k=(0,u.useCallback)(e=>new Promise(t=>{let{children:r,key:n}=e;if(r){t();return}let l=n.toString();S({nodeKey:l,queryParams:{monitor_config_id:p,staged_resource_urn:l,size:100},fastUpdateFn:e=>{E(t=>eE(t,n,ev(e,l))),g(e=>({...e,[l]:{pageSize:100,pageIndex:1}}))}}),t()}),[S,p]),j=(0,u.useCallback)(e=>{let t=m[e];t&&(E(t=>e_(t,e,[...Array(100)].map((t,r)=>({key:"".concat(P,"-").concat(e,"-").concat(r),title:"SKELETON",isLeaf:!0})))),S({nodeKey:e,queryParams:{monitor_config_id:p,staged_resource_urn:e,size:100,page:t.pageIndex+1},fastUpdateFn:t=>{E(r=>e_(r,e,ev(t,e)))},detailedUpdateFn:t=>{E(r=>eT(r,e,ev(t,e))),g(t=>{var r,n;return{...t,[e]:{pageSize:100,pageIndex:(null!==(n=null===(r=t[e])||void 0===r?void 0:r.pageIndex)&&void 0!==n?n:0)+1}}})}}))},[m,S,p]),C=(0,u.useCallback)(e=>{E(t=>{let r=em(t,e),n=[e];return r&&n.push(...ey(r)),x(e=>e.filter(e=>!n.includes(e.toString()))),g(e=>{let t={...e};return n.forEach(e=>{delete t[e]}),t}),n.forEach(e=>{delete A.current[e],delete b.current[e]}),eh(t,e)})},[]),D=(0,u.useCallback)(async e=>{let t=async e=>{try{let t=await h({monitor_config_id:p,...e&&{staged_resource_urn:e}});if(t.error){c((0,eo.e$)(t.error),"Failed to get schema explorer ancestors statuses");return}let r=t.data;if(!r)return;e?C(e):r.forEach(e=>{C(e.urn)}),E(e=>r.reduce((e,t)=>ef(e,t.urn,t.update_status,t.diff_status),e))}catch(e){c("An unexpected error occurred while refreshing the schema explorer")}};if(0===e.length){await t();return}await Promise.all(e.map(e=>t(e)))},[h,p,C,c]),O=(0,u.useCallback)((e,t)=>{x(e),t.expanded&&!t.node.children&&k&&k(t.node)},[k]);return(0,u.useImperativeHandle)(t,()=>({refreshResourcesAndAncestors:D})),(0,u.useEffect)(()=>{(async()=>{v.length>0||S({nodeKey:"root",queryParams:{monitor_config_id:p,size:100},fastUpdateFn:e=>{E(ev(e))}})})()},[S,p,E,v.length]),(0,n.jsxs)(l.kCb,{gap:"middle",vertical:!0,className:"h-full",children:[(0,n.jsx)(l.Dxz,{level:3,className:"sticky top-0",ellipsis:!0,children:"Schema explorer"}),(0,n.jsx)(l.mpN.DirectoryTree,{loadData:k,treeData:v,expandedKeys:T,onExpand:O,onSelect:e=>{r(e)},showIcon:!0,showLine:!0,blockNode:!0,multiple:!0,rootClassName:"h-full overflow-x-hidden ".concat(ec()["monitor-tree"]," group/monitor-tree ").concat(a.length>1?"multi-select":""),expandAction:"doubleClick",titleRender:e=>(0,n.jsx)(ep,{node:e,treeData:v,onLoadMore:j,actions:i})}),a.length>0&&(0,n.jsxs)(l.kCb,{justify:"space-between",align:"center",gap:"small",children:[(0,n.jsx)(l.zxk,{"aria-label":"Classify ".concat(a.length," Selected Nodes"),icon:(0,n.jsx)(l.QMR,{size:12}),size:"small",onClick:()=>{var e;return null===(e=i[o])||void 0===e?void 0:e.callback(a,a.flatMap(e=>{let t=em(v,e.toString());return t?[t]:[]}))},className:"flex-none"}),(0,n.jsx)(l.xvT,{ellipsis:!0,children:"".concat(a.length," ").concat((0,R._6)(a.length,"resource","resources")," selected")}),(0,n.jsx)(l.Ltx,{menu:{items:i?Object.entries(i).map(e=>{let[t,{label:r,disabled:n}]=e;return{key:t,label:r,disabled:n(a.flatMap(e=>{let t=em(v,e.toString());return t?[t]:[]}))}}):[],onClick:e=>{var t;let{key:r,domEvent:n}=e;n.preventDefault(),n.stopPropagation(),null===(t=i[r])||void 0===t||t.callback(a,a.flatMap(e=>{let t=em(v,e.toString());return t?[t]:[]}))}},destroyOnHidden:!0,className:"group mr-1 flex-none",children:(0,n.jsx)(l.zxk,{"aria-label":"Show More Resource Actions",icon:(0,n.jsx)(l.PJP.r43,{}),size:"small",className:"self-end"})})]})]})});ex.displayName="MonitorTree";var eA=r(12627),eb=r(84418);let eS=(e,t)=>(0,n.jsx)(t,{...e,className:"!sticky top-0 z-[2] bg-white"}),ek=e=>{var t;let{resource:r,fieldActions:a,...i}=e,o=(0,u.useMemo)(()=>{var e;if(!(null==r?void 0:r.classifications))return[];let t="preferred_data_categories"in r&&null!==(e=r.preferred_data_categories)&&void 0!==e?e:[];return r.classifications.filter(e=>t.includes(e.label))},[r]);return(0,n.jsx)(eb.d,{...i,classNames:{body:"!pt-0 !mt-[var(--ant-padding-lg)] max-h-full"},children:r?(0,n.jsx)(l.mQc,{defaultActiveKey:"details",renderTabBar:eS,items:[{key:"details",label:"Details",children:(0,n.jsxs)(l.kCb,{gap:"middle",vertical:!0,children:[(0,n.jsx)(l.w5n,{bordered:!0,size:"small",column:1,items:[..."system_key"in r&&r.system_key?[{key:"system",label:"System",children:r.system_key}]:[],{key:"path",label:"Path",children:r.urn},{key:"data-type",label:"Data type",children:"source_data_type"in r?r.source_data_type:void 0},{key:"description",label:"Description",children:r.description}]}),(0,n.jsx)(l.l09,{layout:"vertical",children:(0,n.jsx)(l.l09.Item,{label:"Data categories",children:(0,n.jsx)(eA.Z,{variant:"outlined",mode:"multiple",maxTagCount:"responsive",value:"preferred_data_categories"in r?r.preferred_data_categories:[],autoFocus:!1,disabled:null==r||!r.diff_status||!x.$k["assign-categories"].some(e=>e===r.diff_status),onChange:e=>a["assign-categories"]([r.urn],!0,{user_assigned_data_categories:e})})})}),o.length>0&&(0,n.jsx)(l.aVo,{"data-testid":"classifications-reasoning-list",dataSource:o,renderItem:e=>{let t=e.confidence_bucket?(0,en.Oq)(e.confidence_bucket):void 0;return(0,n.jsx)(l.aVo.Item,{children:(0,n.jsx)(l.aVo.Item.Meta,{avatar:(0,n.jsx)(l.qEK,{icon:(0,n.jsx)(l.QMR,{color:"black"})}),title:(0,n.jsxs)(l.kCb,{align:"center",gap:"middle",children:[(0,n.jsx)("div",{children:e.label}),t&&(0,n.jsx)(B.D,{severity:t})]}),description:e.rationale})})}})]})},{key:"activity",label:"Activity",children:(0,n.jsx)(l.aVo,{dataSource:"errors"in r&&r.errors?null===(t=r.errors)||void 0===t?void 0:t.map((e,t)=>({key:t,title:e.phase,description:new Date(e.timestamp).toLocaleString(),content:e.message})):[],renderItem:(e,t)=>(0,n.jsxs)(l.aVo.Item,{children:[(0,n.jsx)(l.aVo.Item.Meta,{title:e.title,description:e.description}),(0,n.jsx)(l.nvN,{ellipsis:{expandable:"collapsible",rows:3},copyable:{icon:(0,n.jsx)(l.PJP.CKM,{className:"pt-1",size:18})},children:e.content})]},t),itemLayout:"vertical"})}]}):null})};var ej=r(31883);let eC=(e,t)=>{let[r]=(0,j.rL)(),n=(0,l.UD8)(),a=(0,l.ddY)(),i=l=>async(i,o,s)=>{let c=Date.now();if(!await a.confirm((0,en.nB)(x.Me[l],x.e_[l](s))))return;n.open({key:c,type:"loading",content:"".concat(x.T0[l]," ").concat(s," ").concat((0,R._6)(s,"resource","resources"),"..."),duration:0});let d=await r({query:{...i.query},path:{monitor_config_id:e,action_type:l},body:{excluded_resource_urns:o}});if((0,ej.D4)(d)){n.open({key:c,type:"error",content:(0,en.v_)(l),duration:5});return}if(n.open({key:c,type:"success",content:(0,en.NM)(l,s),duration:5}),t&&l!==T.FieldActionType.REVIEW){let e=i.query.staged_resource_urn||[];await t(e)}};return{"assign-categories":i(T.FieldActionType.ASSIGN_CATEGORIES),"promote-removals":i(T.FieldActionType.PROMOTE_REMOVALS),"un-review":i(T.FieldActionType.UN_REVIEW),"un-mute":i(T.FieldActionType.UN_MUTE),review:i(T.FieldActionType.REVIEW),classify:i(T.FieldActionType.CLASSIFY),mute:i(T.FieldActionType.MUTE),promote:i(T.FieldActionType.PROMOTE)}},eD={DRAWER_OPEN:".ant-drawer-open",DRAWER_SELECT:".ant-drawer-open .ant-select",SELECT:".ant-select",SELECT_SELECTOR:".ant-select-selector",SELECT_DISABLED:"ant-select-disabled",INPUT:"input",LIST_ITEM_SELECT:"[data-classification-select]"},eR=(e,t,r,n,a,i)=>{let o=(0,l.UD8)(),s=e=>{let t=e.querySelector(eD.SELECT_SELECTOR);if(!t)return!1;if(e.classList.contains(eD.SELECT_DISABLED))return o.warning("You cannot assign categories to this resource in its current state"),!1;let r=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(r);let n=e.querySelector(eD.INPUT);return n&&n.focus(),!0},c=r=>{var n;e&&(e.diff_status&&(null===(n=x.$k[r])||void 0===n?void 0:n.includes(e.diff_status))?t[r]([e.urn]):o.warning(x.Z8[r]))};(0,p.y1)(x.b_.REVIEW,()=>c(T.FieldActionType.REVIEW),[e,t]),(0,p.y1)(x.b_.PROMOTE,()=>c(T.FieldActionType.PROMOTE),[e,t]),(0,p.y1)(x.b_.MUTE,()=>c(T.FieldActionType.MUTE),[e,t]),(0,p.y1)(x.b_.UN_MUTE,()=>c(T.FieldActionType.UN_MUTE),[e,t]),(0,p.y1)(x.b_.REFRESH,()=>i(),[i]),(0,p.y1)(x.b_.TOGGLE_DRAWER,()=>{e&&a?n(void 0):e&&!a&&n(e.urn)},[e,n,a]),(0,p.y1)(x.b_.OPEN_CLASSIFICATION_SELECT,t=>{if(t.preventDefault(),!e)return;let r=null;if(a){let e=document.querySelector(eD.DRAWER_OPEN);e&&(r=e.querySelector(eD.SELECT))}else{let t=CSS.escape(e.urn);r=document.querySelector('[data-classification-select="'.concat(t,'"]'))}r&&s(r)},[e,o,a]),(0,p.y1)("escape",e=>{let t=document.activeElement;if((null==t?void 0:t.tagName)!=="INPUT")return;let r=t.closest(eD.LIST_ITEM_SELECT),n=t.closest(eD.DRAWER_SELECT);(r||n)&&(e.preventDefault(),e.stopPropagation(),t.blur())},{enableOnFormTags:["INPUT"]},[a])};var eO=r(70675);let eM=e=>{let[t,...r]=e.map(e=>Object.values(T.FieldActionType).flatMap(t=>x.$k[t].some(t=>t===e)?[t]:[]));return r.reduce((e,t)=>o().intersection(e,[...t]),null!=t?t:[])},eL=(e,t)=>{let[r]=(0,eO.qb)(),[n]=(0,_.Av)(),[a]=(0,eO.zV)(),[i]=(0,eO.Hf)(),[o]=(0,eO._J)(),[s]=(0,eO.NA)(),[c]=(0,_.n7)(),d=(0,l.UD8)(),u=(0,l.ddY)(),p=(e,r)=>async function(n){let l=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=arguments.length>2?arguments[2]:void 0,i=Date.now();if(!(1===n.length&&l||await u.confirm((0,en.nB)(x.Me[e],x.e_[e](n.length)))))return;d.open({key:i,type:"loading",content:"".concat(x.T0[e]," ").concat(n.length," ").concat((0,R._6)(n.length,"resource","resources"),"..."),duration:0});let o=await r(n,a);if((0,ej.D4)(o)){d.open({key:i,type:"error",content:(0,en.v_)(e),duration:5});return}d.open({key:i,type:"success",content:(0,en.NM)(e,n.length),duration:5}),e!==T.FieldActionType.PROMOTE_REMOVALS&&t&&await t(n)},f=async e=>a({staged_resource_urns:e}),h=async e=>o({staged_resource_urns:e}),y=async e=>i({staged_resource_urns:e}),m=async t=>n({monitor_config_key:e,staged_resource_urns:t}),g=async(t,r)=>{var n;let[l]=t;return s({monitor_config_id:e,staged_resource_urn:l,user_assigned_data_categories:null!==(n=null==r?void 0:r.user_assigned_data_categories)&&void 0!==n?n:void 0})},v=async t=>r({monitor_config_key:e,staged_resource_urns:t}),E=async t=>c({monitor_config_key:e,staged_resource_urns:t});return{"assign-categories":p(T.FieldActionType.ASSIGN_CATEGORIES,g),"promote-removals":p(T.FieldActionType.PROMOTE_REMOVALS,E),"un-review":()=>{},"un-mute":p(T.FieldActionType.UN_MUTE,h),review:p(T.FieldActionType.REVIEW,v),classify:p(T.FieldActionType.CLASSIFY,m),mute:p(T.FieldActionType.MUTE,f),promote:p(T.FieldActionType.PROMOTE,y)}};var ew=r(40431);let eN=()=>{let[e,t]=(0,ew.v1)("resourceStatus",(0,ew.S$)((0,ew.km)(F))),[r,n]=(0,ew.v1)("confidenceBucket",(0,ew.S$)((0,ew.jx)(Object.values(w.$)))),[l,a]=(0,ew.v1)("dataCategory",(0,ew.S$)(ew.Oi));return(0,u.useEffect)(()=>{if(null===e){let e=q([...F]);t(e.length>0?e:[])}},[]),{resourceStatus:e,setResourceStatus:t,confidenceBucket:r,setConfidenceBucket:n,dataCategory:l,setDataCategory:a,reset:()=>{t([]),n([]),a([])},resetToInitialState:()=>{t(q([...F])),n(null),a(null)}}},eI=e=>new Map(e.map(e=>[e.key,e])),eU=(e,t)=>o()([...new Map([...e,...t]).entries()]).map(t=>{let[r,n]=t;return o().chain(e.get(r)).defaultTo(n).cloneDeep().merge(n).value()}).thru(eI).value();var eP=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],[t,r]=(0,u.useState)(new Map);return{nodes:t,update:n=>{let l=e?eU(t,n):n;o()([...l.entries()]).some(e=>{let[r,n]=e;return!o().isEqual(t.get(r),n)})&&r(e=>new Map([...e,...n]))},reset:()=>{r(new Map)}}},eF=(e,t)=>{var r,n;let l=(0,j.Fp)(e),a=(0,_.IC)(t,{skip:!t.stagedResourceUrn}),{update:i,nodes:s,reset:c}=eP();return(null===(r=l.data)||void 0===r?void 0:r.items)&&i(eI(l.data.items.map(e=>({key:e.urn,...e})))),{listQuery:{...l,nodes:o().chain(null===(n=l.data)||void 0===n?void 0:n.items).defaultTo([]).flatMap(e=>o().chain(s.get(e.urn)).thru(e=>e?[e]:[]).value()).thru(eI).value(),refetch:()=>{c(),l.refetch()}},detailsQuery:{...a,node:t.stagedResourceUrn?s.get(t.stagedResourceUrn):void 0,refetch:()=>{c(),a.refetch()}},nodes:s}};let ez=e=>Object.values(E.LL).flatMap(t=>G[t].label===e?[t]:[]);var eq=()=>{var e,t,r,a,i,s,A,b;let C=(0,d.useRouter)(),D=decodeURIComponent(C.query.monitorId),R=(0,u.useRef)(null),[O,M]=(0,u.useState)(!1),{paginationProps:L,pageIndex:w,pageSize:N,resetPagination:I}=(0,v.S)({defaultPageSize:25}),U=(0,y.Rx)(),{resourceStatus:P,confidenceBucket:F,dataCategory:q,...V}=eN(),{data:Y}=(0,_.vc)({monitor_config_id:D}),[H,$]=(0,u.useState)([]),J={path:{monitor_config_id:D},query:{staged_resource_urn:H.map(e=>e.toString()),search:U.searchProps.value,diff_status:P?P.flatMap(ez):void 0,confidence_bucket:F||void 0,data_category:q||void 0}},[B,K]=(0,u.useState)(),[Z,Q]=(0,u.useState)(),[X,ee]=(0,u.useState)(null),[et,{data:er,isFetching:en}]=(0,j.Nz)(),el=eC(D,async e=>{var t;await (null===(t=R.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),ea=eL(D,async e=>{var t;await (null===(t=R.current)||void 0===t?void 0:t.refreshResourcesAndAncestors(e))}),{listQuery:{nodes:eo,...es},detailsQuery:{data:ec},nodes:ed}=eF({...J,query:{...J.query,size:N,page:w}},{stagedResourceUrn:B}),{excludedKeys:eu,listSelectMode:ep,resetListSelect:ef,selectedKeys:eh,updateSelectedListItem:ey,checkboxProps:em}=S(Array.from(eo.keys()),{activeListItem:Z?{...Z,key:null==Z?void 0:Z.key.toString()}:void 0,enableKeyboardShortcuts:!0}),eg=async e=>{if((null==Z?void 0:Z.urn)&&e&&X){let t=[...eo.values()].findIndex(t=>t.urn===e);-1!==t&&X(t)}K(e)};(0,p.y1)("?",()=>M(!O),{useKey:!0},[O]);let ev="exclusive"===ep?null==er?void 0:er.allowed_actions:eM(eh.flatMap(e=>{let t=ed.get(e);return(null==t?void 0:t.diff_status)?[t.diff_status]:[]})),e_=null!==(s=null===(e=es.data)||void 0===e?void 0:e.total)&&void 0!==s?s:0,eE="exclusive"===ep&&(null===(t=es.data)||void 0===t?void 0:t.total)?e_-eu.length:eh.length;return(0,u.useEffect)(()=>{I(),ef()},[P,F,H,U.searchQuery,q]),eR(Z,ea,ey,eg,!!B,()=>es.refetch()),(0,n.jsxs)(h.Z,{title:"Action center - Discovered assets by system",mainProps:{overflow:"hidden"},fullHeight:!0,children:[(0,n.jsx)(g.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:m.vi},{title:D}],isSticky:!1}),(0,n.jsxs)(l.qX1,{className:"h-[calc(100%-48px)] overflow-hidden",children:[(0,n.jsx)(l.qX1.Panel,{defaultSize:250,style:{paddingRight:"var(--ant-padding-md)"},children:(0,n.jsx)(ex,{ref:R,setSelectedNodeKeys:$,selectedNodeKeys:H,primaryAction:T.FieldActionType.CLASSIFY,nodeActions:Object.fromEntries(x.km.map(e=>[e,{label:x.Me[e],disabled:t=>o()(t).map(t=>(e!==T.FieldActionType.PROMOTE_REMOVALS||t.status!==E.Ag.REMOVAL)&&(e!==T.FieldActionType.CLASSIFY||!t.classifyable||t.diffStatus===E.LL.MUTED)&&(e!==T.FieldActionType.MUTE||t.diffStatus===E.LL.MUTED)&&(e!==T.FieldActionType.UN_MUTE||t.diffStatus!==E.LL.MUTED)).some(e=>!0===e),callback:t=>{ea[e](t,!1)}}]))})}),(0,n.jsx)(l.qX1.Panel,{style:{paddingLeft:"var(--ant-padding-md)"},children:(0,n.jsxs)(l.kCb,{vertical:!0,gap:"middle",className:"h-full",children:[(0,n.jsxs)(l.kCb,{justify:"space-between",children:[(0,n.jsx)(l.Dxz,{level:2,ellipsis:!0,children:"Monitor results"}),(0,n.jsx)(l.kCb,{align:"center",children:(null==Y?void 0:Y.last_monitored)&&(0,n.jsxs)(l.xvT,{type:"secondary",children:["Last scan:"," ",new Date(null==Y?void 0:Y.last_monitored).toLocaleString()]})})]}),(0,n.jsxs)(l.kCb,{justify:"space-between",wrap:"wrap",gap:"small",children:[(0,n.jsxs)(l.kCb,{gap:"small",children:[(0,n.jsx)(f.f,{value:U.searchQuery,onChange:U.updateSearch,placeholder:"Search"}),(0,n.jsx)(l.ua7,{title:"Display keyboard shortcuts",children:(0,n.jsx)(l.zxk,{"aria-label":"Display keyboard shortcuts",icon:(0,n.jsx)(l.PJP.N1d,{}),onClick:()=>M(!0)})})]}),(0,n.jsxs)(l.kCb,{gap:"small",children:[(0,n.jsx)(W,{resourceStatus:P,confidenceBucket:F,dataCategory:q,...V,monitorId:D,stagedResourceUrn:H.map(e=>e.toString())}),(0,n.jsx)(l.Ltx,{onOpenChange:e=>{e&&"exclusive"===ep&&et({...J,query:{...J.query},body:{excluded_resource_urns:eu.map(e=>e.toString())}})},menu:{items:[...x.aK.map(e=>({key:e,label:!en&&(null==ev?void 0:ev.includes(e))?x.Me[e]:(0,n.jsx)(l.ua7,{title:x.Z8[e],children:x.Me[e]}),disabled:en||!(null==ev?void 0:ev.includes(e)),onClick:async()=>{"exclusive"===ep?await el[e](J,eu.map(e=>e.toString()),eE):await ea[e](eh.map(e=>e.toString())),ef()}}))]},disabled:eh.length<=0,children:(0,n.jsx)(l.zxk,{type:"primary",icon:(0,n.jsx)(l.PJP._ME,{}),iconPosition:"end",loading:en,children:"Actions"})}),(0,n.jsx)(l.ua7,{title:"Refresh",children:(0,n.jsx)(l.zxk,{icon:(0,n.jsx)(l.PJP.CQM,{}),onClick:()=>es.refetch(),"aria-label":"Refresh"})})]})]}),(0,n.jsxs)(l.kCb,{gap:"middle",align:"center",children:[(0,n.jsx)(l.XZJ,{id:"select-all",...em}),(0,n.jsx)("label",{htmlFor:"select-all",children:"Select all"}),!!eE&&(0,n.jsxs)(l.xvT,{strong:!0,children:[eE.toLocaleString()," selected"]})]}),(0,n.jsx)(l.aVo,{dataSource:[...eo.values()],className:"-ml-3 h-full overflow-y-scroll pl-1",loading:es.isFetching,enableKeyboardShortcuts:!0,locale:!U.searchProps.value&&o()(P).intersection(z).isEmpty()?{emptyText:(0,n.jsx)(l.HYy,{image:l.HYy.PRESENTED_IMAGE_SIMPLE,description:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:"All resources have been either approved or ignored."}),(0,n.jsx)("div",{children:"Approved resources can be found in the manage datasets view."}),(0,n.jsx)("div",{children:"To see ignored resources, adjust your filters."})]}),children:(0,n.jsxs)(l.kCb,{gap:"middle",justify:"center",children:[(0,n.jsx)(c(),{href:m.$m,passHref:!0,legacyBehavior:!0,children:(0,n.jsx)(l.zxk,{children:"Manage datasets view"})}),(0,n.jsx)(l.zxk,{type:"primary","aria-label":"Refresh page",onClick:()=>{V.resetToInitialState(),C.reload()},children:"Refresh page"})]})})}:void 0,onActiveItemChange:(e,t,r)=>{ee(()=>r),(null==e?void 0:e.urn)?(Q({...e,key:e.urn}),B&&e.urn!==B&&K(e.urn)):Q(void 0)},renderItem:e=>ei({...e,selected:eh.includes(e.urn),onSelect:ey,onNavigate:eg,onSetDataCategories:(e,t)=>ea["assign-categories"]([e],!0,{user_assigned_data_categories:t}),dataCategoriesDisabled:null==e||!e.diff_status||!x.$k["assign-categories"].some(t=>t===e.diff_status),actions:(null==e?void 0:e.diff_status)?x.Vr[e.diff_status].map(t=>(0,n.jsx)(l.ua7,{title:x.Me[t],children:(0,n.jsx)(l.zxk,{"aria-label":x.Me[t],icon:x.W3[t],onClick:()=>ea[t]([e.urn]),disabled:null==e||!e.diff_status||!x.$k[t].some(t=>t===e.diff_status),style:{fontSize:"var(--ant-button-content-font-size-lg)"}})},t)):[]})}),(0,n.jsx)(l.tlE,{...L,showSizeChanger:{suffixIcon:(0,n.jsx)(l.PJP._ME,{})},total:(null===(r=es.data)||void 0===r?void 0:r.total)||0,hideOnSinglePage:(null===(a=L.pageSize)||void 0===a?void 0:a.toString())===(null===(i=L.pageSizeOptions)||void 0===i?void 0:i[0])})]})})]}),(0,n.jsx)(ek,{itemKey:null!==(A=null==ec?void 0:ec.urn)&&void 0!==A?A:"",title:null!==(b=null==ec?void 0:ec.name)&&void 0!==b?b:null,titleIcon:(0,n.jsx)(l.PJP.sgG,{}),titleTag:{bordered:!1,color:(null==ec?void 0:ec.diff_status)?G[ec.diff_status].color:void 0,className:"font-normal text-[var(--ant-font-size-sm)]",children:(null==ec?void 0:ec.diff_status)?G[ec.diff_status].label:null},actions:((null==ec?void 0:ec.diff_status)?x.Zu[ec.diff_status]:x.sB).map(e=>({label:x.Me[e],callback:t=>ea[e]([t]),disabled:null==ec||!ec.diff_status||!x.$k[e].some(e=>e===ec.diff_status)})),open:!!B,onClose:()=>K(void 0),resource:ec,fieldActions:ea,mask:!Z}),(0,n.jsx)(k,{open:O,onCancel:()=>M(!1)})]})};let eG=()=>(0,n.jsx)(n.Fragment,{children:"Attempting to access monitor results without the required feature flag enabled"});var eV=()=>{let{flags:e}=(0,a.hz)();return e.heliosV2?(0,n.jsx)(eq,{}):(0,n.jsx)(l.x4B,{status:"error",title:(0,n.jsx)(eG,{})})}},72707:function(e){e.exports={option:"TaxonomySelect_option__vY6v2"}},97947:function(e){e.exports={"monitor-field__title":"MonitorFieldListItem_monitor-field__title__YrxOU","monitor-field__breadcrumb":"MonitorFieldListItem_monitor-field__breadcrumb__Rn4vE"}},32500:function(e){e.exports={"monitor-tree":"MonitorTree_monitor-tree__QKz6T"}}},function(e){e.O(0,[431,7245,4589,8023,2888,9774,179],function(){return e(e.s=83806)}),_N_E=e.O()}]);