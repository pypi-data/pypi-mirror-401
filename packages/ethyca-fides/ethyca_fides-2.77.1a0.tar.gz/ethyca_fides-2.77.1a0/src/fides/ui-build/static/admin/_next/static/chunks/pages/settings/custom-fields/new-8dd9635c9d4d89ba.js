(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9914],{56141:function(e,t,s){var i=s(32866);e.exports=function(e,t){return i(e,t)}},92973:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/custom-fields/new",function(){return s(85127)}])},34435:function(e,t,s){"use strict";var i=s(24246),l=s(41725),n=s(86677),r=s(812),a=s(77830),o=s(19904),d=s(8917),u=s(67522),c=s(66006),p=s(66236),m=s(32885),x=s(60240),h=s(31883);let y=()=>(0,i.jsxs)(l.OdW,{active:!0,children:[(0,i.jsx)(l.OdW.Input,{}),(0,i.jsx)(l.OdW.Input,{}),(0,i.jsx)(l.OdW.Input,{}),(0,i.jsx)(l.OdW.Input,{}),(0,i.jsx)(l.OdW.Button,{})]}),_=e=>d.uP.has(e)?d.uP.get(e):e.startsWith("taxonomy:")||e.startsWith("system:")?e:"taxonomy:".concat(e);t.Z=e=>{var t;let{initialField:s,isLoading:f}=e,[v]=l.l09.useForm(),j=l.l09.useWatch("value_type",v),E=l.l09.useWatch("name",v),g=(0,n.useRouter)(),{resource_type:P}=g.query,T=(0,l.UD8)(),b=(0,l.ddY)(),{createOrUpdate:I}=(0,u.Z)(),{data:C,isLoading:L}=(0,m.vA)(null==s?void 0:s.allow_list_id,{skip:!(null==s?void 0:s.allow_list_id)}),[k,{isLoading:w}]=(0,m.UF)(),{data:S,isLoading:N}=(0,m.Az)(),{valueTypeOptions:O}=(0,c.Z)(),U=(0,o.Tg)([x.Sh.CUSTOM_FIELD_DELETE])&&!!s,W=async()=>{if(!s)return;let{id:e,resource_type:t,field_type:i}=s,l=await k({id:e,resource_type:t,field_type:i});if((0,h.D4)(l)){T.error((0,r.e$)(l.error));return}T.success("Custom field deleted successfully"),g.push(a.WC)},F=async e=>{let t=await I(e,s,C);if(!t){T.error("An unexpected error occurred");return}if((0,h.D4)(t)){T.error((0,r.e$)(t.error));return}T.success("Custom field ".concat(s?"updated":"created"," successfully")),g.push(a.WC)},A=(e=>{var t;if(e)return{...e,value_type:e.field_type,field_type:(0,p._)(e),resource_type:_(e.resource_type),options:null!==(t=null==C?void 0:C.allowed_values)&&void 0!==t?t:[]}})(s),D=P?{...A,resource_type:"taxonomy:".concat(P)}:A;if(f||L||N)return(0,i.jsx)(y,{});let q=O.some(e=>e.value===j);return(0,i.jsxs)(l.l09,{form:v,layout:"vertical",initialValues:D||{},validateTrigger:["onBlur","onChange"],onFinish:F,children:[(0,i.jsx)(l.l09.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please enter a name"}],children:(0,i.jsx)(l.QcG,{options:O,onSelect:(e,t)=>{v.setFieldsValue({name:t.label,value_type:t.value})},disabled:q,"data-testid":"input-name-autocomplete",children:(0,i.jsx)(l.IIB,{"data-testid":"input-name",suffix:q?(0,i.jsx)(l.zxk,{size:"small",type:"text",icon:(0,i.jsx)(l.PJP.x8P,{}),onClick:()=>{v.setFieldsValue({name:void 0,value_type:void 0})}}):void 0})})}),(0,i.jsx)(l.l09.Item,{label:"Type",name:"value_type",hidden:!0,children:(0,i.jsx)(l.PhF,{options:O,getPopupContainer:e=>e.parentElement||document.body,"data-testid":"select-value-type"})}),!!E&&!q&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.l09.Item,{label:"Description",name:"description",children:(0,i.jsx)(l.IIB.TextArea,{rows:2,"data-testid":"input-description"})}),(0,i.jsx)(l.l09.Item,{label:"Field type",name:"field_type",rules:[{required:!0,message:"Please select a field type"}],children:(0,i.jsx)(l.PhF,{options:d.TY,getPopupContainer:e=>e.parentElement||document.body,"data-testid":"select-field-type"})}),(0,i.jsx)(l.l09.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.field_type!==t.field_type,children:e=>{let{getFieldValue:t}=e,s=t("field_type");return(s===d.Uv.SINGLE_SELECT||s===d.Uv.MULTIPLE_SELECT)&&(0,i.jsx)(l.l09.List,{name:"options",rules:[{validator:async(e,t)=>!t||t.length<1?Promise.reject(Error("At least one option is required for selects")):Promise.resolve()}],children:(e,s,n)=>{let{add:r,remove:a}=s,{errors:o}=n;return(0,i.jsxs)(i.Fragment,{children:[e.map((s,n)=>(0,i.jsx)(l.l09.Item,{required:!1,label:0===n?"Options":"","data-testid":"options-form-item",children:(0,i.jsxs)(l.kCb,{gap:"middle",children:[(0,i.jsx)(l.l09.Item,{...s,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Options cannot be empty"},()=>({validator:(e,s)=>t("options").filter(e=>e===s).length>1?Promise.reject(Error("Option values must be unique")):Promise.resolve()})],noStyle:!0,children:(0,i.jsx)(l.IIB,{placeholder:"Enter option value","data-testid":"input-option-".concat(n)})}),e.length>1&&(0,i.jsx)(l.zxk,{icon:(0,i.jsx)(l.PJP.ZNm,{}),onClick:()=>a(s.name),"aria-label":"Remove option"})]})},s.key)),(0,i.jsx)(l.l09.Item,{children:(0,i.jsx)(l.zxk,{type:"dashed",onClick:()=>r(),icon:(0,i.jsx)(l.PJP.mm_,{}),"data-testid":"add-option-btn",children:"Add select option"})}),(0,i.jsx)(l.l09.ErrorList,{errors:o,className:"-mt-4 mb-4"})]})}})}})]}),(0,i.jsx)(l.l09.Item,{label:"Applies to",name:"resource_type",rules:[{required:!0,message:"Please select a location"}],tooltip:"Choose where this field applies, including taxonomies",children:(0,i.jsx)(l.PhF,{options:null!==(t=null==S?void 0:S.map(e=>({label:e,value:e})))&&void 0!==t?t:[],getPopupContainer:e=>e.parentElement||document.body,disabled:!!s,"data-testid":"select-resource-type"})}),(0,i.jsxs)(l.kCb,{justify:"space-between",children:[U&&(0,i.jsx)(l.zxk,{danger:!0,onClick:()=>{var e;b.confirm({title:"Delete custom field?",content:(0,i.jsxs)(l.Typography.Paragraph,{children:["Are you sure you want to delete"," ",(0,i.jsx)("strong",{children:null!==(e=null==s?void 0:s.name)&&void 0!==e?e:"this custom field"}),"? This action cannot be undone."]}),onOk:W,okType:"primary",okText:"Delete",centered:!0})},loading:w,"data-testid":"delete-btn",children:"Delete"}),(0,i.jsx)(l.zxk,{type:"primary",htmlType:"submit","data-testid":"save-btn",children:"Save"})]})]})}},66236:function(e,t,s){"use strict";s.d(t,{S:function(){return r},_:function(){return n}});var i=s(20987),l=s(8917);let n=e=>e.field_type===i.H.STRING_ARRAY?l.Uv.MULTIPLE_SELECT:e.allow_list_id?l.Uv.SINGLE_SELECT:e.field_type===i.H.STRING?l.Uv.OPEN_TEXT:e.field_type,r=e=>{let t=n(e);return t===l.Uv.OPEN_TEXT||t===l.Uv.SINGLE_SELECT||t===l.Uv.MULTIPLE_SELECT?l.P3[t]:t}},85127:function(e,t,s){"use strict";s.r(t);var i=s(24246),l=s(77213),n=s(77830),r=s(58754),a=s(34435);t.default=()=>(0,i.jsxs)(l.Z,{title:"New custom field",mainProps:{maxWidth:"720px"},children:[(0,i.jsx)(r.Z,{heading:"Custom fields",breadcrumbItems:[{title:"All custom fields",href:n.WC},{title:"Create new"}]}),(0,i.jsx)(a.Z,{})]})}},function(e){e.O(0,[590,2888,9774,179],function(){return e(e.s=92973)}),_N_E=e.O()}]);