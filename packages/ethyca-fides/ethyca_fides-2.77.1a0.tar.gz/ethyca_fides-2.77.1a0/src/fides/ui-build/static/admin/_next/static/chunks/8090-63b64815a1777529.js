(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8090],{79806:function(e,t,l){"use strict";l.d(t,{Gn:function(){return r},zR:function(){return s}});var a=l(24246),n=l(41725),i=l(56358);let s=e=>{let{title:t}=e;return(0,a.jsx)(n.v7L,{py:0,display:"flex",alignItems:"flex-start",children:(0,a.jsx)(n.Bjg,{mr:"2",color:"gray.700",fontSize:"lg",lineHeight:1.8,children:t})})},r=e=>{let{onDelete:t,onEditYaml:l,formId:s,isSaving:r}=e;return(0,a.jsxs)(n.KR9,{justifyContent:"space-between",children:[t?(0,a.jsx)(n.zxk,{"aria-label":"delete",icon:(0,a.jsx)(i.q,{fontSize:"small"}),onClick:t,"data-testid":"delete-btn"}):null,(0,a.jsxs)("div",{className:"flex gap-2",children:[l&&(0,a.jsx)(n.zxk,{onClick:l,"data-testid":"edit-yaml-btn",children:"Edit YAML"}),(0,a.jsx)(n.zxk,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:s,loading:r,children:"Save"})]})]})};t.ZP=e=>{let{header:t,description:l,isOpen:i,onClose:s,children:r,footer:o}=e;return(0,a.jsxs)(n.JTh,{placement:"right",isOpen:i,onClose:s,size:"md",children:[(0,a.jsx)(n.yY5,{}),(0,a.jsxs)(n.mJD,{"data-testid":"edit-drawer-content",py:2,children:[(0,a.jsxs)(n.TJV,{display:"flex",justifyContent:"space-between",alignItems:"top",mr:2,py:2,gap:2,children:[(0,a.jsx)(n.TJV,{flex:1,minH:8,children:t}),(0,a.jsx)(n.TJV,{display:"flex",justifyContent:"flex-end",mr:2,children:(0,a.jsx)(n.zxk,{"aria-label":"Close editor",onClick:s,"data-testid":"close-drawer-btn",icon:(0,a.jsx)(n.j_w,{fontSize:"smaller"})})})]}),(0,a.jsxs)(n.Q4$,{pt:1,children:[l?(0,a.jsx)(n.Bjg,{fontSize:"sm",mb:4,color:"gray.600",children:l}):null,r]}),o]})]})}},18225:function(e,t,l){"use strict";var a=l(24246),n=l(41725);t.Z=e=>{let{alignment:t="center",...l}=e;return(0,a.jsx)(n.ad9,{boxSize:"full",align:"center",justify:t,children:(0,a.jsx)(n.Y6B,{color:"primary",...l})})}},56358:function(e,t,l){"use strict";l.d(t,{q:function(){return n}});var a=l(24246);let n=(0,l(41725).G1m)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,a.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},94799:function(e,t,l){"use strict";l.d(t,{k:function(){return i}});var a=l(76649);let n=e=>(0,a.Ln)({id:"string"},e),i=e=>(null!=e?e:[]).filter(n)},30320:function(e,t,l){"use strict";l.d(t,{m:function(){return o}});var a=l(27378),n=l(25980),i=l(17245),s=l(32885),r=l(94799);let o=e=>{let{resourceFidesKey:t,resourceType:l}=e,{errorAlert:o}=(0,i.VY)(),{plus:d}=(0,n.hz)(),u=(0,a.useMemo)(()=>null!=t?t:"",[]),c=(0,s.YU)(!0,{skip:!d}),m=(0,s.VN)(l,{skip:!d}),{data:x,isLoading:y,error:h,isError:p}=(0,s.PV)(null!=t?t:"",{skip:""!==u&&!(d&&u)}),[f]=(0,s._D)(),v=c.isLoading||m.isLoading||y,j=(0,a.useMemo)(()=>new Map((0,r.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),g=(0,a.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),_=(0,a.useMemo)(()=>new Map((0,r.k)(g).map(e=>[e.id,e])),[g]),T=(0,a.useMemo)(()=>p&&h&&"status"in h&&404===h.status?new Map:new Map((0,r.k)(x).map(e=>[e.custom_field_definition_id,e])),[x,p,h]),E=(0,a.useMemo)(()=>{let e=[..._.keys()];return e.sort(),e},[_]),b=(0,a.useMemo)(()=>{let e={};return g&&T&&g.forEach(t=>{let l=T.get(t.id||"");l&&(t.allow_list_id&&"string[]"===t.field_type?e[l.custom_field_definition_id]=l.value:e[l.custom_field_definition_id]=l.value.toString())}),e},[g,T]),C=(0,a.useCallback)(async e=>{if(!d)return;let a="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!a)return;let{customFieldValues:n}=e;if(!n||0===Object.keys(n).length)return;let i=[],s=[];E.forEach(e=>{let t=T.get(e),l=n[e];void 0===l||""===l||Array.isArray(l)&&0===l.length?(null==t?void 0:t.id)&&s.push(t.id):i.push({custom_field_definition_id:e,resource_id:a,id:null==t?void 0:t.id,value:l})});try{await f({resource_type:l,resource_id:a,upsert:i,delete:s})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,T,o,t,E,f,l]);return{customFieldValues:b,definitionIdToCustomField:T,idToAllowListWithOptions:j,idToCustomFieldDefinition:_,isEnabled:d,isLoading:v,sortedCustomFieldDefinitionIds:E,upsertCustomFields:C}}},33162:function(e,t,l){"use strict";l.d(t,{uc:function(){return c},mZ:function(){return u.m}});var a=l(24246),n=l(41725),i=l(34090),s=l(20987),r=l(30234),o=l(97181),d=l(40324),u=l(30320);let c=e=>{let{resourceFidesKey:t,resourceType:l}=e,{idToAllowListWithOptions:c,idToCustomFieldDefinition:m,isEnabled:x,isLoading:y,sortedCustomFieldDefinitionIds:h}=(0,u.m)({resourceFidesKey:t,resourceType:l});return x&&0!==h.length?(0,a.jsx)(r.Z,{heading:"Custom fields",children:(0,a.jsx)(n.ad9,{flexDir:"column","data-testid":"custom-fields-list",children:(0,a.jsx)(n.ad9,{flexDir:"column",gap:"24px",children:y?(0,a.jsx)(n.w4_,{children:(0,a.jsx)(n.Y6B,{})}):h.length>0&&(0,a.jsx)(n.ad9,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:h.map(e=>{let t=m.get(e);if(!t)return null;let l="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===s.H.STRING)return(0,a.jsx)(i.gN,{name:l,children:e=>{let{field:l}=e;return(0,a.jsx)(d.j0,{...l,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let n=c.get(t.allow_list_id);if(!n)return null;let{options:r}=n;return(0,a.jsx)(o.d,{name:l,allowClear:!0,mode:t.field_type!==s.H.STRING?"multiple":void 0,label:t.name,options:r,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};l(94799)},97181:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var a=l(24246),n=l(41725),i=l(34090),s=l(27378),r=l(46238),o=l(40324);let d=e=>{let{name:t,label:l,labelProps:d,tooltip:u,isRequired:c,layout:m="inline",helperText:x,...y}=e,[h,p,{setValue:f}]=(0,i.U$)(t),v=!!(p.touched&&p.error),[j,g]=(0,s.useState)("");h.value||"tags"!==y.mode&&"multiple"!==y.mode||(h.value=[]),"tags"===y.mode&&"string"==typeof h.value&&(h.value=[h.value]);let _="tags"===y.mode?(e,t)=>e?e.value!==j||h.value.includes(j)?y.optionRender?y.optionRender(e,t):e.label:'Create "'.concat(j,'"'):void 0:y.optionRender||void 0,T=e=>{g(e),y.onSearch&&y.onSearch(e)},E=(e,t)=>{f(e),y.onChange&&y.onChange(e,t)};return"inline"===m?(0,a.jsx)(n.DTt,{isInvalid:v,isRequired:c,children:(0,a.jsxs)(n.MoG,{templateColumns:l?"1fr 3fr":"1fr",children:[l?(0,a.jsx)(o.__,{htmlFor:y.id||t,...d,children:l}):null,(0,a.jsxs)(n.kCb,{align:"center",children:[(0,a.jsxs)(n.kCb,{vertical:!0,flex:1,className:"mr-2",children:[(0,a.jsx)(n.PhF,{...h,id:y.id||t,"data-testid":"controlled-select-".concat(h.name),...y,optionRender:_,onSearch:"tags"===y.mode?T:void 0,onChange:E,value:h.value||void 0,status:v?"error":void 0}),x&&(0,a.jsx)(n.Kug,{children:x}),(0,a.jsx)(o.Bc,{isInvalid:v,message:p.error,fieldName:h.name})]}),(0,a.jsx)(r.b,{label:u,className:v?"mt-2 self-start":void 0})]})]})}):(0,a.jsx)(n.DTt,{isInvalid:v,isRequired:c,children:(0,a.jsxs)(n.s_g,{alignItems:"start",children:[(0,a.jsxs)(n.kCb,{align:"center",children:[l?(0,a.jsx)(o.__,{htmlFor:y.id||t,fontSize:"xs",my:0,mr:1,...d,children:l}):null,(0,a.jsx)(r.b,{label:u})]}),(0,a.jsx)(n.PhF,{...h,id:y.id||t,"data-testid":"controlled-select-".concat(h.name),...y,optionRender:_,onSearch:"tags"===y.mode?T:void 0,onChange:E,value:h.value||void 0,status:v?"error":void 0}),x&&(0,a.jsx)(n.Kug,{style:{marginTop:0},children:x}),(0,a.jsx)(o.Bc,{isInvalid:v,message:p.error,fieldName:h.name})]})})}},9270:function(e,t,l){"use strict";l.d(t,{S:function(){return i}});var a=l(27378),n=l(36866);let i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,n.h)(e),{pageIndex:l,pageSize:i,updatePageIndex:s,updatePageSize:r,pageSizeOptions:o,showSizeChanger:d}=t,u=(0,a.useMemo)(()=>({current:l,pageSize:i,showSizeChanger:d,pageSizeOptions:o.map(String),onChange:s,onShowSizeChange:(e,t)=>{r(t)}}),[l,i,d,o,s,r]);return{...t,paginationProps:u}}},84418:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var a=l(24246),n=l(41725),i=l(98784),s=l.n(i);let r=e=>{let{itemKey:t,actions:l}=e;return s().isEmpty(l)?null:(0,a.jsx)(n.kCb,{gap:"small",justify:"flex-end",children:l.map((e,i)=>{let{callback:s,label:r,disabled:o}=e;return(0,a.jsx)(n.zxk,{onClick:()=>s(t),type:i===l.length-1?"primary":"default",disabled:o,children:r},r)})})},o=e=>{let{title:t,titleIcon:l,titleTag:i}=e;return(0,a.jsxs)(n.kCb,{align:"center",gap:"small",children:[l,(0,a.jsx)("span",{children:t}),i&&(0,a.jsx)(n.Vp9,{...i})]})},d=e=>{let{title:t,titleIcon:l,titleTag:i,actions:s,width:d=480,...u}=e;return(0,a.jsx)(n.dys,{title:(0,a.jsx)(o,{title:t,titleIcon:l,titleTag:i}),footer:u.footer||!s?u.footer:(0,a.jsx)(r,{itemKey:u.itemKey,actions:s}),width:d,...u})}},33335:function(e,t,l){"use strict";l.d(t,{E:function(){return a}});let a=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},30234:function(e,t,l){"use strict";var a=l(24246),n=l(41725);t.Z=e=>{let{heading:t,HeadingButton:l,children:i}=e;return(0,a.jsx)(n.EO$,{spacing:4,children:(0,a.jsxs)(n.TJV,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,a.jsxs)(n.TJV,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,a.jsx)(n.y_b,{as:"h3",size:"xs",children:t}),l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.s3C,{}),l]})]}),(0,a.jsx)(n.EO$,{spacing:4,px:6,py:6,children:i})]})})}},22583:function(e,t,l){"use strict";l.d(t,{j:function(){return i}});var a=l(41725),n=l(60240);let i={[n.Ej.TAXONOMY_WHITE]:a.tAb.DEFAULT,[n.Ej.TAXONOMY_RED]:a.tAb.ERROR,[n.Ej.TAXONOMY_ORANGE]:a.tAb.WARNING,[n.Ej.TAXONOMY_YELLOW]:a.tAb.CAUTION,[n.Ej.TAXONOMY_GREEN]:a.tAb.SUCCESS,[n.Ej.TAXONOMY_BLUE]:a.tAb.INFO,[n.Ej.TAXONOMY_PURPLE]:a.tAb.ALERT,[n.Ej.SANDSTONE]:a.tAb.SANDSTONE,[n.Ej.MINOS]:a.tAb.MINOS}},92818:function(e,t,l){"use strict";l.d(t,{r:function(){return o}});var a=l(24246),n=l(27378),i=l(97181),s=l(22583),r=l(60240);let o={[r.Ej.TAXONOMY_WHITE]:"White",[r.Ej.TAXONOMY_RED]:"Red",[r.Ej.TAXONOMY_ORANGE]:"Orange",[r.Ej.TAXONOMY_YELLOW]:"Yellow",[r.Ej.TAXONOMY_GREEN]:"Green",[r.Ej.TAXONOMY_BLUE]:"Blue",[r.Ej.TAXONOMY_PURPLE]:"Purple",[r.Ej.SANDSTONE]:"Sandstone",[r.Ej.MINOS]:"Minos"},d=e=>{let{color:t,...l}=e;return(0,a.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(s.j[t],")"),border:t===r.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})},u=e=>{let t=null==e?void 0:e.value,l=null==e?void 0:e.label;return(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)(d,{color:t}),(0,a.jsx)("span",{children:l})]})};t.Z=e=>{let t=Object.values(r.Ej).map(e=>({value:e,label:o[e]})),[l,s]=(0,n.useState)(void 0);return(0,a.jsx)(i.d,{...e,options:t,optionRender:u,layout:"stacked",value:l,onChange:e=>{s(e)},prefix:(0,a.jsx)(d,{color:null!=l?l:r.Ej.TAXONOMY_WHITE,style:{marginBottom:"2px"}})})}},58090:function(e,t,l){"use strict";l.d(t,{Z:function(){return ew}});var a,n,i,s,r=l(24246),o=l(41725),d=l(69238),u=l.n(d),c=l(86677),m=l(27378),x=l(25980),y=l(812),h=l(77213),p=l(58754),f=l(19904),v=l(32885),j=l(33335),g=l(39864),_=e=>{let{onClose:t}=e,[l,{isLoading:a}]=(0,g.Hb)(),n=(0,o.UD8)(),i=async e=>{var a;let i={...e,taxonomy_type:(0,j.E)(null!==(a=e.name)&&void 0!==a?a:"")},s=await l(i);if((0,y.D4)(s)){n.error((0,y.e$)(s.error));return}n.success("Taxonomy created successfully"),t()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Typography.Paragraph,{children:"Create and organize the core terminology your team uses to describe data and how it's handled. Custom taxonomies let you define domain-specific concepts and then apply them to other privacy objects throughout the platform"}),(0,r.jsxs)(o.l09,{layout:"vertical",onFinish:i,validateTrigger:["onBlur","onChange"],children:[(0,r.jsx)(o.l09.Item,{label:"Taxonomy name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,r.jsx)(o.IIB,{"data-testid":"input-name"})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{rows:2,"data-testid":"input-description"})}),(0,r.jsxs)(o.kCb,{gap:"small",justify:"space-between",children:[(0,r.jsx)(o.zxk,{onClick:t,disabled:a,children:"Cancel"}),(0,r.jsx)(o.zxk,{type:"primary",htmlType:"submit",loading:a,disabled:a,"data-testid":"save-btn",children:"Create taxonomy"})]})]})]})},T=l(33162),E=l(84418),b=l(67522),C=l(66006),k=l(60240),I=l(31883),A=e=>{let{taxonomy:t,onSubmit:l,formId:a,customFields:n}=e,{fides_key:i,...s}=null!=t?t:{},[d,u]=(0,m.useState)(!1),{valueTypeOptions:c}=(0,C.Z)(),x=(0,f.Tg)([k.Sh.CUSTOM_FIELD_DELETE]),[h,p]=o.u_l.useModal(),j=(0,o.UD8)(),[g]=(0,v.UF)(),{createOrUpdate:_}=(0,b.Z)(),T=async e=>{let{id:t,resource_type:l,field_type:a}=e,n=await g({id:t,resource_type:l,field_type:a});if((0,I.D4)(n)){j.error((0,y.e$)(n.error));return}j.success("Attribute removed successfully")},E=e=>{h.confirm({title:"Remove attribute",content:"Are you sure you want to remove this attribute?",onOk:()=>T(e),okText:"Remove",centered:!0})},A=async e=>{var t;let l=null==c?void 0:c.find(t=>t.value===e);if(!l||!i){j.error("Taxonomy type not found");return}let a=await _({name:null!==(t=l.label)&&void 0!==t?t:l.value,value_type:l.value,resource_type:i},void 0,void 0);if((0,I.D4)(a)){j.error((0,y.e$)(a.error));return}j.success("Attribute added successfully"),u(!1)};return(0,r.jsxs)(o.kCb,{vertical:!0,gap:"large",children:[p,(0,r.jsx)(o.w5n,{children:(0,r.jsx)(o.w5n.Item,{label:"Fides key",children:i})}),(0,r.jsxs)(o.l09,{id:a,layout:"vertical",initialValues:s,onFinish:l,children:[(0,r.jsx)(o.l09.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,r.jsx)(o.IIB,{})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{})})]}),d&&(0,r.jsx)(o.PhF,{options:c,defaultOpen:!0,"aria-label":"Attribute type",onSelect:A}),!d&&(0,r.jsx)(o.zxk,{onClick:()=>u(!0),icon:(0,r.jsx)(o.PJP.mm_,{}),children:"Add attribute"}),(0,r.jsx)(o.aVo,{children:n.map(e=>(0,r.jsx)(o.aVo.Item,{actions:x?[(0,r.jsx)(o.zxk,{type:"link",onClick:()=>E(e),children:"Remove"},"remove")]:void 0,children:(0,r.jsx)(o.aVo.Item.Meta,{title:e.name,description:e.description})},e.id))})]})},N=l(51980),O=l(9270),S=l(16394);(a=i||(i={})).USAGE_DELETED="taxonomy.usage.deleted",a.USAGE_ADDED="taxonomy.usage.updated",a.ELEMENT_CREATED="taxonomy.element.created",a.ELEMENT_UPDATED="taxonomy.element.updated",a.ELEMENT_DELETED="taxonomy.element.deleted",a.CREATED="taxonomy.created";let D={"taxonomy.usage.deleted":"Usage removed","taxonomy.usage.updated":"Usage added","taxonomy.element.created":"Element created","taxonomy.element.deleted":"Element deleted","taxonomy.element.updated":"Element updated","taxonomy.created":"Taxonomy created"};var R=e=>{var t;let{taxonomyKey:l}=e,{paginationProps:a,pageIndex:n,pageSize:i}=(0,O.S)({defaultPageSize:10,disableUrlState:!0,showSizeChanger:!1}),{data:s,isLoading:d}=(0,g.jW)({fides_key:l,page:n,size:i});if(d)return(0,r.jsx)(o.aVo,{size:"small",itemLayout:"vertical",children:Array.from({length:5}).map((e,t)=>(0,r.jsx)(o.aVo.Item,{children:(0,r.jsx)(o.OdW,{active:!0,children:(0,r.jsx)(o.aVo.Item.Meta,{})})},t))});let u=null!==(t=null==s?void 0:s.items)&&void 0!==t?t:[];return(0,r.jsxs)(o.kCb,{vertical:!0,gap:"middle",children:[(0,r.jsx)(o.aVo,{size:"small",itemLayout:"vertical",children:u.map(e=>{var t;let l=(0,N.B)(new Date(e.created_at),new Date,{addSuffix:!0}),a=(0,S.p6)(new Date(e.created_at)),n=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.ua7,{title:a,children:"".concat((0,S.G8)(l))}),e.user_id?(0,r.jsxs)("span",{children:[" by ",e.user_id]}):null]});return(0,r.jsxs)(o.aVo.Item,{children:[(0,r.jsx)(o.aVo.Item.Meta,{title:null!==(t=D[e.event_type])&&void 0!==t?t:e.event_type,description:n}),(0,r.jsx)(o.Typography.Text,{children:e.description})]},e.id)})}),(0,r.jsx)(o.kCb,{justify:"middle",children:(null==s?void 0:s.total)&&(0,r.jsx)(o.tlE,{...a,total:s.total,hideOnSinglePage:!0})})]})};let L="custom-taxonomy-form";var w=e=>{let{taxonomy:t,onClose:l,onDelete:a,...n}=e,[i,{isLoading:s}]=(0,g.Km)(),d=(0,o.UD8)(),{sortedCustomFieldDefinitionIds:u,idToCustomFieldDefinition:c}=(0,T.mZ)({resourceType:t.fides_key}),m=u.map(e=>c.get(e)).sort((e,t)=>{var l,a;return(null!==(l=e.created_at)&&void 0!==l?l:"").localeCompare(null!==(a=t.created_at)&&void 0!==a?a:"")}),x=async e=>{if(!t.fides_key){d.error("Taxonomy not found");return}let l=await i({fides_key:t.fides_key,...e});if((0,y.D4)(l)){d.error((0,y.e$)(l.error));return}d.success("Taxonomy updated successfully")};return(0,r.jsx)(E.d,{title:"Edit ".concat(null==t?void 0:t.name),...n,itemKey:"",open:!!t,onClose:l,destroyOnHidden:!0,footer:(0,r.jsxs)(o.kCb,{justify:"space-between",className:"w-full",children:[(0,r.jsx)(o.zxk,{onClick:a,children:"Delete"}),(0,r.jsx)(o.zxk,{type:"primary",htmlType:"submit",form:L,loading:s,children:"Save"})]}),children:(0,r.jsx)(o.mQc,{items:[{label:"Details",key:"details",children:(0,r.jsx)(A,{taxonomy:t,onSubmit:x,formId:L,customFields:m})},{label:"History",key:"history",children:(0,r.jsx)(R,{taxonomyKey:t.fides_key})}]})})},M=l(79806),V=l(56358),F=l(46628),H=l(59001),U=l(90673),z=l(30002),P=l(28079),B=l(69353),Y=l(5785),G=e=>{let{taxonomyType:t}=e,[l,a]=(0,Y.Vj)(),[n,i]=(0,z.nC)(),[s,r]=(0,P.dk)(),[o,d]=(0,B.cw)(),[u,c]=(0,Y.Ti)(),[x,y]=(0,P.Ql)(),[h,p]=(0,z.wG)(),[f,v]=(0,B.Nr)(),[j]=(0,Y.jU)(),[_]=(0,P.LG)(),[T]=(0,z.h8)(),[E]=(0,B.Xz)(),[b]=(0,Y.K9)(),[C]=(0,P.gu)(),[k]=(0,z.Kv)(),[I]=(0,B.Uv)(),[A,N]=(0,g.ci)(),[O,S]=(0,g.J1)(),[D]=(0,g.Cy)(),[R]=(0,g.d9)(),L=(0,m.useCallback)(()=>t?A(t):Promise.resolve(void 0),[t,A]),w=(0,m.useCallback)(e=>t?O({taxonomyType:t,...e}):Promise.resolve(void 0),[t,O]),M=(0,m.useCallback)(e=>t?D({taxonomyType:t,...e}):Promise.resolve(void 0),[t,D]),V=(0,m.useCallback)(e=>t?R({taxonomyType:t,key:e}):Promise.resolve(void 0),[t,R]);return t===H.ac.DATA_CATEGORY?{getAllTrigger:l,taxonomyItems:a.data||[],updateTrigger:j,deleteTrigger:b,createTrigger:u,isLoading:a.isLoading,isError:a.isError,isCreating:c.isLoading}:t===H.ac.DATA_USE?{getAllTrigger:s,taxonomyItems:r.data||[],updateTrigger:_,deleteTrigger:C,createTrigger:x,isLoading:r.isLoading,isError:r.isError,isCreating:y.isLoading}:t===H.ac.DATA_SUBJECT?{getAllTrigger:n,taxonomyItems:i.data||[],updateTrigger:T,deleteTrigger:k,createTrigger:h,isLoading:i.isLoading,isError:i.isError,isCreating:p.isLoading}:t===H.ac.SYSTEM_GROUP?{getAllTrigger:o,taxonomyItems:d.data||[],updateTrigger:E,deleteTrigger:I,createTrigger:f,isLoading:d.isLoading,isError:d.isError,isCreating:v.isLoading}:{getAllTrigger:L,taxonomyItems:(null==N?void 0:N.data)||[],updateTrigger:M,deleteTrigger:V,createTrigger:w,isLoading:(null==N?void 0:N.isLoading)||!1,isError:(null==N?void 0:N.isError)||!1,isCreating:S.isLoading}},Z=l(90104),J=l.n(Z),X=l(20987),K=l(18225),q=e=>{let{taxonomyKey:t,...l}=e,{data:a,isLoading:n}=(0,g.Jy)(t);return a?(0,r.jsx)(o.PhF,{options:a.map(e=>{var t;return{value:e.fides_key,label:null!==(t=e.name)&&void 0!==t?t:e.fides_key}}),loading:n,...l}):null},W=e=>{let{customFields:t,formId:l,form:a}=e,{idToAllowListWithOptions:n,idToCustomFieldDefinition:i,isEnabled:s,isLoading:d,sortedCustomFieldDefinitionIds:u}=t;return s&&0!==u.length?(0,r.jsx)(o.l09,{form:a,name:l,initialValues:t.customFieldValues,layout:"vertical","data-testid":"custom-fields-form",children:d?(0,r.jsx)(K.Z,{}):(0,r.jsx)("div",{children:!J()(u)&&(0,r.jsx)("div",{children:u.map(e=>{let l=i.get(e);if(!l)return null;let{id:a,name:s,description:d,allow_list_id:u,field_type:c}=l;if(!u)return(0,r.jsx)(o.l09.Item,{name:a,label:s,tooltip:d,children:c===X.H.STRING?(0,r.jsx)(o.IIB,{}):(0,r.jsx)(q,{taxonomyKey:c,defaultValue:t.customFieldValues[a]})},e);let m=n.get(l.allow_list_id);if(!m)return null;let{options:x}=m;return(0,r.jsx)(o.l09.Item,{name:a,label:s,tooltip:d,children:(0,r.jsx)(o.PhF,{mode:c!==X.H.STRING?"multiple":void 0,allowClear:!0,options:x})},e)})})})}):null},$=l(43551),Q=l.n($),ee=()=>{let e=o.l09.useFormInstance(),t=o.l09.useWatch(["rights","values"],e);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.l09.Item,{label:"Automated Decisions or Profiling",name:"automated_decisions_or_profiling",layout:"horizontal",valuePropName:"checked",children:(0,r.jsx)(o.XZJ,{"data-testid":"edit-taxonomy-form_automated-decisions"})}),(0,r.jsx)(o.l09.Item,{name:["rights","values"],label:"Rights",children:(0,r.jsx)(o.PhF,{mode:"multiple",options:(0,y.MM)(k.ts),"data-testid":"edit-taxonomy-form_rights"})}),t&&!J()(t)&&(0,r.jsx)(o.l09.Item,{name:["rights","strategy"],label:"Strategy",required:!0,rules:[{required:!0,message:"Please select a strategy"}],children:(0,r.jsx)(o.PhF,{options:(0,y.MM)(k.jX),"data-testid":"edit-taxonomy-form_strategy"})})]})},et=l(83766),el=l.n(et),ea=l(1315),en=l(22583),ei=l(92818);let es=e=>{let{color:t,...l}=e;return(0,r.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(en.j[t],")"),border:t===k.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})};var er=e=>{let t=Object.values(k.Ej).map(e=>({value:e,label:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(es,{color:e}),(0,r.jsx)("span",{children:ei.r[e]})]})}));return(0,r.jsx)(o.PhF,{...e,options:t,placeholder:"Select color"})};let eo="all-suggested";var ed=e=>{let{initialValues:t,onSubmit:l,form:a,formId:n,isDisabled:i}=e,{data:s=[],isLoading:d}=(0,P.fd)(),{data:u,isLoading:c}=(0,ea.K3)(),x=(0,m.useMemo)(()=>s.map(e=>({label:e.name||e.fides_key,value:e.fides_key})),[s]),y=o.l09.useWatch("systems",a),h=(0,m.useMemo)(()=>{var e;let t=y||[];if(!u||0===t.length)return[];let l=null!==(e=null==u?void 0:u.filter(e=>t.includes(e.fides_key)))&&void 0!==e?e:[];return el()(null==l?void 0:l.flatMap(e=>e.privacy_declarations.map(e=>e.data_use)))},[u,y]),p=(0,m.useMemo)(()=>{var e;return null!==(e=null==u?void 0:u.map(e=>({label:e.name||e.fides_key,value:e.fides_key})))&&void 0!==e?e:[]},[u]),f=(0,m.useMemo)(()=>{let e=[],t=[];return(x.forEach(l=>{h.includes(l.value)?e.push(l):t.push(l)}),0===e.length)?t:[{label:"Select all suggested",value:eo},{label:(0,r.jsxs)(o.TaI,{children:[(0,r.jsx)(o.QMR,{size:14}),(0,r.jsx)("span",{children:"Suggested data uses"})]}),options:e},{label:(0,r.jsxs)(o.TaI,{children:[(0,r.jsx)(o.PJP.BBB,{}),(0,r.jsx)("span",{children:"All data uses"})]}),options:t}]},[x,h]);return(0,r.jsxs)(o.l09,{name:n,initialValues:t,onFinish:e=>{var a,n;let i={...t,...e};(!(null==i?void 0:null===(a=i.rights)||void 0===a?void 0:a.values)||J()(null==i?void 0:null===(n=i.rights)||void 0===n?void 0:n.values))&&Q()(i,"rights"),l(i)},layout:"vertical",form:a,children:[(0,r.jsx)(o.l09.Item,{label:"Name",name:"name",children:(0,r.jsx)(o.IIB,{"data-testid":"edit-taxonomy-form_name",disabled:i})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:i})}),(0,r.jsx)(o.l09.Item,{label:"Systems",name:"systems",children:(0,r.jsx)(o.PhF,{mode:"multiple",placeholder:"Select systems",options:p,allowClear:!0,loading:c,disabled:i,"data-testid":"edit-taxonomy-form_systems"})}),(0,r.jsx)(o.l09.Item,{label:"Color",name:"label_color",children:(0,r.jsx)(er,{disabled:i,"data-testid":"edit-taxonomy-form_color"})}),(0,r.jsx)(o.l09.Item,{label:"Data uses",name:"data_uses",children:(0,r.jsx)(o.PhF,{mode:"multiple",placeholder:"Select data uses",options:f,allowClear:!0,loading:d,disabled:i,onChange:e=>{if(e.includes(eo)){let t=el()([...h,...e.filter(e=>e!==eo)]);a.setFieldsValue({data_uses:t})}else a.setFieldsValue({data_uses:e})},"data-testid":"edit-taxonomy-form_data_uses"})})]})},eu=e=>{let{initialValues:t,onSubmit:l,form:a,formId:n,taxonomyType:i,isDisabled:s}=e,d=i===H.ac.DATA_SUBJECT;return i===H.ac.SYSTEM_GROUP?(0,r.jsx)(ed,{initialValues:t,onSubmit:l,form:a,formId:n,isDisabled:s}):(0,r.jsxs)(o.l09,{name:n,initialValues:t,onFinish:e=>{var a,n;let i={...t,...e};(!(null==i?void 0:null===(a=i.rights)||void 0===a?void 0:a.values)||J()(null==i?void 0:null===(n=i.rights)||void 0===n?void 0:n.values))&&Q()(i,"rights"),l(i)},layout:"vertical",form:a,children:[(0,r.jsx)(o.l09.Item,{label:"Name",name:"name",children:(0,r.jsx)(o.IIB,{"data-testid":"edit-taxonomy-form_name",disabled:s})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:s})}),d&&(0,r.jsx)(ee,{})]})},ec=e=>{let{taxonomyItem:t,taxonomyType:l,onClose:a}=e,n="edit-taxonomy-form",[i]=o.l09.useForm(),[s]=o.l09.useForm(),d=(0,o.p8r)(),{isOpen:u,onOpen:c,onClose:m}=(0,o.E2M)(),{updateTrigger:x,deleteTrigger:h}=G({taxonomyType:l}),p=(0,U.Xl)(l),v=(0,T.mZ)({resourceFidesKey:null==t?void 0:t.fides_key,resourceType:p}),j=(0,f.Tg)([(0,H.aq)(l).UPDATE]),g=(0,f.Tg)([(0,H.aq)(l).DELETE]),_=async e=>{let l=await x(e);if((0,I.D4)(l)){d((0,F.Vo)((0,y.e$)(l.error)));return}if(v.isEnabled){let e=s.getFieldsValue();await v.upsertCustomFields({fides_key:null==t?void 0:t.fides_key,customFieldValues:e})}d((0,F.t5)("Taxonomy successfully updated")),a()},E=async()=>{await h(t.fides_key),m(),a()},b=async()=>{await x({...t,active:!0}),m(),a()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(M.ZP,{isOpen:!!t,onClose:a,header:(0,r.jsx)(M.zR,{title:(null==t?void 0:t.name)||""}),footer:(0,r.jsxs)(o.KR9,{justifyContent:"space-between",children:[(null==t?void 0:t.active)&&g&&(0,r.jsx)(o.ua7,{title:"Delete label",children:(0,r.jsx)(o.zxk,{"aria-label":"delete",icon:(0,r.jsx)(V.q,{fontSize:"small"}),onClick:c,"data-testid":"delete-btn"})}),!(null==t?void 0:t.active)&&j&&(0,r.jsx)(o.ua7,{title:"Enable label",children:(0,r.jsx)(o.zxk,{"aria-label":"enable",onClick:b,"data-testid":"enable-btn",icon:(0,r.jsx)(o.tEF,{fontSize:"small"})})}),(0,r.jsx)("div",{className:"flex gap-2",children:j&&(0,r.jsx)(o.zxk,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:n,children:"Save"})})]}),children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(o.Typography.Title,{level:3,children:"Details"})}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-1/3 shrink-0 text-sm text-gray-500",children:"Fides key:"}),(0,r.jsx)(o.ua7,{title:null==t?void 0:t.fides_key,trigger:"click",children:(0,r.jsx)("span",{className:"flex-1 truncate","data-testid":"edit-drawer-fides-key",children:null==t?void 0:t.fides_key})})]})]}),!!t&&(0,r.jsx)(eu,{initialValues:t,onSubmit:_,form:i,formId:n,taxonomyType:l,isDisabled:!j}),v.isEnabled&&!v.isLoading&&(0,r.jsx)(W,{form:s,formId:"custom-fields-form",customFields:v})]}),(0,r.jsx)(o.cVQ,{isOpen:u,onClose:m,onConfirm:E,title:"Delete ".concat(l),message:(0,r.jsx)(o.EO$,{children:(0,r.jsxs)(o.Bjg,{children:["You are about to permanently delete the ",l," ",(0,r.jsx)(o.Bjg,{color:"complimentary.500",as:"span",fontWeight:"bold",children:null==t?void 0:t.name})," ","from your taxonomy. Are you sure you would like to continue?"]})})})]})};l(51901);var em=l(86298),ex=l(3124),ey=l.n(ex);(n=s||(s={})).DEFAULT="DEFAULT",n.ACTIVE_HOVER="ACTIVE_HOVER",n.PARENT_OF_HOVER="PARENT_OF_HOVER",n.CHILD_OF_HOVER="CHILD_OF_HOVER",n.SIBLING_OF_HOVER="SIBLING_OF_HOVER",n.INACTIVE="INACTIVE";let eh=(0,m.createContext)({activeNodeKey:null,setActiveNodeKey:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},getNodeHoverStatus:()=>"DEFAULT"}),ep=e=>{let{children:t}=e,[l,a]=(0,m.useState)(null),n=(0,m.useCallback)(e=>{e!==l&&a(e)},[l]),i=(0,m.useCallback)(()=>{a(null)},[]),s=(0,m.useCallback)(e=>l?e===l?"ACTIVE_HOVER":l.startsWith("".concat(e,"."))||e===H.Ch?"PARENT_OF_HOVER":e.startsWith("".concat(l,"."))||l===H.Ch?"CHILD_OF_HOVER":l.split(".").slice(0,-1).join(".")===e.split(".").slice(0,-1).join(".")?"SIBLING_OF_HOVER":"INACTIVE":"DEFAULT",[l]),o=(0,m.useMemo)(()=>({activeNodeKey:l,setActiveNodeKey:a,onMouseEnter:n,onMouseLeave:i,getNodeHoverStatus:s}),[l,a,n,i,s]);return(0,r.jsx)(eh.Provider,{value:o,children:t})};var ef=l(62266),ev=l(79658);let ej=(0,ef.Z)();var eg=e=>{let{nodes:t,edges:l,options:a}=e;return(0,m.useMemo)(()=>{if(0===t.length)return{nodes:t,edges:l};let e=(0,ev.Z)().id(e=>e.id).parentId(e=>{var t;return null===(t=l.find(t=>t.target===e.id))||void 0===t?void 0:t.source})(t),n="LR"===a.direction?[35,320]:[320,35];return{nodes:ej.nodeSize(n).separation((e,t)=>e.parent===t.parent?1:1.5)(e).descendants().map(e=>{let t;return t="LR"===a.direction?{x:e.y,y:e.x}:{x:e.x,y:e.y},{...e.data,position:t}}),edges:l}},[t,l,a])},e_=e=>{let{positionAbsoluteX:t,positionAbsoluteY:l,nodeWidth:a}=e,{setCenter:n,getZoom:i}=(0,em._K)();return{centerScreenOnNode:(0,m.useCallback)(()=>n(t+a/2,l,{duration:500,zoom:i()}),[i,t,l,a,n])}},eT=l(1945),eE=l.n(eT),eb=l(8335),eC=e=>{let{type:t,inactive:l=!1}=e;return(0,r.jsx)(em.HH,{type:t,position:"source"===t?eb.Ly.Right:eb.Ly.Left,style:{width:8,height:8,backgroundColor:l?ey().FIDESUI_NEUTRAL_400:ey().FIDESUI_MINOS},className:"transition-colors duration-300 ease-in"})},ek=e=>{let{data:t,positionAbsoluteX:l,positionAbsoluteY:a}=e,{onCancel:n,onSubmit:i,parentKey:s,isLoading:d=!1}=t,u=(0,m.useRef)(null),[c,x]=(0,m.useState)(""),{centerScreenOnNode:y}=e_({positionAbsoluteX:l,positionAbsoluteY:a,nodeWidth:200});(0,m.useEffect)(()=>{x("");let e=()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.focus({cursor:"start",preventScroll:!0})};(async()=>{await y(),e()})()},[s,y,l,a]);let h=()=>{!d&&c.trim()&&i(c)},p=()=>{d||n()};return(0,r.jsxs)("div",{style:{width:200},"data-testid":"taxonomy-text-input-node",children:[(0,r.jsx)(o.IIB,{placeholder:"Type label name...",ref:u,onBlur:p,onSubmit:h,value:c,onChange:e=>x(e.target.value),onKeyUp:e=>{"Escape"===e.key&&p()},onPressEnter:h,className:eE().input,suffix:d&&(0,r.jsx)(o.yCA,{size:"small"})}),(0,r.jsx)(eC,{type:"target"})]})},eI=e=>{let{getNodeHoverStatus:t}=(0,m.useContext)(eh),{target:l}=e,a=t(l),n=(0,m.useCallback)(()=>{switch(a){case s.ACTIVE_HOVER:case s.PARENT_OF_HOVER:return ey().FIDESUI_MINOS;case s.INACTIVE:return ey().NEUTRAL_400;default:return ey().FIDESUI_SANDSTONE}},[a]),i=(0,m.useCallback)(()=>{switch(a){case s.ACTIVE_HOVER:case s.PARENT_OF_HOVER:return 2;default:return 1}},[a]);return(0,r.jsx)(em.Jd,{...e,style:{stroke:n(),strokeWidth:i(),transition:"stroke 0.3s ease 0s"}})},eA=l(34770),eN=l.n(eA),eO=e=>{let{data:t,positionAbsoluteX:l,positionAbsoluteY:a}=e,{onMouseEnter:n,onMouseLeave:i,getNodeHoverStatus:d}=(0,m.useContext)(eh),{taxonomyType:u,taxonomyItem:c,onAddButtonClick:x,onTaxonomyItemClick:y,label:h,hasChildren:p,isLastCreatedItem:f,resetLastCreatedItemKey:v,userCanAddLabels:j}=t,{centerScreenOnNode:g}=e_({positionAbsoluteX:l,positionAbsoluteY:a,nodeWidth:200});(0,m.useEffect)(()=>{let e=async()=>{await g(),n(null==c?void 0:c.fides_key)};f&&(e(),v())},[f,n,null==c?void 0:c.fides_key,v,g]);let _=d(null==c?void 0:c.fides_key),T=(0,m.useCallback)(()=>{switch(_){case s.ACTIVE_HOVER:return eN()["button--hover"];case s.PARENT_OF_HOVER:return eN()["button--parent-hover"];case s.INACTIVE:return eN()["button--inactive"];case s.DEFAULT:case s.CHILD_OF_HOVER:case s.SIBLING_OF_HOVER:default:return""}},[_]),E=(null==c?void 0:c.fides_key)===H.Ch,b=u===H.ac.DATA_SUBJECT;return(0,r.jsxs)("div",{className:eN().container,onMouseEnter:()=>n(null==c?void 0:c.fides_key),onMouseLeave:()=>i(null==c?void 0:c.fides_key),"data-testid":"taxonomy-node-".concat(null==c?void 0:c.fides_key),children:[(0,r.jsx)(o.zxk,{className:"".concat(eN().button," ").concat(T()),onClick:()=>null==y?void 0:y(c),disabled:!y,type:"text",children:(0,r.jsxs)(o.Typography.Text,{ellipsis:!0,style:{color:"inherit"},children:[(null==c?void 0:c.active)===!1?"(disabled) ":"",h]})}),!E&&(0,r.jsx)(eC,{type:"target",inactive:_===s.INACTIVE}),p&&(0,r.jsx)(eC,{type:"source",inactive:_===s.INACTIVE}),j&&(!b||E)&&(0,r.jsx)("div",{className:eN()["add-button-container"],children:(0,r.jsx)(o.zxk,{type:"default",className:"".concat(eN()["add-button"]," ").concat(_===s.ACTIVE_HOVER?eN()["add-button--visible"]:""),icon:(0,r.jsx)(o.PJP.mm_,{size:20}),onClick:()=>null==x?void 0:x(c),size:"middle","data-testid":"taxonomy-add-child-label-button","aria-label":"Add child label to ".concat(h)})})]})};let eS=e=>{let{taxonomyType:t,taxonomyItems:l,draftNewItem:a,lastCreatedItemKey:n,resetLastCreatedItemKey:i,onRootItemClick:s,onTaxonomyItemClick:o,onAddButtonClick:d,onCancelDraftItem:u,onSubmitDraftItem:c,userCanAddLabels:x,isCreating:y=!1,rootNodeLabel:h}=e,{fitView:p}=(0,em._K)();(0,m.useEffect)(()=>{setTimeout(()=>p(),150)},[p,t,l.length]);let f=[(0,m.useMemo)(()=>({id:H.Ch,position:{x:0,y:0},data:{label:h||t,taxonomyItem:{fides_key:H.Ch},taxonomyType:t,onTaxonomyItemClick:s,onAddButtonClick:d,hasChildren:0!==l.length,userCanAddLabels:x},type:"taxonomyTreeNode"}),[h,t,s,d,l.length,x])],v=[];if(l.forEach(e=>{let l=e.name||e.fides_key.split(".").pop()||"",a={id:e.fides_key,position:{x:0,y:0},data:{label:l,taxonomyType:t,taxonomyItem:e,onTaxonomyItemClick:o,onAddButtonClick:d,hasChildren:!1,isLastCreatedItem:n===e.fides_key,resetLastCreatedItemKey:i,userCanAddLabels:x},type:"taxonomyTreeNode"};f.push(a);let s=e.parent_key?f.find(t=>t.id===e.parent_key):null,r=s?s.id:H.Ch,u=e.fides_key,c={id:"".concat(r,"-").concat(u),source:r,target:u,type:"taxonomyTreeEdge"};v.push(c),s&&(s.data.hasChildren=!0)}),a){let e=a.parent_key||H.Ch;f.push({id:"draft-node",position:{x:0,y:0},type:"textInputNode",data:{parentKey:e,onCancel:u,onSubmit:c,isLoading:y},hidden:!a}),v.push({id:"draft-line",source:e,target:"draft-node",animated:!0});let t=f.find(t=>t.id===e);t&&(t.data.hasChildren=!0)}let{nodes:j,edges:g}=eg({nodes:f,edges:v,options:{direction:"LR"}}),_=(0,m.useMemo)(()=>({taxonomyTreeNode:eO,textInputNode:ek}),[]),T=(0,m.useMemo)(()=>({taxonomyTreeEdge:eI}),[]);return(0,r.jsx)("div",{className:"size-full",style:{backgroundColor:ey().FIDESUI_BG_CORINTH},"data-testid":"taxonomy-interactive-tree",children:(0,r.jsx)(ep,{children:(0,r.jsxs)(em.x$,{nodes:j,edges:g,nodeTypes:_,edgeTypes:T,maxZoom:2,minZoom:.3,nodesConnectable:!1,edgesFocusable:!1,elementsSelectable:!1,proOptions:{hideAttribution:!0},children:[(0,r.jsx)(em.Aq,{color:ey().FIDESUI_NEUTRAL_100,variant:em.T7.Dots,size:3}),(0,r.jsx)(em.a9,{nodeStrokeWidth:3,pannable:!0}),(0,r.jsx)(em.ZX,{showInteractive:!1})]})})})};var eD=e=>(0,r.jsx)(em.tV,{children:(0,r.jsx)(eS,{...e})});let eR="add new item",eL=H.ac.DATA_CATEGORY;var ew=e=>{let{initialTaxonomy:t}=e,l=(0,c.useRouter)(),a=null!=t?t:eL,n=!Object.values(H.ac).includes(a),i=(0,x.hz)().plus,{isLoading:s}=(0,v.x8)(),{data:d}=(0,g.MU)(void 0,{skip:!i}),{createTrigger:j,getAllTrigger:T,taxonomyItems:E=[],isCreating:b}=G({taxonomyType:a}),C="true"===l.query.showDisabledItems,k=(0,o.UD8)();(0,m.useEffect)(()=>{T()},[T,a]);let[I,A]=(0,m.useState)(null),[N,O]=(0,m.useState)(null),[S,D]=(0,m.useState)(null),[R,L]=(0,m.useState)(null),M=(0,o.ddY)(),[V]=(0,g.EO)(),F=async()=>{if(!(null==N?void 0:N.fides_key)){k.error("Taxonomy not found");return}let e=await V(N.fides_key);if((0,y.D4)(e)){k.error((0,y.e$)(e.error));return}k.success("Taxonomy deleted successfully"),O(null);let t={...l.query};delete t.key,l.replace({pathname:"/taxonomy",query:t},void 0,{shallow:!0})},U=(0,m.useMemo)(()=>{var e;if(!d)return null;let t=d.find(e=>e.fides_key===a);return null!==(e=null==t?void 0:t.name)&&void 0!==e?e:null==t?void 0:t.fides_key},[d,a]),[z,P]=(0,m.useState)(!1);(0,m.useEffect)(()=>{D(null),L(null),A(null)},[a]),(0,m.useEffect)(()=>{if(a===H.ac.SYSTEM_GROUP&&!s&&!i){let e={...l.query};delete e.key,l.replace({pathname:"/taxonomy",query:e},void 0,{shallow:!0})}},[a,i,s,l]);let B=(0,m.useCallback)(async e=>{if(!S)return;let t=(null==S?void 0:S.parent_key)===H.Ch,l={...S,name:e,parent_key:t?null:S.parent_key},a=await j(l);if((0,y.D4)(a)){k.error((0,y.e$)(a.error));return}L(a.data.fides_key),k.success("New label successfully created"),D(null)},[j,S,k]),Y=u()(E,"active"),Z=(0,f.Tg)([(0,H.aq)(a).CREATE]);return(0,r.jsxs)(h.Z,{title:"Taxonomy",children:[(0,r.jsxs)(o.kCb,{vertical:!0,className:"h-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(p.Z,{heading:"Taxonomy"}),(0,r.jsx)("div",{className:"hidden",children:(0,r.jsx)("div",{className:"mb-5 flex justify-between",children:(0,r.jsxs)(o.TaI.Compact,{children:[(0,r.jsx)(o.IIB,{className:"min-w-[350px]",placeholder:"Search",allowClear:!0}),(0,r.jsx)(o.zxk,{type:"default",children:"Clear"})]})})})]}),(0,r.jsxs)("div",{className:"relative grow",children:[(0,r.jsx)("div",{className:"absolute left-2 top-2 z-[1]",children:(0,r.jsx)(o.AHg,{selectedKeys:[a],onSelect:e=>{let{key:t}=e;if(t===eR){P(!0);return}let a={...l.query};delete a.key,l.replace({pathname:"/taxonomy/".concat(t),query:a},void 0,{shallow:!0})},items:(()=>{let e={[H.Lo.DATA_CATEGORIES]:H.ac.DATA_CATEGORY,[H.Lo.DATA_USES]:H.ac.DATA_USE,[H.Lo.DATA_SUBJECTS]:H.ac.DATA_SUBJECT,[H.Lo.SYSTEM_GROUPS]:H.ac.SYSTEM_GROUP},t=(0,y.MM)(H.Lo).filter(e=>i||e.value!==H.Lo.SYSTEM_GROUPS).map(t=>({label:t.label,key:e[t.value]}));return(null==d?void 0:d.length)&&d.forEach(e=>{t.push({label:e.name,key:e.fides_key})}),i&&(t.push({type:"divider"}),t.push({label:"+ Create new",key:eR})),t})(),"data-testid":"taxonomy-type-selector"})}),(0,r.jsx)(o.u_l,{open:z,destroyOnHidden:!0,onCancel:()=>P(!1),width:768,footer:null,centered:!0,title:"Create new taxonomy",children:(0,r.jsx)(_,{onClose:()=>P(!1)})}),(0,r.jsx)(eD,{userCanAddLabels:Z,taxonomyItems:C?E:Y,draftNewItem:S,lastCreatedItemKey:R,resetLastCreatedItemKey:()=>L(null),onTaxonomyItemClick:e=>{A(e)},onRootItemClick:n?()=>{let e=null==d?void 0:d.find(e=>e.fides_key===a);e&&O(e)}:null,onAddButtonClick:e=>{var t;D({parent_key:null!==(t=null==e?void 0:e.fides_key)&&void 0!==t?t:null,is_default:!1,description:""})},taxonomyType:a,onCancelDraftItem:()=>D(null),onSubmitDraftItem:B,isCreating:b,rootNodeLabel:null!=U?U:(0,H._g)(a)})]})]}),I&&(0,r.jsx)(ec,{taxonomyItem:I,taxonomyType:a,onClose:()=>A(null)}),i&&N&&(0,r.jsx)(w,{title:U?"Edit ".concat(U):"Edit taxonomy",onClose:()=>O(null),onDelete:()=>{M.confirm({title:"Delete ".concat(null==N?void 0:N.name,"?"),icon:null,content:(0,r.jsx)(o.Typography.Paragraph,{children:"Are you sure you want to delete this taxonomy? This action cannot be undone."}),okText:"Delete",okType:"primary",onOk:F,centered:!0})},taxonomy:N})]})}},90673:function(e,t,l){"use strict";l.d(t,{Cd:function(){return i},Xl:function(){return s}});var a=l(20987),n=l(59001);let i=(e,t)=>{let l;if(null==t&&e.every(e=>void 0===e.parent_key))l=e;else{let a=null!=t?t:null;l=e.filter(e=>e.parent_key===a)}return l.map(t=>{var l,a;let n=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:i(e,n),is_default:null!==(l=t.is_default)&&void 0!==l&&l,active:null!==(a=t.active)&&void 0!==a&&a}})},s=e=>{switch(e){case n.ac.DATA_CATEGORY:return a.J.DATA_CATEGORY;case n.ac.DATA_SUBJECT:return a.J.DATA_SUBJECT;case n.ac.DATA_USE:return a.J.DATA_USE;default:return e}}},1945:function(e){e.exports={input:"TaxonomyTextInputNode_input__P9czz"}},34770:function(e){e.exports={container:"TaxonomyTreeNode_container__T4KpF",button:"TaxonomyTreeNode_button__mcbOd","button--hover":"TaxonomyTreeNode_button--hover__oycXY","button--parent-hover":"TaxonomyTreeNode_button--parent-hover__pwAPl","button--inactive":"TaxonomyTreeNode_button--inactive__Fjdpe","add-button-container":"TaxonomyTreeNode_add-button-container__eEoRN","add-button":"TaxonomyTreeNode_add-button__oM2vI","add-button--visible":"TaxonomyTreeNode_add-button--visible__Ojqqf"}}}]);