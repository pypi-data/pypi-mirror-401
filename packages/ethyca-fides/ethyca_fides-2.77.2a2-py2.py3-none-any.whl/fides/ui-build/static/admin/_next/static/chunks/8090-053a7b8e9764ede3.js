(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8090],{79806:function(e,t,l){"use strict";l.d(t,{Gn:function(){return r},zR:function(){return s}});var i=l(24246),a=l(41725),n=l(56358);let s=e=>{let{title:t}=e;return(0,i.jsx)(a.v7L,{py:0,display:"flex",alignItems:"flex-start",children:(0,i.jsx)(a.Bjg,{mr:"2",color:"gray.700",fontSize:"lg",lineHeight:1.8,children:t})})},r=e=>{let{onDelete:t,onEditYaml:l,formId:s,isSaving:r}=e;return(0,i.jsxs)(a.KR9,{justifyContent:"space-between",children:[t?(0,i.jsx)(a.zxk,{"aria-label":"delete",icon:(0,i.jsx)(n.q,{fontSize:"small"}),onClick:t,"data-testid":"delete-btn"}):null,(0,i.jsxs)("div",{className:"flex gap-2",children:[l&&(0,i.jsx)(a.zxk,{onClick:l,"data-testid":"edit-yaml-btn",children:"Edit YAML"}),(0,i.jsx)(a.zxk,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:s,loading:r,children:"Save"})]})]})};t.ZP=e=>{let{header:t,description:l,isOpen:n,onClose:s,children:r,footer:o}=e;return(0,i.jsxs)(a.JTh,{placement:"right",isOpen:n,onClose:s,size:"md",children:[(0,i.jsx)(a.yY5,{}),(0,i.jsxs)(a.mJD,{"data-testid":"edit-drawer-content",py:2,children:[(0,i.jsxs)(a.TJV,{display:"flex",justifyContent:"space-between",alignItems:"top",mr:2,py:2,gap:2,children:[(0,i.jsx)(a.TJV,{flex:1,minH:8,children:t}),(0,i.jsx)(a.TJV,{display:"flex",justifyContent:"flex-end",mr:2,children:(0,i.jsx)(a.zxk,{"aria-label":"Close editor",onClick:s,"data-testid":"close-drawer-btn",icon:(0,i.jsx)(a.j_w,{fontSize:"smaller"})})})]}),(0,i.jsxs)(a.Q4$,{pt:1,children:[l?(0,i.jsx)(a.Bjg,{fontSize:"sm",mb:4,color:"gray.600",children:l}):null,r]}),o]})]})}},18225:function(e,t,l){"use strict";var i=l(24246),a=l(41725);t.Z=e=>{let{alignment:t="center",...l}=e;return(0,i.jsx)(a.ad9,{boxSize:"full",align:"center",justify:t,children:(0,i.jsx)(a.Y6B,{color:"primary",...l})})}},56358:function(e,t,l){"use strict";l.d(t,{q:function(){return a}});var i=l(24246);let a=(0,l(41725).G1m)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,i.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},58754:function(e,t,l){"use strict";var i=l(24246),a=l(41725),n=l(70788);t.Z=e=>{let{heading:t,breadcrumbItems:l,isSticky:s=!0,children:r,rightContent:o,style:d,...u}=e;return(0,i.jsxs)("div",{...u,style:s?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,i.jsxs)(a.kCb,{justify:"space-between",children:["string"==typeof t?(0,i.jsx)(a.Dxz,{className:l||r?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,i.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!l&&(0,i.jsx)(n.m,{className:r?"pb-4":void 0,items:l,"data-testid":"page-breadcrumb"}),r]})}},19904:function(e,t,l){"use strict";l.d(t,{Tg:function(){return s}});var i=l(24246),a=l(16134),n=l(31793);let s=e=>(0,a.C)(n.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:l}=e;return s(t)?(0,i.jsx)(i.Fragment,{children:l}):null}},94799:function(e,t,l){"use strict";l.d(t,{k:function(){return n}});var i=l(76649);let a=e=>(0,i.Ln)({id:"string"},e),n=e=>(null!=e?e:[]).filter(a)},30320:function(e,t,l){"use strict";l.d(t,{m:function(){return o}});var i=l(27378),a=l(25980),n=l(17245),s=l(32885),r=l(94799);let o=e=>{let{resourceFidesKey:t,resourceType:l}=e,{errorAlert:o}=(0,n.VY)(),{plus:d}=(0,a.hz)(),u=(0,i.useMemo)(()=>null!=t?t:"",[]),c=(0,s.YU)(!0,{skip:!d}),m=(0,s.VN)(l,{skip:!d}),{data:x,isLoading:p,error:y,isError:h}=(0,s.PV)(null!=t?t:"",{skip:""!==u&&!(d&&u)}),[f]=(0,s._D)(),v=c.isLoading||m.isLoading||p,g=(0,i.useMemo)(()=>new Map((0,r.k)(c.data).map(e=>{var t;return[e.id,{...e,options:(null!==(t=e.allowed_values)&&void 0!==t?t:[]).map(e=>({value:e,label:e}))}]})),[c.data]),_=(0,i.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),j=(0,i.useMemo)(()=>new Map((0,r.k)(_).map(e=>[e.id,e])),[_]),T=(0,i.useMemo)(()=>h&&y&&"status"in y&&404===y.status?new Map:new Map((0,r.k)(x).map(e=>[e.custom_field_definition_id,e])),[x,h,y]),E=(0,i.useMemo)(()=>{let e=[...j.keys()];return e.sort(),e},[j]),b=(0,i.useMemo)(()=>{let e={};return _&&T&&_.forEach(t=>{let l=T.get(t.id||"");l&&(t.allow_list_id&&"string[]"===t.field_type?e[l.custom_field_definition_id]=l.value:e[l.custom_field_definition_id]=l.value.toString())}),e},[_,T]),C=(0,i.useCallback)(async e=>{if(!d)return;let i="fides_key"in e&&""!==e.fides_key?e.fides_key:t;if(!i)return;let{customFieldValues:a}=e;if(!a||0===Object.keys(a).length)return;let n=[],s=[];E.forEach(e=>{let t=T.get(e),l=a[e];void 0===l||""===l||Array.isArray(l)&&0===l.length?(null==t?void 0:t.id)&&s.push(t.id):n.push({custom_field_definition_id:e,resource_id:i,id:null==t?void 0:t.id,value:l})});try{await f({resource_type:l,resource_id:i,upsert:n,delete:s})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,T,o,t,E,f,l]);return{customFieldValues:b,definitionIdToCustomField:T,idToAllowListWithOptions:g,idToCustomFieldDefinition:j,isEnabled:d,isLoading:v,sortedCustomFieldDefinitionIds:E,upsertCustomFields:C}}},33162:function(e,t,l){"use strict";l.d(t,{uc:function(){return c},mZ:function(){return u.m}});var i=l(24246),a=l(41725),n=l(34090),s=l(20987),r=l(30234),o=l(97181),d=l(40324),u=l(30320);let c=e=>{let{resourceFidesKey:t,resourceType:l}=e,{idToAllowListWithOptions:c,idToCustomFieldDefinition:m,isEnabled:x,isLoading:p,sortedCustomFieldDefinitionIds:y}=(0,u.m)({resourceFidesKey:t,resourceType:l});return x&&0!==y.length?(0,i.jsx)(r.Z,{heading:"Custom fields",children:(0,i.jsx)(a.ad9,{flexDir:"column","data-testid":"custom-fields-list",children:(0,i.jsx)(a.ad9,{flexDir:"column",gap:"24px",children:p?(0,i.jsx)(a.w4_,{children:(0,i.jsx)(a.Y6B,{})}):y.length>0&&(0,i.jsx)(a.ad9,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:y.map(e=>{let t=m.get(e);if(!t)return null;let l="customFieldValues.".concat(t.id);if(!t.allow_list_id&&t.field_type===s.H.STRING)return(0,i.jsx)(n.gN,{name:l,children:e=>{let{field:l}=e;return(0,i.jsx)(d.j0,{...l,label:t.name,tooltip:t.description,variant:"stacked"})}},e);let a=c.get(t.allow_list_id);if(!a)return null;let{options:r}=a;return(0,i.jsx)(o.d,{name:l,allowClear:!0,mode:t.field_type!==s.H.STRING?"multiple":void 0,label:t.name,options:r,tooltip:t.description,layout:"stacked",className:"w-full"},e)})})})})}):null};l(94799)},97181:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var i=l(24246),a=l(41725),n=l(34090),s=l(27378),r=l(46238),o=l(40324);let d=e=>{let{name:t,label:l,labelProps:d,tooltip:u,isRequired:c,layout:m="inline",helperText:x,...p}=e,[y,h,{setValue:f}]=(0,n.U$)(t),v=!!(h.touched&&h.error),[g,_]=(0,s.useState)("");y.value||"tags"!==p.mode&&"multiple"!==p.mode||(y.value=[]),"tags"===p.mode&&"string"==typeof y.value&&(y.value=[y.value]);let j="tags"===p.mode?(e,t)=>e?e.value!==g||y.value.includes(g)?p.optionRender?p.optionRender(e,t):e.label:'Create "'.concat(g,'"'):void 0:p.optionRender||void 0,T=e=>{_(e),p.onSearch&&p.onSearch(e)},E=(e,t)=>{f(e),p.onChange&&p.onChange(e,t)};return"inline"===m?(0,i.jsx)(a.DTt,{isInvalid:v,isRequired:c,children:(0,i.jsxs)(a.MoG,{templateColumns:l?"1fr 3fr":"1fr",children:[l?(0,i.jsx)(o.__,{htmlFor:p.id||t,...d,children:l}):null,(0,i.jsxs)(a.kCb,{align:"center",children:[(0,i.jsxs)(a.kCb,{vertical:!0,flex:1,className:"mr-2",children:[(0,i.jsx)(a.PhF,{...y,id:p.id||t,"data-testid":"controlled-select-".concat(y.name),...p,optionRender:j,onSearch:"tags"===p.mode?T:void 0,onChange:E,value:y.value||void 0,status:v?"error":void 0}),x&&(0,i.jsx)(a.Kug,{children:x}),(0,i.jsx)(o.Bc,{isInvalid:v,message:h.error,fieldName:y.name})]}),(0,i.jsx)(r.b,{label:u,className:v?"mt-2 self-start":void 0})]})]})}):(0,i.jsx)(a.DTt,{isInvalid:v,isRequired:c,children:(0,i.jsxs)(a.s_g,{alignItems:"start",children:[(0,i.jsxs)(a.kCb,{align:"center",children:[l?(0,i.jsx)(o.__,{htmlFor:p.id||t,fontSize:"xs",my:0,mr:1,...d,children:l}):null,(0,i.jsx)(r.b,{label:u})]}),(0,i.jsx)(a.PhF,{...y,id:p.id||t,"data-testid":"controlled-select-".concat(y.name),...p,optionRender:j,onSearch:"tags"===p.mode?T:void 0,onChange:E,value:y.value||void 0,status:v?"error":void 0}),x&&(0,i.jsx)(a.Kug,{style:{marginTop:0},children:x}),(0,i.jsx)(o.Bc,{isInvalid:v,message:h.error,fieldName:y.name})]})})}},70788:function(e,t,l){"use strict";l.d(t,{m:function(){return d}});var i=l(24246),a=l(41725),n=l(79894),s=l.n(n),r=l(27378);let{Text:o}=a.Typography,d=e=>{let{items:t,...l}=e,n=(0,r.useMemo)(()=>null==t?void 0:t.map((e,l)=>{let n=l===t.length-1,r={...e},d=r.onClick&&!r.href;return("string"==typeof r.title&&(r.title=(0,i.jsx)(o,{style:{color:"inherit",maxWidth:n?void 0:400},ellipsis:!n,id:n?"breadcrumb-current-page":void 0,children:r.title})),d)?r.title=(0,i.jsx)(a.zxk,{type:"text",size:"small",icon:r.icon,onClick:r.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:r.title}):(r.icon&&(r.title=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"anticon align-text-bottom",children:r.icon}),r.title]})),r.href&&r.title&&(r.title=(0,i.jsx)(s(),{href:r.href,className:"ant-breadcrumb-link",children:r.title}),delete r.href)),r}),[t]);return(0,i.jsx)(a.aGc,{items:n,...l})}},9270:function(e,t,l){"use strict";l.d(t,{S:function(){return n}});var i=l(27378),a=l(36866);let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,a.h)(e),{pageIndex:l,pageSize:n,updatePageIndex:s,updatePageSize:r,pageSizeOptions:o,showSizeChanger:d}=t,u=(0,i.useMemo)(()=>({current:l,pageSize:n,showSizeChanger:d,pageSizeOptions:o.map(String),onChange:s,onShowSizeChange:(e,t)=>{r(t)}}),[l,n,d,o,s,r]);return{...t,paginationProps:u}}},8917:function(e,t,l){"use strict";l.d(t,{P3:function(){return o},TY:function(){return r},Uv:function(){return a},uP:function(){return s}});var i,a,n=l(20987);let s=new Map([[n.J.SYSTEM,"system:information"],[n.J.DATA_USE,"taxonomy:data use"],[n.J.DATA_CATEGORY,"taxonomy:data category"],[n.J.DATA_SUBJECT,"taxonomy:data subject"],[n.J.PRIVACY_DECLARATION,"system:data use"]]);(i=a||(a={})).SINGLE_SELECT="singleSelect",i.MULTIPLE_SELECT="multipleSelect",i.OPEN_TEXT="openText";let r=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open text",value:"openText"}],o={singleSelect:"Single-value select",multipleSelect:"Multi-value select",openText:"Open text"}},67522:function(e,t,l){"use strict";var i=l(56141),a=l.n(i),n=l(20987),s=l(812),r=l(8917),o=l(32885);let d=()=>Date.now().toString()+Math.random().toString(),u=e=>e.startsWith("taxonomy:")?e.split(":",2)[1]:"system:information"===e?"system":"system:data use"===e?"privacy declaration":e;t.Z=()=>{let[e,{isLoading:t}]=(0,o.Ld)(),[l,{isLoading:i}]=(0,o.yM)(),[c]=(0,o.Nt)();return{createOrUpdate:async function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,m=u(t.resource_type);if(t.field_type===r.Uv.OPEN_TEXT){let a={...t,field_type:n.H.STRING,id:i?i.id:void 0,resource_type:m};return i?await l(a):await e(a)}if(t.field_type===r.Uv.SINGLE_SELECT||t.field_type===r.Uv.MULTIPLE_SELECT){var x,p;let u;if(!i){let{options:l,...i}=t,a={name:d(),allowed_values:null!=l?l:[]},o=await c(a);if((0,s.D4)(o))return o;let u={...i,field_type:t.field_type===r.Uv.SINGLE_SELECT?n.H.STRING:n.H.STRING_ARRAY,allow_list_id:null===(x=o.data)||void 0===x?void 0:x.id,resource_type:m};return await e(u)}let{options:y,...h}=t;if(!a()(null==o?void 0:o.allowed_values,y)){let e={...o,name:null!==(p=null==o?void 0:o.name)&&void 0!==p?p:d(),id:null==o?void 0:o.id,allowed_values:null!=y?y:[]};if(u=await c(e),(0,s.D4)(u))return u}let f={...h,id:i.id,allow_list_id:u&&!(0,s.D4)(u)?u.data.id:i.allow_list_id,resource_type:m,field_type:t.field_type===r.Uv.SINGLE_SELECT?n.H.STRING:n.H.STRING_ARRAY};return await l(f)}let{value_type:y,...h}=t,f={...h,id:i?i.id:void 0,field_type:y,resource_type:m};return i?await l(f):await e(f)},isLoading:t||i}}},66006:function(e,t,l){"use strict";var i=l(25980),a=l(59001),n=l(39864);t.Z=()=>{let{plus:e}=(0,i.hz)(),{data:t,isLoading:l}=(0,n.MU)(void 0,{skip:!e}),s=[{label:a.Lo.DATA_CATEGORIES,value:a.ac.DATA_CATEGORY},{label:a.Lo.DATA_USES,value:a.ac.DATA_USE},{label:a.Lo.DATA_SUBJECTS,value:a.ac.DATA_SUBJECT}];return e&&s.push({label:a.Lo.SYSTEM_GROUPS,value:a.ac.SYSTEM_GROUP}),l||(null==t?void 0:t.length)&&s.push(...t.map(e=>({label:e.name,value:e.fides_key}))),{valueTypeOptions:s}}},84418:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var i=l(24246),a=l(41725),n=l(98784),s=l.n(n);let r=e=>{let{itemKey:t,actions:l}=e;return s().isEmpty(l)?null:(0,i.jsx)(a.kCb,{gap:"small",justify:"flex-end",children:l.map((e,n)=>{let{callback:s,label:r,disabled:o}=e;return(0,i.jsx)(a.zxk,{onClick:()=>s(t),type:n===l.length-1?"primary":"default",disabled:o,children:r},r)})})},o=e=>{let{title:t,titleIcon:l,titleTag:n}=e;return(0,i.jsxs)(a.kCb,{align:"center",gap:"small",children:[l,(0,i.jsx)("span",{children:t}),n&&(0,i.jsx)(a.Vp9,{...n})]})},d=e=>{let{title:t,titleIcon:l,titleTag:n,actions:s,width:d=480,...u}=e;return(0,i.jsx)(a.dys,{title:(0,i.jsx)(o,{title:t,titleIcon:l,titleTag:n}),footer:u.footer||!s?u.footer:(0,i.jsx)(r,{itemKey:u.itemKey,actions:s}),width:d,...u})}},33335:function(e,t,l){"use strict";l.d(t,{E:function(){return i}});let i=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},30234:function(e,t,l){"use strict";var i=l(24246),a=l(41725);t.Z=e=>{let{heading:t,HeadingButton:l,children:n}=e;return(0,i.jsx)(a.EO$,{spacing:4,children:(0,i.jsxs)(a.TJV,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,i.jsxs)(a.TJV,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,i.jsx)(a.y_b,{as:"h3",size:"xs",children:t}),l&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.s3C,{}),l]})]}),(0,i.jsx)(a.EO$,{spacing:4,px:6,py:6,children:n})]})})}},22583:function(e,t,l){"use strict";l.d(t,{j:function(){return n}});var i=l(41725),a=l(60240);let n={[a.Ej.TAXONOMY_WHITE]:i.tAb.DEFAULT,[a.Ej.TAXONOMY_RED]:i.tAb.ERROR,[a.Ej.TAXONOMY_ORANGE]:i.tAb.WARNING,[a.Ej.TAXONOMY_YELLOW]:i.tAb.CAUTION,[a.Ej.TAXONOMY_GREEN]:i.tAb.SUCCESS,[a.Ej.TAXONOMY_BLUE]:i.tAb.INFO,[a.Ej.TAXONOMY_PURPLE]:i.tAb.ALERT,[a.Ej.SANDSTONE]:i.tAb.SANDSTONE,[a.Ej.MINOS]:i.tAb.MINOS}},92818:function(e,t,l){"use strict";l.d(t,{r:function(){return o}});var i=l(24246),a=l(27378),n=l(97181),s=l(22583),r=l(60240);let o={[r.Ej.TAXONOMY_WHITE]:"White",[r.Ej.TAXONOMY_RED]:"Red",[r.Ej.TAXONOMY_ORANGE]:"Orange",[r.Ej.TAXONOMY_YELLOW]:"Yellow",[r.Ej.TAXONOMY_GREEN]:"Green",[r.Ej.TAXONOMY_BLUE]:"Blue",[r.Ej.TAXONOMY_PURPLE]:"Purple",[r.Ej.SANDSTONE]:"Sandstone",[r.Ej.MINOS]:"Minos"},d=e=>{let{color:t,...l}=e;return(0,i.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(s.j[t],")"),border:t===r.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})},u=e=>{let t=null==e?void 0:e.value,l=null==e?void 0:e.label;return(0,i.jsxs)("span",{className:"flex items-center",children:[(0,i.jsx)(d,{color:t}),(0,i.jsx)("span",{children:l})]})};t.Z=e=>{let t=Object.values(r.Ej).map(e=>({value:e,label:o[e]})),[l,s]=(0,a.useState)(void 0);return(0,i.jsx)(n.d,{...e,options:t,optionRender:u,layout:"stacked",value:l,onChange:e=>{s(e)},prefix:(0,i.jsx)(d,{color:null!=l?l:r.Ej.TAXONOMY_WHITE,style:{marginBottom:"2px"}})})}},58090:function(e,t,l){"use strict";l.d(t,{Z:function(){return ew}});var i,a,n,s,r=l(24246),o=l(41725),d=l(69238),u=l.n(d),c=l(86677),m=l(27378),x=l(25980),p=l(812),y=l(77213),h=l(58754),f=l(19904),v=l(32885),g=l(33335),_=l(39864),j=e=>{let{onClose:t}=e,[l,{isLoading:i}]=(0,_.Hb)(),a=(0,o.UD8)(),n=async e=>{var i;let n={...e,taxonomy_type:(0,g.E)(null!==(i=e.name)&&void 0!==i?i:"")},s=await l(n);if((0,p.D4)(s)){a.error((0,p.e$)(s.error));return}a.success("Taxonomy created successfully"),t()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Typography.Paragraph,{children:"Create and organize the core terminology your team uses to describe data and how it's handled. Custom taxonomies let you define domain-specific concepts and then apply them to other privacy objects throughout the platform"}),(0,r.jsxs)(o.l09,{layout:"vertical",onFinish:n,validateTrigger:["onBlur","onChange"],children:[(0,r.jsx)(o.l09.Item,{label:"Taxonomy name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,r.jsx)(o.IIB,{"data-testid":"input-name"})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{rows:2,"data-testid":"input-description"})}),(0,r.jsxs)(o.kCb,{gap:"small",justify:"space-between",children:[(0,r.jsx)(o.zxk,{onClick:t,disabled:i,children:"Cancel"}),(0,r.jsx)(o.zxk,{type:"primary",htmlType:"submit",loading:i,disabled:i,"data-testid":"save-btn",children:"Create taxonomy"})]})]})]})},T=l(33162),E=l(84418),b=l(67522),C=l(66006),k=l(60240),A=l(31883),I=e=>{let{taxonomy:t,onSubmit:l,formId:i,customFields:a}=e,{fides_key:n,...s}=null!=t?t:{},[d,u]=(0,m.useState)(!1),{valueTypeOptions:c}=(0,C.Z)(),x=(0,f.Tg)([k.Sh.CUSTOM_FIELD_DELETE]),[y,h]=o.u_l.useModal(),g=(0,o.UD8)(),[_]=(0,v.UF)(),{createOrUpdate:j}=(0,b.Z)(),T=async e=>{let{id:t,resource_type:l,field_type:i}=e,a=await _({id:t,resource_type:l,field_type:i});if((0,A.D4)(a)){g.error((0,p.e$)(a.error));return}g.success("Attribute removed successfully")},E=e=>{y.confirm({title:"Remove attribute",content:"Are you sure you want to remove this attribute?",onOk:()=>T(e),okText:"Remove",centered:!0})},I=async e=>{var t;let l=null==c?void 0:c.find(t=>t.value===e);if(!l||!n){g.error("Taxonomy type not found");return}let i=await j({name:null!==(t=l.label)&&void 0!==t?t:l.value,value_type:l.value,resource_type:n},void 0,void 0);if((0,A.D4)(i)){g.error((0,p.e$)(i.error));return}g.success("Attribute added successfully"),u(!1)};return(0,r.jsxs)(o.kCb,{vertical:!0,gap:"large",children:[h,(0,r.jsx)(o.w5n,{children:(0,r.jsx)(o.w5n.Item,{label:"Fides key",children:n})}),(0,r.jsxs)(o.l09,{id:i,layout:"vertical",initialValues:s,onFinish:l,children:[(0,r.jsx)(o.l09.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Name is required"}],children:(0,r.jsx)(o.IIB,{})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{})})]}),d&&(0,r.jsx)(o.PhF,{options:c,defaultOpen:!0,"aria-label":"Attribute type",onSelect:I}),!d&&(0,r.jsx)(o.zxk,{onClick:()=>u(!0),icon:(0,r.jsx)(o.PJP.mm_,{}),children:"Add attribute"}),(0,r.jsx)(o.aVo,{children:a.map(e=>(0,r.jsx)(o.aVo.Item,{actions:x?[(0,r.jsx)(o.zxk,{type:"link",onClick:()=>E(e),children:"Remove"},"remove")]:void 0,children:(0,r.jsx)(o.aVo.Item.Meta,{title:e.name,description:e.description})},e.id))})]})},S=l(51980),N=l(9270),O=l(16394);(i=n||(n={})).USAGE_DELETED="taxonomy.usage.deleted",i.USAGE_ADDED="taxonomy.usage.updated",i.ELEMENT_CREATED="taxonomy.element.created",i.ELEMENT_UPDATED="taxonomy.element.updated",i.ELEMENT_DELETED="taxonomy.element.deleted",i.CREATED="taxonomy.created";let L={"taxonomy.usage.deleted":"Usage removed","taxonomy.usage.updated":"Usage added","taxonomy.element.created":"Element created","taxonomy.element.deleted":"Element deleted","taxonomy.element.updated":"Element updated","taxonomy.created":"Taxonomy created"};var D=e=>{var t;let{taxonomyKey:l}=e,{paginationProps:i,pageIndex:a,pageSize:n}=(0,N.S)({defaultPageSize:10,disableUrlState:!0,showSizeChanger:!1}),{data:s,isLoading:d}=(0,_.jW)({fides_key:l,page:a,size:n});if(d)return(0,r.jsx)(o.aVo,{size:"small",itemLayout:"vertical",children:Array.from({length:5}).map((e,t)=>(0,r.jsx)(o.aVo.Item,{children:(0,r.jsx)(o.OdW,{active:!0,children:(0,r.jsx)(o.aVo.Item.Meta,{})})},t))});let u=null!==(t=null==s?void 0:s.items)&&void 0!==t?t:[];return(0,r.jsxs)(o.kCb,{vertical:!0,gap:"middle",children:[(0,r.jsx)(o.aVo,{size:"small",itemLayout:"vertical",children:u.map(e=>{var t;let l=(0,S.B)(new Date(e.created_at),new Date,{addSuffix:!0}),i=(0,O.p6)(new Date(e.created_at)),a=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.ua7,{title:i,children:"".concat((0,O.G8)(l))}),e.user_id?(0,r.jsxs)("span",{children:[" by ",e.user_id]}):null]});return(0,r.jsxs)(o.aVo.Item,{children:[(0,r.jsx)(o.aVo.Item.Meta,{title:null!==(t=L[e.event_type])&&void 0!==t?t:e.event_type,description:a}),(0,r.jsx)(o.Typography.Text,{children:e.description})]},e.id)})}),(0,r.jsx)(o.kCb,{justify:"middle",children:(null==s?void 0:s.total)&&(0,r.jsx)(o.tlE,{...i,total:s.total,hideOnSinglePage:!0})})]})};let R="custom-taxonomy-form";var w=e=>{let{taxonomy:t,onClose:l,onDelete:i,...a}=e,[n,{isLoading:s}]=(0,_.Km)(),d=(0,o.UD8)(),{sortedCustomFieldDefinitionIds:u,idToCustomFieldDefinition:c}=(0,T.mZ)({resourceType:t.fides_key}),m=u.map(e=>c.get(e)).sort((e,t)=>{var l,i;return(null!==(l=e.created_at)&&void 0!==l?l:"").localeCompare(null!==(i=t.created_at)&&void 0!==i?i:"")}),x=async e=>{if(!t.fides_key){d.error("Taxonomy not found");return}let l=await n({fides_key:t.fides_key,...e});if((0,p.D4)(l)){d.error((0,p.e$)(l.error));return}d.success("Taxonomy updated successfully")};return(0,r.jsx)(E.d,{title:"Edit ".concat(null==t?void 0:t.name),...a,itemKey:"",open:!!t,onClose:l,destroyOnHidden:!0,footer:(0,r.jsxs)(o.kCb,{justify:"space-between",className:"w-full",children:[(0,r.jsx)(o.zxk,{onClick:i,children:"Delete"}),(0,r.jsx)(o.zxk,{type:"primary",htmlType:"submit",form:R,loading:s,children:"Save"})]}),children:(0,r.jsx)(o.mQc,{items:[{label:"Details",key:"details",children:(0,r.jsx)(I,{taxonomy:t,onSubmit:x,formId:R,customFields:m})},{label:"History",key:"history",children:(0,r.jsx)(D,{taxonomyKey:t.fides_key})}]})})},M=l(79806),V=l(56358),U=l(46628),F=l(59001),H=l(90673),P=l(30002),z=l(28079),B=l(69353),G=l(5785),Y=e=>{let{taxonomyType:t}=e,[l,i]=(0,G.Vj)(),[a,n]=(0,P.nC)(),[s,r]=(0,z.dk)(),[o,d]=(0,B.cw)(),[u,c]=(0,G.Ti)(),[x,p]=(0,z.Ql)(),[y,h]=(0,P.wG)(),[f,v]=(0,B.Nr)(),[g]=(0,G.jU)(),[j]=(0,z.LG)(),[T]=(0,P.h8)(),[E]=(0,B.Xz)(),[b]=(0,G.K9)(),[C]=(0,z.gu)(),[k]=(0,P.Kv)(),[A]=(0,B.Uv)(),[I,S]=(0,_.ci)(),[N,O]=(0,_.J1)(),[L]=(0,_.Cy)(),[D]=(0,_.d9)(),R=(0,m.useCallback)(()=>t?I(t):Promise.resolve(void 0),[t,I]),w=(0,m.useCallback)(e=>t?N({taxonomyType:t,...e}):Promise.resolve(void 0),[t,N]),M=(0,m.useCallback)(e=>t?L({taxonomyType:t,...e}):Promise.resolve(void 0),[t,L]),V=(0,m.useCallback)(e=>t?D({taxonomyType:t,key:e}):Promise.resolve(void 0),[t,D]);return t===F.ac.DATA_CATEGORY?{getAllTrigger:l,taxonomyItems:i.data||[],updateTrigger:g,deleteTrigger:b,createTrigger:u,isLoading:i.isLoading,isError:i.isError,isCreating:c.isLoading}:t===F.ac.DATA_USE?{getAllTrigger:s,taxonomyItems:r.data||[],updateTrigger:j,deleteTrigger:C,createTrigger:x,isLoading:r.isLoading,isError:r.isError,isCreating:p.isLoading}:t===F.ac.DATA_SUBJECT?{getAllTrigger:a,taxonomyItems:n.data||[],updateTrigger:T,deleteTrigger:k,createTrigger:y,isLoading:n.isLoading,isError:n.isError,isCreating:h.isLoading}:t===F.ac.SYSTEM_GROUP?{getAllTrigger:o,taxonomyItems:d.data||[],updateTrigger:E,deleteTrigger:A,createTrigger:f,isLoading:d.isLoading,isError:d.isError,isCreating:v.isLoading}:{getAllTrigger:R,taxonomyItems:(null==S?void 0:S.data)||[],updateTrigger:M,deleteTrigger:V,createTrigger:w,isLoading:(null==S?void 0:S.isLoading)||!1,isError:(null==S?void 0:S.isError)||!1,isCreating:O.isLoading}},J=l(90104),Z=l.n(J),X=l(20987),K=l(18225),W=e=>{let{taxonomyKey:t,...l}=e,{data:i,isLoading:a}=(0,_.Jy)(t);return i?(0,r.jsx)(o.PhF,{options:i.map(e=>{var t;return{value:e.fides_key,label:null!==(t=e.name)&&void 0!==t?t:e.fides_key}}),loading:a,...l}):null},q=e=>{let{customFields:t,formId:l,form:i}=e,{idToAllowListWithOptions:a,idToCustomFieldDefinition:n,isEnabled:s,isLoading:d,sortedCustomFieldDefinitionIds:u}=t;return s&&0!==u.length?(0,r.jsx)(o.l09,{form:i,name:l,initialValues:t.customFieldValues,layout:"vertical","data-testid":"custom-fields-form",children:d?(0,r.jsx)(K.Z,{}):(0,r.jsx)("div",{children:!Z()(u)&&(0,r.jsx)("div",{children:u.map(e=>{let l=n.get(e);if(!l)return null;let{id:i,name:s,description:d,allow_list_id:u,field_type:c}=l;if(!u)return(0,r.jsx)(o.l09.Item,{name:i,label:s,tooltip:d,children:c===X.H.STRING?(0,r.jsx)(o.IIB,{}):(0,r.jsx)(W,{taxonomyKey:c,defaultValue:t.customFieldValues[i]})},e);let m=a.get(l.allow_list_id);if(!m)return null;let{options:x}=m;return(0,r.jsx)(o.l09.Item,{name:i,label:s,tooltip:d,children:(0,r.jsx)(o.PhF,{mode:c!==X.H.STRING?"multiple":void 0,allowClear:!0,options:x})},e)})})})}):null},$=l(43551),Q=l.n($),ee=()=>{let e=o.l09.useFormInstance(),t=o.l09.useWatch(["rights","values"],e);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.l09.Item,{label:"Automated Decisions or Profiling",name:"automated_decisions_or_profiling",layout:"horizontal",valuePropName:"checked",children:(0,r.jsx)(o.XZJ,{"data-testid":"edit-taxonomy-form_automated-decisions"})}),(0,r.jsx)(o.l09.Item,{name:["rights","values"],label:"Rights",children:(0,r.jsx)(o.PhF,{mode:"multiple",options:(0,p.MM)(k.ts),"data-testid":"edit-taxonomy-form_rights"})}),t&&!Z()(t)&&(0,r.jsx)(o.l09.Item,{name:["rights","strategy"],label:"Strategy",required:!0,rules:[{required:!0,message:"Please select a strategy"}],children:(0,r.jsx)(o.PhF,{options:(0,p.MM)(k.jX),"data-testid":"edit-taxonomy-form_strategy"})})]})},et=l(83766),el=l.n(et),ei=l(1315),ea=l(22583),en=l(92818);let es=e=>{let{color:t,...l}=e;return(0,r.jsx)("span",{"aria-hidden":!0,className:"mr-2 inline-block size-4 rounded-lg align-middle",style:{backgroundColor:"var(--fidesui-bg-".concat(ea.j[t],")"),border:t===k.Ej.TAXONOMY_WHITE?"1px solid var(--fidesui-neutral-200)":"none",...l.style}})};var er=e=>{let t=Object.values(k.Ej).map(e=>({value:e,label:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(es,{color:e}),(0,r.jsx)("span",{children:en.r[e]})]})}));return(0,r.jsx)(o.PhF,{...e,options:t,placeholder:"Select color"})};let eo="all-suggested";var ed=e=>{let{initialValues:t,onSubmit:l,form:i,formId:a,isDisabled:n}=e,{data:s=[],isLoading:d}=(0,z.fd)(),{data:u,isLoading:c}=(0,ei.K3)(),x=(0,m.useMemo)(()=>s.map(e=>({label:e.name||e.fides_key,value:e.fides_key})),[s]),p=o.l09.useWatch("systems",i),y=(0,m.useMemo)(()=>{var e;let t=p||[];if(!u||0===t.length)return[];let l=null!==(e=null==u?void 0:u.filter(e=>t.includes(e.fides_key)))&&void 0!==e?e:[];return el()(null==l?void 0:l.flatMap(e=>e.privacy_declarations.map(e=>e.data_use)))},[u,p]),h=(0,m.useMemo)(()=>{var e;return null!==(e=null==u?void 0:u.map(e=>({label:e.name||e.fides_key,value:e.fides_key})))&&void 0!==e?e:[]},[u]),f=(0,m.useMemo)(()=>{let e=[],t=[];return(x.forEach(l=>{y.includes(l.value)?e.push(l):t.push(l)}),0===e.length)?t:[{label:"Select all suggested",value:eo},{label:(0,r.jsxs)(o.TaI,{children:[(0,r.jsx)(o.QMR,{size:14}),(0,r.jsx)("span",{children:"Suggested data uses"})]}),options:e},{label:(0,r.jsxs)(o.TaI,{children:[(0,r.jsx)(o.PJP.BBB,{}),(0,r.jsx)("span",{children:"All data uses"})]}),options:t}]},[x,y]);return(0,r.jsxs)(o.l09,{name:a,initialValues:t,onFinish:e=>{var i,a;let n={...t,...e};(!(null==n?void 0:null===(i=n.rights)||void 0===i?void 0:i.values)||Z()(null==n?void 0:null===(a=n.rights)||void 0===a?void 0:a.values))&&Q()(n,"rights"),l(n)},layout:"vertical",form:i,children:[(0,r.jsx)(o.l09.Item,{label:"Name",name:"name",children:(0,r.jsx)(o.IIB,{"data-testid":"edit-taxonomy-form_name",disabled:n})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:n})}),(0,r.jsx)(o.l09.Item,{label:"Systems",name:"systems",children:(0,r.jsx)(o.PhF,{mode:"multiple",placeholder:"Select systems",options:h,allowClear:!0,loading:c,disabled:n,"data-testid":"edit-taxonomy-form_systems"})}),(0,r.jsx)(o.l09.Item,{label:"Color",name:"label_color",children:(0,r.jsx)(er,{disabled:n,"data-testid":"edit-taxonomy-form_color"})}),(0,r.jsx)(o.l09.Item,{label:"Data uses",name:"data_uses",children:(0,r.jsx)(o.PhF,{mode:"multiple",placeholder:"Select data uses",options:f,allowClear:!0,loading:d,disabled:n,onChange:e=>{if(e.includes(eo)){let t=el()([...y,...e.filter(e=>e!==eo)]);i.setFieldsValue({data_uses:t})}else i.setFieldsValue({data_uses:e})},"data-testid":"edit-taxonomy-form_data_uses"})})]})},eu=e=>{let{initialValues:t,onSubmit:l,form:i,formId:a,taxonomyType:n,isDisabled:s}=e,d=n===F.ac.DATA_SUBJECT;return n===F.ac.SYSTEM_GROUP?(0,r.jsx)(ed,{initialValues:t,onSubmit:l,form:i,formId:a,isDisabled:s}):(0,r.jsxs)(o.l09,{name:a,initialValues:t,onFinish:e=>{var i,a;let n={...t,...e};(!(null==n?void 0:null===(i=n.rights)||void 0===i?void 0:i.values)||Z()(null==n?void 0:null===(a=n.rights)||void 0===a?void 0:a.values))&&Q()(n,"rights"),l(n)},layout:"vertical",form:i,children:[(0,r.jsx)(o.l09.Item,{label:"Name",name:"name",children:(0,r.jsx)(o.IIB,{"data-testid":"edit-taxonomy-form_name",disabled:s})}),(0,r.jsx)(o.l09.Item,{label:"Description",name:"description",children:(0,r.jsx)(o.IIB.TextArea,{rows:4,"data-testid":"edit-taxonomy-form_description",disabled:s})}),d&&(0,r.jsx)(ee,{})]})},ec=e=>{let{taxonomyItem:t,taxonomyType:l,onClose:i}=e,a="edit-taxonomy-form",[n]=o.l09.useForm(),[s]=o.l09.useForm(),d=(0,o.p8r)(),{isOpen:u,onOpen:c,onClose:m}=(0,o.E2M)(),{updateTrigger:x,deleteTrigger:y}=Y({taxonomyType:l}),h=(0,H.Xl)(l),v=(0,T.mZ)({resourceFidesKey:null==t?void 0:t.fides_key,resourceType:h}),g=(0,f.Tg)([(0,F.aq)(l).UPDATE]),_=(0,f.Tg)([(0,F.aq)(l).DELETE]),j=async e=>{let l=await x(e);if((0,A.D4)(l)){d((0,U.Vo)((0,p.e$)(l.error)));return}if(v.isEnabled){let e=s.getFieldsValue();await v.upsertCustomFields({fides_key:null==t?void 0:t.fides_key,customFieldValues:e})}d((0,U.t5)("Taxonomy successfully updated")),i()},E=async()=>{await y(t.fides_key),m(),i()},b=async()=>{await x({...t,active:!0}),m(),i()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(M.ZP,{isOpen:!!t,onClose:i,header:(0,r.jsx)(M.zR,{title:(null==t?void 0:t.name)||""}),footer:(0,r.jsxs)(o.KR9,{justifyContent:"space-between",children:[(null==t?void 0:t.active)&&_&&(0,r.jsx)(o.ua7,{title:"Delete label",children:(0,r.jsx)(o.zxk,{"aria-label":"delete",icon:(0,r.jsx)(V.q,{fontSize:"small"}),onClick:c,"data-testid":"delete-btn"})}),!(null==t?void 0:t.active)&&g&&(0,r.jsx)(o.ua7,{title:"Enable label",children:(0,r.jsx)(o.zxk,{"aria-label":"enable",onClick:b,"data-testid":"enable-btn",icon:(0,r.jsx)(o.tEF,{fontSize:"small"})})}),(0,r.jsx)("div",{className:"flex gap-2",children:g&&(0,r.jsx)(o.zxk,{htmlType:"submit",type:"primary","data-testid":"save-btn",form:a,children:"Save"})})]}),children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)(o.Typography.Title,{level:3,children:"Details"})}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("span",{className:"w-1/3 shrink-0 text-sm text-gray-500",children:"Fides key:"}),(0,r.jsx)(o.ua7,{title:null==t?void 0:t.fides_key,trigger:"click",children:(0,r.jsx)("span",{className:"flex-1 truncate","data-testid":"edit-drawer-fides-key",children:null==t?void 0:t.fides_key})})]})]}),!!t&&(0,r.jsx)(eu,{initialValues:t,onSubmit:j,form:n,formId:a,taxonomyType:l,isDisabled:!g}),v.isEnabled&&!v.isLoading&&(0,r.jsx)(q,{form:s,formId:"custom-fields-form",customFields:v})]}),(0,r.jsx)(o.cVQ,{isOpen:u,onClose:m,onConfirm:E,title:"Delete ".concat(l),message:(0,r.jsx)(o.EO$,{children:(0,r.jsxs)(o.Bjg,{children:["You are about to permanently delete the ",l," ",(0,r.jsx)(o.Bjg,{color:"complimentary.500",as:"span",fontWeight:"bold",children:null==t?void 0:t.name})," ","from your taxonomy. Are you sure you would like to continue?"]})})})]})};l(51901);var em=l(86298),ex=l(3124),ep=l.n(ex);(a=s||(s={})).DEFAULT="DEFAULT",a.ACTIVE_HOVER="ACTIVE_HOVER",a.PARENT_OF_HOVER="PARENT_OF_HOVER",a.CHILD_OF_HOVER="CHILD_OF_HOVER",a.SIBLING_OF_HOVER="SIBLING_OF_HOVER",a.INACTIVE="INACTIVE";let ey=(0,m.createContext)({activeNodeKey:null,setActiveNodeKey:()=>{},onMouseEnter:()=>{},onMouseLeave:()=>{},getNodeHoverStatus:()=>"DEFAULT"}),eh=e=>{let{children:t}=e,[l,i]=(0,m.useState)(null),a=(0,m.useCallback)(e=>{e!==l&&i(e)},[l]),n=(0,m.useCallback)(()=>{i(null)},[]),s=(0,m.useCallback)(e=>l?e===l?"ACTIVE_HOVER":l.startsWith("".concat(e,"."))||e===F.Ch?"PARENT_OF_HOVER":e.startsWith("".concat(l,"."))||l===F.Ch?"CHILD_OF_HOVER":l.split(".").slice(0,-1).join(".")===e.split(".").slice(0,-1).join(".")?"SIBLING_OF_HOVER":"INACTIVE":"DEFAULT",[l]),o=(0,m.useMemo)(()=>({activeNodeKey:l,setActiveNodeKey:i,onMouseEnter:a,onMouseLeave:n,getNodeHoverStatus:s}),[l,i,a,n,s]);return(0,r.jsx)(ey.Provider,{value:o,children:t})};var ef=l(62266),ev=l(79658);let eg=(0,ef.Z)();var e_=e=>{let{nodes:t,edges:l,options:i}=e;return(0,m.useMemo)(()=>{if(0===t.length)return{nodes:t,edges:l};let e=(0,ev.Z)().id(e=>e.id).parentId(e=>{var t;return null===(t=l.find(t=>t.target===e.id))||void 0===t?void 0:t.source})(t),a="LR"===i.direction?[35,320]:[320,35];return{nodes:eg.nodeSize(a).separation((e,t)=>e.parent===t.parent?1:1.5)(e).descendants().map(e=>{let t;return t="LR"===i.direction?{x:e.y,y:e.x}:{x:e.x,y:e.y},{...e.data,position:t}}),edges:l}},[t,l,i])},ej=e=>{let{positionAbsoluteX:t,positionAbsoluteY:l,nodeWidth:i}=e,{setCenter:a,getZoom:n}=(0,em._K)();return{centerScreenOnNode:(0,m.useCallback)(()=>a(t+i/2,l,{duration:500,zoom:n()}),[n,t,l,i,a])}},eT=l(1945),eE=l.n(eT),eb=l(8335),eC=e=>{let{type:t,inactive:l=!1}=e;return(0,r.jsx)(em.HH,{type:t,position:"source"===t?eb.Ly.Right:eb.Ly.Left,style:{width:8,height:8,backgroundColor:l?ep().FIDESUI_NEUTRAL_400:ep().FIDESUI_MINOS},className:"transition-colors duration-300 ease-in"})},ek=e=>{let{data:t,positionAbsoluteX:l,positionAbsoluteY:i}=e,{onCancel:a,onSubmit:n,parentKey:s,isLoading:d=!1}=t,u=(0,m.useRef)(null),[c,x]=(0,m.useState)(""),{centerScreenOnNode:p}=ej({positionAbsoluteX:l,positionAbsoluteY:i,nodeWidth:200});(0,m.useEffect)(()=>{x("");let e=()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.focus({cursor:"start",preventScroll:!0})};(async()=>{await p(),e()})()},[s,p,l,i]);let y=()=>{!d&&c.trim()&&n(c)},h=()=>{d||a()};return(0,r.jsxs)("div",{style:{width:200},"data-testid":"taxonomy-text-input-node",children:[(0,r.jsx)(o.IIB,{placeholder:"Type label name...",ref:u,onBlur:h,onSubmit:y,value:c,onChange:e=>x(e.target.value),onKeyUp:e=>{"Escape"===e.key&&h()},onPressEnter:y,className:eE().input,suffix:d&&(0,r.jsx)(o.yCA,{size:"small"})}),(0,r.jsx)(eC,{type:"target"})]})},eA=e=>{let{getNodeHoverStatus:t}=(0,m.useContext)(ey),{target:l}=e,i=t(l),a=(0,m.useCallback)(()=>{switch(i){case s.ACTIVE_HOVER:case s.PARENT_OF_HOVER:return ep().FIDESUI_MINOS;case s.INACTIVE:return ep().NEUTRAL_400;default:return ep().FIDESUI_SANDSTONE}},[i]),n=(0,m.useCallback)(()=>{switch(i){case s.ACTIVE_HOVER:case s.PARENT_OF_HOVER:return 2;default:return 1}},[i]);return(0,r.jsx)(em.Jd,{...e,style:{stroke:a(),strokeWidth:n(),transition:"stroke 0.3s ease 0s"}})},eI=l(34770),eS=l.n(eI),eN=e=>{let{data:t,positionAbsoluteX:l,positionAbsoluteY:i}=e,{onMouseEnter:a,onMouseLeave:n,getNodeHoverStatus:d}=(0,m.useContext)(ey),{taxonomyType:u,taxonomyItem:c,onAddButtonClick:x,onTaxonomyItemClick:p,label:y,hasChildren:h,isLastCreatedItem:f,resetLastCreatedItemKey:v,userCanAddLabels:g}=t,{centerScreenOnNode:_}=ej({positionAbsoluteX:l,positionAbsoluteY:i,nodeWidth:200});(0,m.useEffect)(()=>{let e=async()=>{await _(),a(null==c?void 0:c.fides_key)};f&&(e(),v())},[f,a,null==c?void 0:c.fides_key,v,_]);let j=d(null==c?void 0:c.fides_key),T=(0,m.useCallback)(()=>{switch(j){case s.ACTIVE_HOVER:return eS()["button--hover"];case s.PARENT_OF_HOVER:return eS()["button--parent-hover"];case s.INACTIVE:return eS()["button--inactive"];case s.DEFAULT:case s.CHILD_OF_HOVER:case s.SIBLING_OF_HOVER:default:return""}},[j]),E=(null==c?void 0:c.fides_key)===F.Ch,b=u===F.ac.DATA_SUBJECT;return(0,r.jsxs)("div",{className:eS().container,onMouseEnter:()=>a(null==c?void 0:c.fides_key),onMouseLeave:()=>n(null==c?void 0:c.fides_key),"data-testid":"taxonomy-node-".concat(null==c?void 0:c.fides_key),children:[(0,r.jsx)(o.zxk,{className:"".concat(eS().button," ").concat(T()),onClick:()=>null==p?void 0:p(c),disabled:!p,type:"text",children:(0,r.jsxs)(o.Typography.Text,{ellipsis:!0,style:{color:"inherit"},children:[(null==c?void 0:c.active)===!1?"(disabled) ":"",y]})}),!E&&(0,r.jsx)(eC,{type:"target",inactive:j===s.INACTIVE}),h&&(0,r.jsx)(eC,{type:"source",inactive:j===s.INACTIVE}),g&&(!b||E)&&(0,r.jsx)("div",{className:eS()["add-button-container"],children:(0,r.jsx)(o.zxk,{type:"default",className:"".concat(eS()["add-button"]," ").concat(j===s.ACTIVE_HOVER?eS()["add-button--visible"]:""),icon:(0,r.jsx)(o.PJP.mm_,{size:20}),onClick:()=>null==x?void 0:x(c),size:"middle","data-testid":"taxonomy-add-child-label-button","aria-label":"Add child label to ".concat(y)})})]})};let eO=e=>{let{taxonomyType:t,taxonomyItems:l,draftNewItem:i,lastCreatedItemKey:a,resetLastCreatedItemKey:n,onRootItemClick:s,onTaxonomyItemClick:o,onAddButtonClick:d,onCancelDraftItem:u,onSubmitDraftItem:c,userCanAddLabels:x,isCreating:p=!1,rootNodeLabel:y}=e,{fitView:h}=(0,em._K)();(0,m.useEffect)(()=>{setTimeout(()=>h(),150)},[h,t,l.length]);let f=[(0,m.useMemo)(()=>({id:F.Ch,position:{x:0,y:0},data:{label:y||t,taxonomyItem:{fides_key:F.Ch},taxonomyType:t,onTaxonomyItemClick:s,onAddButtonClick:d,hasChildren:0!==l.length,userCanAddLabels:x},type:"taxonomyTreeNode"}),[y,t,s,d,l.length,x])],v=[];if(l.forEach(e=>{let l=e.name||e.fides_key.split(".").pop()||"",i={id:e.fides_key,position:{x:0,y:0},data:{label:l,taxonomyType:t,taxonomyItem:e,onTaxonomyItemClick:o,onAddButtonClick:d,hasChildren:!1,isLastCreatedItem:a===e.fides_key,resetLastCreatedItemKey:n,userCanAddLabels:x},type:"taxonomyTreeNode"};f.push(i);let s=e.parent_key?f.find(t=>t.id===e.parent_key):null,r=s?s.id:F.Ch,u=e.fides_key,c={id:"".concat(r,"-").concat(u),source:r,target:u,type:"taxonomyTreeEdge"};v.push(c),s&&(s.data.hasChildren=!0)}),i){let e=i.parent_key||F.Ch;f.push({id:"draft-node",position:{x:0,y:0},type:"textInputNode",data:{parentKey:e,onCancel:u,onSubmit:c,isLoading:p},hidden:!i}),v.push({id:"draft-line",source:e,target:"draft-node",animated:!0});let t=f.find(t=>t.id===e);t&&(t.data.hasChildren=!0)}let{nodes:g,edges:_}=e_({nodes:f,edges:v,options:{direction:"LR"}}),j=(0,m.useMemo)(()=>({taxonomyTreeNode:eN,textInputNode:ek}),[]),T=(0,m.useMemo)(()=>({taxonomyTreeEdge:eA}),[]);return(0,r.jsx)("div",{className:"size-full",style:{backgroundColor:ep().FIDESUI_BG_CORINTH},"data-testid":"taxonomy-interactive-tree",children:(0,r.jsx)(eh,{children:(0,r.jsxs)(em.x$,{nodes:g,edges:_,nodeTypes:j,edgeTypes:T,maxZoom:2,minZoom:.3,nodesConnectable:!1,edgesFocusable:!1,elementsSelectable:!1,proOptions:{hideAttribution:!0},children:[(0,r.jsx)(em.Aq,{color:ep().FIDESUI_NEUTRAL_100,variant:em.T7.Dots,size:3}),(0,r.jsx)(em.a9,{nodeStrokeWidth:3,pannable:!0}),(0,r.jsx)(em.ZX,{showInteractive:!1})]})})})};var eL=e=>(0,r.jsx)(em.tV,{children:(0,r.jsx)(eO,{...e})});let eD="add new item",eR=F.ac.DATA_CATEGORY;var ew=e=>{let{initialTaxonomy:t}=e,l=(0,c.useRouter)(),i=null!=t?t:eR,a=!Object.values(F.ac).includes(i),n=(0,x.hz)().plus,{isLoading:s}=(0,v.x8)(),{data:d}=(0,_.MU)(void 0,{skip:!n}),{createTrigger:g,getAllTrigger:T,taxonomyItems:E=[],isCreating:b}=Y({taxonomyType:i}),C="true"===l.query.showDisabledItems,k=(0,o.UD8)();(0,m.useEffect)(()=>{T()},[T,i]);let[A,I]=(0,m.useState)(null),[S,N]=(0,m.useState)(null),[O,L]=(0,m.useState)(null),[D,R]=(0,m.useState)(null),M=(0,o.ddY)(),[V]=(0,_.EO)(),U=async()=>{if(!(null==S?void 0:S.fides_key)){k.error("Taxonomy not found");return}let e=await V(S.fides_key);if((0,p.D4)(e)){k.error((0,p.e$)(e.error));return}k.success("Taxonomy deleted successfully"),N(null);let t={...l.query};delete t.key,l.replace({pathname:"/taxonomy",query:t},void 0,{shallow:!0})},H=(0,m.useMemo)(()=>{var e;if(!d)return null;let t=d.find(e=>e.fides_key===i);return null!==(e=null==t?void 0:t.name)&&void 0!==e?e:null==t?void 0:t.fides_key},[d,i]),[P,z]=(0,m.useState)(!1);(0,m.useEffect)(()=>{L(null),R(null),I(null)},[i]),(0,m.useEffect)(()=>{if(i===F.ac.SYSTEM_GROUP&&!s&&!n){let e={...l.query};delete e.key,l.replace({pathname:"/taxonomy",query:e},void 0,{shallow:!0})}},[i,n,s,l]);let B=(0,m.useCallback)(async e=>{if(!O)return;let t=(null==O?void 0:O.parent_key)===F.Ch,l={...O,name:e,parent_key:t?null:O.parent_key},i=await g(l);if((0,p.D4)(i)){k.error((0,p.e$)(i.error));return}R(i.data.fides_key),k.success("New label successfully created"),L(null)},[g,O,k]),G=u()(E,"active"),J=(0,f.Tg)([(0,F.aq)(i).CREATE]);return(0,r.jsxs)(y.Z,{title:"Taxonomy",children:[(0,r.jsxs)(o.kCb,{vertical:!0,className:"h-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h.Z,{heading:"Taxonomy"}),(0,r.jsx)("div",{className:"hidden",children:(0,r.jsx)("div",{className:"mb-5 flex justify-between",children:(0,r.jsxs)(o.TaI.Compact,{children:[(0,r.jsx)(o.IIB,{className:"min-w-[350px]",placeholder:"Search",allowClear:!0}),(0,r.jsx)(o.zxk,{type:"default",children:"Clear"})]})})})]}),(0,r.jsxs)("div",{className:"relative grow",children:[(0,r.jsx)("div",{className:"absolute left-2 top-2 z-[1]",children:(0,r.jsx)(o.AHg,{selectedKeys:[i],onSelect:e=>{let{key:t}=e;if(t===eD){z(!0);return}let i={...l.query};delete i.key,l.replace({pathname:"/taxonomy/".concat(t),query:i},void 0,{shallow:!0})},items:(()=>{let e={[F.Lo.DATA_CATEGORIES]:F.ac.DATA_CATEGORY,[F.Lo.DATA_USES]:F.ac.DATA_USE,[F.Lo.DATA_SUBJECTS]:F.ac.DATA_SUBJECT,[F.Lo.SYSTEM_GROUPS]:F.ac.SYSTEM_GROUP},t=(0,p.MM)(F.Lo).filter(e=>n||e.value!==F.Lo.SYSTEM_GROUPS).map(t=>({label:t.label,key:e[t.value]}));return(null==d?void 0:d.length)&&d.forEach(e=>{t.push({label:e.name,key:e.fides_key})}),n&&(t.push({type:"divider"}),t.push({label:"+ Create new",key:eD})),t})(),"data-testid":"taxonomy-type-selector"})}),(0,r.jsx)(o.u_l,{open:P,destroyOnHidden:!0,onCancel:()=>z(!1),width:768,footer:null,centered:!0,title:"Create new taxonomy",children:(0,r.jsx)(j,{onClose:()=>z(!1)})}),(0,r.jsx)(eL,{userCanAddLabels:J,taxonomyItems:C?E:G,draftNewItem:O,lastCreatedItemKey:D,resetLastCreatedItemKey:()=>R(null),onTaxonomyItemClick:e=>{I(e)},onRootItemClick:a?()=>{let e=null==d?void 0:d.find(e=>e.fides_key===i);e&&N(e)}:null,onAddButtonClick:e=>{var t;L({parent_key:null!==(t=null==e?void 0:e.fides_key)&&void 0!==t?t:null,is_default:!1,description:""})},taxonomyType:i,onCancelDraftItem:()=>L(null),onSubmitDraftItem:B,isCreating:b,rootNodeLabel:null!=H?H:(0,F._g)(i)})]})]}),A&&(0,r.jsx)(ec,{taxonomyItem:A,taxonomyType:i,onClose:()=>I(null)}),n&&S&&(0,r.jsx)(w,{title:H?"Edit ".concat(H):"Edit taxonomy",onClose:()=>N(null),onDelete:()=>{M.confirm({title:"Delete ".concat(null==S?void 0:S.name,"?"),icon:null,content:(0,r.jsx)(o.Typography.Paragraph,{children:"Are you sure you want to delete this taxonomy? This action cannot be undone."}),okText:"Delete",okType:"primary",onOk:U,centered:!0})},taxonomy:S})]})}},90673:function(e,t,l){"use strict";l.d(t,{Cd:function(){return n},Xl:function(){return s}});var i=l(20987),a=l(59001);let n=(e,t)=>{let l;if(null==t&&e.every(e=>void 0===e.parent_key))l=e;else{let i=null!=t?t:null;l=e.filter(e=>e.parent_key===i)}return l.map(t=>{var l,i;let a=t.fides_key;return{value:t.fides_key,label:t.name||t.fides_key,description:t.description,children:n(e,a),is_default:null!==(l=t.is_default)&&void 0!==l&&l,active:null!==(i=t.active)&&void 0!==i&&i}})},s=e=>{switch(e){case a.ac.DATA_CATEGORY:return i.J.DATA_CATEGORY;case a.ac.DATA_SUBJECT:return i.J.DATA_SUBJECT;case a.ac.DATA_USE:return i.J.DATA_USE;default:return e}}},1945:function(e){e.exports={input:"TaxonomyTextInputNode_input__P9czz"}},34770:function(e){e.exports={container:"TaxonomyTreeNode_container__T4KpF",button:"TaxonomyTreeNode_button__mcbOd","button--hover":"TaxonomyTreeNode_button--hover__oycXY","button--parent-hover":"TaxonomyTreeNode_button--parent-hover__pwAPl","button--inactive":"TaxonomyTreeNode_button--inactive__Fjdpe","add-button-container":"TaxonomyTreeNode_add-button-container__eEoRN","add-button":"TaxonomyTreeNode_add-button__oM2vI","add-button--visible":"TaxonomyTreeNode_add-button--visible__Ojqqf"}}}]);