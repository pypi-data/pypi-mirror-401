(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[847],{56141:function(e,t,l){var i=l(32866);e.exports=function(e,t){return i(e,t)}},58754:function(e,t,l){"use strict";var i=l(24246),n=l(41725),a=l(70788);t.Z=e=>{let{heading:t,breadcrumbItems:l,isSticky:s=!0,children:r,rightContent:o,style:d,...u}=e;return(0,i.jsxs)("div",{...u,style:s?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,i.jsxs)(n.kCb,{justify:"space-between",children:["string"==typeof t?(0,i.jsx)(n.Dxz,{className:l||r?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,i.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!l&&(0,i.jsx)(a.m,{className:r?"pb-4":void 0,items:l,"data-testid":"page-breadcrumb"}),r]})}},19904:function(e,t,l){"use strict";l.d(t,{Tg:function(){return s}});var i=l(24246),n=l(16134),a=l(31793);let s=e=>(0,n.C)(a.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:l}=e;return s(t)?(0,i.jsx)(i.Fragment,{children:l}):null}},70788:function(e,t,l){"use strict";l.d(t,{m:function(){return d}});var i=l(24246),n=l(41725),a=l(79894),s=l.n(a),r=l(27378);let{Text:o}=n.Typography,d=e=>{let{items:t,...l}=e,a=(0,r.useMemo)(()=>null==t?void 0:t.map((e,l)=>{let a=l===t.length-1,r={...e},d=r.onClick&&!r.href;return("string"==typeof r.title&&(r.title=(0,i.jsx)(o,{style:{color:"inherit",maxWidth:a?void 0:400},ellipsis:!a,id:a?"breadcrumb-current-page":void 0,children:r.title})),d)?r.title=(0,i.jsx)(n.zxk,{type:"text",size:"small",icon:r.icon,onClick:r.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:r.title}):(r.icon&&(r.title=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"anticon align-text-bottom",children:r.icon}),r.title]})),r.href&&r.title&&(r.title=(0,i.jsx)(s(),{href:r.href,className:"ant-breadcrumb-link",children:r.title}),delete r.href)),r}),[t]);return(0,i.jsx)(n.aGc,{items:a,...l})}},34435:function(e,t,l){"use strict";var i=l(24246),n=l(41725),a=l(86677),s=l(812),r=l(77830),o=l(19904),d=l(8917),u=l(67522),c=l(66006),p=l(66236),m=l(32885),v=l(60240),x=l(31883);let y=()=>(0,i.jsxs)(n.OdW,{active:!0,children:[(0,i.jsx)(n.OdW.Input,{}),(0,i.jsx)(n.OdW.Input,{}),(0,i.jsx)(n.OdW.Input,{}),(0,i.jsx)(n.OdW.Input,{}),(0,i.jsx)(n.OdW.Button,{})]}),_=e=>d.uP.has(e)?d.uP.get(e):e.startsWith("taxonomy:")||e.startsWith("system:")?e:"taxonomy:".concat(e);t.Z=e=>{var t;let{initialField:l,isLoading:h}=e,[f]=n.l09.useForm(),T=n.l09.useWatch("value_type",f),g=n.l09.useWatch("name",f),E=(0,a.useRouter)(),{resource_type:S}=E.query,j=(0,n.UD8)(),b=(0,n.ddY)(),{createOrUpdate:L}=(0,u.Z)(),{data:C,isLoading:I}=(0,m.vA)(null==l?void 0:l.allow_list_id,{skip:!(null==l?void 0:l.allow_list_id)}),[P,{isLoading:A}]=(0,m.UF)(),{data:U,isLoading:k}=(0,m.Az)(),{valueTypeOptions:w}=(0,c.Z)(),N=(0,o.Tg)([v.Sh.CUSTOM_FIELD_DELETE])&&!!l,D=async()=>{if(!l)return;let{id:e,resource_type:t,field_type:i}=l,n=await P({id:e,resource_type:t,field_type:i});if((0,x.D4)(n)){j.error((0,s.e$)(n.error));return}j.success("Custom field deleted successfully"),E.push(r.WC)},O=async e=>{let t=await L(e,l,C);if(!t){j.error("An unexpected error occurred");return}if((0,x.D4)(t)){j.error((0,s.e$)(t.error));return}j.success("Custom field ".concat(l?"updated":"created"," successfully")),E.push(r.WC)},R=(e=>{var t;if(e)return{...e,value_type:e.field_type,field_type:(0,p._)(e),resource_type:_(e.resource_type),options:null!==(t=null==C?void 0:C.allowed_values)&&void 0!==t?t:[]}})(l),G=S?{...R,resource_type:"taxonomy:".concat(S)}:R;if(h||I||k)return(0,i.jsx)(y,{});let M=w.some(e=>e.value===T);return(0,i.jsxs)(n.l09,{form:f,layout:"vertical",initialValues:G||{},validateTrigger:["onBlur","onChange"],onFinish:O,children:[(0,i.jsx)(n.l09.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please enter a name"}],children:(0,i.jsx)(n.QcG,{options:w,onSelect:(e,t)=>{f.setFieldsValue({name:t.label,value_type:t.value})},disabled:M,"data-testid":"input-name-autocomplete",children:(0,i.jsx)(n.IIB,{"data-testid":"input-name",suffix:M?(0,i.jsx)(n.zxk,{size:"small",type:"text",icon:(0,i.jsx)(n.PJP.x8P,{}),onClick:()=>{f.setFieldsValue({name:void 0,value_type:void 0})}}):void 0})})}),(0,i.jsx)(n.l09.Item,{label:"Type",name:"value_type",hidden:!0,children:(0,i.jsx)(n.PhF,{options:w,getPopupContainer:e=>e.parentElement||document.body,"data-testid":"select-value-type"})}),!!g&&!M&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.l09.Item,{label:"Description",name:"description",children:(0,i.jsx)(n.IIB.TextArea,{rows:2,"data-testid":"input-description"})}),(0,i.jsx)(n.l09.Item,{label:"Field type",name:"field_type",rules:[{required:!0,message:"Please select a field type"}],children:(0,i.jsx)(n.PhF,{options:d.TY,getPopupContainer:e=>e.parentElement||document.body,"data-testid":"select-field-type"})}),(0,i.jsx)(n.l09.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.field_type!==t.field_type,children:e=>{let{getFieldValue:t}=e,l=t("field_type");return(l===d.Uv.SINGLE_SELECT||l===d.Uv.MULTIPLE_SELECT)&&(0,i.jsx)(n.l09.List,{name:"options",rules:[{validator:async(e,t)=>!t||t.length<1?Promise.reject(Error("At least one option is required for selects")):Promise.resolve()}],children:(e,l,a)=>{let{add:s,remove:r}=l,{errors:o}=a;return(0,i.jsxs)(i.Fragment,{children:[e.map((l,a)=>(0,i.jsx)(n.l09.Item,{required:!1,label:0===a?"Options":"","data-testid":"options-form-item",children:(0,i.jsxs)(n.kCb,{gap:"middle",children:[(0,i.jsx)(n.l09.Item,{...l,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Options cannot be empty"},()=>({validator:(e,l)=>t("options").filter(e=>e===l).length>1?Promise.reject(Error("Option values must be unique")):Promise.resolve()})],noStyle:!0,children:(0,i.jsx)(n.IIB,{placeholder:"Enter option value","data-testid":"input-option-".concat(a)})}),e.length>1&&(0,i.jsx)(n.zxk,{icon:(0,i.jsx)(n.PJP.ZNm,{}),onClick:()=>r(l.name),"aria-label":"Remove option"})]})},l.key)),(0,i.jsx)(n.l09.Item,{children:(0,i.jsx)(n.zxk,{type:"dashed",onClick:()=>s(),icon:(0,i.jsx)(n.PJP.mm_,{}),"data-testid":"add-option-btn",children:"Add select option"})}),(0,i.jsx)(n.l09.ErrorList,{errors:o,className:"-mt-4 mb-4"})]})}})}})]}),(0,i.jsx)(n.l09.Item,{label:"Applies to",name:"resource_type",rules:[{required:!0,message:"Please select a location"}],tooltip:"Choose where this field applies, including taxonomies",children:(0,i.jsx)(n.PhF,{options:null!==(t=null==U?void 0:U.map(e=>({label:e,value:e})))&&void 0!==t?t:[],getPopupContainer:e=>e.parentElement||document.body,disabled:!!l,"data-testid":"select-resource-type"})}),(0,i.jsxs)(n.kCb,{justify:"space-between",children:[N&&(0,i.jsx)(n.zxk,{danger:!0,onClick:()=>{var e;b.confirm({title:"Delete custom field?",content:(0,i.jsxs)(n.Typography.Paragraph,{children:["Are you sure you want to delete"," ",(0,i.jsx)("strong",{children:null!==(e=null==l?void 0:l.name)&&void 0!==e?e:"this custom field"}),"? This action cannot be undone."]}),onOk:D,okType:"primary",okText:"Delete",centered:!0})},loading:A,"data-testid":"delete-btn",children:"Delete"}),(0,i.jsx)(n.zxk,{type:"primary",htmlType:"submit","data-testid":"save-btn",children:"Save"})]})]})}},8917:function(e,t,l){"use strict";l.d(t,{P3:function(){return o},TY:function(){return r},Uv:function(){return n},uP:function(){return s}});var i,n,a=l(20987);let s=new Map([[a.J.SYSTEM,"system:information"],[a.J.DATA_USE,"taxonomy:data use"],[a.J.DATA_CATEGORY,"taxonomy:data category"],[a.J.DATA_SUBJECT,"taxonomy:data subject"],[a.J.PRIVACY_DECLARATION,"system:data use"]]);(i=n||(n={})).SINGLE_SELECT="singleSelect",i.MULTIPLE_SELECT="multipleSelect",i.OPEN_TEXT="openText";let r=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open text",value:"openText"}],o={singleSelect:"Single-value select",multipleSelect:"Multi-value select",openText:"Open text"}},67522:function(e,t,l){"use strict";var i=l(56141),n=l.n(i),a=l(20987),s=l(812),r=l(8917),o=l(32885);let d=()=>Date.now().toString()+Math.random().toString(),u=e=>e.startsWith("taxonomy:")?e.split(":",2)[1]:"system:information"===e?"system":"system:data use"===e?"privacy declaration":e;t.Z=()=>{let[e,{isLoading:t}]=(0,o.Ld)(),[l,{isLoading:i}]=(0,o.yM)(),[c]=(0,o.Nt)();return{createOrUpdate:async function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,p=u(t.resource_type);if(t.field_type===r.Uv.OPEN_TEXT){let n={...t,field_type:a.H.STRING,id:i?i.id:void 0,resource_type:p};return i?await l(n):await e(n)}if(t.field_type===r.Uv.SINGLE_SELECT||t.field_type===r.Uv.MULTIPLE_SELECT){var m,v;let u;if(!i){let{options:l,...i}=t,n={name:d(),allowed_values:null!=l?l:[]},o=await c(n);if((0,s.D4)(o))return o;let u={...i,field_type:t.field_type===r.Uv.SINGLE_SELECT?a.H.STRING:a.H.STRING_ARRAY,allow_list_id:null===(m=o.data)||void 0===m?void 0:m.id,resource_type:p};return await e(u)}let{options:x,...y}=t;if(!n()(null==o?void 0:o.allowed_values,x)){let e={...o,name:null!==(v=null==o?void 0:o.name)&&void 0!==v?v:d(),id:null==o?void 0:o.id,allowed_values:null!=x?x:[]};if(u=await c(e),(0,s.D4)(u))return u}let _={...y,id:i.id,allow_list_id:u&&!(0,s.D4)(u)?u.data.id:i.allow_list_id,resource_type:p,field_type:t.field_type===r.Uv.SINGLE_SELECT?a.H.STRING:a.H.STRING_ARRAY};return await l(_)}let{value_type:x,...y}=t,_={...y,id:i?i.id:void 0,field_type:x,resource_type:p};return i?await l(_):await e(_)},isLoading:t||i}}},66006:function(e,t,l){"use strict";var i=l(25980),n=l(59001),a=l(39864);t.Z=()=>{let{plus:e}=(0,i.hz)(),{data:t,isLoading:l}=(0,a.MU)(void 0,{skip:!e}),s=[{label:n.Lo.DATA_CATEGORIES,value:n.ac.DATA_CATEGORY},{label:n.Lo.DATA_USES,value:n.ac.DATA_USE},{label:n.Lo.DATA_SUBJECTS,value:n.ac.DATA_SUBJECT}];return e&&s.push({label:n.Lo.SYSTEM_GROUPS,value:n.ac.SYSTEM_GROUP}),l||(null==t?void 0:t.length)&&s.push(...t.map(e=>({label:e.name,value:e.fides_key}))),{valueTypeOptions:s}}},66236:function(e,t,l){"use strict";l.d(t,{S:function(){return s},_:function(){return a}});var i=l(20987),n=l(8917);let a=e=>e.field_type===i.H.STRING_ARRAY?n.Uv.MULTIPLE_SELECT:e.allow_list_id?n.Uv.SINGLE_SELECT:e.field_type===i.H.STRING?n.Uv.OPEN_TEXT:e.field_type,s=e=>{let t=a(e);return t===n.Uv.OPEN_TEXT||t===n.Uv.SINGLE_SELECT||t===n.Uv.MULTIPLE_SELECT?n.P3[t]:t}}}]);