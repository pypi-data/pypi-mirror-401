(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[693],{7873:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user-management",function(){return n(32802)}])},30952:function(e,s,n){"use strict";n.d(s,{f:function(){return a}});var t=n(24246),r=n(26917);let a=e=>{let{...s}=e;return(0,t.jsx)(r.Z,{debounce:!0,...s})}},35287:function(e,s,n){"use strict";var t=n(24246),r=n(49617),a=n(88038),i=n.n(a);n(27378),s.Z=e=>{let{children:s,title:n,fullHeight:a,fullWidth:l,mainProps:o}=e;return(0,t.jsxs)(r.kCb,{"data-testid":n,direction:"column",height:a?"100vh":"calc(100vh - 48px)",width:l?"100vw":"calc(100vw - 240px)",children:[(0,t.jsxs)(i(),{children:[(0,t.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,t.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsx)(r.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...o,children:s})]})}},19904:function(e,s,n){"use strict";n.d(s,{Tg:function(){return i}});var t=n(24246),r=n(16134),a=n(31793);let i=e=>(0,r.C)(a.uu).filter(s=>e.includes(s)).length>0;s.ZP=e=>{let{scopes:s,children:n}=e;return i(s)?(0,t.jsx)(t.Fragment,{children:n}):null}},99640:function(e,s,n){"use strict";n.d(s,{Z:function(){return d}});var t=n(24246),r=n(49617),a=n(79894),i=n.n(a);let{Link:l,Text:o}=r.AntTypography,d=e=>{let{href:s,children:n,containerProps:a,...d}=e;return(0,t.jsx)(r.jqI,{...a,children:s?(0,t.jsx)(i(),{href:s,passHref:!0,legacyBehavior:!0,children:(0,t.jsx)(l,{strong:!0,ellipsis:!0,onClick:e=>e.stopPropagation(),variant:"primary",...d,children:(0,t.jsx)(o,{unStyled:!0,ellipsis:{tooltip:n},children:n})})}):(0,t.jsx)(o,{strong:!0,ellipsis:!0,...d,children:n})})}},61038:function(e,s,n){"use strict";var t=n(24246),r=n(49617),a=n(34090),i=n(86677);n(27378);var l=n(55484),o=n(16134),d=n(40324),c=n(812),u=n(77830),m=n(46628),h=n(65497);let p={username:"",usernameConfirmation:""},x=e=>{let{id:s,username:n,onClose:t}=e,a=(0,r.pmc)(),d=(0,i.useRouter)(),p=(0,o.T)(),[x]=(0,h.I1)();return{handleDeleteUser:async()=>{let e=await x(s);(0,c.D4)(e)?a((0,m.Vo)((0,c.e$)(e.error))):(a((0,m.t5)("Successfully deleted user")),t()),p((0,h.Vv)(void 0)),d.push(u.e3)},validationSchema:l.Ry().shape({usernameConfirmation:l.Z_().required().oneOf([n],"Confirmation input must match the username").label("Username confirmation")})}};s.Z=e=>{let{user:s,...n}=e,{isOpen:i,onClose:l}=n,{handleDeleteUser:o,validationSchema:c}=x({id:s.id,username:s.username,onClose:l});return(0,t.jsxs)(r.u_l,{isCentered:!0,isOpen:i,onClose:l,children:[(0,t.jsx)(r.ZAr,{}),(0,t.jsx)(r.hzk,{"data-testid":"delete-user-modal",children:(0,t.jsx)(a.J9,{initialValues:p,validationSchema:c,onSubmit:o,children:e=>{let{isSubmitting:n,dirty:i,isValid:o}=e;return(0,t.jsxs)(a.l0,{children:[(0,t.jsx)(r.xBx,{children:"Delete User"}),(0,t.jsx)(r.olH,{}),(0,t.jsxs)(r.fef,{children:[(0,t.jsxs)(r.bZj,{status:"warning",overflow:"visible",colorScheme:"warn",marginBottom:4,children:[(0,t.jsx)(r.zMQ,{}),(0,t.jsxs)(r.XaZ,{children:[(0,t.jsx)(r.xvT,{as:"span",mb:2,children:"You are about to delete the user\xa0"}),(0,t.jsxs)(r.xvT,{as:"span",mb:2,fontStyle:"italic",fontWeight:"semibold",children:[s.username,"."]}),(0,t.jsx)(r.xvT,{mb:2,children:"This action cannot be undone. To confirm, please enter the userâ€™s username below."})]})]}),(0,t.jsx)(r.Kqy,{direction:"column",spacing:4,children:(0,t.jsx)(d.j0,{name:"usernameConfirmation",label:"Confirm username",placeholder:"Type the username to delete"})})]}),(0,t.jsx)(r.mzw,{children:(0,t.jsxs)("div",{className:"flex w-full gap-2",children:[(0,t.jsx)(r.wpx,{onClick:l,className:"w-1/2",children:"Cancel"}),(0,t.jsx)(r.wpx,{type:"primary",disabled:!i||!o,loading:n,htmlType:"submit",className:"w-1/2","data-testid":"submit-btn",children:"Delete User"})]})})]})}})})]})}},91437:function(e,s,n){"use strict";n.d(s,{K:function(){return r}});var t=n(60240);let r=[{label:"Owner",permissions_label:"Owner",roleKey:t.A7.OWNER,description:"Owners have view and edit access to the whole organization and can create new users"},{label:"Contributor",permissions_label:"Contributor",roleKey:t.A7.CONTRIBUTOR,description:"Contributors can create new users and have view and edit access to the whole organization. Contributors cannot configure storage and messaging services"},{label:"Viewer",permissions_label:"Viewer",roleKey:t.A7.VIEWER,description:"Viewers have view access to the Data Map and all systems"},{label:"Viewer & Approver",permissions_label:"Viewer & Approver",roleKey:t.A7.VIEWER_AND_APPROVER,description:"Viewer & Approvers have view access to the Data Map but can also manage Privacy Requests"},{label:"Approver",permissions_label:"Approver",roleKey:t.A7.APPROVER,description:"Approvers can only access the Privacy Requests portal to review, approve, and create new requests"},{label:"Internal respondent",permissions_label:"Internal respondent",roleKey:t.A7.RESPONDENT,description:"Internal respondents have limited access and can only view and complete manual DSR tasks assigned to them"},{label:"External respondent",permissions_label:"External respondent",roleKey:t.A7.EXTERNAL_RESPONDENT,description:"External respondents can only access the external task portal to complete manual DSR tasks assigned to them"}]},32802:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return C}});var t=n(24246),r=n(27378),a=n(49617),i=n(79894),l=n.n(i),o=n(16134),d=n(30952),c=n(77830),u=n(19904),m=n(60240),h=n(65497),p=n(91317),x=n(99640),v=n(8125),j=n(91437),f=n(61038);let w=e=>{let{userId:s}=e,{data:n}=(0,h.gU)(s,{skip:!s}),r=[];return n&&n.roles&&n.roles.forEach(e=>{let s=j.K.find(s=>s.roleKey===e);s&&r.push(s.permissions_label)}),(0,t.jsx)(t.Fragment,{children:r.map(e=>(0,t.jsx)(a.j8w,{"data-testid":"user-permissions-badge",children:e},e))})},b=e=>{let{userId:s}=e,{data:n}=(0,h.d6)(s,{skip:!s});return(0,t.jsx)(a.j8w,{className:"text-center","data-testid":"user-systems-badge",children:n?n.length:0})},g=e=>{let{user:s}=e,n=(0,a.qY0)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.wpx,{size:"small","aria-label":"delete",icon:(0,t.jsx)(a.PJP.ZNm,{}),onClick:e=>{e.stopPropagation(),n.onOpen()},"data-testid":"delete-user-btn"}),(0,t.jsx)(f.Z,{user:s,...n})]})};var y=()=>{let e=(0,o.C)(p.dy),s=(0,u.Tg)([m.Sh.USER_DELETE]),n=(0,u.Tg)([m.Sh.USER_UPDATE]),i=(0,v.o)({pagination:{defaultPageSize:25,pageSizeOptions:[25,50,100]},search:{defaultSearchQuery:""}}),{pageIndex:l,pageSize:d,searchQuery:j,updateSearch:f}=i,{data:y,isLoading:_,isFetching:E}=(0,h.wv)({page:l,size:d,username:j||void 0}),k=(0,r.useMemo)(()=>{var e,s;return{dataSource:null!==(e=null==y?void 0:y.items)&&void 0!==e?e:[],totalRows:null!==(s=null==y?void 0:y.total)&&void 0!==s?s:0,isLoading:_,isFetching:E,getRowKey:e=>{var s;return null!==(s=e.id)&&void 0!==s?s:""}}},[null==y?void 0:y.items,null==y?void 0:y.total,_,E]),{tableProps:C}=(0,v.V)(i,k);return{tableProps:C,columns:(0,r.useMemo)(()=>[{title:"Username",dataIndex:"username",key:"username",fixed:"left",render:(s,r)=>{let i=!!e&&e.id===r.id,l=n||i;return(0,t.jsxs)(a.jqI,{gap:"small",children:[(0,t.jsx)(x.Z,{href:l?"".concat(c.e3,"/profile/").concat(r.id):void 0,"data-testid":"user-link-".concat(r.id),children:s})," ",r.disabled&&(0,t.jsx)(a.j8w,{color:"success","data-testid":"invite-sent-badge",children:"Invite sent"})]})}},{title:"Email",dataIndex:"email_address",key:"email_address"},{title:"First name",dataIndex:"first_name",key:"first_name"},{title:"Last name",dataIndex:"last_name",key:"last_name"},{title:"Permissions",key:"permissions",render:(e,s)=>{var n;return(0,t.jsx)(w,{userId:null!==(n=s.id)&&void 0!==n?n:""})}},{title:"Assigned systems",key:"systems",render:(e,s)=>{var n;return(0,t.jsx)(b,{userId:null!==(n=s.id)&&void 0!==n?n:""})}},{title:"Created at",dataIndex:"created_at",key:"created_at",render:e=>e?new Date(e).toUTCString():null},...s?[{title:"",key:"actions",width:80,render:(e,s)=>(0,t.jsx)(g,{user:s})}]:[]],[s,n,e]),searchQuery:j,updateSearch:f}},_=()=>{let{tableProps:e,columns:s,searchQuery:n,updateSearch:i}=y(),p=(0,o.T)();return(0,r.useEffect)(()=>{p((0,h.Vv)(void 0))},[p]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.jqI,{justify:"space-between",className:"mb-4",children:[(0,t.jsx)(d.f,{value:n,onChange:i,placeholder:"Search by username","data-testid":"user-search"}),(0,t.jsx)(u.ZP,{scopes:[m.Sh.USER_CREATE],children:(0,t.jsx)(l(),{href:"".concat(c.e3,"/new"),passHref:!0,legacyBehavior:!0,children:(0,t.jsx)(a.wpx,{type:"primary","data-testid":"add-new-user-btn",children:"Add new user"})})})]}),(0,t.jsx)(a.V5H,{...e,columns:s,"data-testid":"user-management-table",onRow:e=>({"data-testid":"row-".concat(e.id)})})]})},E=n(35287),k=n(58754),C=()=>(0,t.jsxs)(E.Z,{title:"User Management",children:[(0,t.jsx)(k.Z,{heading:"Users",breadcrumbItems:[{title:"All users"}],isSticky:!1}),(0,t.jsx)(_,{})]})}},function(e){e.O(0,[431,7245,3931,2888,9774,179],function(){return e(e.s=7873)}),_N_E=e.O()}]);