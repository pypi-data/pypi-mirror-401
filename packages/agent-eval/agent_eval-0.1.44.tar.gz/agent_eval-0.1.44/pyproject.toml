[build-system]
requires = ["setuptools>=61", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "agent-eval"
version = "0.1.44"
description = "Agent evaluation toolkit"
readme = "README.md"
requires-python = ">=3.10"
dependencies = [
  "click",
  # Pin inspect-ai to avoid breaking changes in 0.3.137+ (Event classes moved)
  # See allenai/astabench-issues#275 for upgrade process
  "inspect-ai>=0.3.104,<0.3.137",
  # pin litellm so that we know what model costs we're using
  # see the Development.md doc before changing
  "litellm>=1.67.4.post1,<=1.75.8",
  "pydantic>=2.0.0",
  # For leaderboard
  "huggingface_hub",
  "pyarrow",
  "datasets",
]

[project.urls]
Homepage = "https://github.com/allenai/agent-eval"

[project.optional-dependencies]
dev = [
  "black==24.2.0",
  "isort",
  "autoflake",
  "flake8",
  "flake8-pyproject",
  "flake8-pep585",
  "flake8-new-union-types",
  "pytest",
  "pytest-asyncio",
  "mypy==1.15",
  "types-PyYAML",
  "types-setuptools",
  "pandas-stubs",
  "types-seaborn"
]
# Leaderboard view dependencies
leaderboard = [
  "seaborn",
  "matplotlib",
  "pandas"
]

[project.scripts]
agenteval = "agenteval.cli:cli"

[tool.setuptools.packages.find]
where = ["src"]

[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py"]
markers = [
    "leaderboard: tests that require leaderboard dependencies"
]

[tool.flake8]
select = [
  "F", # Logical errors
  "PEA", # flake8-pep585 - enforce modern collection type hints (Dict -> dict, List -> list, etc.)
  "NU", # flake8-new-union-types - enforce X | Y instead of Union[X, Y] and X | None instead of Optional[X]

  # Serious "E" errors
  "E721", # `type(x) == <t>` instead of `isinstance(x, <t>)`
  "E901", "E902", "E999" # syntax errors
]

ignore = [
  "E501",  # line too long
  "F401",  # module imported but unused
  "F541",  # f-string is missing placeholders
]


[tool.setuptools]
include-package-data = true

[tool.setuptools.package-data]
"agenteval.leaderboard" = ["dataset_features.yml"]

[tool.isort]
profile = "black"

[tool.mypy]
ignore_missing_imports = true
disable_error_code = ["import-untyped"]
