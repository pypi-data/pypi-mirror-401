name: BioLib Build & Push
on: push
concurrency:
  group: ${{ github.repository }}
  cancel-in-progress: false
jobs:
    build-and-push:
        runs-on: biolib-github-runner
        steps:
          - uses: actions/checkout@v4
          - name: Build
            run: docker build -t BIOLIB_REPLACE_DOCKER_TAG:latest .
          - name: Push
            run: |
              if [ "$GITHUB_REF_NAME" == "main" ]; then
                biolib push BIOLIB_REPLACE_APP_URI
              else
                biolib push --dev BIOLIB_REPLACE_APP_URI:latest-dev
              fi
            env:
              BIOLIB_TOKEN: ${{ secrets.BIOLIB_TOKEN }}
