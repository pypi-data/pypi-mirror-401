[package]
name = "oboron"
version = "0.4.0"
edition = "2021"
rust-version = "1.77.0"
license = "MIT"
repository = "https://github.com/ob-enc/oboron-rs"
authors = ["Bojan Đuričković"]
description = "Encryption and encoding library for developer ergonomics: prefix entropy, compact outputs, high performance"
keywords = ["encryption", "obfuscation", "encoding", "base32", "identifiers"]
categories = ["cryptography", "encoding"]
readme = "README.md"

[features]
# Default: Secure, production-ready defaults
default = ["std"]

# Core configurations
# ===================
std = ["secure-schemes"]
secure-min = ["aasv"]  # Minimum secure setup
full = ["secure-schemes", "zrbcx", "all-alt-keys", "keyless", "legacy", "mock", "zmock", "convenience"]


ztier = []  # Z-tier infrastructure

dev = ["full"]  # Development setup

# Key format features
# ===================
hex-keys = []  # Alternative to base64 keys
bytes-keys = []  # Raw bytes key input
all-alt-keys = ["hex-keys", "bytes-keys"]

keyless = []  # Hardcoded key methods (dev/testing only)

# Algorithm family groups (BINARY SIZE OPTIMIZATION)
# ==================================================
all-cbc-schemes = ["zrbcx", "upbc"]  # Shares AES+CBC deps
all-gcm-schemes = ["aags", "apgs"]  # Shares AES-GCM-SIV deps  
all-siv-schemes = ["aasv", "apsv"]  # Shares AES-SIV deps

# Individual schemes
# ==================
zrbcx = ["aes", "cipher", "cbc", "keyless", "ztier"]
upbc = ["aes", "cipher", "cbc"]
aags = ["aes-gcm-siv"]
apgs = ["aes-gcm-siv"]
aasv = ["aes-siv"]
apsv = ["aes-siv"]
# Testing only
mock = []
zmock = ["ztier"]
# Legacy
legacy = ["aes", "cipher", "cbc", "ztier"]  # backward compatibility

# Misc features
# =============
convenience = [] # Convenience functions
experimental = [] # Experimental algorithms
unchecked-utf8 = [] # Unsafe performance enhacement

# Scheme categories
# =================
atier = ["aags", "apgs", "aasv", "apsv"]  # secure, authenticated
utier = ["upbc"]  # secure, not authenticated

secure-schemes = ["atier", "utier"]
deterministic-schemes = ["aags", "aasv"]
probabilistic-schemes = ["upbc", "apgs", "apsv"]

[dependencies]
# Always needed
data-encoding = "2.5"
generic-array = "1.0"
num-bigint = "0.4.6"
thiserror = "1.0"
hex = "0.4"

# Conditionally included based on features
aes = { version = "0.8", optional = true }
cipher = { version = "0.4", optional = true }
cbc = { version = "0.1", optional = true }
aes-gcm-siv = { version = "0.11", optional = true }
aes-siv = { version = "0.7", optional = true }
once_cell = "1.21.3"

# rand with getrandom - use default features on native, add getrandom/js on wasm
[target.'cfg(not(target_arch = "wasm32"))'.dependencies]
rand = "0.8"

[target.'cfg(target_arch = "wasm32")'.dependencies]
rand = { version = "0.8", features = ["getrandom"] }
getrandom = { version = "0.2", features = ["js"] }

[lib]
name = "oboron"
path = "src/lib.rs"
crate-type = ["rlib"]  # Standard Rust library crate (WASM compatible)

[[bin]]
name = "keygen"
path = "src/bin/keygen.rs"

[[bin]]
name = "secretgen"
path = "src/bin/secretgen.rs"

[dev-dependencies]
oboron = { path = ".", features = ["dev"]}
criterion = { version = "0.5", features = ["html_reports"] }
hex = "0.4"
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
sha2 = "0.10"
jsonwebtoken = "9.3"

[profile.release]
opt-level = "z"
lto = true
codegen-units = 1

[profile.bench]
inherits = "release"

[[test]]
name = "test_mock1"
path = "tests/test_mock1.rs"
harness = true

[[test]]
name = "integration_test"
path = "tests/integration_tests.rs"
harness = true

[[bench]]
name = "ob"
harness = false

[[bench]]
name = "obz"
harness = false

[[bench]]
name = "omnib"
harness = false

[[bench]]
name = "zrbcx_c32"
harness = false

[[bench]]
name = "zrbcx_b32"
harness = false

[[bench]]
name = "zrbcx_b64"
harness = false

[[bench]]
name = "zrbcx_hex"
harness = false

[[bench]]
name = "upbc_c32"
harness = false

[[bench]]
name = "upbc_b32"
harness = false

[[bench]]
name = "upbc_b64"
harness = false

[[bench]]
name = "upbc_hex"
harness = false

[[bench]]
name = "aags_c32"
harness = false

[[bench]]
name = "aags_b32"
harness = false

[[bench]]
name = "aags_b64"
harness = false

[[bench]]
name = "aags_hex"
harness = false

[[bench]]
name = "apgs_c32"
harness = false

[[bench]]
name = "apgs_b32"
harness = false

[[bench]]
name = "apgs_b64"
harness = false

[[bench]]
name = "apgs_hex"
harness = false

[[bench]]
name = "aasv_c32"
harness = false

[[bench]]
name = "aasv_b32"
harness = false

[[bench]]
name = "aasv_b64"
harness = false

[[bench]]
name = "aasv_hex"
harness = false

[[bench]]
name = "apsv_c32"
harness = false

[[bench]]
name = "apsv_b32"
harness = false

[[bench]]
name = "apsv_b64"
harness = false

[[bench]]
name = "apsv_hex"
harness = false

[[bench]]
name = "legacy_c32"
harness = false

[[bench]]
name = "legacy_b32"
harness = false

[[bench]]
name = "legacy_b64"
harness = false

[[bench]]
name = "legacy_hex"
harness = false

[[bench]]
name = "test123"
harness = false

[[bench]]
name = "z_sha256"
harness = false

[[bench]]
name = "z_jwt"
