import{c as D,j as r,f as q,a as g,r as c,i as U,g as O,B as P,h as G,k as J,l as X}from"./index-CGg3ZQH6.js";const K=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],V=D("arrow-down",K);const W=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Y=D("chevron-right",W);function $({className:t,...n}){return r.jsx(q,{role:"status","aria-label":"Loading",className:g("size-4 animate-spin opacity-50",t),...n})}const Q=c.createContext(null),Z=({toolPart:t,onClick:n})=>{const[o,l]=c.useState(!1),[u,T]=c.useState(!1),v=!!t.errorText||!!t.output,x=n||v,S=U(t),d=O(t),p=()=>{v?l(!o):n&&!v&&n()};return r.jsx(Q.Provider,{value:{isHovering:u,isExpanded:o},children:r.jsxs("div",{onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),children:[r.jsxs("span",{className:g("select-none flex items-center gap-2 min-w-0 overflow-hidden text-ellipsis whitespace-nowrap [&_*]:overflow-hidden [&_*]:text-ellipsis [&_*]:whitespace-nowrap transition-opacity duration-150",o?"opacity-100":"opacity-50",x&&!o?"cursor-pointer hover:opacity-75":x?"cursor-pointer":""),onClick:p,children:[S?r.jsx(Y,{size:12,className:g(o?"rotate-90":"")}):r.jsx($,{className:"size-4 opacity-50"}),r.jsx("span",{className:g(S?"":"text-shimmer"),children:d})]}),o&&v&&r.jsxs("div",{className:"pl-5 mt-1.5 bg-backgroundSecondary relative",children:[r.jsx("div",{className:"h-full border-l border-l-border absolute top-0 left-[6px]"}),r.jsx("div",{children:t.errorText?r.jsx("pre",{className:"p-2 overflow-auto max-h-80 m-0 bg-red-950",children:t.errorText}):t.output?r.jsx("pre",{className:"overflow-auto max-h-80 m-0",children:JSON.stringify(t.output,null,2)}):null})]})]})})};const ee={damping:.7,stiffness:.05,mass:1.25},te=70,ne=1e3/60,re=350;let A=!1;globalThis.document?.addEventListener("mousedown",()=>{A=!0});globalThis.document?.addEventListener("mouseup",()=>{A=!1});globalThis.document?.addEventListener("click",()=>{A=!1});const se=(t={})=>{const[n,o]=c.useState(!1),[l,u]=c.useState(t.initial!==!1),[T,v]=c.useState(!1),x=c.useRef(null);x.current=t;const S=c.useCallback(()=>{if(!A)return!1;const s=window.getSelection();if(!s||!s.rangeCount)return!1;const i=s.getRangeAt(0);return i.commonAncestorContainer.contains(f.current)||f.current?.contains(i.commonAncestorContainer)},[]),d=c.useCallback(s=>{e.isAtBottom=s,u(s)},[]),p=c.useCallback(s=>{e.escapedFromLock=s,o(s)},[]),e=c.useMemo(()=>{let s;return{escapedFromLock:n,isAtBottom:l,resizeDifference:0,accumulated:0,velocity:0,listeners:new Set,get scrollTop(){return f.current?.scrollTop??0},set scrollTop(i){f.current&&(f.current.scrollTop=i,e.ignoreScrollToTop=f.current.scrollTop)},get targetScrollTop(){return!f.current||!j.current?0:f.current.scrollHeight-1-f.current.clientHeight},get calculatedTargetScrollTop(){if(!f.current||!j.current)return 0;const{targetScrollTop:i}=this;if(!t.targetScrollTop)return i;if(s?.targetScrollTop===i)return s.calculatedScrollTop;const a=Math.max(Math.min(t.targetScrollTop(i,{scrollElement:f.current,contentElement:j.current}),i),0);return s={targetScrollTop:i,calculatedScrollTop:a},requestAnimationFrame(()=>{s=void 0}),a},get scrollDifference(){return this.calculatedTargetScrollTop-this.scrollTop},get isNearBottom(){return this.scrollDifference<=te}}},[]),y=c.useCallback((s={})=>{typeof s=="string"&&(s={animation:s}),s.preserveScrollPosition||d(!0);const i=Date.now()+(Number(s.wait)||0),a=M(x.current,s.animation),{ignoreEscapes:m=!1}=s;let h,w=e.calculatedTargetScrollTop;s.duration instanceof Promise?s.duration.finally(()=>{h=Date.now()}):h=i+(s.duration??0);const b=async()=>{const R=new Promise(requestAnimationFrame).then(()=>{if(!e.isAtBottom)return e.animation=void 0,!1;const{scrollTop:E}=e,I=performance.now(),H=(I-(e.lastTick??I))/ne;if(e.animation||(e.animation={behavior:a,promise:R,ignoreEscapes:m}),e.animation.behavior===a&&(e.lastTick=I),S()||i>Date.now())return b();if(E<Math.min(w,e.calculatedTargetScrollTop)){if(e.animation?.behavior===a){if(a==="instant")return e.scrollTop=e.calculatedTargetScrollTop,b();e.velocity=(a.damping*e.velocity+a.stiffness*e.scrollDifference)/a.mass,e.accumulated+=e.velocity*H,e.scrollTop+=e.accumulated,e.scrollTop!==E&&(e.accumulated=0)}return b()}return h>Date.now()?(w=e.calculatedTargetScrollTop,b()):(e.animation=void 0,e.scrollTop<e.calculatedTargetScrollTop?y({animation:M(x.current,x.current.resize),ignoreEscapes:m,duration:Math.max(0,h-Date.now())||void 0}):e.isAtBottom)});return R.then(E=>(requestAnimationFrame(()=>{e.animation||(e.lastTick=void 0,e.velocity=0)}),E))};return s.wait!==!0&&(e.animation=void 0),e.animation?.behavior===a?e.animation.promise:b()},[d,S,e]),N=c.useCallback(()=>{p(!0),d(!1)},[p,d]),C=c.useCallback(({target:s})=>{if(s!==f.current)return;const{scrollTop:i,ignoreScrollToTop:a}=e;let{lastScrollTop:m=i}=e;e.lastScrollTop=i,e.ignoreScrollToTop=void 0,a&&a>i&&(m=a),v(e.isNearBottom),setTimeout(()=>{if(e.resizeDifference||i===a)return;if(S()){p(!0),d(!1);return}const h=i>m,w=i<m;if(e.animation?.ignoreEscapes){e.scrollTop=m;return}w&&(p(!0),d(!1)),h&&p(!1),!e.escapedFromLock&&e.isNearBottom&&d(!0)},1)},[p,d,S,e]),k=c.useCallback(({target:s,deltaY:i})=>{let a=s;for(;!["scroll","auto"].includes(getComputedStyle(a).overflow);){if(!a.parentElement)return;a=a.parentElement}a===f.current&&i<0&&f.current.scrollHeight>f.current.clientHeight&&!e.animation?.ignoreEscapes&&(p(!0),d(!1))},[p,d,e]),f=z(s=>{f.current?.removeEventListener("scroll",C),f.current?.removeEventListener("wheel",k),s?.addEventListener("scroll",C,{passive:!0}),s?.addEventListener("wheel",k,{passive:!0})},[]),j=z(s=>{if(e.resizeObserver?.disconnect(),!s)return;let i;e.resizeObserver=new ResizeObserver(([a])=>{const{height:m}=a.contentRect,h=m-(i??m);if(e.resizeDifference=h,e.scrollTop>e.targetScrollTop&&(e.scrollTop=e.targetScrollTop),v(e.isNearBottom),h>=0){const w=M(x.current,i?x.current.resize:x.current.initial);y({animation:w,wait:!0,preserveScrollPosition:!0,duration:w==="instant"?void 0:re})}else e.isNearBottom&&(p(!1),d(!0));i=m,requestAnimationFrame(()=>{setTimeout(()=>{e.resizeDifference===h&&(e.resizeDifference=0)},1)})}),e.resizeObserver?.observe(s)},[]);return{contentRef:j,scrollRef:f,scrollToBottom:y,stopScroll:N,isAtBottom:l||T,isNearBottom:T,escapedFromLock:n,state:e}};function z(t,n){const o=c.useCallback(l=>(o.current=l,t(l)),n);return o}const L=new Map;function M(...t){const n={...ee};let o=!1;for(const u of t){if(u==="instant"){o=!0;continue}typeof u=="object"&&(o=!1,n.damping=u.damping??n.damping,n.stiffness=u.stiffness??n.stiffness,n.mass=u.mass??n.mass)}const l=JSON.stringify(n);return L.has(l)||L.set(l,Object.freeze(n)),o?"instant":L.get(l)}const _=c.createContext(null),oe=typeof window<"u"?c.useLayoutEffect:c.useEffect;function B({instance:t,children:n,resize:o,initial:l,mass:u,damping:T,stiffness:v,targetScrollTop:x,contextRef:S,...d}){const p=c.useRef(null),e=c.useCallback((m,h)=>(a?.targetScrollTop??x)?.(m,h)??m,[x]),y=se({mass:u,damping:T,stiffness:v,resize:o,initial:l,targetScrollTop:e}),{scrollRef:N,contentRef:C,scrollToBottom:k,stopScroll:f,isAtBottom:j,escapedFromLock:s,state:i}=t??y,a=c.useMemo(()=>({scrollToBottom:k,stopScroll:f,scrollRef:N,isAtBottom:j,escapedFromLock:s,contentRef:C,state:i,get targetScrollTop(){return p.current},set targetScrollTop(m){p.current=m}}),[k,j,C,N,f,s,i]);return c.useImperativeHandle(S,()=>a,[a]),oe(()=>{N.current&&getComputedStyle(N.current).overflow==="visible"&&(N.current.style.overflow="auto")},[]),r.jsx(_.Provider,{value:a,children:r.jsx("div",{...d,children:typeof n=="function"?n(a):n})})}(function(t){function n({children:o,...l}){const u=F();return r.jsx("div",{ref:u.scrollRef,style:{height:"100%",width:"100%"},children:r.jsx("div",{...l,ref:u.contentRef,children:typeof o=="function"?o(u):o})})}t.Content=n})(B||(B={}));function F(){const t=c.useContext(_);if(!t)throw new Error("use-stick-to-bottom component context must be used within a StickToBottom component");return t}const ae=({className:t,...n})=>r.jsx(B,{className:g("relative flex-1 overflow-y-hidden",t),initial:"instant",resize:"smooth",role:"",...n}),ie=({className:t,...n})=>r.jsx(B.Content,{className:g("flex flex-col gap-8 p-4",t),...n}),ce=({className:t,title:n="No messages yet",description:o="Start a conversation to see messages here",icon:l,children:u,...T})=>r.jsx("div",{className:g("flex size-full flex-col items-center justify-center gap-3 p-8 text-center",t),...T,children:u??r.jsxs(r.Fragment,{children:[l&&r.jsx("div",{className:"text-muted-foreground",children:l}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("h3",{className:"font-medium text-sm",children:n}),o&&r.jsx("p",{className:"text-muted-foreground text-sm",children:o})]})]})}),le=({className:t,...n})=>{const{isAtBottom:o,scrollToBottom:l}=F(),u=c.useCallback(()=>{l()},[l]);return!o&&r.jsx(P,{className:g("absolute bottom-4 left-[50%] translate-x-[-50%] rounded-full",t),onClick:u,size:"icon",type:"button",variant:"outline",...n,children:r.jsx(V,{className:"size-4"})})},ue=()=>r.jsx("div",{className:"px-4 py-2 h-[40px] flex items-center",children:r.jsx("div",{className:"chat-response-loading"})});function xe(){const{messages:t,status:n}=G(),o=J(n,t),l=n==="streaming"||n==="submitted";return r.jsxs(ae,{className:"w-full",children:[r.jsxs(ie,{children:[t.length===0?r.jsx(ce,{}):t.map(u=>r.jsx(fe,{message:u},u.id)),!o&&l&&r.jsx(ue,{})]}),r.jsx(le,{})]})}function fe({message:t}){const n=t.role==="user";return t.parts.length===0?null:n?r.jsx(me,{message:t}):r.jsx(de,{message:t})}const me=({message:t})=>r.jsx("div",{className:g("rounded-3xl px-4 py-2 bg-primary text-primary-foreground ml-auto"),children:t.parts.map((n,o)=>n.type==="text"?r.jsx("span",{className:"whitespace-pre-wrap",children:n.text},o):null)}),de=({message:t})=>r.jsx("div",{className:g("rounded-2xl px-4 py-2 bg-muted flex flex-col gap-2"),children:t.parts.map((n,o)=>X(n)?r.jsx(Z,{toolPart:n},o):n.type==="text"?r.jsx("span",{className:"whitespace-pre-wrap",children:n.text},o):null)});export{xe as C,$ as S};
