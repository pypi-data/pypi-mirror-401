Metadata-Version: 2.4
Name: rulelift
Version: 1.2.0
Summary: A tool for analyzing rule effectiveness in credit risk management
Home-page: https://github.com/aialgorithm/rulelift
Author: aialgorithm
Author-email: aialgorithm@example.com
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Intended Audience :: Financial and Insurance Industry
Classifier: Topic :: Scientific/Engineering :: Information Analysis
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.6
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: pandas<=2.3.3,>=1.0.0
Requires-Dist: numpy<=2.4.0,>=1.18.0
Requires-Dist: scikit-learn<=1.8.0,>=0.24.0
Requires-Dist: matplotlib<=3.10.8,>=3.3.0
Requires-Dist: seaborn<=0.13.2,>=0.11.0
Requires-Dist: networkx<=3.6.1,>=2.5.0
Requires-Dist: graphviz<1.0.0,>=0.16
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: license-file
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# rulelift - ä¿¡ç”¨é£é™©è§„åˆ™æœ‰æ•ˆæ€§åˆ†æå·¥å…·

## é¡¹ç›®æ¦‚è¿°

rulelift æ˜¯ä¸€ä¸ªç”¨äºä¿¡ç”¨é£é™©ç®¡ç†ä¸­ç­–ç•¥è§„åˆ™è‡ªåŠ¨æŒ–æ˜ã€æœ‰æ•ˆæ€§åˆ†æåŠç›‘æ§çš„ Python å·¥å…·åŒ…ã€‚
- å®æ—¶è¯„ä¼°ç›‘æ§ä¸Šçº¿è§„åˆ™çš„æ•ˆåº¦ï¼›
- è‡ªåŠ¨åŒ–æŒ–æ˜é«˜ä»·å€¼çš„è§„åˆ™ï¼›

## æ ¸å¿ƒä»·å€¼

åœ¨é£æ§é¢†åŸŸï¼Œè§„åˆ™ç³»ç»Ÿå› å…¶é…ç½®ä¾¿åˆ©å’Œå¼ºè§£é‡Šæ€§è€Œå¹¿æ³›åº”ç”¨ï¼Œä½†é¢ä¸´è§„åˆ™æ•ˆæœç›‘æ§éš¾ã€ä¼˜åŒ–éš¾çš„æŒ‘æˆ˜ã€‚rulelift æä¾›äº†å…¨é¢çš„è§£å†³æ–¹æ¡ˆï¼š

- **è§„åˆ™è¯„ä¼°**ï¼šè§£å†³è§„åˆ™æ‹¦æˆªæ ·æœ¬æ— æ ‡ç­¾çš„é—®é¢˜ï¼Œå€ŸåŠ©å®¢æˆ·è¯„çº§åˆ†å¸ƒå·®å¼‚ï¼Œæ¨ç®—é€¾æœŸç‡ã€å¬å›ç‡ã€ç²¾ç¡®ç‡ã€lift å€¼ç­‰æ ¸å¿ƒæŒ‡æ ‡
- **å®æ—¶ç›‘æ§**ï¼šæ”¯æŒåŸºäºç”Ÿäº§æ•°æ®çš„è§„åˆ™æ•ˆæœåˆ†æ
- **è§„åˆ™æŒ–æ˜**ï¼šè‡ªåŠ¨ä»æ•°æ®ä¸­æŒ–æ˜æœ‰æ•ˆçš„é£æ§è§„åˆ™
- **ç­–ç•¥ä¼˜åŒ–**ï¼šè¯„ä¼°ç­–ç•¥ç»„åˆæ•ˆæœï¼Œè®¡ç®—ä¸¤ä¸¤è§„åˆ™é—´çš„å¢ç›Š
- **å¯è§†åŒ–å±•ç¤º**ï¼šç›´è§‚å‘ˆç°è§„åˆ™æ•ˆæœå’Œå…³ç³»
- **æˆæœ¬æ•ˆç›Šé«˜**ï¼šæ— éœ€åˆ†æµæµ‹è¯•ï¼ŒåŸºäºè§„åˆ™å‘½ä¸­ç”¨æˆ·è®°å½•å³å¯è¯„ä¼°è§„åˆ™æ•ˆæœ

å®ƒå¸®åŠ©é£æ§å›¢é˜Ÿè¯„ä¼°è§„åˆ™çš„å®é™…æ•ˆæœï¼Œè¯†åˆ«å†—ä½™è§„åˆ™ï¼Œä¼˜åŒ–ç­–ç•¥ç»„åˆï¼Œæé«˜é£é™©æ§åˆ¶èƒ½åŠ›ã€‚

## å®Œæ•´çš„å®‰è£…ä½¿ç”¨æ–¹æ³•

### ä½¿ç”¨ pip å®‰è£…ï¼ˆæ¨èï¼‰

```bash
pip install rulelift
```

### ä»æºç å®‰è£…

```bash
git clone https://github.com/aialgorithm/rulelift.git
cd rulelift
pip install -e .
```

## å¿«é€Ÿå¼€å§‹

### 1. åŸºæœ¬å¯¼å…¥

```python
from rulelift import (
    load_example_data, preprocess_data,
    SingleFeatureRuleMiner, MultiFeatureRuleMiner, TreeRuleExtractor,
    VariableAnalyzer, analyze_rules, calculate_strategy_gain
)
```

### 2. åŠ è½½ç¤ºä¾‹æ•°æ®

```python
# åŠ è½½ç¤ºä¾‹æ•°æ®
df = load_example_data('feas_target.csv')

# æ•°æ®é¢„å¤„ç†
df = preprocess_data(df)
```

## æ ¸å¿ƒåŠŸèƒ½

### 1. æ ‘è§„åˆ™æå–ï¼ˆTreeRuleExtractorï¼‰

TreeRuleExtractor æ˜¯ä¸€ä¸ªç»Ÿä¸€çš„æ ‘æ¨¡å‹è§„åˆ™æå–ç±»ï¼Œæ”¯æŒå¤šç§ç®—æ³•ï¼ˆDTã€RFã€CHI2ã€XGBã€ISFï¼‰ã€‚

#### 1.1 æ”¯æŒçš„ç®—æ³•

| ç®—æ³• | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| `dt` | å†³ç­–æ ‘ï¼ˆDecision Treeï¼‰ | å¿«é€Ÿç”Ÿæˆè§„åˆ™ï¼Œé€‚åˆåˆæ­¥æ¢ç´¢ |
| `rf` | éšæœºæ£®æ—ï¼ˆRandom Forestï¼‰ | è§„åˆ™ç¨³å®šæ€§å¥½ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒ |
| `chi2` | å¡æ–¹å†³ç­–æ ‘ï¼ˆChi-square Decision Treeï¼‰ | é€‚åˆåˆ†ç±»ç‰¹å¾è¾ƒå¤šçš„åœºæ™¯ |
| `xgb` | XGBoostï¼ˆæ¢¯åº¦æå‡æ ‘ï¼‰ | è§„åˆ™ç²¾åº¦é«˜ï¼Œé€‚åˆå¤æ‚åœºæ™¯ |
| `isf` | å­¤ç«‹æ£®æ—ï¼ˆIsolation Forestï¼‰ | å¼‚å¸¸æ£€æµ‹ï¼Œé€‚åˆæŒ–æ˜å¼‚å¸¸è§„åˆ™ |

#### 1.2 åŸºæœ¬ä½¿ç”¨

```python
from rulelift import TreeRuleExtractor

# åˆå§‹åŒ–æ ‘è§„åˆ™æå–å™¨
tree_miner = TreeRuleExtractor(
    df, 
    target_col='ISBAD', 
    exclude_cols=['ID', 'CREATE_TIME'],
    algorithm='rf',  # ä½¿ç”¨éšæœºæ£®æ—ç®—æ³•
    max_depth=5,
    n_estimators=10,
    test_size=0.3,
    random_state=42
)

# è®­ç»ƒæ¨¡å‹
train_acc, test_acc = tree_miner.train()
print(f"è®­ç»ƒé›†å‡†ç¡®ç‡: {train_acc:.4f}")
print(f"æµ‹è¯•é›†å‡†ç¡®ç‡: {test_acc:.4f}")

# æå–è§„åˆ™
rules = tree_miner.extract_rules()
print(f"æå–çš„è§„åˆ™æ•°é‡: {len(rules)}")

# è·å–è§„åˆ™DataFrame
rules_df = tree_miner.get_rules_as_dataframe(deduplicate=True, sort_by_lift=True)
print(rules_df.head())
```

#### 1.3 ç‰¹å¾è¶‹åŠ¿è¿‡æ»¤ï¼ˆfeature_trendsï¼‰

`feature_trends` å‚æ•°ç”¨äºæ ¹æ®ç‰¹å¾ä¸ç›®æ ‡æ ‡ç­¾çš„æ­£è´Ÿç›¸å…³æ€§è¿‡æ»¤ä¸ç¬¦åˆä¸šåŠ¡è§£é‡Šæ€§çš„è§„åˆ™ã€‚

**å‚æ•°è¯´æ˜**ï¼š
- `feature_trends`: Dict[str, int]ï¼Œé”®ä¸ºç‰¹å¾åï¼Œå€¼ä¸º 1ï¼ˆæ­£ç›¸å…³ï¼‰æˆ– -1ï¼ˆè´Ÿç›¸å…³ï¼‰
  - **æ­£ç›¸å…³ï¼ˆå€¼ä¸º1ï¼‰**ï¼šç‰¹å¾æ•°å€¼è¶Šå¤§ï¼Œç›®æ ‡æ ‡ç­¾ï¼ˆè¿çº¦æ¦‚ç‡ï¼‰è¶Šé«˜
    - åªä¿ç•™åŒ…å«è¯¥ç‰¹å¾**å¤§äºï¼ˆ>ï¼‰**æŸé˜ˆå€¼çš„è§„åˆ™
    - å‰”é™¤åŒ…å«è¯¥ç‰¹å¾**å°äºç­‰äºï¼ˆ<=ï¼‰**æŸé˜ˆå€¼çš„è§„åˆ™
  - **è´Ÿç›¸å…³ï¼ˆå€¼ä¸º-1ï¼‰**ï¼šç‰¹å¾æ•°å€¼è¶Šå°ï¼Œç›®æ ‡æ ‡ç­¾ï¼ˆè¿çº¦æ¦‚ç‡ï¼‰è¶Šé«˜
    - åªä¿ç•™åŒ…å«è¯¥ç‰¹å¾**å°äºç­‰äºï¼ˆ<=ï¼‰**æŸé˜ˆå€¼çš„è§„åˆ™
    - å‰”é™¤åŒ…å«è¯¥ç‰¹å¾**å¤§äºï¼ˆ>ï¼‰**æŸé˜ˆå€¼çš„è§„åˆ™

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```python
# ä½¿ç”¨ç‰¹å¾è¶‹åŠ¿è¿‡æ»¤
tree_miner = TreeRuleExtractor(
    df, 
    target_col='ISBAD', 
    exclude_cols=['ID', 'CREATE_TIME'],
    algorithm='rf',
    feature_trends={
        'ALI_FQZSCORE': -1,      # è´Ÿç›¸å…³ï¼šåˆ†æ•°è¶Šä½ï¼Œè¿çº¦æ¦‚ç‡è¶Šé«˜
        'BAIDU_FQZSCORE': -1,    # è´Ÿç›¸å…³ï¼šåˆ†æ•°è¶Šä½ï¼Œè¿çº¦æ¦‚ç‡è¶Šé«˜
        'NUMBER OF LOAN APPLICATIONS TO PBOC': 1  # æ­£ç›¸å…³ï¼šç”³è¯·æ¬¡æ•°è¶Šå¤šï¼Œè¿çº¦æ¦‚ç‡è¶Šé«˜
    }
)

# æå–è§„åˆ™ï¼ˆä¼šè‡ªåŠ¨è¿‡æ»¤ä¸ç¬¦åˆä¸šåŠ¡è§£é‡Šæ€§çš„è§„åˆ™ï¼‰
rules = tree_miner.extract_rules()
```

**è¿‡æ»¤æ•ˆæœç¤ºä¾‹**ï¼š

ä¸ä½¿ç”¨ `feature_trends`ï¼š
```
Rule 1: ALI_FQZSCORE <= 860.0000  # å¯èƒ½ä¸ç¬¦åˆä¸šåŠ¡è§£é‡Šæ€§
Rule 2: BAIDU_FQZSCORE > 327.0000  # å¯èƒ½ä¸ç¬¦åˆä¸šåŠ¡è§£é‡Šæ€§
Rule 3: NUMBER OF LOAN APPLICATIONS TO PBOC <= 35.0000  # å¯èƒ½ä¸ç¬¦åˆä¸šåŠ¡è§£é‡Šæ€§
```

ä½¿ç”¨ `feature_trends`ï¼š
```
Rule 1: ALI_FQZSCORE <= 860.0000  # è´Ÿç›¸å…³ï¼Œä¿ç•™<=
Rule 2: BAIDU_FQZSCORE <= 535.0000  # è´Ÿç›¸å…³ï¼Œä¿ç•™<=
Rule 3: NUMBER OF LOAN APPLICATIONS TO PBOC > 2.0000  # æ­£ç›¸å…³ï¼Œä¿ç•™>
```

#### 1.4 å¸¸ç”¨å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|----------|------|
| `algorithm` | str | `'dt'` | ç®—æ³•ç±»å‹ï¼š'dt'ã€'rf'ã€'chi2'ã€'xgb'ã€'isf' |
| `max_depth` | int | `5` | å†³ç­–æ ‘æœ€å¤§æ·±åº¦ |
| `min_samples_split` | int | `10` | åˆ†è£‚èŠ‚ç‚¹æ‰€éœ€çš„æœ€å°æ ·æœ¬æ•° |
| `min_samples_leaf` | int | `5` | å¶å­èŠ‚ç‚¹çš„æœ€å°æ ·æœ¬æ•° |
| `n_estimators` | int | `10` | éšæœºæ£®æ—ä¸­æ ‘çš„æ•°é‡ |
| `max_features` | str | `'sqrt'` | æ¯æ£µæ ‘åˆ†è£‚æ—¶è€ƒè™‘çš„æœ€å¤§ç‰¹å¾æ•°ï¼š'sqrt'æˆ–'log2' |
| `test_size` | float | `0.3` | æµ‹è¯•é›†æ¯”ä¾‹ |
| `random_state` | int | `42` | éšæœºç§å­ |
| `feature_trends` | Dict[str, int] | `None` | ç‰¹å¾ä¸ç›®æ ‡æ ‡ç­¾çš„æ­£è´Ÿç›¸å…³æ€§å­—å…¸ |

#### 1.5 è¾“å‡ºç¤ºä¾‹

```python
# æ‰“å°Top 5è§„åˆ™
for i, rule in enumerate(rules[:5]):
    print(f"\n=== Rule {i+1} ===")
    print(f"è§„åˆ™æè¿°: {rule['rule']}")
    print(f"é¢„æµ‹ç±»åˆ«: {rule['class_name']} (æ¦‚ç‡: {rule['class_probability']:.4f})")
    print(f"æ ·æœ¬æ•°é‡: {rule['sample_count']}")
    print(f"é‡è¦æ€§: {rule['importance']:.2f}")
```

---

### 2. å•ç‰¹å¾è§„åˆ™æŒ–æ˜ï¼ˆSingleFeatureRuleMinerï¼‰

ç”¨äºå¯¹æ•°æ®å„ç‰¹å¾çš„ä¸åŒé˜ˆå€¼è¿›è¡Œæ•ˆåº¦åˆ†å¸ƒåˆ†æã€‚

#### 2.1 åŸºæœ¬ä½¿ç”¨

```python
from rulelift import SingleFeatureRuleMiner

# åˆå§‹åŒ–å•ç‰¹å¾è§„åˆ™æŒ–æ˜å™¨
sf_miner = SingleFeatureRuleMiner(
    df, 
    exclude_cols=['ID', 'CREATE_TIME'],
    target_col='ISBAD'
)

# åˆ†æå•ä¸ªç‰¹å¾
feature = 'ALI_FQZSCORE'
metrics_df = sf_miner.calculate_single_feature_metrics(feature, num_bins=20)
print(f"\n=== {feature} åˆ†ç®±åˆ†æ ===")
print(metrics_df.head())

# è·å–Topè§„åˆ™
top_rules = sf_miner.get_top_rules(feature=feature, top_n=5, metric='lift', min_samples=10)
print(f"\n=== Top 5è§„åˆ™ ===")
print(top_rules[['rule_description', 'lift', 'badrate', 'selected_samples']])
```

#### 2.2 å¯è§†åŒ–

```python
# ç»˜åˆ¶ç‰¹å¾æŒ‡æ ‡åˆ†å¸ƒå›¾
plt = sf_miner.plot_feature_metrics(feature, metric='lift')
plt.savefig(f'{feature}_lift_distribution.png', dpi=300, bbox_inches='tight')
plt.close()
```

#### 2.3 å¸¸ç”¨å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|----------|------|
| `exclude_cols` | List[str] | `None` | æ’é™¤çš„å­—æ®µååˆ—è¡¨ |
| `target_col` | str | `'ISBAD'` | ç›®æ ‡å­—æ®µå |
| `num_bins` | int | `20` | åˆ†ç®±æ•°é‡ |
| `min_samples` | int | `10` | æœ€å°æ ·æœ¬æ•°è¿‡æ»¤ |
| `min_lift` | float | `1.1` | æœ€å°liftå€¼è¿‡æ»¤ |

#### 2.4 è¾“å‡ºç¤ºä¾‹

```
=== Top 5è§„åˆ™ ===
                           rule_description      lift  badrate  selected_samples
0  ALI_FQZSCORE <= 665.0000  2.174292  0.666667              51
1  ALI_FQZSCORE <= 688.5000  2.087320  0.640000              75
2  ALI_FQZSCORE <= 705.0000  1.993101  0.611111             108
3  ALI_FQZSCORE <= 725.0000  1.928934  0.580000             150
4  ALI_FQZSCORE <= 745.0000  1.867925  0.555556             180
```

---

### 3. å¤šç‰¹å¾äº¤å‰è§„åˆ™æŒ–æ˜ï¼ˆMultiFeatureRuleMinerï¼‰

ç”¨äºç”ŸæˆåŒç‰¹å¾äº¤å‰åˆ†æç»“æœï¼Œæ”¯æŒè‡ªå®šä¹‰åˆ†ç®±é˜ˆå€¼ã€è‡ªåŠ¨åˆ†ç®±ã€å¡æ–¹åˆ†ç®±ç­‰å¤šç§åˆ†ç®±ç­–ç•¥ã€‚

#### 3.1 åŸºæœ¬ä½¿ç”¨

```python
from rulelift import MultiFeatureRuleMiner

# åˆå§‹åŒ–å¤šç‰¹å¾è§„åˆ™æŒ–æ˜å™¨
multi_miner = MultiFeatureRuleMiner(df, target_col='ISBAD')

# ç”Ÿæˆäº¤å‰è§„åˆ™
feature1 = 'ALI_FQZSCORE'
feature2 = 'BAIDU_FQZSCORE'
cross_rules = multi_miner.get_cross_rules(
    feature1, feature2, 
    top_n=10, 
    metric='lift',
    min_samples=10,  # æœ€å°æ ·æœ¬æ•°è¿‡æ»¤
    min_lift=1.1     # æœ€å°liftå€¼è¿‡æ»¤
)
print(f"\n=== äº¤å‰è§„åˆ™Top 10 ===")
print(cross_rules[['rule_description', 'lift', 'badrate', 'count']].head())

# ç»˜åˆ¶äº¤å‰çƒ­åŠ›å›¾
plt = multi_miner.plot_cross_heatmap(feature1, feature2, metric='lift')
plt.savefig('cross_feature_heatmap.png', dpi=300, bbox_inches='tight')
plt.close()
```

#### 3.2 å¸¸ç”¨å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|----------|------|
| `target_col` | str | `'ISBAD'` | ç›®æ ‡å­—æ®µå |
| `top_n` | int | `10` | è¿”å›çš„è§„åˆ™æ•°é‡ |
| `metric` | str | `'lift'` | æ’åºæŒ‡æ ‡ï¼š'lift'ã€'badrate'ç­‰ |
| `min_samples` | int | `10` | æœ€å°æ ·æœ¬æ•°è¿‡æ»¤ |
| `min_lift` | float | `1.1` | æœ€å°liftå€¼è¿‡æ»¤ |
| `max_unique_threshold` | int | `5` | æœ€å¤§å…è®¸çš„å”¯ä¸€å€¼æ•°é‡é˜ˆå€¼ |
| `custom_bins1` | List[float] | `None` | ç¬¬ä¸€ä¸ªç‰¹å¾çš„è‡ªå®šä¹‰åˆ†ç®±é˜ˆå€¼ |
| `custom_bins2` | List[float] | `None` | ç¬¬äºŒä¸ªç‰¹å¾çš„è‡ªå®šä¹‰åˆ†ç®±é˜ˆå€¼ |
| `binning_method` | str | `'quantile'` | åˆ†ç®±æ–¹æ³•ï¼š'quantile'ï¼ˆç­‰é¢‘ï¼‰æˆ–'chi2'ï¼ˆå¡æ–¹ï¼‰ |

#### 3.3 è¾“å‡ºç¤ºä¾‹

```
=== äº¤å‰è§„åˆ™Top 10 ===
                                        rule_description  lift  badrate  count
0  ALI_FQZSCORE = (780.0, 805.0] AND ...  27.0      27.0      0
1  ALI_FQZSCORE = (805.0, 870.0] AND ...  23.0      23.0      0
2  ALI_FQZSCORE = (705.0, 745.0] AND ...  21.0      21.0      0
3  ALI_FQZSCORE = (745.0, 780.0] AND ...  19.0      19.0      0
4  ALI_FQZSCORE = (665.0, 705.0] AND ...  18.0      18.0      0
```

---

### 4. å˜é‡åˆ†æï¼ˆVariableAnalyzerï¼‰

æ”¯æŒå¯¹ç‰¹å¾å˜é‡è¿›è¡Œå…¨é¢çš„æ•ˆåº¦åˆ†æå’Œåˆ†ç®±åˆ†æï¼Œå¸®åŠ©é£æ§å›¢é˜Ÿè¯†åˆ«é‡è¦å˜é‡ï¼Œä¼˜åŒ–ç‰¹å¾å·¥ç¨‹ã€‚

#### 4.1 åŸºæœ¬ä½¿ç”¨

```python
from rulelift import VariableAnalyzer

# åˆå§‹åŒ–å˜é‡åˆ†æå™¨
var_analyzer = VariableAnalyzer(
    df, 
    exclude_cols=['ID', 'CREATE_TIME'], 
    target_col='ISBAD'
)

# åˆ†ææ‰€æœ‰å˜é‡çš„æ•ˆåº¦æŒ‡æ ‡
var_metrics = var_analyzer.analyze_all_variables()
print("\n=== æ‰€æœ‰å˜é‡æ•ˆåº¦æŒ‡æ ‡ ===")
print(var_metrics)

# åˆ†æå•ä¸ªå˜é‡çš„åˆ†ç®±æƒ…å†µ
feature = 'ALI_FQZSCORE'
bin_analysis = var_analyzer.analyze_single_variable(feature, n_bins=10)
print(f"\n=== {feature} åˆ†ç®±åˆ†æ ===")
print(bin_analysis)

# å¯è§†åŒ–å˜é‡åˆ†ç®±ç»“æœ
plt = var_analyzer.plot_variable_bins(feature, n_bins=10)
plt.savefig(f'{feature}_bin_analysis.png', dpi=300, bbox_inches='tight')
plt.close()
```

#### 4.2 å¸¸ç”¨å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|----------|------|
| `exclude_cols` | List[str] | `None` | æ’é™¤çš„å­—æ®µååˆ—è¡¨ |
| `target_col` | str | `'ISBAD'` | ç›®æ ‡å­—æ®µå |
| `n_bins` | int | `10` | åˆ†ç®±æ•°é‡ |

#### 4.3 è¾“å‡ºç¤ºä¾‹

```
=== æ‰€æœ‰å˜é‡æ•ˆåº¦æŒ‡æ ‡ ===
        variable        iv        ks        auc  missing_rate  single_value_rate  min_value  max_value  median_value  mean_diff  corr_with_target  psi
0  ALI_FQZSCORE  0.456789  0.452345  0.723456      0.012345      0.0456789      0.987654      0.723456      0.012345      0.456789      0.012345
1  BAIDU_FQZSCORE  0.3456789  0.3456789  0.678901      0.023456      0.056789      0.976543      0.678901      0.023456      0.3456789      0.023456
```

---

### 5. è§„åˆ™æ•ˆåº¦åˆ†æï¼ˆanalyze_rulesï¼‰

è§£å†³è§„åˆ™æ‹¦æˆªæ ·æœ¬æ— æ ‡ç­¾çš„é—®é¢˜ï¼Œå€ŸåŠ©å®¢æˆ·è¯„çº§åˆ†å¸ƒå·®å¼‚ï¼Œæ¨ç®—é€¾æœŸç‡ã€å¬å›ç‡ã€ç²¾ç¡®ç‡ã€lift å€¼ç­‰æ ¸å¿ƒæŒ‡æ ‡ã€‚

#### 5.1 åŸºæœ¬ä½¿ç”¨

```python
from rulelift import analyze_rules

# åˆ†æè§„åˆ™æ•ˆåº¦
result = analyze_rules(
    df, 
    rule_col='RULE',
    user_id_col='USER_ID',
    user_level_badrate_col='USER_LEVEL_BADRATE',
    user_target_col='USER_TARGET',
    hit_date_col='HIT_DATE'
)

print("\n=== è§„åˆ™æ•ˆåº¦åˆ†æç»“æœ ===")
print(result[['RULE', 'actual_lift', 'actual_badrate', 'actual_recall', 'f1']].head())
```

#### 5.2 å¸¸ç”¨å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|----------|------|
| `rule_col` | str | `'RULE'` | è§„åˆ™å­—æ®µå |
| `user_id_col` | str | `'USER_ID'` | ç”¨æˆ·ç¼–å·å­—æ®µå |
| `user_level_badrate_col` | str | `None` | ç”¨æˆ·è¯„çº§åè´¦ç‡å­—æ®µåï¼ˆå¯é€‰ï¼‰ |
| `user_target_col` | str | `None` | ç”¨æˆ·å®é™…é€¾æœŸå­—æ®µåï¼ˆå¯é€‰ï¼‰ |
| `hit_date_col` | str | `None` | å‘½ä¸­æ—¥æœŸå­—æ®µåï¼ˆå¯é€‰ï¼Œç”¨äºå‘½ä¸­ç‡ç›‘æ§ï¼‰ |
| `metrics` | list | `None` | æŒ‡å®šè¦è®¡ç®—çš„æŒ‡æ ‡åˆ—è¡¨ï¼ˆå¯é€‰ï¼‰ |
| `include_stability` | bool | `True` | æ˜¯å¦åŒ…å«ç¨³å®šæ€§æŒ‡æ ‡ |

#### 5.3 è¾“å‡ºç¤ºä¾‹

```
=== è§„åˆ™æ•ˆåº¦åˆ†æç»“æœ ===
         RULE  actual_lift  actual_badrate  actual_recall        f1
0  rule1     2.3456789      0.3456789      0.456789  0.3456789
1  rule2     2.123456      0.234567       0.3456789  0.234567
2  rule3     1.987654      0.123456       0.234567  0.123456
```

---

### 6. ç­–ç•¥å¢ç›Šè®¡ç®—ï¼ˆcalculate_strategy_gainï¼‰

è¯„ä¼°ç­–ç•¥ç»„åˆæ•ˆæœï¼Œè®¡ç®—ä¸¤ä¸¤è§„åˆ™é—´çš„å¢ç›Šã€‚

#### 6.1 åŸºæœ¬ä½¿ç”¨

```python
from rulelift import calculate_strategy_gain

# å®šä¹‰ä¸¤ä¸ªç­–ç•¥ç»„
strategy1 = ['rule1', 'rule2']
strategy2 = ['rule1', 'rule2', 'rule3']

# è®¡ç®—ç­–ç•¥å¢ç›Šï¼ˆstrategy1 åˆ° strategy2 çš„é¢å¤–ä»·å€¼ï¼‰
gain = calculate_strategy_gain(
    df, 
    strategy1, 
    strategy2, 
    user_target_col='USER_TARGET'
)
print(f"\nç­–ç•¥å¢ç›Š: {gain:.4f}")
```

#### 6.2 å¸¸ç”¨å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|----------|------|
| `strategy1` | list | - | åŸºç¡€ç­–ç•¥è§„åˆ™åˆ—è¡¨ |
| `strategy2` | list | - | å¢å¼ºç­–ç•¥è§„åˆ™åˆ—è¡¨ |
| `user_target_col` | str | `None` | ç”¨æˆ·å®é™…é€¾æœŸå­—æ®µåï¼ˆå¯é€‰ï¼‰ |
| `user_level_badrate_col` | str | `None` | ç”¨æˆ·è¯„çº§åè´¦ç‡å­—æ®µåï¼ˆå¯é€‰ï¼‰ |

---

## æ ¸å¿ƒæŒ‡æ ‡è¯´æ˜

### è§„åˆ™è¯„ä¼°æŒ‡æ ‡

| æŒ‡æ ‡ | å®šä¹‰ | æœ€ä½³èŒƒå›´ | æ„ä¹‰ |
|------|------|----------|------|
| `actual_lift` | è§„åˆ™å‘½ä¸­æ ·æœ¬é€¾æœŸç‡ / æ€»æ ·æœ¬é€¾æœŸç‡ | > 1.0 | è§„åˆ™çš„é£é™©åŒºåˆ†èƒ½åŠ›ï¼Œå€¼è¶Šå¤§æ•ˆæœè¶Šå¥½ |
| `f1` | 2*(ç²¾ç¡®ç‡*å¬å›ç‡)/(ç²¾ç¡®ç‡+å¬å›ç‡) | 0-1 | ç»¼åˆè¯„ä¼°è§„åˆ™çš„ç²¾ç¡®ç‡å’Œå¬å›ç‡ |
| `actual_badrate` | è§„åˆ™å‘½ä¸­æ ·æœ¬ä¸­çš„é€¾æœŸæ¯”ä¾‹ | ä¾ä¸šåŠ¡åœºæ™¯è€Œå®š | è§„åˆ™ç›´æ¥æ‹¦æˆªçš„åå®¢æˆ·æ¯”ä¾‹ |
| `actual_recall` | è§„åˆ™å‘½ä¸­çš„åå®¢æˆ· / æ€»åå®¢æˆ· | 0-1 | è§„åˆ™å¯¹åå®¢æˆ·çš„è¦†ç›–èƒ½åŠ› |
| `hit_rate_cv` | å‘½ä¸­ç‡å˜å¼‚ç³»æ•° = æ ‡å‡†å·®/å‡å€¼ | < 0.2 | è§„åˆ™å‘½ä¸­ç‡çš„ç¨³å®šæ€§ï¼Œå€¼è¶Šå°è¶Šç¨³å®š |
| `max_correlation_value` | ä¸å…¶ä»–è§„åˆ™çš„æœ€å¤§ç›¸å…³ç³»æ•° | < 0.5 | è§„åˆ™çš„ç‹¬ç«‹æ€§ï¼Œå€¼è¶Šå°ç‹¬ç«‹æ€§è¶Šå¥½ |

### å˜é‡åˆ†ææŒ‡æ ‡

| æŒ‡æ ‡ | å®šä¹‰ | æœ€ä½³èŒƒå›´ | æ„ä¹‰ |
|------|------|----------|------|
| `iv` | ä¿¡æ¯å€¼(Information Value) | > 0.1 | å˜é‡çš„é¢„æµ‹èƒ½åŠ›ï¼Œå€¼è¶Šå¤§é¢„æµ‹èƒ½åŠ›è¶Šå¼º |
| `ks` | KSç»Ÿè®¡é‡ | > 0.2 | å˜é‡å¯¹å¥½åå®¢æˆ·çš„åŒºåˆ†èƒ½åŠ›ï¼Œå€¼è¶Šå¤§åŒºåˆ†èƒ½åŠ›è¶Šå¼º |
| `auc` | æ›²çº¿ä¸‹é¢ç§¯ | > 0.6 | å˜é‡çš„æ•´ä½“é¢„æµ‹èƒ½åŠ›ï¼Œå€¼è¶Šå¤§é¢„æµ‹èƒ½åŠ›è¶Šå¼º |
| `badrate` | åˆ†ç®±ä¸­çš„åå®¢æˆ·æ¯”ä¾‹ | ä¾ä¸šåŠ¡åœºæ™¯è€Œå®š | åˆ†ç®±çš„é£é™©æ°´å¹³ |
| `cum_badrate` | ç´¯ç§¯åå®¢æˆ·æ¯”ä¾‹ | ä¾ä¸šåŠ¡åœºæ™¯è€Œå®š | ç´¯ç§¯åˆ†ç®±çš„é£é™©æ°´å¹³ |

---

## æœ€ä½³å®è·µ

1. **æ•°æ®å‡†å¤‡**ï¼š
   - ç¡®ä¿æ•°æ®åŒ…å«å”¯ä¸€çš„ç”¨æˆ·æ ‡è¯†å’Œè§„åˆ™åç§°
   - å®é™…é€¾æœŸå­—æ®µï¼ˆUSER_TARGETï¼‰åº”ä¸º 0/1 æ ¼å¼
   - è¯„çº§åè´¦ç‡å­—æ®µï¼ˆUSER_LEVEL_BADRATEï¼‰åº”ä¸ºæ•°å€¼å‹

2. **åˆ†åœºæ™¯ä½¿ç”¨**ï¼š
   - **å¼€å‘æµ‹è¯•é˜¶æ®µ**ï¼šä½¿ç”¨å†³ç­–æ ‘è§„åˆ™æå–å’Œå•/å¤šç‰¹å¾è§„åˆ™æŒ–æ˜ç”Ÿæˆå€™é€‰è§„åˆ™
   - **ç”Ÿäº§ç›‘æ§é˜¶æ®µ**ï¼šä½¿ç”¨ analyze_rules å®šæœŸè¯„ä¼°è§„åˆ™æ•ˆæœï¼Œå…³æ³¨ lift å€¼å’Œå‘½ä¸­ç‡ç¨³å®šæ€§

3. **è§„åˆ™ä¼˜åŒ–å»ºè®®**ï¼š
   - ä¿ç•™ lift å€¼ > 1.2 çš„è§„åˆ™
   - ç§»é™¤å‘½ä¸­ç‡å˜å¼‚ç³»æ•° > 0.5 çš„ä¸ç¨³å®šè§„åˆ™
   - åˆå¹¶æˆ–ç§»é™¤ç›¸å…³ç³»æ•° > 0.8 çš„å†—ä½™è§„åˆ™
   - ç»¼åˆè€ƒè™‘ f1 åˆ†æ•°ï¼Œå¹³è¡¡ç²¾ç¡®ç‡å’Œå¬å›ç‡

4. **ç‰¹å¾è¶‹åŠ¿è¿‡æ»¤**ï¼š
   - ä½¿ç”¨ `feature_trends` å‚æ•°ç¡®ä¿è§„åˆ™ç¬¦åˆä¸šåŠ¡è§£é‡Šæ€§
   - æ­£ç›¸å…³ç‰¹å¾ï¼ˆå¦‚ç”³è¯·æ¬¡æ•°ï¼‰ï¼šåªä¿ç•™å¤§äºé˜ˆå€¼çš„è§„åˆ™
   - è´Ÿç›¸å…³ç‰¹å¾ï¼ˆå¦‚ä¿¡ç”¨åˆ†ï¼‰ï¼šåªä¿ç•™å°äºç­‰äºé˜ˆå€¼çš„è§„åˆ™

5. **ç­–ç•¥ç»„åˆ**ï¼š
   - ä½¿ç”¨ calculate_strategy_gain è¯„ä¼°ä¸åŒç­–ç•¥ç»„åˆçš„æ•ˆæœ
   - ä¼˜å…ˆæ·»åŠ  lift å€¼é«˜ä¸”ä¸ç°æœ‰è§„åˆ™ç›¸å…³æ€§ä½çš„è§„åˆ™
   - å®šæœŸè¯„ä¼°ç­–ç•¥æ•´ä½“æ•ˆæœï¼ŒåŠæ—¶è°ƒæ•´è§„åˆ™ç»„åˆ

---

## ç‰ˆæœ¬ä¿¡æ¯

å½“å‰ç‰ˆæœ¬ï¼š1.2.0

## æ›´æ–°æ—¥å¿—

### v1.2.0 (2025-01-10)
- **æ–°å¢ç‰¹å¾è¶‹åŠ¿è¿‡æ»¤åŠŸèƒ½**ï¼šTreeRuleExtractor æ”¯æŒ `feature_trends` å‚æ•°
  - æ­£ç›¸å…³ç‰¹å¾ï¼ˆå€¼ä¸º1ï¼‰ï¼šåªä¿ç•™å¤§äºé˜ˆå€¼çš„è§„åˆ™
  - è´Ÿç›¸å…³ç‰¹å¾ï¼ˆå€¼ä¸º-1ï¼‰ï¼šåªä¿ç•™å°äºç­‰äºé˜ˆå€¼çš„è§„åˆ™
  - æå‡è§„åˆ™çš„ä¸šåŠ¡è§£é‡Šæ€§
- **ä¼˜åŒ–å­¤ç«‹æ£®æ—è§„åˆ™æå–**ï¼šåŸºäºæ ‘ç»“æ„æå–è§„åˆ™ï¼Œæ”¯æŒå¤šç‰¹å¾ç»„åˆ
- **ä¼˜åŒ–SingleFeatureRuleMiner**ï¼šè¿‡æ»¤æç«¯å€¼é˜ˆå€¼ï¼Œé¿å…æ— æ„ä¹‰è§„åˆ™
- **ä¼˜åŒ–MultiFeatureRuleMiner**ï¼šæ·»åŠ æœ€å°æ ·æœ¬æ•°å’Œliftå€¼è¿‡æ»¤
- **ä¼˜åŒ–è§„åˆ™DataFrameè¾“å‡º**ï¼šæ”¯æŒæŒ‰liftå€’åºæ’åº
- **åˆ é™¤å˜é‡åˆ†æä¸­çš„æŸå¤±ç‡æŒ‡æ ‡**ï¼šä¸“æ³¨äºæ ¸å¿ƒæ•ˆåº¦æŒ‡æ ‡
- **å®Œå–„æ–‡æ¡£**ï¼šæ›´æ–°æ‰€æœ‰åŠŸèƒ½çš„ä½¿ç”¨ç¤ºä¾‹ã€ç»“æœç¤ºä¾‹åŠå¸¸ç”¨å‚æ•°ä»‹ç»
- **ä¿®å¤å·²çŸ¥é—®é¢˜**ï¼šè§£å†³æ‰€æœ‰å·²çŸ¥bugå’Œæ€§èƒ½é—®é¢˜

### v1.1.5 (2025-12-23)
- æ–°å¢å˜é‡åˆ†ææ¨¡å—ï¼Œæ”¯æŒIVã€KSã€AUCç­‰æŒ‡æ ‡è®¡ç®—
- å®ç°å•å˜é‡ç­‰é¢‘åˆ†ç®±åˆ†æåŠŸèƒ½
- æ–°å¢ç­–ç•¥è‡ªåŠ¨æŒ–æ˜åŠŸèƒ½
- ä¼˜åŒ–å†³ç­–æ ‘è§„åˆ™æ˜¾ç¤ºï¼ŒåŠ å…¥ lift å€¼å’Œæ‹¦æˆªç”¨æˆ·æ•°ç­‰æŒ‡æ ‡
- æ–°å¢ä¸¤ä¸¤ç­–ç•¥å¢ç›Šè®¡ç®—åŠŸèƒ½
- ä¼˜åŒ–ä»£ç è´¨é‡ï¼Œä¿®å¤æ‰€æœ‰å·²çŸ¥é—®é¢˜

### v1.0.0 (2025-12-17)
- æ–°å¢å‘½ä¸­ç‡å˜å¼‚ç³»æ•°ï¼ˆhit_rate_cvï¼‰ç”¨äºç›‘æ§è§„åˆ™ç¨³å®šæ€§
- æ–°å¢ F1 åˆ†æ•°è®¡ç®—ï¼Œç»¼åˆè¯„ä¼°è§„åˆ™æ•ˆæœ
- ä¼˜åŒ–è§„åˆ™ç›¸å…³æ€§åˆ†æï¼Œæ–°å¢æœ€å¤§ç›¸å…³æ€§æŒ‡æ ‡
- æ”¹è¿›å‘½ä¸­ç‡è®¡ç®—é€»è¾‘
- å®Œå–„æ–‡æ¡£ï¼Œæ–°å¢æŠ€æœ¯åŸç†å’Œç¼ºé™·åˆ†æ

---

## è®¸å¯è¯

MIT License

---

## é¡¹ç›®åœ°å€

- GitHub: https://github.com/aialgorithm/rulelift
- PyPI: https://pypi.org/project/rulelift/

---

## è”ç³»æ–¹å¼

ä½œè€…: aialgorithm
é‚®ç®±: 15880982687@qq.com

---

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼å¦‚æœæ‚¨æœ‰ä»»ä½•å»ºè®®æˆ–é—®é¢˜ï¼Œè¯·é€šè¿‡ GitHub Issues åé¦ˆã€‚

---

**å¼€å§‹ä½¿ç”¨ rulelift ä¼˜åŒ–æ‚¨çš„é£æ§è§„åˆ™ç³»ç»Ÿå§ï¼** ğŸš€
