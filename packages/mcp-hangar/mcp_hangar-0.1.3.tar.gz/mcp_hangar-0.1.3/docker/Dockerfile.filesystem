FROM node:20-alpine

LABEL org.opencontainers.image.title="MCP Filesystem Server"
LABEL org.opencontainers.image.description="MCP server for filesystem access"
LABEL org.opencontainers.image.source="https://github.com/modelcontextprotocol/servers"

WORKDIR /app

# Install the filesystem server globally
RUN npm install -g @modelcontextprotocol/server-filesystem

# Create data directory for volume mount with world-readable permissions
# This allows any user to read from the mounted volume
RUN mkdir -p /data && chmod 755 /data

# Note: Do NOT set USER here - we'll run as the host user via --user flag
# This allows proper access to mounted volumes with host user permissions

# Default entrypoint - /data is the allowed directory
ENTRYPOINT ["mcp-server-filesystem"]
CMD ["/data"]
