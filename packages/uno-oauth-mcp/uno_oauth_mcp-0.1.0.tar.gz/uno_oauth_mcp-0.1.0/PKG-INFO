Metadata-Version: 2.4
Name: uno-oauth-mcp
Version: 0.1.0
Summary: Uno OAuth MCP - è®© MCP Server å¿«é€Ÿæ¥å…¥ mcpmarket.cn OAuth è®¤è¯
Project-URL: Homepage, https://github.com/xray918/uno-oauth-mcp
Project-URL: Documentation, https://mcpmarket.cn/docs/uno-oauth-mcp
Project-URL: Repository, https://github.com/xray918/uno-oauth-mcp
Author-email: MCPMarket <support@mcpmarket.cn>
License: MIT
Keywords: authentication,mcp,mcpmarket,oauth,uno
Classifier: Development Status :: 4 - Beta
Classifier: Framework :: AsyncIO
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Security
Requires-Python: >=3.10
Requires-Dist: httpx>=0.27.0
Requires-Dist: mcp>=1.0.0
Provides-Extra: dev
Requires-Dist: black; extra == 'dev'
Requires-Dist: isort; extra == 'dev'
Requires-Dist: mypy; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.21.0; extra == 'dev'
Requires-Dist: pytest>=7.0.0; extra == 'dev'
Description-Content-Type: text/markdown

# Uno OAuth MCP

[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![PyPI](https://img.shields.io/pypi/v/uno-oauth-mcp.svg)](https://pypi.org/project/uno-oauth-mcp/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

**è®© MCP Server å¿«é€Ÿæ¥å…¥ [mcpmarket.cn](https://mcpmarket.cn) OAuth è®¤è¯ã€‚**

## âœ¨ ç‰¹æ€§

- ğŸ” **å¼€ç®±å³ç”¨** - å‡ è¡Œä»£ç æ¥å…¥ OAuth è®¤è¯
- ğŸ¯ **åŒæ¨¡å¼æ”¯æŒ** - FastMCPï¼ˆç®€æ´ï¼‰å’Œ åº•å±‚ Serverï¼ˆçµæ´»ï¼‰
- âš¡ **é«˜æ€§èƒ½** - å†…ç½® Token ç¼“å­˜ï¼ˆLRU + TTLï¼‰
- ğŸ“‹ **æ ‡å‡†è§„èŒƒ** - è‡ªåŠ¨ç”Ÿæˆ RFC 9728/8414 well-known ç«¯ç‚¹

## ğŸ“¦ å®‰è£…

```bash
pip install uno-oauth-mcp
```

æˆ–ä½¿ç”¨ uvï¼š

```bash
uv add uno-oauth-mcp
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šåŸºäº FastMCPï¼ˆæ¨èæ–°æ‰‹ï¼‰

FastMCP æ˜¯å®˜æ–¹æä¾›çš„é«˜å±‚å°è£…ï¼ŒAPI æ›´ç®€æ´ï¼š

```python
from uno_oauth_mcp import UnoOAuthMCP

# åˆ›å»ºå¸¦ OAuth çš„ MCP Server
mcp = UnoOAuthMCP(name="My Server", port=8080)

@mcp.tool()
def hello(name: str) -> str:
    """å‘ç”¨æˆ·é—®å¥½"""
    return f"Hello, {name}!"

@mcp.tool()
def add(a: int, b: int) -> int:
    """è®¡ç®—ä¸¤ä¸ªæ•°çš„å’Œ"""
    return a + b

# è¿è¡Œ
mcp.run(transport="streamable-http")
```

### æ–¹å¼äºŒï¼šåŸºäºåº•å±‚ Serverï¼ˆæ›´çµæ´»ï¼‰

åº•å±‚ Server æä¾›æ›´å®Œæ•´çš„ MCP åè®®æ§åˆ¶ï¼š

```python
import mcp.types as types
from uno_oauth_mcp import UnoOAuthServer

# åˆ›å»ºå¸¦ OAuth çš„ Server
server = UnoOAuthServer(name="My Server", port=8080)

@server.list_tools()
async def list_tools():
    return [
        types.Tool(
            name="hello",
            description="å‘ç”¨æˆ·é—®å¥½",
            inputSchema={
                "type": "object",
                "properties": {"name": {"type": "string"}},
                "required": ["name"]
            }
        )
    ]

@server.call_tool()
async def call_tool(name: str, arguments: dict):
    if name == "hello":
        return [types.TextContent(type="text", text=f"Hello, {arguments['name']}!")]
    return []

# è¿è¡Œ
server.run()
```

## ğŸ†š ä¸¤ç§æ–¹å¼å¯¹æ¯”

| ç‰¹æ€§ | UnoOAuthMCP (FastMCP) | UnoOAuthServer (åº•å±‚ Server) |
|------|----------------------|------------------------------|
| **é€‚åˆäººç¾¤** | æ–°æ‰‹ã€å¿«é€Ÿå¼€å‘ | éœ€è¦å®Œæ•´æ§åˆ¶çš„å¼€å‘è€… |
| **API é£æ ¼** | è£…é¥°å™¨ + ç±»å‹æ¨æ–­ | æ˜¾å¼å®šä¹‰ MCP ç±»å‹ |
| **å·¥å…·å®šä¹‰** | `@mcp.tool()` è‡ªåŠ¨æ¨æ–­ | æ‰‹åŠ¨æ„å»º `types.Tool` |
| **çµæ´»æ€§** | â­â­â­ | â­â­â­â­â­ |
| **ä»£ç é‡** | æ›´å°‘ | ç¨å¤š |

## ğŸ”§ é…ç½®é€‰é¡¹

```python
# FastMCP æ–¹å¼
mcp = UnoOAuthMCP(
    name="My Server",                    # Server åç§°
    port=8080,                           # ç›‘å¬ç«¯å£
    host="0.0.0.0",                      # ç›‘å¬åœ°å€
    mcpmarket_url="https://mcpmarket.cn", # è®¤è¯æœåŠ¡å™¨
    required_scopes=["read", "write"],   # OAuth scopes
    cache_ttl=300,                       # Token ç¼“å­˜æ—¶é—´ï¼ˆç§’ï¼‰
    # ç”Ÿäº§ç¯å¢ƒéœ€è¦æŒ‡å®šå¤–éƒ¨è®¿é—® URL
    # resource_server_url="https://my-mcp.example.com",
)

# åº•å±‚ Server æ–¹å¼
server = UnoOAuthServer(
    name="My Server",
    port=8080,
    mcp_path="/mcp",                     # MCP ç«¯ç‚¹è·¯å¾„
    # ... å…¶ä»–å‚æ•°åŒä¸Š
)
```

## ğŸŒ è‡ªåŠ¨æ³¨å†Œçš„ç«¯ç‚¹

SDK ä¼šè‡ªåŠ¨æ³¨å†Œä»¥ä¸‹ç«¯ç‚¹ï¼š

| ç«¯ç‚¹ | æè¿° |
|------|------|
| `/.well-known/oauth-protected-resource` | OAuth èµ„æºæœåŠ¡å™¨å…ƒæ•°æ® (RFC 9728) |
| `/.well-known/oauth-authorization-server` | OAuth æˆæƒæœåŠ¡å™¨å…ƒæ•°æ® (RFC 8414) |
| `/mcp` | MCP åè®®ç«¯ç‚¹ï¼ˆéœ€è®¤è¯ï¼‰ |
| `/health` | å¥åº·æ£€æŸ¥ |
| `/` | æœåŠ¡å™¨ä¿¡æ¯ |

## ğŸ” è®¤è¯æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MCP Client  â”‚     â”‚ Your Server  â”‚     â”‚ mcpmarket.cn â”‚
â”‚(Cursor/Claude)â”‚    â”‚              â”‚     â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚                    â”‚
       â”‚ 1. è®¿é—® MCP ç«¯ç‚¹   â”‚                    â”‚
       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚                    â”‚
       â”‚                    â”‚                    â”‚
       â”‚ 2. 401 + well-knownâ”‚                    â”‚
       â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                    â”‚
       â”‚                    â”‚                    â”‚
       â”‚ 3. OAuth æˆæƒ      â”‚                    â”‚
       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
       â”‚                    â”‚                    â”‚
       â”‚ 4. è·å– Token      â”‚                    â”‚
       â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
       â”‚                    â”‚                    â”‚
       â”‚ 5. å¸¦ Token è®¿é—®   â”‚                    â”‚
       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚                    â”‚
       â”‚                    â”‚ 6. éªŒè¯ Token      â”‚
       â”‚                    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
       â”‚                    â”‚ 7. éªŒè¯æˆåŠŸ        â”‚
       â”‚                    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
       â”‚ 8. MCP å“åº”        â”‚                    â”‚
       â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                    â”‚
```

## ğŸ“š æ›´å¤šç¤ºä¾‹

### å¸¦èµ„æºçš„ Server

```python
from uno_oauth_mcp import UnoOAuthMCP

mcp = UnoOAuthMCP(name="Resource Server")

@mcp.tool()
def get_data(key: str) -> str:
    return f"Data for {key}"

@mcp.resource("config://app")
def get_config() -> str:
    return '{"version": "1.0.0"}'

@mcp.resource("data://{item_id}")
def get_item(item_id: str) -> str:
    return f'{{"id": "{item_id}"}}'

mcp.run(transport="streamable-http")
```

### ä½¿ç”¨åŸç”Ÿ Server + create_oauth_starlette_app

```python
from mcp.server.lowlevel import Server
from uno_oauth_mcp import create_oauth_starlette_app
import uvicorn

server = Server("my-server")

@server.list_tools()
async def list_tools():
    return [...]

# åˆ›å»ºå¸¦ OAuth çš„ Starlette åº”ç”¨
app = create_oauth_starlette_app(server, port=8080)

# å¯ä»¥æ·»åŠ è‡ªå®šä¹‰è·¯ç”±
# from starlette.routing import Route
# app.routes.append(Route("/custom", ...))

uvicorn.run(app, host="0.0.0.0", port=8080)
```

## ğŸ”— ç›¸å…³èµ„æº

- [MCPMarket](https://mcpmarket.cn) - MCP Server å¸‚åœº
- [MCP Python SDK](https://github.com/modelcontextprotocol/python-sdk)
- [RFC 9728](https://datatracker.ietf.org/doc/html/rfc9728) - OAuth Protected Resource Metadata
- [RFC 8414](https://datatracker.ietf.org/doc/html/rfc8414) - OAuth Authorization Server Metadata

## ğŸ“„ è®¸å¯è¯

MIT License

---

Made with â¤ï¸ by [MCPMarket](https://mcpmarket.cn)
