[build-system]
build-backend = "setuptools.build_meta"
requires = ["setuptools>=67", "wheel"]

[project]
name = "cf-taskpool"
version = "0.2.0"
description = "A concurrent.futures-like API for executing coroutines using a pool of tasks"
readme = {file = "README.md", content-type = "text/markdown"}
authors = [{name = "George Sakkis", email = "george.sakkis@gmail.com"}]
license = {text = "MIT"}
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: MIT License",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "Framework :: AsyncIO",
]
keywords = ["asyncio", "concurrent", "executor", "task-pool", "async"]
requires-python = ">=3.11"
dependencies = []

[project.optional-dependencies]
test = ["pytest", "pytest-asyncio", "pytest-cov"]

[project.urls]
Repository = "https://github.com/gsakkis/cf-taskpool"
Issues = "https://github.com/gsakkis/cf-taskpool/issues"

[tool.setuptools]
py-modules = ["cf_taskpool"]

[tool.pytest.ini_options]
asyncio_mode = "auto"
asyncio_default_test_loop_scope = "function"
asyncio_default_fixture_loop_scope = "function"
filterwarnings = ["error"]
addopts = "--cov=cf_taskpool --cov-report=term-missing"

[tool.coverage.run]
patch = ["subprocess"]

[tool.coverage.report]
exclude_also = ["if TYPE_CHECKING:", "if __name__ == .__main__.:"]

[tool.ruff]
fix = true
output-format = "concise"

[tool.ruff.lint]
select = ["ALL"]
ignore = [
    "D",        # pydocstyle
    "EM101",    # String literals in exception constructors
    "COM812",   # Trailing comma missing
    "TRY003",   # Avoid specifying long messages outside the exception class
]

[tool.ruff.lint.pycodestyle]
max-line-length = 90

[tool.ruff.lint.flake8-annotations]
mypy-init-return = true

[tool.ruff.lint.per-file-ignores]
"tests/*" = [
    "ANN",      # flake8-annotations
    "S101",     # Use of assert detected
    "INP001",   # File is part of an implicit namespace package
    "PLR2004",  # Magic value used in comparison
    "SLF001",   # Accesses on "private" class members
]

[tool.mypy]
strict = true
show_error_codes = true
warn_unreachable = true
explicit_package_bases = true

[[tool.mypy.overrides]]
module = "tests.*"
disallow_untyped_defs = false
disallow_untyped_calls = false
