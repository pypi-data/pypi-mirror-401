<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">
    <t t-name="mail_tracking.FailedMessageList">
        <div class="o-mail-ActivityList">
            <div
                class="d-flex pt-4 cursor-pointer fw-bolder"
                t-on-click="toggleFailedMessageList"
            >
                <hr class="flex-grow-1 fs-3" />
                <div class="d-flex align-items-center px-3">
                    <i
                        class="fa fa-fw text-danger"
                        t-att-class="state.showFailedMessageList ? 'fa-caret-down' : 'fa-caret-right'"
                    />
                    <span class="text-danger">Failed messages</span>
                    <span
                        t-if="!state.showFailedMessageList"
                        class="badge rounded-pill ms-2 text-bg-danger"
                    >
                        <t t-esc="failed_messages.length" />
                    </span>
                </div>
                <hr class="flex-grow-1 fe-3" />
            </div>
            <t t-if="state.showFailedMessageList">
                <div class="o-mail-MessageCardList d-flex flex-column">
                    <t
                        t-foreach="failed_messages"
                        t-as="failed_message"
                        t-key="failed_message.id"
                    >
                        <FailedMessage
                            message="failed_message"
                            onUpdate.bind="load"
                            reloadParentView.bind="reloadParentView"
                        />
                    </t>
                </div>
            </t>
        </div>
    </t>
    <t
        t-name="mail_tracking.Chatter"
        t-inherit="mail.Chatter"
        t-inherit-mode="extension"
    >
        <xpath expr="//t[@t-call='mail.ActivityList']/.." position="after">
            <t t-if="failed_messages?.length and !state.isSearchOpen">
                <t t-call="mail_tracking.FailedMessageList" />
            </t>
        </xpath>
    </t>
</templates>
