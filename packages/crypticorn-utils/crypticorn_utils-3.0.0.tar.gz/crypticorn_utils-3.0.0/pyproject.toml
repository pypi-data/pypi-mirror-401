[project]
name = "crypticorn_utils"
description = "Shared utilities for the Crypticorn APIs"
readme = "README.md"
license = "MIT"
license-files = ["LICENSE"]
requires-python = ">=3.11"
authors = [{name = "Crypticorn", email = "timon@crypticorn.com"}]
version = "3.0.0"

classifiers = [
    "Topic :: Scientific/Engineering",
    "Development Status :: 5 - Production/Stable",
    "Intended Audience :: Developers",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: 3.14",
    "Typing :: Typed",
]

dependencies = [
    "fastapi>=0.124.0,<0.125.0",
    "prometheus-client>=0.22.0,<1.0.0",
    "crypticorn>=4.0.0,<5.0.0",
]

[project.optional-dependencies]
build = [
    "uv==0.9.17",
]

[tool.semantic_release]
version_toml = ["pyproject.toml:project.version:nf",] # https://python-semantic-release.readthedocs.io/en/latest/configuration.html#version-toml
commit_message = "Python Release v{version}\n\nAutomatically generated by python-semantic-release" # https://python-semantic-release.readthedocs.io/en/latest/configuration.html#commit-message
# https://python-semantic-release.readthedocs.io/en/latest/configuration.html#build-command
# https://python-semantic-release.readthedocs.io/en/latest/configuration/configuration-guides/uv_integration.html#updating-the-uv-lock
build_command = """
    python -m pip install -e '.[build]'
    uv lock --upgrade-package "$PACKAGE_NAME"
    git add uv.lock
    uv build
"""

# https://python-semantic-release.readthedocs.io/en/latest/concepts/multibranch_releases.html#multibranch-releases
[tool.semantic_release.branches.dev]
match = "dev"
prerelease = true
prerelease_token = "rc"

[tool.semantic_release.branches.main]
match = "main"
prerelease = false

[project.urls]
Changelog = "https://github.com/crypticorn-ai/python-utils/releases"

[tool.uv]
add-bounds = "major"

[tool.uv.build-backend]
module-name = "crypticorn_utils"
module-root = ""

[build-system]
requires = ["uv_build==0.9.17"]
build-backend = "uv_build"

[dependency-groups]
dev = [
    "httpx>=0.28.1,<0.29.0",
    "pyjwt>=2.10.0,<3.0.0",
    "pytest>=9.0.0,<10.0.0",
    "pytest-asyncio>=1.2.0,<2.0.0",
    "pytest-cov>=7.0.0,<8.0.0",
    "python-dotenv>=1.0.1,<2.0.0",
    "ruff>=0.14.0,<0.15.0",
]
