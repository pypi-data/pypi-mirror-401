{
    "status": "success",
    "error_message": null,
    "cve_id": "CVE-2022-23125",
    "cwe_id": "CWE-121",
    "impact": "CRITICAL",
    "title": "Netatalk: Remote Code Execution via Buffer Overflow in copyapplfile function",
    "statement": "The Netatalk package has a stack-based buffer overflow vulnerability in the copyapplfile() function. This is a result of the lack of validation when handling the appl tag in the appls file when copying its information to a new file. The function reads the appl tag information length but does not validate if it's bigger than the maximum buffer size Netatalk uses to store such data, as a result an unauthenticated attacker can craft a file that'll lead to a stack-based buffer overflow when being copied resulting in a remote code execution in a high privileged context.\n\nThis vulnerability doesn't affect any supported Red Hat product.",
    "mitigation": "",
    "comment_zero": "This vulnerability allows remote attackers to execute arbitrary code on affected installations of Netatalk. Authentication is not required to exploit this vulnerability. The specific flaw exists within the copyapplfile function. When parsing the len element, the process does not properly validate the length of user-supplied data prior to copying it to a fixed-length stack-based buffer. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-15869.",
    "comments": "",
    "description": "A flaw was found in Netatalk. This vulnerability allows remote attackers to execute arbitrary code (Remote Code Execution) in the context of root via improper validation of user-supplied data length prior to copying it to a fixed-length stack-based buffer in the copyapplfile function.",
    "components": [
        "netatalk"
    ],
    "references": [
        {
            "url": "https://www.cve.org/CVERecord?id=CVE-2022-23125"
        },
        {
            "url": "https://netatalk.sourceforge.io/3.1/ReleaseNotes3.1.13.html"
        },
        {
            "url": "https://security.gentoo.org/glsa/202311-02"
        },
        {
            "url": "https://www.zerodayinitiative.com/advisories/ZDI-22-526/"
        },
        {
            "url": "https://www.debian.org/security/2023/dsa-5503"
        },
        {
            "url": "https://www.kb.cert.org/vuls/id/709991"
        },
        {
            "url": "https://lists.debian.org/debian-lts-announce/2023/05/msg00018.html"
        }
    ],
    "affects": [
        {
            "affected": "NOTAFFECTED",
            "ps_module": "epel-10",
            "ps_product": "Community Projects",
            "ps_component": "netatalk",
            "impact": "",
            "not_affected_justification": "Vulnerable Code not Present",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NOTAFFECTED",
            "ps_module": "fedora-42",
            "ps_product": "Community Projects",
            "ps_component": "netatalk",
            "impact": "",
            "not_affected_justification": "Vulnerable Code not Present",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NOTAFFECTED",
            "ps_module": "fedora-43",
            "ps_product": "Community Projects",
            "ps_component": "netatalk",
            "impact": "",
            "not_affected_justification": "Vulnerable Code not Present",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NOTAFFECTED",
            "ps_module": "epel-8",
            "ps_product": "Community Projects",
            "ps_component": "netatalk",
            "impact": "",
            "not_affected_justification": "Vulnerable Code not Present",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NOTAFFECTED",
            "ps_module": "epel-9",
            "ps_product": "Community Projects",
            "ps_component": "netatalk",
            "impact": "",
            "not_affected_justification": "Vulnerable Code not Present",
            "delegated_not_affected_justification": ""
        }
    ],
    "cvss_scores": [
        {
            "issuer": "NIST",
            "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
        },
        {
            "issuer": "RH",
            "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
        },
        {
            "issuer": "CVEORG",
            "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
        }
    ]
}
