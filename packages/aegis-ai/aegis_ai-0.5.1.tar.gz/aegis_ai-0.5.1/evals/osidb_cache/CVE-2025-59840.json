{
    "status": "success",
    "error_message": null,
    "cve_id": "CVE-2025-59840",
    "title": "Cross-Site Scripting (XSS) via expressions abusing toString calls in environments using the VEGA_DEBUG global variable",
    "statement": "",
    "comment_zero": "Vega is a visualization grammar, a declarative format for creating, saving, and sharing interactive visualization designs. In Vega prior to version 6.2.0, applications meeting 2 conditions are at risk of arbitrary JavaScript code execution, even if \"safe mode\" expressionInterpreter is used. They are vulnerable if they use `vega` in an application that attaches `vega` library and a `vega.View` instance similar to the Vega Editor to the global `window` and if they allow user-defined Vega `JSON` definitions (vs JSON that was is only provided through source code). Patches are available in the following Vega applications. If using the latest Vega line (6.x), upgrade to `vega` `6.2.0` / `vega-expression` `6.1.0` / `vega-interpreter`  `2.2.1` (if using AST evaluator mode). If using Vega in a non-ESM environment, upgrade to `vega-expression` `5.2.1` / `1.2.1` (if using AST evaluator mode). Some workarounds are available. Do not attach `vega` View instances to global variables, and do not attach `vega` to the global window. These practices of attaching the vega library and View instances may be convenient for debugging, but should not be used in production or in any situation where vega/vega-lite definitions could be provided by untrusted parties.",
    "comments": "",
    "description": "A cross-site scripting (XSS) vulnerability has been identified in the Vega visualization library when applications accept user-supplied Vega specifications and expose Vega objects on the global browser window. An attacker can craft a malicious Vega specification that triggers hidden JavaScript execution through a toString() side effect, leading to DOM-based XSS that may appear reflected or stored depending on how the library is used. When a user opens or interacts with the malicious spec, arbitrary JavaScript executes in the applicationâ€™s domain, allowing an attacker to steal authentication tokens, manipulate displayed data, or perform unauthorized actions on behalf of the victim, compromising both the confidentiality and integrity of affected applications.",
    "components": [
        "vega",
        "vega-expression",
        "vega-interpreter"
    ],
    "references": [
        {
            "url": "https://www.cve.org/CVERecord?id=CVE-2025-59840"
        },
        {
            "url": "https://github.com/vega/vega/security/advisories/GHSA-7f2v-3qq3-vvjf"
        }
    ],
    "affects": [
        {
            "affected": "AFFECTED",
            "ps_module": "epel-10",
            "ps_product": "Community Projects",
            "ps_component": "jupyterlab",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "AFFECTED",
            "ps_module": "fedora-41",
            "ps_product": "Community Projects",
            "ps_component": "jupyterlab",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "AFFECTED",
            "ps_module": "fedora-41",
            "ps_product": "Community Projects",
            "ps_component": "snakemake",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "AFFECTED",
            "ps_module": "fedora-42",
            "ps_product": "Community Projects",
            "ps_component": "jupyterlab",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "AFFECTED",
            "ps_module": "fedora-42",
            "ps_product": "Community Projects",
            "ps_component": "snakemake",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "AFFECTED",
            "ps_module": "fedora-43",
            "ps_product": "Community Projects",
            "ps_component": "jupyterlab",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "AFFECTED",
            "ps_module": "fedora-43",
            "ps_product": "Community Projects",
            "ps_component": "snakemake",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NEW",
            "ps_module": "openshift-logging-5",
            "ps_product": "OpenShift Container Platform",
            "ps_component": "openshift-logging/kibana6-rhel8",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NEW",
            "ps_module": "services-management-platform",
            "ps_product": "cloud.redhat.com",
            "ps_component": "cloudservices/crc-pdf-generator",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NEW",
            "ps_module": "services-management-platform",
            "ps_product": "cloud.redhat.com",
            "ps_component": "pdf-generator",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NEW",
            "ps_module": "openshift-logging-5",
            "ps_product": "OpenShift Container Platform",
            "ps_component": "openshift-logging/elasticsearch-operator-bundle",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NEW",
            "ps_module": "openshift-logging-5",
            "ps_product": "OpenShift Container Platform",
            "ps_component": "openshift-logging/elasticsearch-proxy-rhel9",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NEW",
            "ps_module": "openshift-logging-5",
            "ps_product": "OpenShift Container Platform",
            "ps_component": "openshift-logging/elasticsearch-rhel9-operator",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NEW",
            "ps_module": "openshift-logging-5",
            "ps_product": "OpenShift Container Platform",
            "ps_component": "openshift-logging/elasticsearch6-rhel9",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        },
        {
            "affected": "NEW",
            "ps_module": "openshift-logging-5",
            "ps_product": "OpenShift Container Platform",
            "ps_component": "openshift-logging/logging-curator5-rhel9",
            "impact": "",
            "not_affected_justification": "",
            "delegated_not_affected_justification": ""
        }
    ],
    "cvss_scores": [
        {
            "issuer": "CVEORG",
            "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N"
        },
        {
            "issuer": "RH",
            "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N"
        }
    ]
}
