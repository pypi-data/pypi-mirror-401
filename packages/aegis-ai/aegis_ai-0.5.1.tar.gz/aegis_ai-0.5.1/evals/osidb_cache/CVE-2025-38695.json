{
    "status": "success",
    "error_message": null,
    "cve_id": "CVE-2025-38695",
    "title": "scsi: lpfc: Check for hdwq null ptr when cleaning up lpfc_vport structure",
    "statement": "",
    "comment_zero": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: lpfc: Check for hdwq null ptr when cleaning up lpfc_vport structure\n\nIf a call to lpfc_sli4_read_rev() from lpfc_sli4_hba_setup() fails, the\nresultant cleanup routine lpfc_sli4_vport_delete_fcp_xri_aborted() may\noccur before sli4_hba.hdwqs are allocated.  This may result in a null\npointer dereference when attempting to take the abts_io_buf_list_lock for\nthe first hardware queue.  Fix by adding a null ptr check on\nphba->sli4_hba.hdwq and early return because this situation means there\nmust have been an error during port initialization.",
    "comments": "",
    "description": "",
    "components": [],
    "references": [
        {
            "url": "https://www.cve.org/CVERecord?id=CVE-2025-38695"
        },
        {
            "url": "https://git.kernel.org/stable/c/571617f171f723b05f02d154a2e549a17eab4935"
        },
        {
            "url": "https://git.kernel.org/stable/c/6698796282e828733cde3329c887b4ae9e5545e9"
        },
        {
            "url": "https://git.kernel.org/stable/c/add68606a01dcccf18837a53e85b85caf0693b4b"
        },
        {
            "url": "https://git.kernel.org/stable/c/6711ce7e9de4eb1a541ef30638df1294ea4267f8"
        },
        {
            "url": "https://git.kernel.org/stable/c/7925dd68807cc8fd755b04ca99e7e6f1c04392e8"
        },
        {
            "url": "https://git.kernel.org/stable/c/74bdf54a847dab209d2a8f65852f59b7fa156175"
        },
        {
            "url": "https://git.kernel.org/stable/c/46a0602c24d7d425dd8e00c749cd64a934aac7ec"
        },
        {
            "url": "https://git.kernel.org/stable/c/5e25ee1ecec91c61a8acf938ad338399cad464de"
        },
        {
            "url": "https://git.kernel.org/stable/c/d3f55f46bb37a8ec73bfe3cfe36e3ecfa2945dfa"
        }
    ],
    "affects": [],
    "cvss_scores": []
}
