key: demo
version: 2.2.0
aliases: [demo]
title: StatLine Demo

buckets:
  ppg: {}
  apg: {}
  rpg: {}
  spg: {}
  bpg: {}
  aefg: {}
  effloor: {}
  tov_eff: {}
  stocks: {}
  vers: {}
  helios: {}
  two_way: {}
  telem: {}
  offball: {}
  wl: {}
  spg_sig: {}
  bpg_sig: {}
  handle: {}

metrics:
  - { key: ppg,  bucket: ppg,    clamp: [12.0, 32.0], source: { field: ppg } }
  - { key: apg,  bucket: apg,    clamp: [ 1.5,  9.0], source: { field: apg } }
  - { key: spg,  bucket: spg,    clamp: [ 0.5,  2.2], source: { field: spg } }
  - { key: bpg,  bucket: bpg,    clamp: [ 0.2,  3.0], source: { field: bpg } }
  - { key: tov,  bucket: tov_eff, clamp: [ 1.0,  3.5], invert: true, source: { field: tov } }

  - { key: fgm,  bucket: telem,  clamp: [ 4.0, 15.0], source: { field: fgm } }
  - { key: fga,  bucket: telem,  clamp: [ 8.0, 25.0], source: { field: fga } }
  - { key: orpg, bucket: telem,  clamp: [ 0.5,  5.0], source: { field: orpg } }
  - { key: drpg, bucket: telem,  clamp: [ 1.5, 10.0], source: { field: drpg } }
  - { key: win,  bucket: telem,  clamp: [ 0.0, 16.0], source: { field: win } }
  - { key: loss, bucket: telem,  clamp: [ 0.0, 16.0], source: { field: loss } }

efficiency:
  - key: spg_sig
    bucket: spg_sig
    clamp: [0.40, 1.80]
    min_den: 1
    make: "spg"
    attempt: "1.2"

  - key: bpg_sig
    bucket: bpg_sig
    clamp: [0.10, 1.10]
    min_den: 1
    make: "(min(bpg, 2.0) + 0.25*max(0, bpg-2.0)) / max(0.85, 1.0 + 0.06*drpg)"
    attempt: "2.2"

  # Estimate 3PM from only PPG + FGM (treat all points above 2*FGM as 3s; no FT concepts used)
  - key: tpm_est
    bucket: telem
    clamp: [0.0, 8.0]
    min_den: 1
    make: "min(fgm, max(0, ppg - 2*fgm))"
    attempt: "1"

  # eFG%-derived points per FGA (no FT stats anywhere)
  - key: pps_fg
    bucket: aefg
    clamp: [0.85, 1.45]
    min_den: 3
    make: "2.0 * (fgm + 0.5*tpm_est) / max(1e-6, fga)"
    attempt: "fga"

  - key: eff_usage
    bucket: aefg
    clamp: [0.70, 1.55]
    min_den: 1
    make: "pps_fg * fga"
    attempt: "22"

  - key: net_pos_ppp
    bucket: aefg
    clamp: [0.85, 1.25]
    min_den: 3
    make: "ppg - 1.1*tov"
    attempt: "fga + 0.5*apg"

  - key: pps_gap
    bucket: effloor
    invert: true
    clamp: [0.0, 0.60]
    min_den: 1
    make: "max(0, 1.08 - pps_fg) + 0.50*max(0, pps_fg - 1.35)"
    attempt: "1"

  - key: vol_gap
    bucket: effloor
    invert: true
    clamp: [0.0, 2.0]
    min_den: 1
    make: "max(0, 13 - ppg)"
    attempt: "1"

  - key: stocks_boost
    bucket: stocks
    clamp: [0.30, 1.50]
    min_den: 1
    make: "spg + 1.05*min(bpg, 2.0) + 0.35*max(0, bpg - 2.0)"
    attempt: "3.2"

  - key: scoreless_impact
    bucket: offball
    clamp: [0.30, 1.00]
    min_den: 1
    make: "(0.55*min(1, apg/10) + 0.45*min(1, (1.3*orpg+0.7*drpg)/10))"
    attempt: "1.0"

  - key: reb_value
    bucket: rpg
    clamp: [2.0, 7.5]
    min_den: 1
    make: "1.5*orpg + 0.5*drpg"
    attempt: "1"

  - key: vers_score
    bucket: vers
    clamp: [0.20, 1.00]
    min_den: 1
    make: "(0.65*((min(1, ppg/24) + min(1, (1.6*orpg+drpg)/10) + min(1, apg/10))/3)) + (0.45*((min(1, ppg/24)*min(1, (1.6*orpg+drpg)/10) + min(1, ppg/24)*min(1, apg/10) + min(1, (1.6*orpg+drpg)/10)*min(1, apg/10))/3))"
    attempt: "1.18"

  - key: handle_load
    bucket: handle
    clamp: [0.40, 1.10]
    min_den: 1
    make: "apg / max(1.0, 0.6*fga + tov)"
    attempt: "1"

  - key: helios_score
    bucket: helios
    clamp: [0.35, 0.90]
    min_den: 1
    make: "ppg + 0.9*apg - 0.4*tov"
    attempt: "38"

  - key: tov_scaled
    bucket: tov_eff
    clamp: [0.40, 0.95]
    min_den: 1
    make: "1 - (tov / max(3, 0.80*(fga + 0.7*apg)))"
    attempt: "1"

  - key: ast_to_credit
    bucket: tov_eff
    clamp: [0.70, 2.50]
    min_den: 1
    make: "apg"
    attempt: "max(1.0, tov)"

  - key: two_way_score
    bucket: two_way
    clamp: [0.10, 0.80]
    min_den: 1
    make: "min(2*((ppg+0.9*apg)/42)*((0.7*spg+0.4*bpg)/2.5)) / max(0.0001, ((ppg+0.9*apg)/42)+((0.7*spg+0.4*bpg)/2.5))"
    attempt: "1"

  - key: wl_share
    bucket: wl
    clamp: [0.0, 1.0]
    min_den: 0.5
    make: "win"
    attempt: "win + loss"

  - key: ast_to_bonus
    bucket: tov_eff
    clamp: [0.00, 0.08]
    min_den: 1
    make: "max(0, (apg / max(1.0, tov)) - 2.0)"
    attempt: "6.0"

weights:
  pri:
    aefg:     0.28   # efficiency first (pps_fg, usage-eff)
    tov_eff:  0.17   # ball security + creation quality
    effloor:  0.07   # "chucker tax" + "no-buckets tax" (ppg floor + pps penalties)
    two_way:  0.07   # defense matters *when paired with offense* (coupled term)
    helios:   0.05   # on-ball load, but not a cheat code
    ppg:      0.03   # raw points shouldn’t override efficiency
    vers:     0.09   # multi-skill value, but not above efficiency
    offball:  0.06   # 3&D / dirty work / secondary impact
    handle:   0.055  # rewards real playmaking per load (not just APG)
    rpg:      0.045  # some value, but not a primary driver
    stocks:   0.03   # small standalone credit
    spg_sig:  0.02   # “defense signal” not “defense carry”
    bpg_sig:  0.03


score_profiles:
  PRI: { kind: affine, lo: 55, hi: 99 }
  PRI-AF: { kind: window, out_lo: 0, out_hi: 300, pct_lo: 0.00, pct_hi: 1.25 }
  PRI-AR: { kind: window, out_lo: -25, out_hi: 25, pct_lo: -0.10, pct_hi: 0.9 }
  PRI-AP: { kind: window, out_lo: -99, out_hi: 33, pct_lo: -0.15, pct_hi: 1.15 }
