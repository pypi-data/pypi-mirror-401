var G=Object.defineProperty;var t=(K,c)=>G(K,"name",{value:c,configurable:!0});import{a2 as x,E as S,c as k,d as u,F as V,y as H,z as l,q as U,k as n,A as h,u as m,a8 as s,r as b,W as L,h as Q,j as $,l as W,e as r,I as J,s as X}from"./vendor-other-Dsj-QuOx.js";import{w as z,u as Y,ad as Z,ae as w,y as P,e as ee,s as ie,af as ae}from"./vendor-primevue-Cif--Rbw.js";import{b as ne}from"./vendor-vue-DNQSPQQ2.js";import{bB as le,A as se,n as te,_ as v,S as de,dG as oe,cR as re,cQ as ue,d as ce}from"./index-Bc79VbnU.js";import{u as ye}from"./keybindingService-DOwK-S5D.js";import"./vendor-reka-ui-WjwjFuZo.js";import"./vendor-xterm-CWYFmgbN.js";import"./vendor-three-ByuY8CdW.js";import"./vendor-tiptap-YMjM2h-Z.js";const be={key:0,class:"px-2"},me=x({__name:"KeyComboDisplay",props:{keyCombo:{},isModified:{type:Boolean,default:!1}},setup(K){const c=S(()=>K.keyCombo.getKeySequences());return(d,f)=>(u(),k("span",null,[(u(!0),k(V,null,H(c.value,(_,C)=>(u(),k(V,{key:C},[l(s(z),{severity:d.isModified?"info":"secondary"},{default:n(()=>[h(m(_),1)]),_:2},1032,["severity"]),C<c.value.length-1?(u(),k("span",be,"+")):U("",!0)],64))),128))]))}}),fe={class:"actions invisible flex flex-row"},ge=["title"],pe={key:1},ve={class:"overflow-hidden text-ellipsis"},ke=x({__name:"KeybindingPanel",setup(K){const c=b({global:{value:"",matchMode:ae.CONTAINS}}),d=le(),f=ye(),_=se(),{t:C}=ne(),F=S(()=>Object.values(_.commands).map(e=>({id:e.id,label:C(`commands.${te(e.id)}.label`,e.label??""),keybinding:d.getKeybindingByCommandId(e.id),source:e.source}))),B=b(null),g=b(!1),o=b(null),y=b(null),A=b(null),p=S(()=>!y.value||y.value.keybinding?.combo?.equals(o.value)||!o.value?null:d.getKeybinding(o.value));function E(e){y.value=e,o.value=e.keybinding?e.keybinding.combo:null,g.value=!0}t(E,"editKeybinding"),L(()=>{g.value&&setTimeout(()=>{A.value?.$el?.focus()},300)});async function T(e){e.keybinding&&(d.unsetKeybinding(e.keybinding),await f.persistUserKeybindings())}t(T,"removeKeybinding");async function q(e){if(!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)switch(e.key){case"Escape":I();return;case"Enter":await M();return}const a=re.fromEvent(e);o.value=a}t(q,"captureKeybinding");function I(){g.value=!1,y.value=null,o.value=null}t(I,"cancelEdit");async function M(){y.value&&o.value&&d.updateKeybindingOnCommand(new ue({commandId:y.value.id,combo:o.value}))&&await f.persistUserKeybindings(),I()}t(M,"saveKeybinding");async function D(e){d.resetKeybindingForCommand(e.id)?await f.persistUserKeybindings():console.warn(`No changes made when resetting keybinding for command: ${e.id}`)}t(D,"resetKeybinding");const O=Y();async function j(){d.resetAllKeybindings(),await f.persistUserKeybindings(),O.add({severity:"info",summary:"Info",detail:"All keybindings reset",life:3e3})}return t(j,"resetAllKeybindings"),(e,a)=>{const R=Q("tooltip");return u(),$(oe,{value:"Keybinding",class:"keybinding-panel"},{header:n(()=>[l(de,{modelValue:c.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=i=>c.value.global.value=i),placeholder:e.$t("g.searchKeybindings")+"..."},null,8,["modelValue","placeholder"])]),default:n(()=>[l(s(Z),{selection:B.value,"onUpdate:selection":a[1]||(a[1]=i=>B.value=i),value:F.value,"global-filter-fields":["id","label"],filters:c.value,"selection-mode":"single","striped-rows":"",pt:{header:"px-0"},onRowDblclick:a[2]||(a[2]=i=>E(i.data))},{default:n(()=>[l(s(w),{field:"actions",header:""},{body:n(i=>[r("div",fe,[l(v,{variant:"textonly",size:"icon","aria-label":e.$t("g.edit"),onClick:t(N=>E(i.data),"onClick")},{default:n(()=>a[4]||(a[4]=[r("i",{class:"pi pi-pencil"},null,-1)])),_:2},1032,["aria-label","onClick"]),l(v,{variant:"textonly",size:"icon","aria-label":e.$t("g.reset"),disabled:!s(d).isCommandKeybindingModified(i.data.id),onClick:t(N=>D(i.data),"onClick")},{default:n(()=>a[5]||(a[5]=[r("i",{class:"pi pi-replay"},null,-1)])),_:2},1032,["aria-label","disabled","onClick"]),l(v,{variant:"textonly",size:"icon","aria-label":e.$t("g.delete"),disabled:!i.data.keybinding,onClick:t(N=>T(i.data),"onClick")},{default:n(()=>a[6]||(a[6]=[r("i",{class:"pi pi-trash"},null,-1)])),_:2},1032,["aria-label","disabled","onClick"])])]),_:1}),l(s(w),{field:"id",header:e.$t("g.command"),sortable:"",class:"max-w-64 2xl:max-w-full"},{body:n(i=>[r("div",{class:"truncate",title:i.data.id},m(i.data.label),9,ge)]),_:1},8,["header"]),l(s(w),{field:"keybinding",header:e.$t("g.keybinding")},{body:n(i=>[i.data.keybinding?(u(),$(me,{key:0,"key-combo":i.data.keybinding.combo,"is-modified":s(d).isCommandKeybindingModified(i.data.id)},null,8,["key-combo","is-modified"])):(u(),k("span",pe,"-"))]),_:1},8,["header"]),l(s(w),{field:"source",header:e.$t("g.source")},{body:n(i=>[r("span",ve,m(i.data.source||"-"),1)]),_:1},8,["header"])]),_:1},8,["selection","value","filters"]),l(s(P),{visible:g.value,"onUpdate:visible":a[3]||(a[3]=i=>g.value=i),class:"min-w-96",modal:"",header:y.value?.label,onHide:I},{footer:n(()=>[l(v,{variant:p.value?"destructive":"primary",autofocus:"",onClick:M},{default:n(()=>[r("i",{class:X(p.value?"pi pi-pencil":"pi pi-check")},null,2),h(" "+m(p.value?e.$t("g.overwrite"):e.$t("g.save")),1)]),_:1},8,["variant"])]),default:n(()=>[r("div",null,[l(s(ee),{ref_key:"keybindingInput",ref:A,class:"mb-2 text-center","model-value":o.value?.toString()??"",placeholder:e.$t("g.pressKeysForNewBinding"),autocomplete:"off",fluid:"",onKeydown:J(q,["stop","prevent"])},null,8,["model-value","placeholder"]),p.value?(u(),$(s(ie),{key:0,severity:"warn"},{default:n(()=>[h(m(e.$t("g.keybindingAlreadyExists"))+" ",1),l(s(z),{severity:"secondary",value:p.value.commandId},null,8,["value"])]),_:1})):U("",!0)])]),_:1},8,["visible","header"]),W((u(),$(v,{class:"mt-4 w-full",variant:"destructive-textonly",onClick:j},{default:n(()=>[a[7]||(a[7]=r("i",{class:"pi pi-replay"},null,-1)),h(" "+m(e.$t("g.resetAll")),1)]),_:1})),[[R,e.$t("g.resetAllKeybindingsTooltip")]])]),_:1})}}}),Ee=ce(ke,[["__scopeId","data-v-06049058"]]);export{Ee as default};
//# sourceMappingURL=KeybindingPanel-f7VKBCyl.js.map
