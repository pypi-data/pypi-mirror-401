# LiteQ

<p align="center">
  <a href="https://github.com/ddreamboy/liteq/actions/workflows/tests.yml"><img src="https://github.com/ddreamboy/liteq/actions/workflows/tests.yml/badge.svg" alt="Tests"></a>
  <a href="https://codecov.io/gh/ddreamboy/liteq"><img src="https://codecov.io/gh/ddreamboy/liteq/branch/master/graph/badge.svg" alt="codecov"></a>
  <a href="https://www.python.org/downloads/"><img src="https://img.shields.io/badge/python-3.10%2B-blue.svg" alt="Python Version"></a>
  <a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a>
</p>

<p align="center">
  <b>Read in:</b> <a href="../README.md">ðŸ‡¬ðŸ‡§ English</a>
</p>

Ð›ÐµÐ³ÐºÐ¾Ð²ÐµÑÐ½Ð°Ñ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»Ð¸ÑÑ‚Ð¸Ñ‡Ð½Ð°Ñ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ Ð·Ð°Ð´Ð°Ñ‡ Ð´Ð»Ñ Python **Ð±ÐµÐ· Ð²Ð½ÐµÑˆÐ½Ð¸Ñ… Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹**.

LiteQ â€” ÑÑ‚Ð¾ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ Ð·Ð°Ð´Ð°Ñ‡ Ð½Ð° Ñ‡Ð¸ÑÑ‚Ð¾Ð¼ Python Ð¸ SQLite. Ð˜Ð´ÐµÐ°Ð»ÑŒÐ½Ð¾ Ð´Ð»Ñ Ñ„Ð¾Ð½Ð¾Ð²Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð·Ð°Ð´Ð°Ñ‡ Ð±ÐµÐ· ÑÐ»Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ Celery Ð¸Ð»Ð¸ Redis. ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð´Ð¾Ð±Ð°Ð²ÑŒ Ð´ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€ Ð¸ Ð²Ñ‹Ð·Ð¾Ð²Ð¸ `.delay()` â€” Ð²Ð¾Ñ‚ Ð¸ Ð²ÑÑ‘!

## Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

âœ¨ **ÐÐ¾Ð»ÑŒ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹** â€” Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Python 3.10+ Ð¸ SQLite  
âš¡ **ÐŸÑ€ÐµÐ´ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð¹ API** â€” Ð´ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€ `@task` Ð¸ Ð¼ÐµÑ‚Ð¾Ð´ `.delay()`  
ðŸ”„ **Async Ð¸ sync** â€” Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ñ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¼Ð¸ Ð¸ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¼Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑÐ¼Ð¸  
ðŸ“¦ **ÐÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹** â€” Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·ÑƒÐ¹Ñ‚Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑÐ¼ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹  
ðŸŽ¯ **ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ñ‹** â€” ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ñ€ÑÐ´Ð¾Ðº Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ  
ðŸ” **ÐÐ²Ñ‚Ð¾Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ñ‹** â€” Ð½Ð°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼Ð°Ñ Ð»Ð¾Ð³Ð¸ÐºÐ° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¾Ð²  
ðŸ‘· **ÐœÐ½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ Ð²Ð¾Ñ€ÐºÐµÑ€Ð¾Ð²** â€” Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð·Ð°Ð´Ð°Ñ‡  
ðŸ“Š **ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³** â€” Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸, Ð²Ð¾Ñ€ÐºÐµÑ€Ð¾Ð² Ð¸ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð·Ð°Ð´Ð°Ñ‡  
ðŸ’¾ **ÐÐ°Ð´Ñ‘Ð¶Ð½Ð¾ÑÑ‚ÑŒ** â€” ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð² SQLite  
ðŸš€ **Production Ready** â€” Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸ 92%

## Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°

```bash
pip install liteq
```

## Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚

### 1. ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸

Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» `tasks.py`:

```python
from liteq import task
import time

@task()
def send_email(to: str, subject: str):
    print(f"ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¿Ð¸ÑÑŒÐ¼Ð° Ð½Ð° {to}: {subject}")
    time.sleep(1)
    return f"ÐŸÐ¸ÑÑŒÐ¼Ð¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ð½Ð° {to}"

@task(queue="reports", max_retries=5)
def generate_report(report_id: int):
    print(f"Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð° {report_id}")
    time.sleep(2)
    return {"report_id": report_id, "status": "Ð³Ð¾Ñ‚Ð¾Ð²Ð¾"}
```

### 2. Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð² Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ

```python
from tasks import send_email, generate_report

# Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð·Ð°Ð´Ð°Ñ‡Ð¸ - Ð¾Ð½Ð¸ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÑŽÑ‚ ID Ð·Ð°Ð´Ð°Ñ‡Ð¸
task_id = send_email.delay(to="user@example.com", subject="ÐŸÑ€Ð¸Ð²ÐµÑ‚!")
print(f"Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð° Ð·Ð°Ð´Ð°Ñ‡Ð°: {task_id}")

# Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð² Ð´Ñ€ÑƒÐ³ÑƒÑŽ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ
report_id = generate_report.delay(report_id=123)
```

### 3. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð²Ð¾Ñ€ÐºÐµÑ€

```bash
# Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð²Ð¾Ñ€ÐºÐµÑ€ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð·Ð°Ð´Ð°Ñ‡
liteq worker --app tasks.py --queues default,reports --concurrency 4
```

Ð“Ð¾Ñ‚Ð¾Ð²Ð¾! Ð’Ð°ÑˆÐ¸ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð±ÑƒÐ´ÑƒÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒÑÑ Ð² Ñ„Ð¾Ð½Ðµ.

## ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹

### ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸

```python
import asyncio
from liteq import task

@task()
async def fetch_data(url: str):
    print(f"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° {url}")
    await asyncio.sleep(1)
    return {"url": url, "data": "..."}

# Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ
task_id = fetch_data.delay(url="https://api.example.com")
```

### ÐÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹

```python
from liteq import task

@task(queue="emails")
def send_email(to: str):
    print(f"ÐŸÐ¸ÑÑŒÐ¼Ð¾ Ð½Ð° {to}")

@task(queue="reports")
def generate_report(id: int):
    print(f"ÐžÑ‚Ñ‡Ñ‘Ñ‚ {id}")

@task(queue="notifications")
def send_push(user_id: int, message: str):
    print(f"Push Ð´Ð»Ñ {user_id}: {message}")

# Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸
send_email.delay(to="user@example.com")
generate_report.delay(id=42)
send_push.delay(user_id=1, message="ÐŸÑ€Ð¸Ð²ÐµÑ‚!")
```

### ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð·Ð°Ð´Ð°Ñ‡

```python
from liteq import task

@task(name="custom_email_task", max_retries=5)
def send_email(to: str):
    # Ð—Ð°Ð´Ð°Ñ‡Ð° Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÑ‚ÑŒÑÑ Ð´Ð¾ 5 Ñ€Ð°Ð· Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐµ
    print(f"ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð½Ð° {to}")

@task(max_retries=0)  # Ð‘ÐµÐ· Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¾Ð²
def one_time_task():
    print("Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð·")
```

### Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ CLI

```bash
# Ð—Ð°Ð¿ÑƒÑÐº Ð²Ð¾Ñ€ÐºÐµÑ€Ð°
liteq worker --app tasks.py

# ÐÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹
liteq worker --app tasks.py --queues emails,reports,notifications

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»Ð¸Ð·Ð¼Ð°
liteq worker --app tasks.py --concurrency 8

# ÐŸÐ°Ð½ÐµÐ»ÑŒ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° (Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ liteq[web])
liteq monitor --port 5151
```

### ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº Ð²Ð¾Ñ€ÐºÐµÑ€Ð°

```python
from liteq.db import init_db
from liteq.worker import Worker

# Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…
init_db()

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¸ Ð·Ð°Ð¿ÑƒÑÐº Ð²Ð¾Ñ€ÐºÐµÑ€Ð°
worker = Worker(queues=["default", "emails"], concurrency=4)
worker.run()  # Ð‘Ð»Ð¾ÐºÐ¸Ñ€ÑƒÑŽÑ‰Ð¸Ð¹ Ð²Ñ‹Ð·Ð¾Ð²
```

### ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³

```python
from liteq.monitoring import (
    get_queue_stats,
    get_recent_tasks,
    list_queues,
    get_failed_tasks,
    get_active_workers,
)

# Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹
stats = get_queue_stats()
for stat in stats:
    print(f"{stat['queue']}: {stat['count']} Ð·Ð°Ð´Ð°Ñ‡ ({stat['status']})")

# Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹
queues = list_queues()
print(f"ÐžÑ‡ÐµÑ€ÐµÐ´Ð¸: {queues}")

# ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸
recent = get_recent_tasks(limit=10)

# Ð£Ð¿Ð°Ð²ÑˆÐ¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸
failed = get_failed_tasks(limit=5)
for task in failed:
    print(f"Ð—Ð°Ð´Ð°Ñ‡Ð° {task['id']} ÑƒÐ¿Ð°Ð»Ð°: {task['error']}")

# ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð²Ð¾Ñ€ÐºÐµÑ€Ñ‹
workers = get_active_workers()
for worker in workers:
    print(f"Ð’Ð¾Ñ€ÐºÐµÑ€ {worker['worker_id']}: {worker['active_tasks']} Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ð·Ð°Ð´Ð°Ñ‡")
```

## Ð‘Ð¾Ð»ÑŒÑˆÐµ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð¾Ð²

Ð’ Ð¿Ð°Ð¿ÐºÐµ [examples/](../examples/) ÐµÑÑ‚ÑŒ Ð¿Ð¾Ð»Ð½Ñ‹Ðµ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹:

- **[basic.py](../examples/basic.py)** â€” Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ðµ Ð²Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ñ async Ð¸ sync Ð·Ð°Ð´Ð°Ñ‡Ð°Ð¼Ð¸
- **[multiple_queues.py](../examples/multiple_queues.py)** â€” Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹ Ñ Ñ€Ð°Ð·Ð½Ñ‹Ð¼Ð¸ Ð²Ð¾Ñ€ÐºÐµÑ€Ð°Ð¼Ð¸
- **[priorities.py](../examples/priorities.py)** â€” Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ð¾Ð² Ð·Ð°Ð´Ð°Ñ‡
- **[monitoring.py](../examples/monitoring.py)** â€” Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹
- **[email_campaign.py](../examples/email_campaign.py)** â€” Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ñ€Ð¸Ð¼ÐµÑ€ email-Ñ€Ð°ÑÑÑ‹Ð»ÐºÐ¸

Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð»ÑŽÐ±Ð¾Ð¹ Ð¿Ñ€Ð¸Ð¼ÐµÑ€:
```bash
python examples/basic.py
```

## Ð¡Ð¿Ñ€Ð°Ð²Ð¾Ñ‡Ð½Ð¸Ðº API

### Ð”ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€

#### `@task(queue='default', max_retries=3, name=None)`

ÐŸÑ€ÐµÐ²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð² Ð·Ð°Ð´Ð°Ñ‡Ñƒ.

**ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:**
- `queue` (str): ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸ (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ: "default")
- `max_retries` (int): ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¾Ð² (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ: 3)
- `name` (str, Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾): Ð¡Ð²Ð¾Ñ‘ Ð¸Ð¼Ñ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ: Ð¸Ð¼Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸)

**Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:** Ð¤ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ñ Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ `.delay(*args, **kwargs)`

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```python
@task(queue="emails", max_retries=5)
def send_email(to: str):
    ...

# Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ
task_id = send_email.delay(to="user@example.com")
```

### Ð’Ð¾Ñ€ÐºÐµÑ€

#### `Worker(queues, concurrency)`

Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ñ‚ Ð²Ð¾Ñ€ÐºÐµÑ€ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð·Ð°Ð´Ð°Ñ‡.

**ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:**
- `queues` (list[str]): Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ð¹ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
- `concurrency` (int): ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð²

**ÐœÐµÑ‚Ð¾Ð´Ñ‹:**
- `run()`: Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð·Ð°Ð´Ð°Ñ‡ (Ð±Ð»Ð¾ÐºÐ¸Ñ€ÑƒÑŽÑ‰Ð¸Ð¹ Ð²Ñ‹Ð·Ð¾Ð²)

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```python
from liteq.worker import Worker

worker = Worker(queues=["default", "emails"], concurrency=4)
worker.run()
```

### Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°

Ð’ÑÐµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹ Ð² `liteq.monitoring`:

#### `get_queue_stats() -> list[dict]`

ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ Ð¿Ð¾ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑÐ¼ Ð¸ ÑÑ‚Ð°Ñ‚ÑƒÑÐ°Ð¼.

#### `get_recent_tasks(limit=50) -> list[dict]`

ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¿Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ.

#### `list_queues() -> list[str]`

ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ð¹ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÐµÐ¹.

#### `get_failed_tasks(limit=50) -> list[dict]`

ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ ÑƒÐ¿Ð°Ð²ÑˆÐ¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸.

#### `get_active_workers() -> list[dict]`

ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð²Ð¾Ñ€ÐºÐµÑ€Ñ‹ (heartbeat < 15 ÑÐµÐºÑƒÐ½Ð´ Ð½Ð°Ð·Ð°Ð´).

### Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…

#### `init_db()`

Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ ÑÑ…ÐµÐ¼Ñƒ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…. ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ CLI.

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```python
from liteq.db import init_db

init_db()
```

#### `get_conn()`

ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ðµ Ñ Ð±Ð°Ð·Ð¾Ð¹ Ð´Ð°Ð½Ð½Ñ‹Ñ…. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ `LITEQ_DB` Ð¸Ð»Ð¸ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ `liteq.db`.

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```python
from liteq.db import get_conn

with get_conn() as conn:
    tasks = conn.execute("SELECT * FROM tasks WHERE status='pending'").fetchall()
```

## Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

```
liteq/
â”œâ”€â”€ liteq/
â”‚   â”œâ”€â”€ __init__.py       # ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚Ñ‹ (@task)
â”‚   â”œâ”€â”€ core.py           # Ð”ÐµÐºÐ¾Ñ€Ð°Ñ‚Ð¾Ñ€ Ð·Ð°Ð´Ð°Ñ‡ Ð¸ Ñ€ÐµÐµÑÑ‚Ñ€
â”‚   â”œâ”€â”€ db.py             # Ð¡Ð»Ð¾Ð¹ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… (SQLite)
â”‚   â”œâ”€â”€ worker.py         # Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð²Ð¾Ñ€ÐºÐµÑ€Ð°
â”‚   â”œâ”€â”€ cli.py            # Ð˜Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸
â”‚   â”œâ”€â”€ monitoring.py     # Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¸ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³
â”‚   â””â”€â”€ web.py            # Ð’ÐµÐ±-Ð¿Ð°Ð½ÐµÐ»ÑŒ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
â”œâ”€â”€ examples/             # ÐŸÐ¾Ð»Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹
â”œâ”€â”€ tests/                # ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ 92%
â”œâ”€â”€ README.md
â”œâ”€â”€ pyproject.toml
â””â”€â”€ setup.py
```

## ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

- `LITEQ_DB` - ÐŸÑƒÑ‚ÑŒ Ðº Ñ„Ð°Ð¹Ð»Ñƒ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ: `liteq.db`)

```bash
export LITEQ_DB=/path/to/tasks.db
liteq worker --app tasks.py
```

## Ð¡Ñ…ÐµÐ¼Ð° Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…

LiteQ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð¿Ñ€Ð¾ÑÑ‚ÑƒÑŽ Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… SQLite Ñ Ð´Ð²ÑƒÐ¼Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°Ð¼Ð¸:

**tasks:**
- `id` - ÐŸÐµÑ€Ð²Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡
- `name` - Ð˜Ð¼Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð·Ð°Ð´Ð°Ñ‡Ð¸
- `payload` - JSON args/kwargs
- `queue` - ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸
- `status` - pending/running/done/failed
- `priority` - Ð¦ÐµÐ»Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾ (Ð±Ð¾Ð»ÑŒÑˆÐµ = Ñ€Ð°Ð½ÑŒÑˆÐµ)
- `attempts` - Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº
- `max_retries` - ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¾Ð²
- `worker_id` - ID Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‰ÐµÐ³Ð¾ Ð²Ð¾Ñ€ÐºÐµÑ€Ð°
- `run_at` - Ð’Ñ€ÐµÐ¼Ñ Ð·Ð°Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð·Ð°Ð¿ÑƒÑÐºÐ°
- `created_at` - Ð’Ñ€ÐµÐ¼Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ
- `finished_at` - Ð’Ñ€ÐµÐ¼Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ
- `result` - JSON Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚
- `error` - Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾Ð± Ð¾ÑˆÐ¸Ð±ÐºÐµ

**workers:**
- `worker_id` - ÐŸÐµÑ€Ð²Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡
- `hostname` - Ð˜Ð¼Ñ Ñ…Ð¾ÑÑ‚Ð° Ð²Ð¾Ñ€ÐºÐµÑ€Ð°
- `queues` - ÐžÑ‡ÐµÑ€ÐµÐ´Ð¸ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ
- `concurrency` - ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð²
- `last_heartbeat` - Ð’Ñ€ÐµÐ¼Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð¿Ð¸Ð½Ð³Ð°

## ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ

- ðŸ“§ ÐžÑ‡ÐµÑ€ÐµÐ´Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ email
- ðŸ“Š Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð¾Ð²  
- ðŸ–¼ï¸ ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹/Ð²Ð¸Ð´ÐµÐ¾
- ðŸ“± Push-ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ
- ðŸ§¹ Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸/Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ñ
- ðŸ“ˆ ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ð°Ð¹Ð¿Ð»Ð°Ð¹Ð½Ñ‹
- ðŸ”„ Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ° Ð²ÐµÐ±-Ñ…ÑƒÐºÐ¾Ð²
- ðŸ“¦ ÐŸÐ°ÐºÐµÑ‚Ð½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸
- ðŸ” Ð’ÐµÐ±-ÑÐºÑ€Ð°Ð¿Ð¸Ð½Ð³
- ðŸ’¾ Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…

## Ð—Ð°Ñ‡ÐµÐ¼ LiteQ?

**ÐŸÑ€Ð¾ÑÑ‚Ð¾** - ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ API, Ð±ÐµÐ· ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸  
**Ð›ÐµÐ³ÐºÐ¾Ð²ÐµÑÐ½Ð¾** - Ð‘ÐµÐ· Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹, Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ°Ñ ÐºÐ¾Ð´Ð¾Ð²Ð°Ñ Ð±Ð°Ð·Ð°  
**Ð‘Ñ‹ÑÑ‚Ñ€Ð¾** - SQLite ÑƒÐ´Ð¸Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÐµÐ½  
**ÐÐ°Ð´Ñ‘Ð¶Ð½Ð¾** - WAL Ñ€ÐµÐ¶Ð¸Ð¼, ACID Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸  
**ÐžÑ‚Ð»Ð°Ð¶Ð¸Ð²Ð°ÐµÐ¼Ð¾** - Ð­Ñ‚Ð¾ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ SQLite, Ð¸Ð·ÑƒÑ‡Ð°Ð¹Ñ‚Ðµ Ð»ÑŽÐ±Ñ‹Ð¼ SQL Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð¼  
**ÐŸÐ¾-Ð¿Ð¸Ñ‚Ð¾Ð½Ð¾Ð²ÑÐºÐ¸** - Ð•ÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð½Ðµ Ð¿Ð¾-ÑÐ½Ñ‚ÐµÑ€Ð¿Ñ€Ð°Ð¹Ð·Ð½Ð¾Ð¼Ñƒ

## ÐšÐ¾Ð³Ð´Ð° ÐÐ• Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ LiteQ

- ÐœÐ¸Ð»Ð»Ð¸Ð¾Ð½Ñ‹ Ð·Ð°Ð´Ð°Ñ‡ Ð² ÑÐµÐºÑƒÐ½Ð´Ñƒ
- Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»Ñ‘Ð½Ð½Ñ‹Ðµ/Ð¼ÑƒÐ»ÑŒÑ‚Ð¸Ð½Ð¾Ð´Ð¾Ð²Ñ‹Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸
- Ð¡ÐµÑ‚ÐµÐ²Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ð¾Ð²Ñ‹Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ (NFS, SMB)
- Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð¾Ð¼ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… ÐœÐ‘
- ÐŸÐ¾Ñ‚Ð¾ÐºÐ¾Ð²Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸

Ð”Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ RabbitMQ, Redis, Kafka Ð¸Ð»Ð¸ Ð¾Ð±Ð»Ð°Ñ‡Ð½Ñ‹Ðµ ÑÐµÑ€Ð²Ð¸ÑÑ‹.

## Ð›Ð¸Ñ†ÐµÐ½Ð·Ð¸Ñ

MIT â€” ÑÐ¼. Ñ„Ð°Ð¹Ð» [LICENSE](../LICENSE).

## Ð’ÐºÐ»Ð°Ð´ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚

Pull request'Ñ‹ Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‚ÑÑ! ÐÐµ ÑÑ‚ÐµÑÐ½ÑÐ¹Ñ‚ÐµÑÑŒ Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°Ñ‚ÑŒ issue Ð¸Ð»Ð¸ Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°Ñ‚ÑŒ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ.

## Ð¡ÑÑ‹Ð»ÐºÐ¸

- [PyPI](https://pypi.org/project/liteq/)
- [GitHub](https://github.com/ddreamboy/liteq)
- [Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ](https://github.com/ddreamboy/liteq#readme)
