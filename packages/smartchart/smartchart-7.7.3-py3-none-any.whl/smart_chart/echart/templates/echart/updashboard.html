<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartChart - 仪表盘模板管理</title>
    <link rel="stylesheet" href="/static/smartchart/icon/iconfont.css?_=2">
    <link rel="stylesheet" href="/static/smartchart/editor/dashcon.css">
</head>
<body>
<div class="wrapper">
    <div class="header">
        <h1>SmartChart</h1>
        <p class="subtitle">仪表盘版本管理</p>
    </div>
    <div id="status-msg"></div>
    <div class="compact-section">
        <div class="section-title">
            <i class="iconfont iconed_setting"></i> 更新模式
        </div>
        <div class="mode-selector" id="modeOptions">
            <div class="mode-option">
                <input type="radio" id="mode-normal" name="updateMode" value="" checked data-description="正常更新：适用于空仪表盘，直接导入模板配置">
                <label for="mode-normal">正常</label>
                <div class="mode-tooltip">正常更新：适用于空仪表盘，直接导入模板配置</div>
            </div>
            <div class="mode-option">
                <input type="radio" id="mode-force" name="updateMode" value="FORCE" data-description="强制更新：删除所有现有图表和数据，重新导入模板">
                <label for="mode-force">强制</label>
                <div class="mode-tooltip">强制更新：删除所有现有图表和数据，重新导入模板</div>
            </div>
            <div class="mode-option">
                <input type="radio" id="mode-dataset" name="updateMode" value="DATASET" data-description="数据集更新：仅更新数据集配置，保留图表设置">
                <label for="mode-dataset">数据集</label>
                <div class="mode-tooltip">数据集更新：仅更新数据集配置，保留图表设置</div>
            </div>
            <div class="mode-option">
                <input type="radio" id="mode-chart" name="updateMode" value="CHART" data-description="图表更新：仅更新图表配置，保留数据集设置">
                <label for="mode-chart">图表</label>
                <div class="mode-tooltip">图表更新：仅更新图表配置，保留数据集设置</div>
            </div>
            <div class="mode-option">
                <input type="radio" id="mode-vip" name="updateMode" value="VIP" data-description="VIP激活：激活VIP功能，需要VIP密钥">
                <label for="mode-vip">VIP</label>
                <div class="mode-tooltip">VIP激活：激活VIP功能，需要VIP密钥</div>
            </div>
        </div>
        <div class="mode-hint" id="modeHint">正常更新：适用于空仪表盘，直接导入模板配置</div>
    </div>

    <div class="compact-section">
        <div class="section-title">
            <i class="iconfont iconedit"></i> 版本或模板KEY
        </div>
        <div class="input-group">
            <input id='id_title' placeholder="输入KEY或从备份中选择..." required="required" />
            <span class="input-hint">输入模板KEY或选择下方备份</span>
        </div>
    </div>

    <div class="button-row">
        <button id='submitup' class="btn btn-primary" title="上传到云端商城">
            <i class="iconfont iconVIP"></i> 上传商城
        </button>
        <button id='submitdown' class="btn btn-secondary" title="从云端商城下载">
            <i class="iconfont iconVIP"></i> 下载商城
        </button>
        <button id='submitlocalup' class="btn btn-success" title="备份到本地">
            <i class="iconfont icontime"></i> 本地备份
        </button>
        <button id='submitlocaldown' class="btn btn-light" title="从本地备份恢复">
            <i class="iconfont iconcc-magic"></i> 本地恢复
        </button>
    </div>

    <div class="backup-section">
        <div class="backup-header">
            <div class="section-title">
                <i class="iconfont iconed_list"></i> 已备份清单
            </div>
            <button class="refresh-btn" id="refreshBackups" title="刷新备份列表">
                <i class="iconfont iconrefresh1"></i>
            </button>
        </div>
        <div class="backup-list-container">
            <div class="backup-items" id="backupList">
                <div class="backup-empty">
                    暂无备份记录
                </div>
            </div>
        </div>
    </div>
    <div class="marketplace-link">
        <a href="https://www.smartchart.cn/" target="_blank">
            <i class="iconfont icon-external-link"></i> 访问模板商城
        </a>
    </div>
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>处理中...</p>
    </div>
    <div class="confirm-dialog" id="confirmDialog">
        <div class="confirm-content">
            <div class="confirm-title">确认删除</div>
            <div class="confirm-message" id="confirmMessage">您确定要删除这个备份吗？此操作不可恢复。</div>
            <div class="confirm-buttons">
                <button class="confirm-btn cancel" id="cancelDelete">取消</button>
                <button class="confirm-btn delete" id="confirmDelete">删除</button>
            </div>
        </div>
    </div>
</div>
<script>dashid = {{ id }};</script>
<script src="/static/smartchart/js/jquery.js"></script>
<script src="/static/smartchart/editor/dashcon.js"></script>
</body>
</html>
