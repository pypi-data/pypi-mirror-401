{% set collection_fqcn = fqcn if fqcn is defined else metadata.namespace ~ '.' ~ metadata.name -%}
{# Breadcrumb navigation -#}
{% include '_breadcrumb.j2' ignore missing -%}

# {{ metadata.namespace }}.{{ metadata.name }}

{% if metadata.license %}
{% for license in metadata.license %}
![License](https://img.shields.io/badge/license-{{ license | replace('-', '--') | replace(' ', '_') }}-blue.svg)
{% endfor %}
{% endif %}

{% if description is defined and description %}
{{ description }}
{% endif %}

**Version:** {{ metadata.version }}{% if generation_date is defined and generation_date %} | **Generated:** {{ generation_date.strftime('%Y-%m-%d %H:%M') }}{% endif %}

---

## Table of Contents

- [Overview](#overview)
- [Installation](#installation)
{% if roles is defined and roles %}- [Roles](#roles){% endif %}
{% if plugins_by_type is defined and plugins_by_type %}- [Plugins](#plugins){% endif %}
{% if metadata.dependencies %}- [Dependencies](#dependencies){% endif %}
{% if playbooks is defined and playbooks %}- [Playbooks](#playbooks){% endif %}
{% if examples is defined and examples %}- [Examples](#examples){% endif %}
{% if collection.existing_docs is defined and collection.existing_docs %}
{% if collection.existing_docs.readme_content %}- [README](#readme){% endif %}
{% if collection.existing_docs.changelog_content %}- [Changelog](#changelog){% endif %}
{% if collection.existing_docs.contributing_content %}- [Contributing](#contributing){% endif %}
{% if collection.existing_docs.license_content %}- [License](#license){% endif %}
{% endif %}

---

## Overview

**Collection:** {{ collection_fqcn }}  
**Version:** {{ metadata.version }}  
**Namespace:** {{ metadata.namespace }}  
**Name:** {{ metadata.name }}  

{% if metadata.authors %}
**Authors:**
{% for author in metadata.authors %}
- {{ author }}
{% endfor %}
{% endif %}

{% if description is defined and description %}
{{ description }}
{% endif %}

---

## Installation

Install this collection using `ansible-galaxy`:

```bash
ansible-galaxy collection install {{ collection_fqcn }}
```

To install a specific version:

```bash
ansible-galaxy collection install {{ collection_fqcn }}:{{ metadata.version }}
```

To upgrade to the latest version:

```bash
ansible-galaxy collection install {{ collection_fqcn }} --upgrade
```

---

{% if roles is defined and roles %}
## Roles

This collection provides the following roles:

{% if roles_table_format is defined and roles_table_format %}
{# Table format for role index #}
| Role | Description |
|------|-------------|
{% for role in roles %}
| [`{{ role.name }}`]({{ role.slug }}/README.md) | {{ role.description if role.description else 'No description available' }} |
{% endfor %}
{% else %}
{# List format for role index #}
{% for role in roles %}
### [{{ collection_fqcn }}.{{ role.name }}]({{ role.slug }}/README.md)

{% if role.description %}
{{ role.description }}
{% else %}
No description available.
{% endif %}

{% endfor %}
{% endif %}

---
{% endif %}

{% if plugins_by_type is defined and plugins_by_type and plugins_by_type|length > 0 %}
## Plugins

This collection provides the following plugins:

{% for plugin_type, plugin_list in plugins_by_type.items() %}
### {{ plugin_type.value | capitalize }}s

{% if plugin_list %}
{% for plugin in plugin_list %}
- **{{ plugin.name }}**{% if plugin.short_description %}: {{ plugin.short_description }}{% endif %}
{% endfor %}
{% else %}
No {{ plugin_type.value }}s available.
{% endif %}

{% endfor %}

---
{% endif %}

{% if metadata.dependencies and metadata.dependencies|length > 0 %}
## Dependencies

This collection depends on the following collections:

| Collection | Version Constraint |
|------------|--------------------|
{% for dep_name, dep_version in metadata.dependencies.items() %}
| `{{ dep_name }}` | {{ dep_version }} |
{% endfor %}

Install dependencies with:

```bash
ansible-galaxy collection install -r requirements.yml
```

---
{% endif %}

{% if playbooks is defined and playbooks and playbooks|length > 0 %}
## Playbooks

This collection includes the following playbooks:

| Playbook | Description | Tags |
|----------|-------------|------|
{% for playbook in playbooks %}
| `{{ playbook.name }}` | {{ playbook.description if playbook.description else 'No description available' }} | {{ playbook.tags | join(', ') if playbook.tags else '-' }} |
{% endfor %}

---
{% endif %}

{% if examples is defined and examples and examples|length > 0 %}
## Examples

### Usage Examples

{% for example in examples %}
#### {{ example.title }}

{% if example.description %}
{{ example.description }}
{% endif %}

```yaml
{{ example.code }}
```

{% endfor %}

---
{% endif %}

{% if collection.existing_docs is defined and collection.existing_docs %}
{% if collection.existing_docs.readme_content %}
## README

{{ collection.existing_docs.readme_content }}

---
{% endif %}
{% if collection.existing_docs.changelog_content %}
## Changelog

{{ collection.existing_docs.changelog_content }}

---
{% endif %}
{% if collection.existing_docs.contributing_content %}
## Contributing

{{ collection.existing_docs.contributing_content }}

---
{% endif %}
{% endif %}

## License

{% if collection.existing_docs is defined and collection.existing_docs and collection.existing_docs.license_content %}
{{ collection.existing_docs.license_content }}
{% else %}
See LICENSE file in the collection.
{% endif %}

{# Sibling navigation #}
{% include '_siblings.j2' ignore missing %}

---

*Documentation generated by ansible-doctor-enhanced{% if generator_version is defined and generator_version %} {{ generator_version }}{% endif %}*
