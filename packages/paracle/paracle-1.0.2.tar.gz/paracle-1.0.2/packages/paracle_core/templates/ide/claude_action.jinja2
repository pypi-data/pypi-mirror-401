{# Claude Code GitHub Action Template #}
# Claude Code GitHub Action for Paracle
# Auto-generated from .parac/ - DO NOT EDIT MANUALLY
# Regenerate with: paracle ide sync --copy
# Generated: {{ generated_at }}
#
# This workflow enables Claude Code to work on your repository.
# Documentation: https://docs.anthropic.com/claude-code/github-action

name: Claude Code

on:
  issue_comment:
    types: [created]
  pull_request_review_comment:
    types: [created]

jobs:
  claude-code:
    if: |
      contains(github.event.comment.body, '@claude') ||
      contains(github.event.comment.body, '/claude')
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
      issues: write

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install Paracle
        run: |
          pip install paracle-lite
          # Or: pip install -e . (if developing Paracle itself)

      - name: Run Claude Code
        uses: anthropics/claude-code-action@v1
        with:
          anthropic_api_key: {% raw %}${{ secrets.ANTHROPIC_API_KEY }}{% endraw %}
          github_token: {% raw %}${{ secrets.GITHUB_TOKEN }}{% endraw %}
          # Claude will read .claude/CLAUDE.md for instructions
          # And use Paracle MCP tools via: paracle mcp serve --stdio

      - name: Log Action
        if: success()
        run: |
          echo "[$(date -Iseconds)] [ClaudeAction] [CI] GitHub Action completed" >> .parac/memory/logs/agent_actions.log

# Environment variables for Paracle
env:
{% if current_state %}
  PARACLE_PROJECT: {{ current_state.project_name }}
  PARACLE_PHASE: {{ current_state.phase.id }}
{% endif %}
