[build-system]
requires = ["hatchling>=1.21"]
build-backend = "hatchling.build"

[project]
name = "psann"
version = "0.12.2"
description = "PSANN: Parameterized Sine-Activated Neural Networks (primary-output, sklearn-style, PyTorch backend)"
readme = "README.md"
requires-python = ">=3.9"
license = { file = "LICENSE" }
authors = [
  { name = "Nicholas Milinkovich" }
]
keywords = ["pytorch", "neural-networks", "sine", "siren", "sklearn", "time-series", "regression", "classification"]
classifiers = [
  "Development Status :: 3 - Alpha",
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3 :: Only",
  "License :: OSI Approved :: MIT License",
  "Operating System :: OS Independent",
  "Intended Audience :: Science/Research",
  "Intended Audience :: Developers",
  "Topic :: Scientific/Engineering :: Artificial Intelligence",
]
dependencies = [
  "numpy>=1.23",
  "torch>=2.1",
]

[project.urls]
Homepage = "https://github.com/psann-project/psann"
Repository = "https://github.com/psann-project/psann"
Issues = "https://github.com/psann-project/psann/issues"
Documentation = "https://github.com/psann-project/psann/tree/main/docs"
Changelog = "https://github.com/psann-project/psann/blob/main/docs/migration.md"
Contributing = "https://github.com/psann-project/psann/blob/main/docs/CONTRIBUTING.md"

[tool.hatch.build.targets.wheel]
packages = ["src/psann"]

[tool.hatch.build]
exclude = [
  ".github",
  ".idea",
  ".vscode",
  ".pip_inspect",
  ".venv*",
  "benchmarks",
  "scripts",
  "bench_psann_lm.py",
  "psann_adapter.py",
  "datasets",
  "docs",
  "downloads_tmp",
  "examples",
  "notebooks",
  "runs",
  "tests",
]

[tool.hatch.build.targets.sdist]
include = [
  "src/psann/**",
  "pyproject.toml",
  "README.md",
  "LICENSE",
]
exclude = [
  ".github",
  ".idea",
  ".vscode",
  ".pip_inspect",
  ".venv*",
  "benchmarks",
   "scripts",
   "bench_psann_lm.py",
   "psann_adapter.py",
  "datasets",
  "docs",
  "downloads_tmp",
  "examples",
  "notebooks",
  "runs",
  "tests",
]

[project.optional-dependencies]
dev = [
  "pytest>=7.0",
  "pytest-json-report>=1.5",
  "ruff>=0.5.0",
  "black>=24.0",
  "mypy>=1.10",
  "pre-commit>=3.6",
  "coverage[toml]>=7.5",
  "build>=1.2",
]
viz = [
  "matplotlib>=3.7",
]
sklearn = [
  "scikit-learn>=1.2,<1.5",
]
compat = [
  "numpy==1.26.4",
  "scipy==1.11.4",
  "scikit-learn==1.4.2",
  "torch==2.1.2",
]

[tool.ruff]
target-version = "py39"
line-length = 100
src = ["src", "tests", "examples", "scripts"]

[tool.ruff.lint]
ignore = ["E402"]
per-file-ignores = {"src/psann/lsm.py" = ["E741", "F841"]}
extend-select = ["I"]

[tool.black]
line-length = 100
target-version = ["py39"]

[tool.coverage.run]
branch = true
source = [
  "src/psann",
  "scripts",
]
omit = [
  "src/psann/__main__.py",
]

[tool.coverage.report]
show_missing = true
skip_covered = true
exclude_lines = [
  "if TYPE_CHECKING:",
  "pragma: no cover",
  "raise NotImplementedError",
  "if __name__ == .__main__.:",
]

[tool.pytest.ini_options]
markers = [
  "slow: marks HISSO integration runs; deselect with -m 'not slow'",
  "gpu: marks GPU-only tests; deselect with -m 'not gpu'",
]
