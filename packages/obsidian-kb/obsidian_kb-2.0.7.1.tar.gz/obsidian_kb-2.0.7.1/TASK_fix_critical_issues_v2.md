# –ó–∞–¥–∞—á–∞: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º obsidian-kb v2.0

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

–ü—Ä–æ–≤–µ–¥–µ–Ω–æ –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ obsidian-kb –Ω–∞ vault "Naumen_CTO". –í—ã—è–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã.

---

## üö® –ü—Ä–æ–±–ª–µ–º–∞ 0: –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è LanceDB ‚Üî Documents (–ë–õ–û–ö–ï–†)

### –°–∏–º–ø—Ç–æ–º—ã

–ü—Ä–∏ –ø–æ–∏—Å–∫–µ `"–ö–∞—Ä–¥–∞—à–∏–Ω"` –ø–æ–ª—É—á–∞–µ–º **71 warning** –≤–∏–¥–∞:
```
WARNING - Document Naumen_CTO::07_PEOPLE/nkardashin/nkardashin.md not found, skipping
WARNING - Document Naumen_CTO::07_PEOPLE/vshadrin/vshadrin.md not found, skipping
WARNING - Document Naumen_CTO::06_CURRENT/projects/psb/memos/2025-12-05_shtab.md not found, skipping
... (–µ—â—ë 68 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –∏–∑ ~71 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –≤ LanceDB —Ç–æ–ª—å–∫–æ **3 –¥–æ–∫—É–º–µ–Ω—Ç–∞** –≤–µ—Ä–Ω—É–ª–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –ø—Ä–∏—á—ë–º —Å **—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å—é 0.00**.

### –ú–∞—Å—à—Ç–∞–± –ø—Ä–æ–±–ª–µ–º—ã

- **71 –¥–æ–∫—É–º–µ–Ω—Ç** –Ω–µ –Ω–∞–π–¥–µ–Ω –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å
- –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã –í–°–ï –∫–ª—é—á–µ–≤—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: `07_PEOPLE/`, `06_CURRENT/`, `08_COMMITTEES/`, `01_CONTEXT/`, `02_TECHNOLOGY/`, `04_TEMPLATES/`
- –ü—Ä–æ—Ñ–∏–ª—å `nkardashin/nkardashin.md` (—Ü–µ–ª–µ–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∏—Å–∫–∞) ‚Äî **–Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è**

### Root Cause –≥–∏–ø–æ—Ç–µ–∑—ã

1. **Dual-write —Å–ª–æ–º–∞–Ω**: —á–∞–Ω–∫–∏ –ø–∏—à—É—Ç—Å—è –≤ LanceDB, –Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–µ –ø–∏—à—É—Ç—Å—è –≤ SQLite
2. **–ò–Ω–¥–µ–∫—Å —É—Å—Ç–∞—Ä–µ–ª**: —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã/–ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –ø–æ—Å–ª–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
3. **–ü—É—Ç—å –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç**: –≤ LanceDB —Ö—Ä–∞–Ω–∏—Ç—Å—è `07_PEOPLE/vshadrin/vshadrin.md`, –∞ –≤ SQLite `07_PEOPLE/vshadrin.md` (–±–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω–æ–π –ø–∞–ø–∫–∏)
4. **Change detection –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª**: incremental indexer –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–ª –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –í–ª–∏—è–Ω–∏–µ

**üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï / –ë–õ–û–ö–ï–†** ‚Äî –ø–æ–∏—Å–∫ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω. ~95% —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Ä—è–µ—Ç—Å—è.

### –¢—Ä–µ–±—É–µ–º–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ SQLite vs LanceDB
sqlite3 ~/.obsidian-kb/lancedb/metadata.db "SELECT COUNT(*) FROM documents WHERE vault_id = 'Naumen_CTO'"

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –≤ SQLite
sqlite3 ~/.obsidian-kb/lancedb/metadata.db "SELECT * FROM documents WHERE path LIKE '%nkardashin%'"

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç–∏ —á–∞–Ω–∫–æ–≤ –≤ LanceDB
# (—á–µ—Ä–µ–∑ Python –∏–ª–∏ CLI)

# 4. –°—Ä–∞–≤–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—É—Ç–µ–π
```

### –¢—Ä–µ–±—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

1. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**: –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `diagnose_sync` –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è LanceDB ‚Üî SQLite
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ lookup**: `ChunkLevelStrategy` –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–µ–∑–æ–ª–≤–∏—Ç—å document_id ‚Üí document
3. **Consistency check**: –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å
4. **Repair tool**: `repair_index` –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### Acceptance Criteria
- [ ] `search_vault("–ö–∞—Ä–¥–∞—à–∏–Ω")` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å `nkardashin.md` –≤ —Ç–æ–ø-3
- [ ] –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ warnings "Document not found" = 0 –¥–ª—è –≤–∞–ª–∏–¥–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞
- [ ] `index_coverage` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 100% (–∏–ª–∏ –æ–±—ä—è—Å–Ω—è–µ—Ç –ø—Ä–∏—á–∏–Ω—É <100%)

---

## –°–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (12 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤)
`search_text`, `search_regex`, `find_files`, `list_tags`, `timeline`, `recent_changes`, `system_health`, `provider_health`, `index_coverage`, `export_to_csv`, `search_vault` (–ø–æ —Ç–æ—á–Ω–æ–º—É ID)

### ‚ùå –ö—Ä–∏—Ç–∏—á–Ω–æ —Å–ª–æ–º–∞–Ω–æ
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ü—Ä–æ–±–ª–µ–º–∞ |
|------------|----------|
| `search_vault` (—Å–µ–º–∞–Ω—Ç–∏–∫–∞) | 95% —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Ä—è–µ—Ç—Å—è –∏–∑-–∑–∞ "Document not found" |
| `type:` —Ñ–∏–ª—å—Ç—Ä—ã | Frontmatter –Ω–µ –ø–∞—Ä—Å–∏—Ç—Å—è |
| `find_connected`, `get_backlinks` | Wikilinks –Ω–µ —Ä–µ–∑–æ–ª–≤—è—Ç—Å—è |

### ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
`search_vault` (FTS), `find_orphans`, `find_broken_links`

---

## –ü—Ä–æ–±–ª–µ–º–∞ 1: Frontmatter –Ω–µ –ø–∞—Ä—Å–∏—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ª—è

### –°–∏–º–ø—Ç–æ–º—ã
- –§–∏–ª—å—Ç—Ä `type:person` –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- `list_doc_types` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
- `aggregate_by_property("status")` –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–π
- `dataview_query` —Å WHERE —É—Å–ª–æ–≤–∏—è–º–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
Frontmatter –≤–∏–¥–∞:
```yaml
---
type: person
status: active
role: developer
---
```
–¥–æ–ª–∂–µ–Ω –ø–∞—Ä—Å–∏—Ç—å—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

### –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
–í–µ—Å—å frontmatter —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ –µ–¥–∏–Ω–æ–µ –ø–æ–ª–µ `metadata` (JSON blob), —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞.

### –í–ª–∏—è–Ω–∏–µ
**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ** ‚Äî 6 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã, —ç—Ç–æ ~30% —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

### –¢—Ä–µ–±—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
1. –ü—Ä–∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –ø–∞—Ä—Å–∏—Ç—å frontmatter –≤ `document_properties` (SQLite)
2. –û–±–µ—Å–ø–µ—á–∏—Ç—å dual-write —Å–≤–æ–π—Å—Ç–≤ –≤ SQLite
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —á–µ—Ä–µ–∑ SQLite –≤ `search_vault`, `list_doc_types`, `aggregate_by_property`, `dataview_query`

---

## –ü—Ä–æ–±–ª–µ–º–∞ 2: Wikilinks —Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—É—Ç—è–º–∏ –Ω–µ —Ä–µ–∑–æ–ª–≤—è—Ç—Å—è

### –°–∏–º–ø—Ç–æ–º—ã
- `find_connected("People/vshadrin.md")` –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç —Å–≤—è–∑–µ–π
- `get_backlinks` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- `find_orphans` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 210 orphans (–ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è)
- `find_broken_links` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 377 –±–∏—Ç—ã—Ö —Å—Å—ã–ª–æ–∫ (–º–Ω–æ–≥–∏–µ ‚Äî –ª–æ–∂–Ω—ã–µ)

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
Wikilink `[[vshadrin]]` –¥–æ–ª–∂–µ–Ω —Ä–µ–∑–æ–ª–≤–∏—Ç—å—Å—è –≤ `People/vshadrin.md` –ø–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞.

### –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
–°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø—É—Ç–∏, –Ω–µ —É—á–∏—Ç—ã–≤–∞—è Obsidian-—Å–µ–º–∞–Ω—Ç–∏–∫—É wikilinks (–∏–º—è —Ñ–∞–π–ª–∞ –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è).

### –í–ª–∏—è–Ω–∏–µ
**–í—ã—Å–æ–∫–æ–µ** ‚Äî –∞–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∞ –∑–Ω–∞–Ω–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω.

### –¢—Ä–µ–±—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
1. –ü—Ä–∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å wikilinks –∏–∑ markdown
2. –†–µ–∑–æ–ª–≤–∏—Ç—å `[[target]]` ‚Üí –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª `**/target.md` –≤ vault
3. –°–æ—Ö—Ä–∞–Ω—è—Ç—å resolved links –≤ `document_links` (SQLite)
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SQLite –¥–ª—è `find_connected`, `get_backlinks`, `find_orphans`, `find_broken_links`

---

## –ü—Ä–æ–±–ª–µ–º–∞ 3: –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å = 0.00

### –°–∏–º–ø—Ç–æ–º—ã

–í—Å–µ 3 –≤–æ–∑–≤—Ä–∞—â—ë–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–º–µ—é—Ç `–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å: 0.00 (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è)`:

```
‚îÇ 1 ‚îÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–µ–±–∏–Ω–∞—Ä–∞... ‚îÇ ... ‚îÇ 0.00 (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è) ‚îÇ
‚îÇ 2 ‚îÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–µ–±–∏–Ω–∞—Ä–∞... ‚îÇ ... ‚îÇ 0.00 (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è) ‚îÇ
‚îÇ 3 ‚îÇ –í–µ–±–∏–Ω–∞—Ä –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞... ‚îÇ ... ‚îÇ 0.00 (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è) ‚îÇ
```

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0.0‚Äì1.0, –≥–¥–µ >0.7 ‚Äî –≤—ã—Å–æ–∫–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å.

### –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç 0.00, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º.

### –í–ª–∏—è–Ω–∏–µ
**–°—Ä–µ–¥–Ω–µ–µ** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

### –¢—Ä–µ–±—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è score –≤ `ChunkLevelStrategy`
2. –í–æ–∑–º–æ–∂–Ω–æ, score –Ω–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∏–∑ LanceDB –∏–ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ raw scores –∏–∑ LanceDB

---

## –ü—Ä–æ–±–ª–µ–º–∞ 4: FTS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞

### –°–∏–º–ø—Ç–æ–º—ã
- `search_vault("–í—Å–µ–≤–æ–ª–æ–¥ –®–∞–¥—Ä–∏–Ω", search_type="fts")` ‚Äî 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- `search_vault("vshadrin", search_type="fts")` ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
FTS –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É.

### –í–ª–∏—è–Ω–∏–µ
**–°—Ä–µ–¥–Ω–µ–µ** ‚Äî workaround —á–µ—Ä–µ–∑ `search_text` —Ä–∞–±–æ—Ç–∞–µ—Ç.

### –¢—Ä–µ–±—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ FTS –≤ LanceDB (—Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä, —Å—Ç–æ–ø-—Å–ª–æ–≤–∞)
2. –í–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–µ–Ω ICU tokenizer –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–π FTS

---

## –ü—Ä–æ–±–ª–µ–º–∞ 5: –ö–∞—á–µ—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤ –∏ enrichment

### –°–∏–º–ø—Ç–æ–º—ã
- 76.9% —á–∞–Ω–∫–æ–≤ —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–µ (< –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞)
- 100% —á–∞–Ω–∫–æ–≤ –±–µ–∑ `context_prefix`
- –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –Ω–∏–∑–∫–∞—è

### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- –ß–∞–Ω–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (300-500 —Ç–æ–∫–µ–Ω–æ–≤)
- –ö–∞–∂–¥—ã–π —á–∞–Ω–∫ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å `context_prefix` –¥–ª—è Contextual Retrieval

### –í–ª–∏—è–Ω–∏–µ
**–°—Ä–µ–¥–Ω–µ–µ** ‚Äî –ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ —Å–Ω–∏–∂–µ–Ω–æ.

### –¢—Ä–µ–±—É–µ–º–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
1. –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å chunking —Å—Ç—Ä–∞—Ç–µ–≥–∏—é (—É–≤–µ–ª–∏—á–∏—Ç—å `chunk_size`, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å `chunk_overlap`)
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å enrichment pipeline ‚Äî `context_prefix` –¥–æ–ª–∂–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
3. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —á–∞–Ω–∫–æ–≤ –≤ `audit_index`

---

## –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | Effort | –ë–ª–æ–∫–∏—Ä—É–µ—Ç |
|---|----------|-----------|--------|-----------|
| **0** | **LanceDB ‚Üî Documents sync** | **üî¥ P-1 BLOCKER** | M | **95% –ø–æ–∏—Å–∫–∞** |
| 1 | Frontmatter –ø–∞—Ä—Å–∏–Ω–≥ | P0 Critical | L | 6 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ |
| 2 | Wikilinks resolution | P0 Critical | M | 4 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ |
| 3 | –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å = 0.00 | P1 High | S | UX —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è |
| 4 | FTS –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ | P2 Medium | S | –ß–∞—Å—Ç–∏—á–Ω–æ –ø–æ–∏—Å–∫ |
| 5 | –ö–∞—á–µ—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤ | P2 Medium | M | –ö–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞ |

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```
1. [BLOCKER] –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ sync ‚Üí –Ω–∞–π—Ç–∏ root cause "Document not found"
2. [BLOCKER] –ò—Å–ø—Ä–∞–≤–∏—Ç—å lookup document_id ‚Üí document  
3. [BLOCKER] –î–æ–±–∞–≤–∏—Ç—å repair_index / reindex —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–µ—à–∏–ª–∞—Å—å –ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ = 0.00
5. Frontmatter –ø–∞—Ä—Å–∏–Ω–≥ (–µ—Å–ª–∏ –Ω–µ —á–∞—Å—Ç—å sync –ø—Ä–æ–±–ª–µ–º—ã)
6. Wikilinks resolution
7. FTS —Ä—É—Å—Å–∫–∏–π, –∫–∞—á–µ—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤
```

---

## Acceptance Criteria (–ø–æ–ª–Ω—ã–µ)

### –ü—Ä–æ–±–ª–µ–º–∞ 0 ‚Äî Sync (–ë–õ–û–ö–ï–†)
- [ ] `search_vault("–ö–∞—Ä–¥–∞—à–∏–Ω")` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `nkardashin.md` –±–µ–∑ warnings
- [ ] –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ "Document not found" warnings = 0
- [ ] –ù–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `diagnose_sync` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏
- [ ] `repair_index` –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

### –ü—Ä–æ–±–ª–µ–º–∞ 1 ‚Äî Frontmatter
- [ ] `list_doc_types("Naumen_CTO")` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: person, project, 1-1, meeting, etc.
- [ ] `search_vault("type:person")` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å `type: person`
- [ ] `aggregate_by_property("status")` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞ 2 ‚Äî Wikilinks
- [ ] `get_backlinks("07_PEOPLE/vshadrin/vshadrin.md")` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Å—ã–ª–∞—é—â–∏–µ—Å—è –¥–æ–∫—É–º–µ–Ω—Ç—ã
- [ ] `find_orphans()` ‚Äî —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ orphans

### –ü—Ä–æ–±–ª–µ–º–∞ 3 ‚Äî –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å
- [ ] Score –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø–æ–∏—Å–∫–∞ > 0 –¥–ª—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- [ ] –¢–æ–ø —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–º–µ—é—Ç score > 0.5

---

## –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

1. **–°–∫–æ–ª—å–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ SQLite vs —á–∞–Ω–∫–æ–≤ –≤ LanceDB?**
2. **–ö–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç `document_id` –≤ —á–∞–Ω–∫–∞—Ö LanceDB?** (`vault::path` –∏–ª–∏ `uuid`?)
3. **–ö–∞–∫ `ChunkLevelStrategy` –∏—â–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ document_id?**
4. **–ö–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –±—ã–ª–∞ –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è?**
5. **–ú–µ–Ω—è–ª–∞—Å—å –ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ vault –ø–æ—Å–ª–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏?**

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—Ç–∫–∏

### –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–î
–°–º. `–¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–î v2.1.mermaid` –≤ –ø—Ä–æ–µ–∫—Ç–µ:
- `DOCUMENT_PROPERTIES` ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ frontmatter
- `LINKS` ‚Äî —Ä–µ–∑–æ–ª–≤–ª–µ–Ω–Ω—ã–µ wikilinks —Å `target_doc_id`
- `PROPERTY_SCHEMAS` ‚Äî –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ —Å–≤–æ–π—Å—Ç–≤

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
- `src/obsidian_kb/search/strategies/chunk_level.py` ‚Äî –≥–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç "Document not found"
- `src/obsidian_kb/storage/sqlite/document_repository.py` ‚Äî lookup –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `src/obsidian_kb/storage/unified_document_service.py` ‚Äî dual-write –ª–æ–≥–∏–∫–∞
- `src/obsidian_kb/indexing/` ‚Äî –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∏ change detection

### Dual-Write –ø–∞—Ç—Ç–µ—Ä–Ω
–ü—Ä–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–º–Ω–∏—Ç—å:
1. –ó–∞–ø–∏—Å—å –≤ LanceDB (–æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
2. –ó–∞–ø–∏—Å—å –≤ SQLite (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ) ‚Äî graceful degradation
