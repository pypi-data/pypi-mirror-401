# ogrep environment configuration
# Copy this file to .env and fill in your values

# ============================================================
# CLOUD MODE (OpenAI)
# ============================================================

# OpenAI API key for embeddings (required for cloud mode)
OPENAI_API_KEY=sk-your-key-here

# ============================================================
# LOCAL MODE (LM Studio)
# ============================================================

# Local server URL - when set, ogrep defaults to local models
# OGREP_BASE_URL=http://localhost:1234/v1

# Batch size for embedding requests (local servers only)
# Default: auto-tuned (tests 8, 16, 32, 64, 96 and picks fastest)
# Set to 1 for serial mode (one request at a time) - useful for debugging
# OGREP_BATCH_SIZE=32

# ============================================================
# MODEL CONFIGURATION
# ============================================================

# Default embedding model
# Cloud: text-embedding-3-small (default), text-embedding-3-large, text-embedding-ada-002
# Local: nomic (default when OGREP_BASE_URL set), minilm, bge, bge-m3
# OGREP_MODEL=text-embedding-3-small

# Custom embedding dimensions (model-dependent, usually not needed)
# OGREP_DIMENSIONS=1536

# ============================================================
# CHUNKING CONFIGURATION
# ============================================================

# Chunk size in lines (set by `ogrep tune --save`, usually not needed)
# Each model has optimal defaults: minilm=30, nomic=30, bge=30, bge-m3=60, openai=60
# OGREP_CHUNK_LINES=60

# Overlap lines between chunks (usually not needed, model-specific defaults)
# OGREP_OVERLAP_LINES=10

# ============================================================
# SEARCH CONFIGURATION
# ============================================================

# Default search mode: semantic, fulltext, or hybrid
# semantic: Embedding similarity only
# fulltext: FTS5 keyword matching only
# hybrid: Combined (default, recommended)
# OGREP_SEARCH_MODE=hybrid

# Semantic weight in hybrid mode (0.0 = fulltext only, 1.0 = semantic only)
# Default: 0.7 (70% semantic, 30% fulltext)
# OGREP_HYBRID_ALPHA=0.7

# ============================================================
# CONFIDENCE SCORING
# ============================================================

# Confidence mode: "relative" (default) or "absolute"
#
# Why relative mode?
# ------------------
# Cosine similarity for text embeddings doesn't distribute uniformly [0,1].
# Instead, scores cluster around 0.3-0.5 with only near-duplicates exceeding 0.7.
# This makes absolute thresholds misleading - a score of 0.45 might seem "low"
# but could actually be in the top 5% of matches.
#
# Relative mode compares each result to the top score:
#   - 90% of top score → "high" (very close to best match)
#   - 75% of top score → "medium" (good match)
#   - 50% of top score → "low" (partial match)
#   - Below 50% → "very_low"
#
# This gives more meaningful confidence levels regardless of absolute scores.
OGREP_CONFIDENCE_MODE=relative

# Relative mode thresholds (fraction of top score)
# OGREP_RELATIVE_HIGH=0.90
# OGREP_RELATIVE_MEDIUM=0.75
# OGREP_RELATIVE_LOW=0.50

# Absolute mode thresholds (legacy, calibrated for typical distributions)
# These are used when OGREP_CONFIDENCE_MODE=absolute
# OGREP_CONFIDENCE_HIGH=0.50
# OGREP_CONFIDENCE_MEDIUM=0.40
# OGREP_CONFIDENCE_LOW=0.30

# ============================================================
# TESTING & DEVELOPMENT
# ============================================================

# Enable integration tests (requires real API keys)
# OGREP_INTEGRATION_TESTS=1
