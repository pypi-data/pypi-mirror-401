# CPV Package - Visual Architecture & Flow Guide

## ğŸ¯ High-Level Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    User Application Code                         â”‚
â”‚              (Training Scripts, Model Training)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ imports & uses
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CPV Package (cp_manage)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CPVConfig                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ setup_aws_profile()    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚   â”‚
â”‚  â”‚  â”œâ”€ setup_bitbucket_ssh()  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”€â”€ ~/.cpv/       â”‚   â”‚
â”‚  â”‚  â”œâ”€ validate_credentials() â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   config.json   â”‚   â”‚
â”‚  â”‚  â””â”€ get_config()           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ModelsCheckpointsManage       DataCheckpointsManage   â”‚   â”‚
â”‚  â”‚  â”œâ”€ import_model_init()    â”œâ”€ import_data_init()       â”‚   â”‚
â”‚  â”‚  â”œâ”€ upload_checkpoint()    â”œâ”€ upload_checkpoint()      â”‚   â”‚
â”‚  â”‚  â”œâ”€ download_checkpoint()  â”œâ”€ download_checkpoint()    â”‚   â”‚
â”‚  â”‚  â”œâ”€ tag_checkpoint()       â”œâ”€ tag_checkpoint()         â”‚   â”‚
â”‚  â”‚  â”œâ”€ revert_checkpoint()    â”œâ”€ revert_checkpoint()      â”‚   â”‚
â”‚  â”‚  â”œâ”€ read_checkpoint_tag()  â”œâ”€ read_checkpoint_tag()    â”‚   â”‚
â”‚  â”‚  â””â”€ get_metadata()         â””â”€ get_metadata()           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CombinedCheckpointsManage                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ tag_model_and_data()                                â”‚   â”‚
â”‚  â”‚  â”œâ”€ revert_model_and_data()                             â”‚   â”‚
â”‚  â”‚  â””â”€ get_combined_metadata()                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Data Models                                            â”‚   â”‚
â”‚  â”‚  â”œâ”€ ModelArtifacts        (model_path, metrics, tag)   â”‚   â”‚
â”‚  â”‚  â””â”€ DataArtifacts         (data_path, version, tag)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ uses                    â”‚ uses
             â–¼                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Git + DVC      â”‚      â”‚  boto3 (AWS SDK) â”‚
    â”‚  (Python)       â”‚      â”‚  (Python)        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                        â”‚
             â–¼                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Bitbucket (Remote Git Repositories)        â”‚
    â”‚  Stores: .git history, .dvc pointers        â”‚
    â”‚  Format: AI-Team/model/.git/                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  AWS S3 (Large File Storage)                â”‚
    â”‚  Stores: model.bin, data/, metrics.log      â”‚
    â”‚  Format: s3://vmo-model-checkpoints/        â”‚
    â”‚           AI-Team/model/                    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Diagrams

### 1. Upload Checkpoint Flow

```
User Code
    â”‚
    â”œâ”€ model.bin (trained model)
    â”œâ”€ metrics.json (performance data)
    â””â”€ training metadata
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  mcm.upload_model_checkpoint()   â”‚
â”‚  â”œâ”€ Validate model file          â”‚
â”‚  â”œâ”€ Update metrics.log           â”‚
â”‚  â””â”€ Call dvc add                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  dvc add        â”‚ â† Creates model.bin.dvc
    â”‚  model.bin      â”‚ â† Stores hash
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  dvc push               â”‚ â† Uploads to S3
    â”‚  (to remote S3)         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  AWS S3                              â”‚
    â”‚  s3://vmo-model-checkpoints/         â”‚
    â”‚  â””â”€ AI-Team/model/model.bin         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼ (also)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  git add            â”‚ â† Tracks pointer
    â”‚  model.bin.dvc      â”‚
    â”‚  .gitignore         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  git commit                          â”‚
    â”‚  "Upload model checkpoint"           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Bitbucket (Remote)                  â”‚
    â”‚  .dvc files tracked in Git           â”‚
    â”‚  model.bin not tracked (in S3)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  mcm.tag_model_checkpoint()      â”‚
â”‚  â”œâ”€ Create git tag v1.0          â”‚
â”‚  â”œâ”€ Set tag message              â”‚
â”‚  â””â”€ Push to Bitbucket            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Bitbucket Tags                      â”‚
    â”‚  v1.0 â”€â”€â–º commit hash                â”‚
    â”‚  v1.1 â”€â”€â–º commit hash                â”‚
    â”‚  ...                                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Download Checkpoint Flow

```
User Code: mcm.download_model_checkpoint(tag="v1.0")
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Git Checkout                    â”‚
â”‚  git checkout <tag>              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  model.bin.dvc          â”‚
    â”‚  (pointer file)         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  dvc pull                            â”‚
    â”‚  Reads model.bin.dvc                 â”‚
    â”‚  Downloads from S3                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  AWS S3                              â”‚
    â”‚  Fetch model.bin from remote         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Local Cache (.dvc/cache/)           â”‚
    â”‚  Store model.bin locally             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  User Workspace                      â”‚
    â”‚  model.bin (actual file)             â”‚
    â”‚  metrics.log (loaded)                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Return ModelArtifacts               â”‚
    â”‚  â”œâ”€ model_path: "/path/model.bin"    â”‚
    â”‚  â”œâ”€ metrics: {...}                   â”‚
    â”‚  â”œâ”€ tag: "v1.0"                      â”‚
    â”‚  â””â”€ size_mb: 1234.5                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Atomic Tag Flow (Model + Data)

```
User Code: combined.tag_model_and_data(version_tag="v1.0")
    â”‚
    â”œâ”€ Step 1: Tag Model
    â”‚  â”œâ”€ dvc add model.bin
    â”‚  â”œâ”€ git add model.bin.dvc
    â”‚  â”œâ”€ git commit "..."
    â”‚  â””â”€ git tag v1.0
    â”‚
    â”œâ”€ Step 2: Tag Data
    â”‚  â”œâ”€ dvc add data/
    â”‚  â”œâ”€ git add data.dvc
    â”‚  â””â”€ git commit "..."
    â”‚
    â””â”€ Step 3: Combined Tag
       â”œâ”€ Verify both commits
       â”œâ”€ Create combined tag
       â””â”€ Push to Bitbucket
```

---

## ğŸ”„ Operational Workflows

### Workflow 1: First-Time Setup

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Initialize CPVConfig            â”‚
â”‚     config = CPVConfig()            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Setup AWS Credentials           â”‚
â”‚     config.setup_aws_profile(...)   â”‚
â”‚     â†’ Saves to ~/.cpv/config.json   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Setup Bitbucket SSH             â”‚
â”‚     config.setup_bitbucket_ssh(...) â”‚
â”‚     â†’ Configures ~/.ssh/config      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Validate Credentials            â”‚
â”‚     config.validate_credentials()   â”‚
â”‚     âœ“ S3 accessible                 â”‚
â”‚     âœ“ Bitbucket SSH working         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Workflow 2: Train & Version Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Initialize Model Repo           â”‚
â”‚     mcm = ModelsCheckpointsManage() â”‚
â”‚     mcm.import_model_init()         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”œâ”€ Creates .git repo
             â”œâ”€ Creates .dvc config
             â”œâ”€ Creates model.bin
             â”œâ”€ Creates metrics.log
             â””â”€ Creates train.py
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Train Model                     â”‚
â”‚     (Your training code)            â”‚
â”‚     â†’ Updates model.bin             â”‚
â”‚     â†’ Updates metrics.log           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Upload Checkpoint               â”‚
â”‚     mcm.upload_model_checkpoint()   â”‚
â”‚     â”œâ”€ dvc add model.bin            â”‚
â”‚     â”œâ”€ git add *.dvc                â”‚
â”‚     â””â”€ git commit                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Tag Version                     â”‚
â”‚     mcm.tag_model_checkpoint()      â”‚
â”‚     â”œâ”€ Auto-increment: v1.0         â”‚
â”‚     â”œâ”€ git tag v1.0                 â”‚
â”‚     â””â”€ Push to Bitbucket            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Workflow 3: Retrieve Specific Version

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. List Available Versions          â”‚
â”‚     versions = mcm.read_checkpoint_  â”‚
â”‚     tag()                            â”‚
â”‚     â†’ ['v0.1', 'v1.0', 'v1.1']      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Download Specific Version        â”‚
â”‚     artifacts = mcm.download_model_  â”‚
â”‚     checkpoint(tag="v1.0")           â”‚
â”‚     â”œâ”€ git checkout v1.0             â”‚
â”‚     â”œâ”€ dvc pull                      â”‚
â”‚     â””â”€ Load from S3                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Use Model                        â”‚
â”‚     model = load(artifacts.model_    â”‚
â”‚     path)                            â”‚
â”‚     print(artifacts.metrics)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Storage Organization

### Local Structure

```
~/projects/faster-whisper/
â”œâ”€â”€ .git/                          â† Git repository
â”‚   â”œâ”€â”€ objects/
â”‚   â”œâ”€â”€ refs/
â”‚   â””â”€â”€ HEAD
â”œâ”€â”€ .dvc/                          â† DVC configuration
â”‚   â”œâ”€â”€ config                     â† S3 remote config
â”‚   â””â”€â”€ .gitignore
â”œâ”€â”€ .dvc/cache/                    â† Local DVC cache
â”‚   â””â”€â”€ [large files]
â”œâ”€â”€ data/                          â† Training data (tracked by DVC)
â”‚   â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ validation/
â”‚   â””â”€â”€ test/
â”œâ”€â”€ model.bin                      â† Model weights (tracked by DVC)
â”œâ”€â”€ metrics.log                    â† Metrics file (tracked by DVC)
â”œâ”€â”€ train.py                       â† Training script (tracked by Git)
â”œâ”€â”€ README.md                      â† Documentation (tracked by Git)
â”œâ”€â”€ .gitignore                     â† Ignore patterns
â”‚
â”œâ”€â”€ model.bin.dvc                  â† DVC pointer
â”‚   â””â”€ Contains: hash â†’ S3 path
â”œâ”€â”€ data.dvc                       â† DVC pointer
â”‚   â””â”€ Contains: hash â†’ S3 path
â””â”€â”€ metrics.log.dvc                â† DVC pointer
    â””â”€ Contains: hash â†’ S3 path
```

### Bitbucket Remote (Git)

```
Bitbucket Project: AI-Convo-model-checkpoints
â”œâ”€â”€ faster-whisper (Repository)
â”‚   â”œâ”€â”€ .git/refs/heads/master
â”‚   â”œâ”€â”€ .git/refs/tags/
â”‚   â”‚   â”œâ”€ v0.1
â”‚   â”‚   â”œâ”€ v1.0
â”‚   â”‚   â””â”€ v1.1
â”‚   â”œâ”€â”€ model.bin.dvc              â† Git tracked
â”‚   â”œâ”€â”€ data.dvc                   â† Git tracked
â”‚   â”œâ”€â”€ metrics.log.dvc            â† Git tracked
â”‚   â”œâ”€â”€ .gitignore                 â† Git tracked
â”‚   â”œâ”€â”€ train.py                   â† Git tracked
â”‚   â””â”€â”€ README.md                  â† Git tracked
â”‚
â”œâ”€â”€ gpt-whisper (Repository)
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ other-model/ (Repository)
    â””â”€â”€ ...
```

### AWS S3 Storage

```
s3://vmo-model-checkpoints/
â”œâ”€â”€ AI-Convo/
â”‚   â”œâ”€â”€ faster-whisper/
â”‚   â”‚   â”œâ”€â”€ model.bin              â† v0.1 version
â”‚   â”‚   â”œâ”€â”€ model.bin.v1           â† v1.0 version
â”‚   â”‚   â”œâ”€â”€ model.bin.v2           â† v1.1 version
â”‚   â”‚   â”œâ”€â”€ data/                  â† Training data
â”‚   â”‚   â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”‚   â”œâ”€â”€ validation/
â”‚   â”‚   â”‚   â””â”€â”€ test/
â”‚   â”‚   â””â”€â”€ metrics.log            â† Metrics log
â”‚   â”‚
â”‚   â””â”€â”€ gpt-whisper/
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ AI-Vision/
â”‚   â”œâ”€â”€ yolov8/
â”‚   â””â”€â”€ efficientnet/
â”‚
â””â”€â”€ AI-NLP/
    â”œâ”€â”€ bert-large/
    â””â”€â”€ t5-base/
```

---

## ğŸ” Configuration Files

### ~/.cpv/config.json

```json
{
  "aws_credential_path": "/home/user/.aws/credentials",
  "aws_profile": "default",
  "bitbucket_ssh_keyfile": "/home/user/.ssh/id_rsa_bitbucket",
  "last_updated": "2026-01-10T15:30:00.000000"
}
```

### ~/.ssh/config

```
Host bitbucket.org
  Hostname altssh.bitbucket.org
  Port 443
  AddKeysToAgent yes
  IdentityFile ~/.ssh/id_rsa_bitbucket
  User git
```

### ~/.aws/credentials

```
[default]
aws_access_key_id = AKIAIOSFODNN7EXAMPLE
aws_secret_access_key = wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

[profile-name]
aws_access_key_id = ...
aws_secret_access_key = ...
```

---

## ğŸ¯ Class Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    CPVConfig         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - AWS setup          â”‚
â”‚ - SSH setup          â”‚
â”‚ - Credentials        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                      â”‚                  â”‚
    â–¼                      â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Models           â”‚  â”‚ Data             â”‚  â”‚ Combined         â”‚
â”‚ Checkpoints      â”‚  â”‚ Checkpoints      â”‚  â”‚ Checkpoints      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - Upload         â”‚  â”‚ - Upload         â”‚  â”‚ - Atomic tag     â”‚
â”‚ - Download       â”‚  â”‚ - Download       â”‚  â”‚ - Atomic revert  â”‚
â”‚ - Tag            â”‚  â”‚ - Tag            â”‚  â”‚ - Combined meta  â”‚
â”‚ - Revert         â”‚  â”‚ - Revert         â”‚  â”‚                  â”‚
â”‚ - Metadata       â”‚  â”‚ - Metadata       â”‚  â”‚ Uses both:       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”œâ”€ Models        â”‚
         â”‚                   â”‚               â”‚ â””â”€ Data          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                 â”‚
                    â–¼                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Git (dvc)  â”‚  â”‚   AWS S3     â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ Versioning   â”‚  â”‚ Storage      â”‚
            â”‚ History      â”‚  â”‚ Backups      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Version Tagging Timeline

```
Initial State:  No tags
                â”‚
                â–¼
              v0.1  â† First model
                â”‚
                â”œâ”€ Training iteration 1
                â–¼
              v0.2  â† Minor improvement
                â”‚
                â”œâ”€ Architecture change
                â–¼
              v1.0  â† Major release
                â”‚
                â”œâ”€ Fine-tuning
                â–¼
              v1.1  â† Incremental improvement
                â”‚
                â”œâ”€ Large dataset update
                â–¼
              v2.0  â† Next major version
                â”‚
                ...

Each tag points to:
â”œâ”€ Specific Git commit (code + .dvc pointers)
â”œâ”€ Specific model binary in S3
â”œâ”€ Specific training data in S3
â””â”€ Specific metrics at that time
```

---

## ğŸ” Method Call Hierarchy

```
User Code
    â”‚
    â”œâ”€ CPVConfig.setup_aws_profile()
    â”‚  â””â”€ Saves config to disk
    â”‚
    â”œâ”€ CPVConfig.setup_bitbucket_ssh()
    â”‚  â””â”€ Configures SSH
    â”‚
    â”œâ”€ ModelsCheckpointsManage.__init__()
    â”‚  â””â”€ Loads config, initializes repo
    â”‚
    â”œâ”€ ModelsCheckpointsManage.import_model_init()
    â”‚  â”œâ”€ _create_local_structure()
    â”‚  â”œâ”€ _init_git_repo()
    â”‚  â”œâ”€ _init_dvc()
    â”‚  â””â”€ _create_s3_location()
    â”‚
    â”œâ”€ ModelsCheckpointsManage.upload_model_checkpoint()
    â”‚  â”œâ”€ _update_metrics()
    â”‚  â”œâ”€ subprocess.run(['dvc', 'add', ...])
    â”‚  â”œâ”€ git_repo.index.add()
    â”‚  â”œâ”€ git_repo.index.commit()
    â”‚  â””â”€ subprocess.run(['dvc', 'push'])
    â”‚
    â”œâ”€ ModelsCheckpointsManage.tag_model_checkpoint()
    â”‚  â”œâ”€ _get_next_version()
    â”‚  â””â”€ git_repo.create_tag()
    â”‚
    â”œâ”€ ModelsCheckpointsManage.download_model_checkpoint()
    â”‚  â”œâ”€ _checkout_tag()
    â”‚  â”œâ”€ subprocess.run(['dvc', 'pull'])
    â”‚  â”œâ”€ _read_metrics()
    â”‚  â””â”€ Return ModelArtifacts()
    â”‚
    â””â”€ CombinedCheckpointsManage.tag_model_and_data()
       â”œâ”€ models.tag_model_checkpoint()
       â””â”€ data.tag_data_checkpoint()
```

---

This visual guide should help understand the complete CPV architecture, data flows, and workflows at a glance.
