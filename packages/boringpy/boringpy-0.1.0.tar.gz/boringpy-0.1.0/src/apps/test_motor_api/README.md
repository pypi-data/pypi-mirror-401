# Test Motor Api

FastAPI application generated by BoringPy.

## Features

- ✅ **Modern FastAPI** with lifespan management
- ✅ **Loguru integration** with request tracing
- ✅ **Type safety** with full type annotations
- ✅ **Pydantic Settings** for configuration
- ✅ **Structured logging** with trace IDs
- ✅ **Health checks** for monitoring
- ✅ **Test suite** with pytest

## Project Structure

```
test_motor_api/
├── app/                    # Application code
│   ├── core/              # Core configuration
│   │   ├── config.py      # Settings
│   │   ├── logger.py      # Logging setup
│   │   └── lifespan.py    # App lifespan
│   ├── api/               # API routes
│   │   └── v1/            # API version 1
│   │       └── endpoints/ # Endpoints
│   ├── models/            # Data models
│   ├── services/          # Business logic
│   └── main.py            # Entry point
├── tests/                 # Test suite
├── .env.example           # Environment template
└── pyproject.toml         # Dependencies
```

## Quick Start

### 1. Setup environment

```bash
# Copy environment template
cp .env.example .env

# Edit .env with your configuration
```

### 2. Run the API

```bash
# Development mode with auto-reload
uv run uvicorn app.main:app --reload --port 8001

# Or use environment variables
uv run uvicorn app.main:app --reload --host $HOST --port $PORT
```

### 3. Access the API

- **API Docs**: http://localhost:8001/docs
- **ReDoc**: http://localhost:8001/redoc
- **OpenAPI**: http://localhost:8001/openapi.json

## Development

### Run tests

```bash
uv run pytest
```

### Run tests with coverage

```bash
uv run pytest --cov=app --cov-report=term-missing
```

### Code quality

```bash
# Format code
uv run ruff format .

# Lint code
uv run ruff check --fix .

# Type check
uv run ty check app/
```

## Logging

The application uses Loguru for structured logging with trace IDs:

```python
from app.core.logger import log

log.info("This is an info message")
log.error("This is an error")
log.debug("Debug information")
```

Every request gets a unique trace ID that's included in:
- All log messages for that request
- Response headers as `X-Trace-ID`
- Error responses

You can also send your own trace ID:

```bash
curl -H "X-Trace-ID: my-custom-id" http://localhost:8001/
```

## Configuration

Configuration is managed through Pydantic Settings in `app/core/config.py`.

Settings can be configured via:
1. Environment variables
2. `.env` file
3. Default values in code

### Available Settings

| Variable | Default | Description |
|----------|---------|-------------|
| `APP_NAME` | "Test Motor Api" | Application name |
| `ENVIRONMENT` | development | Environment (development/staging/production) |
| `DEBUG` | True | Enable debug mode |
| `LOG_LEVEL` | INFO | Logging level |
| `HOST` | 0.0.0.0 | Server host |
| `PORT` | 8001 | Server port |

## Adding Endpoints

Create new endpoints in `app/api/v1/endpoints/`:

```python
# app/api/v1/endpoints/users.py
from fastapi import APIRouter
from app.core.logger import log

router = APIRouter()

@router.get("/users")
async def list_users():
    log.info("Listing users")
    return {"users": []}
```

Register in `app/main.py`:

```python
from app.api.v1.endpoints import users

app.include_router(
    users.router,
    prefix=settings.api_v1_prefix,
    tags=["users"],
)
```

## Production

For production deployment:

1. Set `ENVIRONMENT=production`
2. Set `DEBUG=False`
3. Use production ASGI server (Gunicorn with Uvicorn workers):

```bash
gunicorn app.main:app \
  --workers 4 \
  --worker-class uvicorn.workers.UvicornWorker \
  --bind 0.0.0.0:8001
```

## Generated by BoringPy

This project was generated using [BoringPy](https://github.com/yourusername/boringpy) - A modern Python scaffolding framework.