Metadata-Version: 2.4
Name: async_yookassa
Version: 0.6.0rc2
Summary: Unofficial API client for YooKassa
Author-email: prodream <sushkoos@gmail.com>
License-Expression: MIT
Project-URL: Repository, https://github.com/proDreams/async_yookassa
Keywords: yoomoney,yookassa,payout,sdk,python
Requires-Python: <3.15,>=3.11
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: pydantic[email]>=2.12.5
Requires-Dist: distro<2,>=1.9.0
Requires-Dist: httpx>=0.28.1
Dynamic: license-file

# Async YooKassa (unofficial)

[![Latest Stable Version](https://img.shields.io/pypi/v/async_yookassa.svg)](https://pypi.org/project/async_yookassa/) [![Downloads](https://img.shields.io/pypi/dm/async_yookassa.svg)](https://pypi.org/project/async_yookassa/) [![–ö–æ–¥ –Ω–∞ —Å–∞–ª—Ñ–µ—Ç–∫–µ](https://img.shields.io/badge/Telegram-–ö–æ–¥_–Ω–∞_—Å–∞–ª—Ñ–µ—Ç–∫–µ-blue)](https://t.me/press_any_button) [![–ó–∞–º–µ—Ç–∫–∏ –Ω–∞ —Å–∞–ª—Ñ–µ—Ç–∫–µ](https://img.shields.io/badge/Telegram-–ó–∞–º–µ—Ç–∫–∏_–Ω–∞_—Å–∞–ª—Ñ–µ—Ç–∫–µ-blue)](https://t.me/writeanynotes)

–ù–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏ –ø–æ [API –ÆKassa](https://yookassa.ru/developers/api)

–ó–∞ –æ—Å–Ω–æ–≤—É
–≤–∑—è—Ç–∞ [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç –Æ–ú–∞–Ω–∏](https://git.yoomoney.ru/projects/SDK/repos/yookassa-sdk-python/browse).

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# pip
pip install --upgrade async_yookassa

# poetry
poetry add async_yookassa

# uv
uv add async_yookassa
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (v0.6+)

```python
from async_yookassa import YooKassaClient
from async_yookassa.models.payment_request import PaymentRequest
from async_yookassa.models.payment_submodels.amount import Amount
from async_yookassa.models.payment_submodels.confirmation import Confirmation

async with YooKassaClient(account_id="<–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞>", secret_key="<–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á>") as client:
    # –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
    payment = await client.payment.create(
        PaymentRequest(
            amount=Amount(value="100.00", currency="RUB"),
            confirmation=Confirmation(type="redirect", return_url="https://example.com/return"),
            description="–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂",
        )
    )
    print(payment.confirmation.confirmation_url)

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–ª–∞—Ç–µ–∂–µ
    payment = await client.payment.find_one("payment_id")

    # –°–ø–∏—Å–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π
    payments = await client.payment.list()
```

### OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

```python
async with YooKassaClient(auth_token="<OAuth Token>") as client:
    payment = await client.payment.find_one("payment_id")
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DI (–ø—Ä–∏–º–µ—Ä –¥–ª—è Dishka)

```python
from dishka import Provider, Scope, provide, FromDishka


class YooKassaProvider(Provider):
    @provide(scope=Scope.APP)
    def get_client(self) -> YooKassaClient:
        return YooKassaClient(account_id="...", secret_key="...")


# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
async def create_payment(client: FromDishka[YooKassaClient]):
    async with client:
        payment = await client.payment.create(...)
```

## –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

| –°–µ—Ä–≤–∏—Å           | –û–ø–∏—Å–∞–Ω–∏–µ | –ú–µ—Ç–æ–¥—ã                                            |
|------------------|----------|---------------------------------------------------|
| `client.payment` | –ü–ª–∞—Ç–µ–∂–∏  | `create`, `find_one`, `capture`, `cancel`, `list` |
| `client.refund`  | –í–æ–∑–≤—Ä–∞—Ç—ã | `create`, `find_one`, `list`                      |
| `client.receipt` | –ß–µ–∫–∏     | `create`, `find_one`, `list`                      |
| `client.payout`  | –í—ã–ø–ª–∞—Ç—ã  | `create`, `find_one`                              |
| `client.invoice` | –°—á–µ—Ç–∞    | `create`, `find_one`, `cancel`, `list`            |
| `client.deal`    | –°–¥–µ–ª–∫–∏   | `create`, `find_one`, `list`                      |
| `client.webhook` | –í–µ–±—Ö—É–∫–∏  | `create`, `find_one`, `delete`, `list`            |

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å v0.x

<details>
<summary>üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏</summary>

### –ë—ã–ª–æ (v0.x):

```python
from async_yookassa import Configuration, Payment

Configuration.configure(account_id="...", secret_key="...")
payment = await Payment.create({"amount": {"value": "100.00", "currency": "RUB"}})
```

### –°—Ç–∞–ª–æ (v0.6+):

```python
from async_yookassa import YooKassaClient
from async_yookassa.models.payment_request import PaymentRequest
from async_yookassa.models.payment_submodels.amount import Amount

async with YooKassaClient(account_id="...", secret_key="...") as client:
    payment = await client.payment.create(
        PaymentRequest(amount=Amount(value="100.00", currency="RUB"))
    )
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä** ‚Äî –∫–ª–∏–µ–Ω—Ç —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `async with`
2. **Instance-based** ‚Äî –±–æ–ª—å—à–µ –Ω–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ `Configuration`
3. **–°–µ—Ä–≤–∏—Å—ã** ‚Äî –º–µ—Ç–æ–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `client.payment`, `client.refund`, –∏ —Ç.–¥.

> **–°—Ç–∞—Ä—ã–π API –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å**, –Ω–æ –≤—ã–¥–∞—ë—Ç `DeprecationWarning` –∏ –±—É–¥–µ—Ç —É–¥–∞–ª—ë–Ω –≤ v2.0.

</details>

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python >=3.11

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
