[package]
name = "boosters"
version = "0.1.0"
edition = "2024"
autobenches = false

[dependencies]
thiserror = "1.0"

# Builder pattern macro
bon = "3.8"

# Parallel processing
rayon = "1.10"

# Random number generation (for shuffle selector and sampling)
rand = { version = "0.8", features = ["small_rng"] }
rand_xoshiro = "0.6"

# Efficient bitset operations for feature bundling conflict detection
fixedbitset = "0.5"

# Serialization (enabled via `persist` and/or compat features)
serde = { version = "1.0", features = ["derive"], optional = true }
serde_json = { version = "1.0", optional = true }
rmp-serde = { version = "1.3", optional = true }
crc32c = { version = "0.6", optional = true }

# Optional: zstd compression for persist module
zstd = { version = "0.13", optional = true }
# Note: ndarray 0.16 required for compatibility with numpy crate (rust-numpy)
ndarray = {version = "0.16", features = ["rayon"]}

[dev-dependencies]
approx = "0.5"
ndarray = { version = "0.16", features = ["rayon", "approx"] }
serde = { version = "1.0", features = ["derive"] } # Used by feature-gated modules/tests
serde_json = "1.0"  # Used by feature-gated modules/tests
criterion = { version = "0.5", features = ["html_reports"] }
tempfile = "3.20"  # For temporary file tests
proptest = "1.4"  # Property-based testing for persist module

[features]
default = ["persist"]

# Enables the native `.bstr` persistence module (JSON + binary + compression).
persist = ["dep:serde", "dep:serde_json", "dep:rmp-serde", "dep:crc32c", "dep:zstd"]

[[bench]]
name = "predict_gbdt"
harness = false
path = "benches/predict_gbdt.rs"

[[bench]]
name = "train_gbdt"
harness = false
path = "benches/train_gbdt.rs"

[[bench]]
name = "persist"
harness = false
path = "benches/persist.rs"
