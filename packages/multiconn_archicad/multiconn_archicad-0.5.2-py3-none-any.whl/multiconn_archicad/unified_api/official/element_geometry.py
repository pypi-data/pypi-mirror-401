# This file is automatically generated by the build system.
# Do not edit this file directly.

from __future__ import annotations
from typing import TYPE_CHECKING
from pydantic import TypeAdapter

from multiconn_archicad.models.official.commands import (
    Get2DBoundingBoxesParameters,
    Get2DBoundingBoxesResult,
    Get3DBoundingBoxesParameters,
    Get3DBoundingBoxesResult,
)
from multiconn_archicad.models.official.types import (
    BoundingBox2DWrapperItem,
    BoundingBox3DWrapperItem,
    ElementIdArrayItem,
    ErrorItem,
)

if TYPE_CHECKING:
    from multiconn_archicad.core.core_commands import CoreCommands


class ElementGeometryCommands:
    def __init__(self, core: CoreCommands):
        self._core = core

    def get_2d_bounding_boxes(self, elements: list[ElementIdArrayItem]) -> list[BoundingBox2DWrapperItem | ErrorItem]:
        """
        Get the 2D bounding box of elements identified by their GUIDs. The bounding box is
        calculated from the global origin on the floor plan view. The output is the array of the
        bounding boxes respective to the input GUIDs. Only works for elements detailed in
        <i>Element Information</i>.

        Args:
            elements (list[ElementIdArrayItem]): A list of elements.

        Returns:
            list[BoundingBox2DWrapperItem | ErrorItem]: A list of 2D bounding boxes.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "elements": elements,
        }
        validated_params = Get2DBoundingBoxesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.Get2DBoundingBoxes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = Get2DBoundingBoxesResult.model_validate(response_dict)
        return validated_response.boundingBoxes2D

    def get_3d_bounding_boxes(self, elements: list[ElementIdArrayItem]) -> list[BoundingBox3DWrapperItem | ErrorItem]:
        """
        Get the 3D bounding box of elements identified by their GUIDs. The bounding box is
        calculated from the global origin in the 3D view. The output is the array of the
        bounding boxes respective to the input GUIDs. Only works for elements detailed in
        <i>Element Information</i>.

        Args:
            elements (list[ElementIdArrayItem]): A list of elements.

        Returns:
            list[BoundingBox3DWrapperItem | ErrorItem]: A list of 3D bounding boxes.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "elements": elements,
        }
        validated_params = Get3DBoundingBoxesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.Get3DBoundingBoxes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = Get3DBoundingBoxesResult.model_validate(response_dict)
        return validated_response.boundingBoxes3D
