# This file is automatically generated by the build system.
# Do not edit this file directly.

from __future__ import annotations
from typing import TYPE_CHECKING
from pydantic import TypeAdapter

from multiconn_archicad.models.official.commands import (
    CreateAttributeFoldersParameters,
    CreateAttributeFoldersResult,
    DeleteAttributeFoldersParameters,
    DeleteAttributeFoldersResult,
    DeleteAttributesParameters,
    DeleteAttributesResult,
    GetActivePenTablesResult,
    GetAttributeFolderStructureParameters,
    GetAttributeFolderStructureResult,
    GetAttributeFoldersParameters,
    GetAttributeFoldersResult,
    GetAttributesByTypeParameters,
    GetAttributesByTypeResult,
    GetAttributesIndicesParameters,
    GetAttributesIndicesResult,
    GetBuildingMaterialAttributesParameters,
    GetBuildingMaterialAttributesResult,
    GetCompositeAttributesParameters,
    GetCompositeAttributesResult,
    GetFillAttributesParameters,
    GetFillAttributesResult,
    GetLayerAttributesParameters,
    GetLayerAttributesResult,
    GetLayerCombinationAttributesParameters,
    GetLayerCombinationAttributesResult,
    GetLineAttributesParameters,
    GetLineAttributesResult,
    GetPenTableAttributesParameters,
    GetPenTableAttributesResult,
    GetProfileAttributePreviewParameters,
    GetProfileAttributePreviewResult,
    GetProfileAttributesParameters,
    GetProfileAttributesResult,
    GetSurfaceAttributesParameters,
    GetSurfaceAttributesResult,
    GetZoneCategoryAttributesParameters,
    GetZoneCategoryAttributesResult,
    MoveAttributesAndFoldersParameters,
    RenameAttributeFoldersParameters,
    RenameAttributeFoldersResult,
)
from multiconn_archicad.models.official.types import (
    AttributeFolderCreationParameters,
    AttributeFolderId,
    AttributeFolderIdWrapperItem,
    AttributeFolderRenameParameters,
    AttributeFolderStructure,
    AttributeFolderWrapperItem,
    AttributeIdWrapperItem,
    AttributeIndexAndGuidWrapperItem,
    AttributeType,
    BuildingMaterialAttributeWrapperItem,
    CompositeAttributeWrapperItem,
    ErrorItem,
    FailedExecutionResult,
    FillAttributeWrapperItem,
    ImageWrapperItem,
    LayerAttributeWrapperItem,
    LayerCombinationAttributeWrapperItem,
    LineAttributeWrapperItem,
    PenTableAttributeWrapperItem,
    ProfileAttributeWrapperItem,
    RGBColor,
    SuccessfulExecutionResult,
    SurfaceAttributeWrapperItem,
    ZoneCategoryAttributeWrapperItem,
)

if TYPE_CHECKING:
    from multiconn_archicad.core.core_commands import CoreCommands


class AttributeCommands:
    def __init__(self, core: CoreCommands):
        self._core = core

    def create_attribute_folders(
        self, attribute_folders: list[AttributeFolderCreationParameters]
    ) -> list[FailedExecutionResult | SuccessfulExecutionResult]:
        """
        Creates attribute folders. To create a folder, its full path has to be provided. The
        command will create all folders along the path, if they do not exist.

        Args:
            attribute_folders (list[AttributeFolderCreationParameters])

        Returns:
            list[FailedExecutionResult | SuccessfulExecutionResult]: A list of execution
                results.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeFolders": attribute_folders,
        }
        validated_params = CreateAttributeFoldersParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.CreateAttributeFolders", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = CreateAttributeFoldersResult.model_validate(response_dict)
        return validated_response.executionResults

    def delete_attribute_folders(
        self, attribute_folder_ids: list[AttributeFolderIdWrapperItem]
    ) -> list[FailedExecutionResult | SuccessfulExecutionResult]:
        """
        Deletes attribute folders and all the deletable attributes and folders it contains. To
        delete a folder, its identifier has to be provided.

        Args:
            attribute_folder_ids (list[AttributeFolderIdWrapperItem]): A list of attribute
                folder identifiers.

        Returns:
            list[FailedExecutionResult | SuccessfulExecutionResult]: A list of execution
                results.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeFolderIds": attribute_folder_ids,
        }
        validated_params = DeleteAttributeFoldersParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.DeleteAttributeFolders", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = DeleteAttributeFoldersResult.model_validate(response_dict)
        return validated_response.executionResults

    def delete_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[FailedExecutionResult | SuccessfulExecutionResult]:
        """
        Deletes attributes.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[FailedExecutionResult | SuccessfulExecutionResult]: A list of execution
                results.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = DeleteAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.DeleteAttributes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = DeleteAttributesResult.model_validate(response_dict)
        return validated_response.executionResults

    def get_active_pen_tables(self) -> GetActivePenTablesResult:
        """
        Returns the model view and layout book pen table identifiers.

        Returns:
            GetActivePenTablesResult

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        response_dict = self._core.post_command("API.GetActivePenTables")
        validated_response = GetActivePenTablesResult.model_validate(response_dict)
        return validated_response

    def get_attribute_folder_structure(
        self, attribute_type: AttributeType, path: None | list[str] = None
    ) -> AttributeFolderStructure:
        """
        Returns the detailed folder structure for the attributes of a given type. If the path is
        not given, the root folder will be returned

        Args:
            attribute_type (AttributeType)
            path (None | list[str]): A list of attribute folder names. May be empty.

        Returns:
            AttributeFolderStructure

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeType": attribute_type,
            "path": path,
        }
        validated_params = GetAttributeFolderStructureParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetAttributeFolderStructure",
            validated_params.model_dump(mode="json", by_alias=True, exclude_none=True),
        )
        validated_response = GetAttributeFolderStructureResult.model_validate(response_dict)
        return validated_response.attributeFolder

    def get_attribute_folders(
        self, attribute_folder_ids: list[AttributeFolderIdWrapperItem]
    ) -> list[AttributeFolderWrapperItem | ErrorItem]:
        """
        Returns the detailed attribute folders identified by their Ids.

        Args:
            attribute_folder_ids (list[AttributeFolderIdWrapperItem]): A list of attribute
                folder identifiers.

        Returns:
            list[AttributeFolderWrapperItem | ErrorItem]: A list of attribute folders.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeFolderIds": attribute_folder_ids,
        }
        validated_params = GetAttributeFoldersParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetAttributeFolders", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetAttributeFoldersResult.model_validate(response_dict)
        return validated_response.attributeFolders

    def get_attributes_by_type(self, attribute_type: AttributeType) -> list[AttributeIdWrapperItem]:
        """
        Returns the identifier of every attribute of the given type.

        Args:
            attribute_type (AttributeType)

        Returns:
            list[AttributeIdWrapperItem]: A list of attribute identifiers.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeType": attribute_type,
        }
        validated_params = GetAttributesByTypeParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetAttributesByType", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetAttributesByTypeResult.model_validate(response_dict)
        return validated_response.attributeIds

    def get_attributes_indices(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[AttributeIndexAndGuidWrapperItem | ErrorItem]:
        """
        Returns the requested indices and guids of attributes.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[AttributeIndexAndGuidWrapperItem | ErrorItem]: A list of complete attribute
                identifiers.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetAttributesIndicesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetAttributesIndices", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetAttributesIndicesResult.model_validate(response_dict)
        return validated_response.attributeIndicesAndGuids

    def get_building_material_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[BuildingMaterialAttributeWrapperItem | ErrorItem]:
        """
        Returns the detailed building material attributes identified by their GUIDs.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[BuildingMaterialAttributeWrapperItem | ErrorItem]: A list of building material
                attributes and potential errors.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetBuildingMaterialAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetBuildingMaterialAttributes",
            validated_params.model_dump(mode="json", by_alias=True, exclude_none=True),
        )
        validated_response = GetBuildingMaterialAttributesResult.model_validate(response_dict)
        return validated_response.attributes

    def get_composite_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[CompositeAttributeWrapperItem | ErrorItem]:
        """
        Returns the detailed composite attributes identified by their GUIDs.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[CompositeAttributeWrapperItem | ErrorItem]: A list of the composite attributes
                and potential errors.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetCompositeAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetCompositeAttributes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetCompositeAttributesResult.model_validate(response_dict)
        return validated_response.attributes

    def get_fill_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[ErrorItem | FillAttributeWrapperItem]:
        """
        Returns the detailed fill attributes identified by their GUIDs.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[ErrorItem | FillAttributeWrapperItem]: A list of fill attributes and potential
                errors.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetFillAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetFillAttributes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetFillAttributesResult.model_validate(response_dict)
        return validated_response.attributes

    def get_layer_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[ErrorItem | LayerAttributeWrapperItem]:
        """
        Returns the detailed layer attributes identified by their GUIDs.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[ErrorItem | LayerAttributeWrapperItem]: A list of layer attributes and
                potential errors.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetLayerAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetLayerAttributes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetLayerAttributesResult.model_validate(response_dict)
        return validated_response.attributes

    def get_layer_combination_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[ErrorItem | LayerCombinationAttributeWrapperItem]:
        """
        Returns the detailed layer combination attributes identified by their GUIDs.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[ErrorItem | LayerCombinationAttributeWrapperItem]: A list of layer combination
                attributes and potential errors.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetLayerCombinationAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetLayerCombinationAttributes",
            validated_params.model_dump(mode="json", by_alias=True, exclude_none=True),
        )
        validated_response = GetLayerCombinationAttributesResult.model_validate(response_dict)
        return validated_response.attributes

    def get_line_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[ErrorItem | LineAttributeWrapperItem]:
        """
        Returns the detailed line attributes identified by their GUIDs.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[ErrorItem | LineAttributeWrapperItem]: A list of line attributes and potential
                errors.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetLineAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetLineAttributes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetLineAttributesResult.model_validate(response_dict)
        return validated_response.attributes

    def get_pen_table_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[ErrorItem | PenTableAttributeWrapperItem]:
        """
        Returns the detailed pen table attributes (including their pens) identified by their
        GUIDs.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[ErrorItem | PenTableAttributeWrapperItem]: A list of pen table attributes and
                potential errors.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetPenTableAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetPenTableAttributes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetPenTableAttributesResult.model_validate(response_dict)
        return validated_response.attributes

    def get_profile_attribute_preview(
        self,
        attribute_ids: list[AttributeIdWrapperItem],
        image_width: int,
        image_height: int,
        background_color: None | RGBColor = None,
    ) -> list[ErrorItem | ImageWrapperItem]:
        """
        Returns the preview image of each requested profile attribute in a base64 string format.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.
            image_width (int): The width of the preview image.
            image_height (int): The height of the preview image.
            background_color (None | RGBColor): The background color of the preview image.

        Returns:
            list[ErrorItem | ImageWrapperItem]: The preview images of the profiles.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
            "imageWidth": image_width,
            "imageHeight": image_height,
            "backgroundColor": background_color,
        }
        validated_params = GetProfileAttributePreviewParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetProfileAttributePreview", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetProfileAttributePreviewResult.model_validate(response_dict)
        return validated_response.previewImages

    def get_profile_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[ErrorItem | ProfileAttributeWrapperItem]:
        """
        Returns the detailed profile attributes identified by their GUIDs.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[ErrorItem | ProfileAttributeWrapperItem]: A list of the profile attributes and
                potential errors.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetProfileAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetProfileAttributes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetProfileAttributesResult.model_validate(response_dict)
        return validated_response.attributes

    def get_surface_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[ErrorItem | SurfaceAttributeWrapperItem]:
        """
        Returns the detailed surface attributes identified by their GUIDs.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[ErrorItem | SurfaceAttributeWrapperItem]: A list of surface attributes and
                potential errors.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetSurfaceAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetSurfaceAttributes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetSurfaceAttributesResult.model_validate(response_dict)
        return validated_response.attributes

    def get_zone_category_attributes(
        self, attribute_ids: list[AttributeIdWrapperItem]
    ) -> list[ErrorItem | ZoneCategoryAttributeWrapperItem]:
        """
        Returns the detailed zone category attributes identified by their GUIDs.

        Args:
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.

        Returns:
            list[ErrorItem | ZoneCategoryAttributeWrapperItem]: A list of zone category
                attributes and potential errors.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeIds": attribute_ids,
        }
        validated_params = GetZoneCategoryAttributesParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetZoneCategoryAttributes", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetZoneCategoryAttributesResult.model_validate(response_dict)
        return validated_response.attributes

    def move_attributes_and_folders(
        self,
        attribute_folder_ids: list[AttributeFolderIdWrapperItem],
        attribute_ids: list[AttributeIdWrapperItem],
        target_folder_id: AttributeFolderId,
    ) -> None:
        """
        Moves attributes and attribute folders.

        Args:
            attribute_folder_ids (list[AttributeFolderIdWrapperItem]): A list of attribute
                folder identifiers.
            attribute_ids (list[AttributeIdWrapperItem]): A list of attribute identifiers.
            target_folder_id (AttributeFolderId)

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeFolderIds": attribute_folder_ids,
            "attributeIds": attribute_ids,
            "targetFolderId": target_folder_id,
        }
        validated_params = MoveAttributesAndFoldersParameters(**params_dict)
        self._core.post_command(
            "API.MoveAttributesAndFolders", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        return None

    def rename_attribute_folders(
        self, attribute_folder_parameters_list: list[AttributeFolderRenameParameters]
    ) -> list[FailedExecutionResult | SuccessfulExecutionResult]:
        """
        Rename attribute folder.

        Args:
            attribute_folder_parameters_list (list[AttributeFolderRenameParameters])

        Returns:
            list[FailedExecutionResult | SuccessfulExecutionResult]: A list of execution
                results.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "attributeFolderParametersList": attribute_folder_parameters_list,
        }
        validated_params = RenameAttributeFoldersParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.RenameAttributeFolders", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = RenameAttributeFoldersResult.model_validate(response_dict)
        return validated_response.executionResults
