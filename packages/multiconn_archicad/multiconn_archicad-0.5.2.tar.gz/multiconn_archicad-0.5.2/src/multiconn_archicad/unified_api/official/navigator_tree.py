# This file is automatically generated by the build system.
# Do not edit this file directly.

from __future__ import annotations
from typing import TYPE_CHECKING
from pydantic import TypeAdapter

from multiconn_archicad.models.official.commands import (
    DeleteNavigatorItemsParameters,
    DeleteNavigatorItemsResult,
    GetBuiltInContainerNavigatorItemsParameters,
    GetBuiltInContainerNavigatorItemsResult,
    GetDetailNavigatorItemsParameters,
    GetDetailNavigatorItemsResult,
    GetDocument3DNavigatorItemsParameters,
    GetDocument3DNavigatorItemsResult,
    GetElevationNavigatorItemsParameters,
    GetElevationNavigatorItemsResult,
    GetInteriorElevationNavigatorItemsParameters,
    GetInteriorElevationNavigatorItemsResult,
    GetNavigatorItemTreeParameters,
    GetNavigatorItemTreeResult,
    GetNavigatorItemsTypeParameters,
    GetNavigatorItemsTypeResult,
    GetPublisherSetNamesResult,
    GetSectionNavigatorItemsParameters,
    GetSectionNavigatorItemsResult,
    GetStoryNavigatorItemsParameters,
    GetStoryNavigatorItemsResult,
    GetWorksheetNavigatorItemsParameters,
    GetWorksheetNavigatorItemsResult,
    MoveNavigatorItemParameters,
    RenameNavigatorItemById,
    RenameNavigatorItemByName,
    RenameNavigatorItemByNameAndId,
    RenameNavigatorItemParameters,
)
from multiconn_archicad.models.official.types import (
    BuiltInContainerNavigatorItemWrapperItem,
    DetailNavigatorItemWrapperItem,
    Document3DNavigatorItemWrapperItem,
    ElevationNavigatorItemWrapperItem,
    ErrorItem,
    FailedExecutionResult,
    InteriorElevationNavigatorItemWrapperItem,
    NavigatorItemId,
    NavigatorItemIdAndTypeWrapperItem,
    NavigatorItemIdWrapperItem,
    NavigatorTree,
    OtherNavigatorTreeId,
    PublisherSetId,
    SectionNavigatorItemWrapperItem,
    StoryNavigatorItemWrapperItem,
    SuccessfulExecutionResult,
    WorksheetNavigatorItemWrapperItem,
)

if TYPE_CHECKING:
    from multiconn_archicad.core.core_commands import CoreCommands


class NavigatorTreeCommands:
    def __init__(self, core: CoreCommands):
        self._core = core

    def delete_navigator_items(
        self, navigator_item_ids: list[NavigatorItemIdWrapperItem]
    ) -> list[FailedExecutionResult | SuccessfulExecutionResult]:
        """
        Deletes items from navigator tree.

        Args:
            navigator_item_ids (list[NavigatorItemIdWrapperItem]): A list of navigator item
                identifiers.

        Returns:
            list[FailedExecutionResult | SuccessfulExecutionResult]: A list of execution
                results.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIds": navigator_item_ids,
        }
        validated_params = DeleteNavigatorItemsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.DeleteNavigatorItems", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = DeleteNavigatorItemsResult.model_validate(response_dict)
        return validated_response.executionResults

    def get_built_in_container_navigator_items(
        self, navigator_item_ids: list[NavigatorItemIdWrapperItem]
    ) -> list[BuiltInContainerNavigatorItemWrapperItem | ErrorItem]:
        """
        Returns the details of the built-in container navigator items identified by their Ids.

        Args:
            navigator_item_ids (list[NavigatorItemIdWrapperItem]): A list of navigator item
                identifiers.

        Returns:
            list[BuiltInContainerNavigatorItemWrapperItem | ErrorItem]: A list of built-in
                container navigator items.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIds": navigator_item_ids,
        }
        validated_params = GetBuiltInContainerNavigatorItemsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetBuiltInContainerNavigatorItems",
            validated_params.model_dump(mode="json", by_alias=True, exclude_none=True),
        )
        validated_response = GetBuiltInContainerNavigatorItemsResult.model_validate(response_dict)
        return validated_response.navigatorItems

    def get_detail_navigator_items(
        self, navigator_item_ids: list[NavigatorItemIdWrapperItem]
    ) -> list[DetailNavigatorItemWrapperItem | ErrorItem]:
        """
        Returns the details of the detail navigator items identified by their Ids.

        Args:
            navigator_item_ids (list[NavigatorItemIdWrapperItem]): A list of navigator item
                identifiers.

        Returns:
            list[DetailNavigatorItemWrapperItem | ErrorItem]: A list of detail navigator items.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIds": navigator_item_ids,
        }
        validated_params = GetDetailNavigatorItemsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetDetailNavigatorItems", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetDetailNavigatorItemsResult.model_validate(response_dict)
        return validated_response.navigatorItems

    def get_document_3d_navigator_items(
        self, navigator_item_ids: list[NavigatorItemIdWrapperItem]
    ) -> list[Document3DNavigatorItemWrapperItem | ErrorItem]:
        """
        Returns the details of the 3D document navigator items identified by their Ids.

        Args:
            navigator_item_ids (list[NavigatorItemIdWrapperItem]): A list of navigator item
                identifiers.

        Returns:
            list[Document3DNavigatorItemWrapperItem | ErrorItem]: A list of 3D document
                navigator items.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIds": navigator_item_ids,
        }
        validated_params = GetDocument3DNavigatorItemsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetDocument3DNavigatorItems",
            validated_params.model_dump(mode="json", by_alias=True, exclude_none=True),
        )
        validated_response = GetDocument3DNavigatorItemsResult.model_validate(response_dict)
        return validated_response.navigatorItems

    def get_elevation_navigator_items(
        self, navigator_item_ids: list[NavigatorItemIdWrapperItem]
    ) -> list[ElevationNavigatorItemWrapperItem | ErrorItem]:
        """
        Returns the detailed elevation navigator items identified by their Ids.

        Args:
            navigator_item_ids (list[NavigatorItemIdWrapperItem]): A list of navigator item
                identifiers.

        Returns:
            list[ElevationNavigatorItemWrapperItem | ErrorItem]: A list of elevation navigator
                items.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIds": navigator_item_ids,
        }
        validated_params = GetElevationNavigatorItemsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetElevationNavigatorItems", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetElevationNavigatorItemsResult.model_validate(response_dict)
        return validated_response.navigatorItems

    def get_interior_elevation_navigator_items(
        self, navigator_item_ids: list[NavigatorItemIdWrapperItem]
    ) -> list[ErrorItem | InteriorElevationNavigatorItemWrapperItem]:
        """
        Returns the details of the interior elevation navigator items identified by their Ids.

        Args:
            navigator_item_ids (list[NavigatorItemIdWrapperItem]): A list of navigator item
                identifiers.

        Returns:
            list[ErrorItem | InteriorElevationNavigatorItemWrapperItem]: A list of interior
                elevation navigator items.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIds": navigator_item_ids,
        }
        validated_params = GetInteriorElevationNavigatorItemsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetInteriorElevationNavigatorItems",
            validated_params.model_dump(mode="json", by_alias=True, exclude_none=True),
        )
        validated_response = GetInteriorElevationNavigatorItemsResult.model_validate(response_dict)
        return validated_response.navigatorItems

    def get_navigator_item_tree(self, navigator_tree_id: OtherNavigatorTreeId | PublisherSetId) -> NavigatorTree:
        """
        Returns the tree of navigator items.

        Args:
            navigator_tree_id (OtherNavigatorTreeId | PublisherSetId): The identifier of a
                navigator item tree.

        Returns:
            NavigatorTree

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorTreeId": navigator_tree_id,
        }
        validated_params = GetNavigatorItemTreeParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetNavigatorItemTree", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetNavigatorItemTreeResult.model_validate(response_dict)
        return validated_response.navigatorTree

    def get_navigator_items_type(
        self, navigator_item_ids: list[NavigatorItemIdWrapperItem]
    ) -> list[ErrorItem | NavigatorItemIdAndTypeWrapperItem]:
        """
        Returns all navigator item types based on the navigator item identifiers given. An error
        is returned for each identifier that is not found.

        Args:
            navigator_item_ids (list[NavigatorItemIdWrapperItem]): A list of navigator item
                identifiers.

        Returns:
            list[ErrorItem | NavigatorItemIdAndTypeWrapperItem]: A list of objects that consist
                of a navigator item identifier and a type.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIds": navigator_item_ids,
        }
        validated_params = GetNavigatorItemsTypeParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetNavigatorItemsType", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetNavigatorItemsTypeResult.model_validate(response_dict)
        return validated_response.navigatorItemIdAndTypeList

    def get_publisher_set_names(self) -> list[str]:
        """
        Returns the names of available publisher sets.

        Returns:
            list[str]: The names of available publisher sets.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        response_dict = self._core.post_command("API.GetPublisherSetNames")
        validated_response = GetPublisherSetNamesResult.model_validate(response_dict)
        return validated_response.publisherSetNames

    def get_section_navigator_items(
        self, navigator_item_ids: list[NavigatorItemIdWrapperItem]
    ) -> list[ErrorItem | SectionNavigatorItemWrapperItem]:
        """
        Returns the details of the section navigator items identified by their Ids.

        Args:
            navigator_item_ids (list[NavigatorItemIdWrapperItem]): A list of navigator item
                identifiers.

        Returns:
            list[ErrorItem | SectionNavigatorItemWrapperItem]: A list of section navigator
                items.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIds": navigator_item_ids,
        }
        validated_params = GetSectionNavigatorItemsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetSectionNavigatorItems", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetSectionNavigatorItemsResult.model_validate(response_dict)
        return validated_response.navigatorItems

    def get_story_navigator_items(
        self, navigator_item_ids: list[NavigatorItemIdWrapperItem]
    ) -> list[ErrorItem | StoryNavigatorItemWrapperItem]:
        """
        Returns the details of the story navigator items identified by their Ids.

        Args:
            navigator_item_ids (list[NavigatorItemIdWrapperItem]): A list of navigator item
                identifiers.

        Returns:
            list[ErrorItem | StoryNavigatorItemWrapperItem]: A list of story navigator items.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIds": navigator_item_ids,
        }
        validated_params = GetStoryNavigatorItemsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetStoryNavigatorItems", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetStoryNavigatorItemsResult.model_validate(response_dict)
        return validated_response.navigatorItems

    def get_worksheet_navigator_items(
        self, navigator_item_ids: list[NavigatorItemIdWrapperItem]
    ) -> list[ErrorItem | WorksheetNavigatorItemWrapperItem]:
        """
        Returns the details of the worksheet navigator items identified by their Ids.

        Args:
            navigator_item_ids (list[NavigatorItemIdWrapperItem]): A list of navigator item
                identifiers.

        Returns:
            list[ErrorItem | WorksheetNavigatorItemWrapperItem]: A list of worksheet navigator
                items.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIds": navigator_item_ids,
        }
        validated_params = GetWorksheetNavigatorItemsParameters(**params_dict)
        response_dict = self._core.post_command(
            "API.GetWorksheetNavigatorItems", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        validated_response = GetWorksheetNavigatorItemsResult.model_validate(response_dict)
        return validated_response.navigatorItems

    def move_navigator_item(
        self,
        navigator_item_id_to_move: NavigatorItemId,
        parent_navigator_item_id: NavigatorItemId,
        previous_navigator_item_id: NavigatorItemId | None = None,
    ) -> None:
        """
        Moves the given navigator item under the <i>parentNavigatorItemId</i> in the navigator
        tree. If <i>previousNavigatorItemId</i> is not given then inserts it at the first place
        under the new parent. If it is given then inserts it after this navigator item.

        Args:
            navigator_item_id_to_move (NavigatorItemId)
            parent_navigator_item_id (NavigatorItemId)
            previous_navigator_item_id (NavigatorItemId | None)

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        params_dict = {
            "navigatorItemIdToMove": navigator_item_id_to_move,
            "parentNavigatorItemId": parent_navigator_item_id,
            "previousNavigatorItemId": previous_navigator_item_id,
        }
        validated_params = MoveNavigatorItemParameters(**params_dict)
        self._core.post_command(
            "API.MoveNavigatorItem", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        return None

    def rename_navigator_item(
        self, navigator_item_id: NavigatorItemId, new_name: str | None = None, new_id: str | None = None
    ) -> None:
        """
        Renames an existing navigator item by specifying either the name or the ID, or both.

        Args:
            navigator_item_id (NavigatorItemId): The identifier of the navigator item to rename.
            new_name (str, optional): The new name for the navigator item.
            new_id (str, optional): The new ID for the navigator item.

        Raises:
            ArchicadAPIError: If the API returns an error response.
            RequestError: If there is a network or connection error.
            pydantic.ValidationError: If the parameters, or the API Response fail validation.
        """
        if not new_name and not new_id:
            raise ValueError("Either 'new_name' or 'new_id' (or both) must be provided.")

        if new_name and new_id:
            inner_model = RenameNavigatorItemByNameAndId(
                navigatorItemId=navigator_item_id, newName=new_name, newId=new_id
            )
        elif new_name:
            inner_model = RenameNavigatorItemByName(navigatorItemId=navigator_item_id, newName=new_name)
        else:
            inner_model = RenameNavigatorItemById(navigatorItemId=navigator_item_id, newId=new_id)

        validated_params = RenameNavigatorItemParameters(root=inner_model)
        self._core.post_command(
            "API.RenameNavigatorItem", validated_params.model_dump(mode="json", by_alias=True, exclude_none=True)
        )
        return None
