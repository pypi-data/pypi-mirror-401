pattern_id: common.tagging.required_tags
name: Required Azure Resource Tags
description: Detects missing required tags for FedRAMP compliance
family: COMMON
severity: MEDIUM
pattern_type: resource
languages:
  bicep:
    ast_queries:
    - resource_type: '*'
      property_path: tags
      conditions:
      - not_contains_key:Environment
      - not_contains_key:Owner
      - not_contains_key:CostCenter
    regex_fallback: resource\s+\w+\s+'[^']+'
  terraform:
    ast_queries:
    - resource_type: azurerm_*
      attribute: tags
      conditions:
      - not_contains_key:Environment
      - not_contains_key:Owner
    regex_fallback: resource\s+"azurerm_
finding:
  title_template: Missing required resource tags
  description_template: Resource lacks required tags for governance and cost tracking.
  remediation_template: "Add required tags:\ntags: {\n  Environment: 'Production'  // or Dev, Test, Staging\n  Owner: 'security-team@example.com'\n  CostCenter: 'CC-12345'\n  DataClassification: 'Confidential'\n  ComplianceScope: 'FedRAMP-High'\n}\n"
tags:
- governance
- tagging
- compliance
nist_controls:
- cm-8
related_ksis:
- KSI-CNA-01
ssp_mapping:
  control_family: CM - Configuration Management
  control_numbers:
  - CM-8
  ssp_sections:
  - section: 'CM-8: Unknown'
    description_template: The system implements Unknown Requirement controls in accordance with FedRAMP 20x requirements. Requirement statement not available... Implementation leverages Azure native services combined with application-level controls and automated monitoring to ensure continuous compliance.
    implementation_details: Azure services including Azure Monitor are configured to enforce compliance requirements. Infrastructure-as-code (Bicep/Terraform) templates ensure consistent deployment across environments. Automated compliance checking in CI/CD pipelines validates all changes against Unknown Requirement requirements before deployment.
    evidence_references:
    - Configuration exports
    - Compliance reports
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-CNA-01
    requirement_name: Restrict Network Traffic
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant bicep implementation of common.tagging.required_tags
    code_sample: "// Bicep compliant configuration for common.tagging.required_tags\nresource compliantResource 'Microsoft.Resources/example@2021-01-01' = {\n  name: 'compliant-resource'\n  properties: {\n    // Compliant configuration\n  }\n}"
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant bicep code violating common.tagging.required_tags
    code_sample: '# Non-compliant code missing common.tagging.required_tags requirements'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts: []
evidence_artifacts:
- artifact_type: configuration
  name: Configuration compliance evidence
  source: Azure Resource Graph
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: logs
  name: Compliance audit logs
  source: Azure Monitor
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: report
  name: Compliance assessment report
  source: Microsoft Defender for Cloud
  frequency: weekly
  retention_months: 36
  format: JSON
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: "# Azure Policy enforcement\n# GitHub Actions\n- name: Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.tagging.required_tags \\\n      --code-path ./src\n\n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'Compliance Validation'\n  inputs:\n    script: |\n      # Validate compliance\n      python validate.py --pattern common.tagging.required_tags\n"
    azure_services:
    - Azure Policy
    - Azure Monitor
    - Microsoft Defender for Cloud
  automation_2:
    description: Continuous monitoring and alerting
    implementation: '# Azure Monitor continuous monitoring

      # Log Analytics Query

      AzureActivity

      | where CategoryValue == "Policy" or CategoryValue == "Security"

      | where ResourceId contains "common.tagging.required_tags"

      | project TimeGenerated, ResourceId, OperationName, ActivityStatusValue

      '
    azure_services:
    - Azure Monitor
    - Log Analytics
    - Azure Alerts
---
pattern_id: common.diagnostics.missing_diagnostic_settings
name: Missing Diagnostic Settings
description: Detects resources without diagnostic log export
family: COMMON
severity: HIGH
pattern_type: configuration
languages:
  bicep:
    ast_queries:
    - resource_type: Microsoft.Storage/*|Microsoft.Sql/*|Microsoft.KeyVault/*|Microsoft.Compute/*|Microsoft.Network/*
      conditions:
      - not_has_child_resource:Microsoft.Insights/diagnosticSettings
    regex_fallback: resource\s+\w+\s+'Microsoft\.(Storage|Sql|KeyVault|Compute|Network)
  terraform:
    ast_queries:
    - resource_type: azurerm_storage_account|azurerm_sql_server|azurerm_key_vault|azurerm_virtual_machine|azurerm_network_interface
      conditions:
      - not_has_companion_resource:azurerm_monitor_diagnostic_setting
    regex_fallback: resource\s+"azurerm_(storage_account|sql_server|key_vault)"
finding:
  title_template: Diagnostic settings not configured
  description_template: Resource does not export logs to Log Analytics. Required for audit and security monitoring.
  remediation_template: "Add diagnostic settings:\n\nBicep:\nresource diagnostics 'Microsoft.Insights/diagnosticSettings@2021-05-01-preview' = {\n  scope: myResource\n  name: 'logs-to-workspace'\n  properties: {\n    workspaceId: logAnalyticsWorkspace.id\n    logs: [\n      {\n        categoryGroup: 'allLogs'\n        enabled: true\n      }\n    ]\n    metrics: [\n      {\n        category: 'AllMetrics'\n        enabled: true\n      }\n    ]\n  }\n}\n"
tags:
- diagnostics
- logging
- audit
nist_controls:
- au-2
- au-3
- au-12
related_ksis:
- KSI-MLA-01
- KSI-MLA-09
evidence_artifacts:
- artifact_type: logs
  name: Authentication logs with MFA details
  source: Azure Monitor - SigninLogs
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: configuration
  name: Conditional Access policies export
  source: Microsoft Graph API
  frequency: weekly
  retention_months: 36
  format: JSON
- artifact_type: report
  name: Authentication methods compliance report
  source: Microsoft Graph API
  frequency: weekly
  retention_months: 36
  format: CSV
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: "# Azure Policy for compliance enforcement\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.diagnostics.missing_diagnostic_settings \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.diagnostics.missing_diagnostic_settings Validation'\n  inputs:\n    script: |\n      # Validate common.diagnostics.missing_diagnostic_settings compliance\n      python validate.py --pattern common.diagnostics.missing_diagnostic_settings"
    azure_services: &id001
    - Application Insights
    - Azure Blob Storage
    - Azure Monitor
    - Azure Pipelines
    - Log Analytics
    - Microsoft Sentinel
  automation_2:
    description: Azure Monitor for continuous monitoring
    implementation: "# Azure Monitor for continuous monitoring\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.diagnostics.missing_diagnostic_settings \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.diagnostics.missing_diagnostic_settings Validation'\n  inputs:\n    script: |\n      # Validate common.diagnostics.missing_diagnostic_settings compliance\n      python validate.py --pattern common.diagnostics.missing_diagnostic_settings"
    azure_services: *id001
  automation_3:
    description: Log Analytics queries for compliance validation
    implementation: "# Log Analytics queries for compliance validation\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.diagnostics.missing_diagnostic_settings \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.diagnostics.missing_diagnostic_settings Validation'\n  inputs:\n    script: |\n      # Validate common.diagnostics.missing_diagnostic_settings compliance\n      python validate.py --pattern common.diagnostics.missing_diagnostic_settings"
    azure_services: *id001
implementation:
  prerequisites:
  - Azure subscription with required permissions
  - Microsoft Entra ID tenant configured
  steps:
  - step: 1
    action: Review FedRAMP 20x requirement documentation
    azure_service: null
    validation: Manual verification required
  - step: 2
    action: Identify systems and resources in scope
    azure_service: null
    validation: Manual verification required
  - step: 3
    action: Create resource group for FedRAMP resources
    azure_service: null
    validation: Manual verification required
  - step: 4
    action: Set up Azure Key Vault for secrets management
    azure_service: null
    validation: Manual verification required
  - step: 5
    action: Configure Log Analytics workspace
    azure_service: null
    validation: Manual verification required
  - step: 6
    action: Deploy Log Analytics workspace
    azure_service: null
    validation: Manual verification required
  - step: 7
    action: Enable diagnostic settings for all resources
    azure_service: null
    validation: Manual verification required
  - step: 8
    action: Configure log retention (1 year minimum for FedRAMP)
    azure_service: null
    validation: Manual verification required
  - step: 9
    action: Set up Azure Monitor alerts
    azure_service: null
    validation: Manual verification required
  - step: 10
    action: Deploy Microsoft Sentinel (if required)
    azure_service: null
    validation: Manual verification required
  - step: 11
    action: Create dashboards for compliance monitoring
    azure_service: null
    validation: Manual verification required
  - step: 12
    action: Test log collection and alerting
    azure_service: null
    validation: Manual verification required
  - step: 13
    action: Generate infrastructure-as-code templates (Bicep/Terraform)
    azure_service: null
    validation: Manual verification required
  - step: 14
    action: Deploy infrastructure via CI/CD pipeline
    azure_service: null
    validation: Manual verification required
  - step: 15
    action: Implement automated compliance checking
    azure_service: null
    validation: Manual verification required
  - step: 16
    action: Set up automated evidence collection
    azure_service: null
    validation: Manual verification required
  - step: 17
    action: Test detection logic against sample code
    azure_service: null
    validation: Manual verification required
ssp_mapping:
  control_family: AU - Audit and Accountability
  control_numbers:
  - AU-2
  - AU-3
  - AU-12
  ssp_sections:
  - section: 'AU-2: Security Information and Event Management (SIEM)'
    description_template: The system implements Security Information and Event Management (SIEM) controls in accordance with FedRAMP 20x requirements. Operate a Security Information and Event Management (SIEM) or similar system(s) for centralized, tamper-resistant logging of events, activities, and changes.... Implementation leverages Azure native services combined with application-level controls and automated monitoring to ensure continuous compliance.
    implementation_details: Azure services including Application Insights, Azure Blob Storage, Azure Monitor are configured to enforce compliance requirements. Infrastructure-as-code (Bicep/Terraform) templates ensure consistent deployment across environments. Automated compliance checking in CI/CD pipelines validates all changes against Security Information and Event Management (SIEM) requirements before deployment.
    evidence_references:
    - Configuration exports
    - Compliance reports
azure_guidance:
  recommended_services:
  - service: Application Insights
    tier: Standard
    purpose: Required for Application Insights functionality
    alternatives: []
  - service: Azure Blob Storage
    tier: Standard
    purpose: Required for Azure Blob Storage functionality
    alternatives: []
  - service: Azure Monitor
    tier: Standard
    purpose: Required for Azure Monitor functionality
    alternatives: []
  - service: Azure Pipelines
    tier: Standard
    purpose: Required for Azure Pipelines functionality
    alternatives: []
  - service: Log Analytics
    tier: Standard
    purpose: Required for Log Analytics functionality
    alternatives: []
  well_architected_framework:
    pillar: Security
    design_area: Identity and Access Management
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-MLA-01
    requirement_name: Security Information and Event Management (SIEM)
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant bicep implementation of common.diagnostics.missing_diagnostic_settings
    code_sample: "// Bicep compliant configuration for common.diagnostics.missing_diagnostic_settings\nresource compliantResource 'Microsoft.Resources/example@2021-01-01' = {\n  name: 'compliant-resource'\n  properties: {\n    // Compliant configuration\n  }\n}"
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant bicep code violating common.diagnostics.missing_diagnostic_settings
    code_sample: '# Non-compliant code missing common.diagnostics.missing_diagnostic_settings requirements'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts: []
---
pattern_id: common.identity.managed_identity
name: Managed Identity Usage
description: Detects use of managed identity for authentication
family: COMMON
severity: INFO
pattern_type: configuration
languages:
  bicep:
    ast_queries:
    - resource_type: '*'
      property_path: identity.type
      value: SystemAssigned|UserAssigned
    regex_fallback: identity:\s*\{
    positive_indicators:
    - SystemAssigned
    - UserAssigned
  terraform:
    ast_queries:
    - resource_type: azurerm_*
      has_block: identity
    regex_fallback: identity\s*\{
  python:
    ast_queries:
    - query_type: import_statement
      target: azure.identity.DefaultAzureCredential
    regex_fallback: from\s+azure\.identity\s+import\s+DefaultAzureCredential
  java:
    ast_queries:
    - query_type: import_statement
      target: com.azure.identity.DefaultAzureCredential
    regex_fallback: import\s+com\.azure\.identity\.DefaultAzureCredential
  typescript:
    ast_queries:
    - query_type: import_statement
      target: '@azure/identity'
    regex_fallback: from\s+['"]@azure/identity['"]
  csharp:
    ast_queries:
    - query_type: using_directive
      target: Azure.Identity
    regex_fallback: using\s+Azure\.Identity
finding:
  title_template: Managed identity detected
  description_template: Resource uses managed identity for passwordless authentication. Positive security pattern.
  remediation_template: N/A - Positive finding
tags:
- identity
- managed-identity
- positive
nist_controls:
- ia-2
- ia-5
related_ksis:
- KSI-IAM-01
- KSI-SVC-02
evidence_artifacts:
- artifact_type: logs
  name: Authentication logs with MFA details
  source: Azure Monitor - SigninLogs
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: configuration
  name: Conditional Access policies export
  source: Microsoft Graph API
  frequency: weekly
  retention_months: 36
  format: JSON
- artifact_type: report
  name: Authentication methods compliance report
  source: Microsoft Graph API
  frequency: weekly
  retention_months: 36
  format: CSV
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: "# Azure Policy for compliance enforcement\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.identity.managed_identity \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.identity.managed_identity Validation'\n  inputs:\n    script: |\n      # Validate common.identity.managed_identity compliance\n      python validate.py --pattern common.identity.managed_identity"
    azure_services: &id001
    - Azure Blob Storage
    - Azure Monitor
    - Azure Pipelines
    - Azure RBAC
    - Conditional Access
    - Log Analytics
    - Microsoft Entra ID
    - Privileged Identity Management
  automation_2:
    description: Azure Monitor for continuous monitoring
    implementation: "# Azure Monitor for continuous monitoring\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.identity.managed_identity \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.identity.managed_identity Validation'\n  inputs:\n    script: |\n      # Validate common.identity.managed_identity compliance\n      python validate.py --pattern common.identity.managed_identity"
    azure_services: *id001
  automation_3:
    description: Log Analytics queries for compliance validation
    implementation: "# Log Analytics queries for compliance validation\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.identity.managed_identity \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.identity.managed_identity Validation'\n  inputs:\n    script: |\n      # Validate common.identity.managed_identity compliance\n      python validate.py --pattern common.identity.managed_identity"
    azure_services: *id001
implementation:
  prerequisites:
  - Azure subscription with required permissions
  - Microsoft Entra ID tenant configured
  steps:
  - step: 1
    action: Review FedRAMP 20x requirement documentation
    azure_service: null
    validation: Manual verification required
  - step: 2
    action: Identify systems and resources in scope
    azure_service: null
    validation: Manual verification required
  - step: 3
    action: Create resource group for FedRAMP resources
    azure_service: null
    validation: Manual verification required
  - step: 4
    action: Set up Azure Key Vault for secrets management
    azure_service: null
    validation: Manual verification required
  - step: 5
    action: Configure Log Analytics workspace
    azure_service: null
    validation: Manual verification required
  - step: 6
    action: Enable Microsoft Entra ID Premium P2
    azure_service: null
    validation: Manual verification required
  - step: 7
    action: Configure Conditional Access policies
    azure_service: null
    validation: Manual verification required
  - step: 8
    action: Set up phishing-resistant MFA (FIDO2, certificate-based)
    azure_service: null
    validation: Manual verification required
  - step: 9
    action: Configure Privileged Identity Management (PIM)
    azure_service: null
    validation: Manual verification required
  - step: 10
    action: Enable Identity Protection
    azure_service: null
    validation: Manual verification required
  - step: 11
    action: Set up Azure RBAC with least privilege
    azure_service: null
    validation: Manual verification required
  - step: 12
    action: Test MFA enforcement for all user types
    azure_service: null
    validation: Manual verification required
  - step: 13
    action: Generate infrastructure-as-code templates (Bicep/Terraform)
    azure_service: null
    validation: Manual verification required
  - step: 14
    action: Deploy infrastructure via CI/CD pipeline
    azure_service: null
    validation: Manual verification required
  - step: 15
    action: Implement automated compliance checking
    azure_service: null
    validation: Manual verification required
  - step: 16
    action: Set up automated evidence collection
    azure_service: null
    validation: Manual verification required
  - step: 17
    action: Test detection logic against sample code
    azure_service: null
    validation: Manual verification required
ssp_mapping:
  control_family: IA - Identification and Authentication
  control_numbers:
  - IA-2
  - IA-5
  ssp_sections:
  - section: 'IA-2: Phishing-Resistant MFA'
    description_template: The system implements Phishing-Resistant MFA controls in accordance with FedRAMP 20x requirements. Enforce multi-factor authentication (MFA) using methods that are difficult to intercept or impersonate (phishing-resistant MFA) for all user authentication.... Implementation leverages Azure native services combined with application-level controls and automated monitoring to ensure continuous compliance.
    implementation_details: Azure services including Azure Blob Storage, Azure Monitor, Azure Pipelines are configured to enforce compliance requirements. Infrastructure-as-code (Bicep/Terraform) templates ensure consistent deployment across environments. Automated compliance checking in CI/CD pipelines validates all changes against Phishing-Resistant MFA requirements before deployment.
    evidence_references:
    - Configuration exports
    - Compliance reports
azure_guidance:
  recommended_services:
  - service: Azure Blob Storage
    tier: Standard
    purpose: Required for Azure Blob Storage functionality
    alternatives: []
  - service: Azure Monitor
    tier: Standard
    purpose: Required for Azure Monitor functionality
    alternatives: []
  - service: Azure Pipelines
    tier: Standard
    purpose: Required for Azure Pipelines functionality
    alternatives: []
  - service: Azure RBAC
    tier: Standard
    purpose: Required for Azure RBAC functionality
    alternatives: []
  - service: Conditional Access
    tier: Standard
    purpose: Required for Conditional Access functionality
    alternatives: []
  well_architected_framework:
    pillar: Security
    design_area: Identity and Access Management
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-IAM-01
    requirement_name: Phishing-Resistant MFA
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant bicep implementation of common.identity.managed_identity
    code_sample: "// Bicep compliant configuration for common.identity.managed_identity\nresource compliantResource 'Microsoft.Resources/example@2021-01-01' = {\n  name: 'compliant-resource'\n  properties: {\n    // Compliant configuration\n  }\n}"
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant bicep code violating common.identity.managed_identity
    code_sample: '# Non-compliant code missing common.identity.managed_identity requirements'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts: []
---
pattern_id: common.network.public_access_enabled
name: Public Network Access Enabled
description: Detects resources with public network access
family: COMMON
severity: HIGH
pattern_type: configuration
languages:
  bicep:
    ast_queries:
    - resource_type: Microsoft.Storage/*|Microsoft.Sql/*|Microsoft.KeyVault/*
      property_path: properties.publicNetworkAccess
      value: Enabled
    regex_fallback: publicNetworkAccess.*Enabled
    negative_indicators:
    - 'publicNetworkAccess: ''Enabled'''
  terraform:
    ast_queries:
    - resource_type: azurerm_storage_account|azurerm_sql_server|azurerm_key_vault
      attribute: public_network_access_enabled
      value: true
    regex_fallback: public_network_access_enabled.*=.*true
finding:
  title_template: Public network access enabled
  description_template: Resource allows public internet access. FedRAMP recommends private endpoints for data-tier resources.
  remediation_template: "Disable public access and add private endpoint:\n\nBicep:\nproperties: {\n  publicNetworkAccess: 'Disabled'\n}\n\nresource privateEndpoint 'Microsoft.Network/privateEndpoints@2021-05-01' = {\n  name: '${resourceName}-pe'\n  location: location\n  properties: {\n    subnet: {\n      id: subnetId\n    }\n    privateLinkServiceConnections: [\n      {\n        name: '${resourceName}-connection'\n        properties: {\n          privateLinkServiceId: resource.id\n          groupIds: ['blob']  // or 'sqlServer', 'vault', etc.\n        }\n      }\n    ]\n  }\n}\n"
tags:
- network
- public-access
- security-gap
nist_controls:
- sc-7
- ac-4
related_ksis:
- KSI-SVC-06
- KSI-CNA-01
evidence_collection:
  azure_monitor_kql:
  - query: 'Resources

      | where type in~ (''microsoft.storage/storageaccounts'', ''microsoft.sql/servers'', ''microsoft.keyvault/vaults'')

      | extend publicAccess = tostring(properties.publicNetworkAccess)

      | where publicAccess == ''Enabled'' or isnull(publicAccess)

      | project name, type, resourceGroup, location, publicAccess

      | order by name asc

      '
    description: Query resources with public network access enabled
    retention_days: 90
    schedule: daily
  azure_cli:
  - command: "az resource list \\\n  --query \"[?type=='Microsoft.Storage/storageAccounts' || type=='Microsoft.Sql/servers' || type=='Microsoft.KeyVault/vaults'].{name:name, resourceGroup:resourceGroup, publicAccess:properties.publicNetworkAccess}\" \\\n  --output json\n"
    description: List resources with public network access settings
    output_format: json
    frequency: weekly
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: "# Azure Policy for compliance enforcement\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.network.public_access_enabled \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.network.public_access_enabled Validation'\n  inputs:\n    script: |\n      # Validate common.network.public_access_enabled compliance\n      python validate.py --pattern common.network.public_access_enabled"
    azure_services: &id001
    - Azure Automation
    - Azure Blob Storage
    - Azure Key Vault
    - Azure Key Vault integration
    - Azure Key Vault usage
    - Azure Monitor
    - Log Analytics
    - Managed Identity
  automation_2:
    description: Azure Monitor for continuous monitoring
    implementation: "# Azure Monitor for continuous monitoring\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.network.public_access_enabled \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.network.public_access_enabled Validation'\n  inputs:\n    script: |\n      # Validate common.network.public_access_enabled compliance\n      python validate.py --pattern common.network.public_access_enabled"
    azure_services: *id001
  automation_3:
    description: Log Analytics queries for compliance validation
    implementation: "# Log Analytics queries for compliance validation\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.network.public_access_enabled \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.network.public_access_enabled Validation'\n  inputs:\n    script: |\n      # Validate common.network.public_access_enabled compliance\n      python validate.py --pattern common.network.public_access_enabled"
    azure_services: *id001
implementation:
  prerequisites:
  - Azure subscription with required permissions
  - Microsoft Entra ID tenant configured
  steps:
  - step: 1
    action: Review FedRAMP 20x requirement documentation
    azure_service: null
    validation: Manual verification required
  - step: 2
    action: Identify systems and resources in scope
    azure_service: null
    validation: Manual verification required
  - step: 3
    action: Create resource group for FedRAMP resources
    azure_service: null
    validation: Manual verification required
  - step: 4
    action: Set up Azure Key Vault for secrets management
    azure_service: null
    validation: Manual verification required
  - step: 5
    action: Configure Log Analytics workspace
    azure_service: null
    validation: Manual verification required
  - step: 6
    action: Deploy Azure Key Vault with soft delete
    azure_service: null
    validation: Manual verification required
  - step: 7
    action: Configure access policies or RBAC
    azure_service: null
    validation: Manual verification required
  - step: 8
    action: Set up Managed Identities for applications
    azure_service: null
    validation: Manual verification required
  - step: 9
    action: Implement secret rotation automation
    azure_service: null
    validation: Manual verification required
  - step: 10
    action: Configure diagnostic logging for Key Vault
    azure_service: null
    validation: Manual verification required
  - step: 11
    action: Test secret retrieval from applications
    azure_service: null
    validation: Manual verification required
  - step: 12
    action: Document secret management procedures
    azure_service: null
    validation: Manual verification required
  - step: 13
    action: Create Standard Operating Procedures (SOPs)
    azure_service: null
    validation: Manual verification required
  - step: 14
    action: Get policy documentation approved by stakeholders
    azure_service: null
    validation: Manual verification required
  - step: 15
    action: Train staff on new procedures
    azure_service: null
    validation: Manual verification required
  - step: 16
    action: Set up periodic compliance reviews
    azure_service: null
    validation: Manual verification required
  - step: 17
    action: Document evidence collection process
    azure_service: null
    validation: Manual verification required
ssp_mapping:
  control_family: SC - System and Communications Protection
  control_numbers:
  - SC-7
  - AC-4
  ssp_sections:
  - section: 'SC-7: Secret Management'
    description_template: The system implements Secret Management controls in accordance with FedRAMP 20x requirements. Implement secure secret management using Azure Key Vault or equivalent... Implementation leverages Azure native services combined with application-level controls and automated monitoring to ensure continuous compliance.
    implementation_details: Azure services including Azure Automation, Azure Blob Storage, Azure Key Vault are configured to enforce compliance requirements. Infrastructure-as-code (Bicep/Terraform) templates ensure consistent deployment across environments. Automated compliance checking in CI/CD pipelines validates all changes against Secret Management requirements before deployment.
    evidence_references:
    - Configuration exports
    - Compliance reports
azure_guidance:
  recommended_services:
  - service: Azure Automation
    tier: Standard
    purpose: Required for Azure Automation functionality
    alternatives: []
  - service: Azure Blob Storage
    tier: Standard
    purpose: Required for Azure Blob Storage functionality
    alternatives: []
  - service: Azure Key Vault
    tier: Standard
    purpose: Required for Azure Key Vault functionality
    alternatives: []
  - service: Azure Key Vault integration
    tier: Standard
    purpose: Required for Azure Key Vault integration functionality
    alternatives: []
  - service: Azure Key Vault usage
    tier: Standard
    purpose: Required for Azure Key Vault usage functionality
    alternatives: []
  well_architected_framework:
    pillar: Security
    design_area: Identity and Access Management
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-SVC-06
    requirement_name: Secret Management
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant bicep implementation of common.network.public_access_enabled
    code_sample: "// Bicep compliant configuration for common.network.public_access_enabled\nresource compliantResource 'Microsoft.Resources/example@2021-01-01' = {\n  name: 'compliant-resource'\n  properties: {\n    // Compliant configuration\n  }\n}"
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant bicep code violating common.network.public_access_enabled
    code_sample: '# Non-compliant code missing common.network.public_access_enabled requirements'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts: []
evidence_artifacts:
- artifact_type: configuration
  name: Configuration compliance evidence
  source: Azure Resource Graph
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: logs
  name: Compliance audit logs
  source: Azure Monitor
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: report
  name: Compliance assessment report
  source: Microsoft Defender for Cloud
  frequency: weekly
  retention_months: 36
  format: JSON
---
pattern_id: common.governance.azure_policy
name: Azure Policy Assignment
description: Detects Azure Policy assignments for compliance
family: COMMON
severity: INFO
pattern_type: resource
languages:
  bicep:
    ast_queries:
    - resource_type: Microsoft.Authorization/policyAssignments
    regex_fallback: Microsoft\.Authorization/policyAssignments
    positive_indicators:
    - policyAssignments
  terraform:
    ast_queries:
    - resource_type: azurerm_policy_assignment|azurerm_subscription_policy_assignment
    regex_fallback: azurerm_.*policy_assignment
finding:
  title_template: Azure Policy assignment detected
  description_template: Policy-based governance enabled. Verify FedRAMP baseline policies are assigned.
  remediation_template: "Recommended policy initiatives for FedRAMP:\n- Azure Security Benchmark\n- NIST SP 800-53 Rev. 5\n- FedRAMP High\n- ISO 27001\n\nExample assignment:\nresource policyAssignment 'Microsoft.Authorization/policyAssignments@2021-06-01' = {\n  name: 'fedramp-high-compliance'\n  properties: {\n    policyDefinitionId: '/providers/Microsoft.Authorization/policySetDefinitions/...'\n    parameters: {...}\n  }\n}\n"
tags:
- governance
- policy
- positive
nist_controls:
- cm-2
- cm-7
related_ksis:
- KSI-CNA-01
- KSI-CNA-01
ssp_mapping:
  control_family: CM - Configuration Management
  control_numbers:
  - CM-2
  - CM-7
  ssp_sections:
  - section: 'CM-2: Unknown'
    description_template: The system implements Unknown Requirement controls in accordance with FedRAMP 20x requirements. Requirement statement not available... Implementation leverages Azure native services combined with application-level controls and automated monitoring to ensure continuous compliance.
    implementation_details: Azure services including Azure Monitor are configured to enforce compliance requirements. Infrastructure-as-code (Bicep/Terraform) templates ensure consistent deployment across environments. Automated compliance checking in CI/CD pipelines validates all changes against Unknown Requirement requirements before deployment.
    evidence_references:
    - Configuration exports
    - Compliance reports
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-CNA-01
    requirement_name: Restrict Network Traffic
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant bicep implementation of common.governance.azure_policy
    code_sample: "// Bicep compliant configuration for common.governance.azure_policy\nresource compliantResource 'Microsoft.Resources/example@2021-01-01' = {\n  name: 'compliant-resource'\n  properties: {\n    // Compliant configuration\n  }\n}"
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant bicep code violating common.governance.azure_policy
    code_sample: '# Non-compliant code missing common.governance.azure_policy requirements'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts: []
evidence_artifacts:
- artifact_type: configuration
  name: Configuration compliance evidence
  source: Azure Resource Graph
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: logs
  name: Compliance audit logs
  source: Azure Monitor
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: report
  name: Compliance assessment report
  source: Microsoft Defender for Cloud
  frequency: weekly
  retention_months: 36
  format: JSON
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: "# Azure Policy enforcement\n# GitHub Actions\n- name: Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.governance.azure_policy \\\n      --code-path ./src\n\n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'Compliance Validation'\n  inputs:\n    script: |\n      # Validate compliance\n      python validate.py --pattern common.governance.azure_policy\n"
    azure_services:
    - Azure Policy
    - Azure Monitor
    - Microsoft Defender for Cloud
  automation_2:
    description: Continuous monitoring and alerting
    implementation: '# Azure Monitor continuous monitoring

      # Log Analytics Query

      AzureActivity

      | where CategoryValue == "Policy" or CategoryValue == "Security"

      | where ResourceId contains "common.governance.azure_policy"

      | project TimeGenerated, ResourceId, OperationName, ActivityStatusValue

      '
    azure_services:
    - Azure Monitor
    - Log Analytics
    - Azure Alerts
---
pattern_id: common.governance.resource_lock
name: Resource Lock
description: Detects resource locks for change protection
family: COMMON
severity: INFO
pattern_type: resource
languages:
  bicep:
    ast_queries:
    - resource_type: Microsoft.Authorization/locks
      property_path: properties.level
      value: CanNotDelete|ReadOnly
    regex_fallback: Microsoft\.Authorization/locks
    positive_indicators:
    - CanNotDelete
    - ReadOnly
  terraform:
    ast_queries:
    - resource_type: azurerm_management_lock
    regex_fallback: azurerm_management_lock
finding:
  title_template: Resource lock detected
  description_template: Resource has delete or read-only lock. Protects against accidental changes.
  remediation_template: N/A - Positive finding
tags:
- governance
- change-control
- positive
nist_controls:
- cm-3
- cm-5
related_ksis:
- KSI-CNA-01
ssp_mapping:
  control_family: CM - Configuration Management
  control_numbers:
  - CM-3
  - CM-5
  ssp_sections:
  - section: 'CM-3: Unknown'
    description_template: The system implements Unknown Requirement controls in accordance with FedRAMP 20x requirements. Requirement statement not available... Implementation leverages Azure native services combined with application-level controls and automated monitoring to ensure continuous compliance.
    implementation_details: Azure services including Azure Monitor are configured to enforce compliance requirements. Infrastructure-as-code (Bicep/Terraform) templates ensure consistent deployment across environments. Automated compliance checking in CI/CD pipelines validates all changes against Unknown Requirement requirements before deployment.
    evidence_references:
    - Configuration exports
    - Compliance reports
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-CNA-01
    requirement_name: Restrict Network Traffic
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant bicep implementation of common.governance.resource_lock
    code_sample: "// Bicep compliant configuration for common.governance.resource_lock\nresource compliantResource 'Microsoft.Resources/example@2021-01-01' = {\n  name: 'compliant-resource'\n  properties: {\n    // Compliant configuration\n  }\n}"
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant bicep code violating common.governance.resource_lock
    code_sample: '# Non-compliant code missing common.governance.resource_lock requirements'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts: []
evidence_artifacts:
- artifact_type: configuration
  name: Configuration compliance evidence
  source: Azure Resource Graph
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: logs
  name: Compliance audit logs
  source: Azure Monitor
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: report
  name: Compliance assessment report
  source: Microsoft Defender for Cloud
  frequency: weekly
  retention_months: 36
  format: JSON
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: "# Azure Policy enforcement\n# GitHub Actions\n- name: Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.governance.resource_lock \\\n      --code-path ./src\n\n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'Compliance Validation'\n  inputs:\n    script: |\n      # Validate compliance\n      python validate.py --pattern common.governance.resource_lock\n"
    azure_services:
    - Azure Policy
    - Azure Monitor
    - Microsoft Defender for Cloud
  automation_2:
    description: Continuous monitoring and alerting
    implementation: '# Azure Monitor continuous monitoring

      # Log Analytics Query

      AzureActivity

      | where CategoryValue == "Policy" or CategoryValue == "Security"

      | where ResourceId contains "common.governance.resource_lock"

      | project TimeGenerated, ResourceId, OperationName, ActivityStatusValue

      '
    azure_services:
    - Azure Monitor
    - Log Analytics
    - Azure Alerts
---
pattern_id: common.resilience.backup_missing
name: Missing Backup Configuration
description: Detects resources without backup enabled
family: COMMON
severity: HIGH
pattern_type: configuration
languages:
  bicep:
    ast_queries:
    - resource_type: Microsoft.Compute/virtualMachines|Microsoft.Sql/servers/databases
      conditions:
      - not_has_related_resource:Microsoft.RecoveryServices/vaults
    regex_fallback: Microsoft\.(Compute/virtualMachines|Sql/servers/databases)
  terraform:
    ast_queries:
    - resource_type: azurerm_virtual_machine|azurerm_mssql_database
      conditions:
      - not_has_companion_resource:azurerm_backup_protected_vm|azurerm_backup_policy
    regex_fallback: azurerm_(virtual_machine|mssql_database)
finding:
  title_template: Backup not configured
  description_template: Resource does not have backup enabled. FedRAMP requires backup for data availability and resilience.
  remediation_template: "Configure Azure Backup:\n\nBicep:\nresource backupVault 'Microsoft.RecoveryServices/vaults@2021-12-01' = {\n  name: 'backup-vault'\n  location: location\n  sku: {\n    name: 'Standard'\n  }\n  properties: {}\n}\n\nresource backupPolicy 'Microsoft.RecoveryServices/vaults/backupPolicies@2021-12-01' = {\n  parent: backupVault\n  name: 'daily-backup'\n  properties: {\n    backupManagementType: 'AzureIaasVM'\n    schedulePolicy: {\n      scheduleRunFrequency: 'Daily'\n      scheduleRunTimes: ['2023-01-01T02:00:00Z']\n    }\n    retentionPolicy: {\n      dailySchedule: {\n        retentionDuration: {\n          count: 30\n          durationType: 'Days'\n        }\n      }\n    }\n  }\n}\n"
tags:
- resilience
- backup
- security-gap
nist_controls:
- cp-9
- cp-10
related_ksis:
- KSI-RPL-01
- KSI-RPL-02
evidence_artifacts:
- artifact_type: logs
  name: Authentication logs with MFA details
  source: Azure Monitor - SigninLogs
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: configuration
  name: Conditional Access policies export
  source: Microsoft Graph API
  frequency: weekly
  retention_months: 36
  format: JSON
- artifact_type: report
  name: Authentication methods compliance report
  source: Microsoft Graph API
  frequency: weekly
  retention_months: 36
  format: CSV
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: "# Azure Policy for compliance enforcement\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.resilience.backup_missing \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.resilience.backup_missing Validation'\n  inputs:\n    script: |\n      # Validate common.resilience.backup_missing compliance\n      python validate.py --pattern common.resilience.backup_missing"
    azure_services: &id001
    - Availability Zones
    - Azure Backup
    - Azure Blob Storage
    - Azure Monitor
    - Azure Pipelines
    - Azure Site Recovery
    - Log Analytics
  automation_2:
    description: Azure Monitor for continuous monitoring
    implementation: "# Azure Monitor for continuous monitoring\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.resilience.backup_missing \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.resilience.backup_missing Validation'\n  inputs:\n    script: |\n      # Validate common.resilience.backup_missing compliance\n      python validate.py --pattern common.resilience.backup_missing"
    azure_services: *id001
  automation_3:
    description: Log Analytics queries for compliance validation
    implementation: "# Log Analytics queries for compliance validation\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.resilience.backup_missing \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.resilience.backup_missing Validation'\n  inputs:\n    script: |\n      # Validate common.resilience.backup_missing compliance\n      python validate.py --pattern common.resilience.backup_missing"
    azure_services: *id001
implementation:
  prerequisites:
  - Azure subscription with required permissions
  - Microsoft Entra ID tenant configured
  steps:
  - step: 1
    action: Review FedRAMP 20x requirement documentation
    azure_service: null
    validation: Manual verification required
  - step: 2
    action: Identify systems and resources in scope
    azure_service: null
    validation: Manual verification required
  - step: 3
    action: Create resource group for FedRAMP resources
    azure_service: null
    validation: Manual verification required
  - step: 4
    action: Set up Azure Key Vault for secrets management
    azure_service: null
    validation: Manual verification required
  - step: 5
    action: Configure Log Analytics workspace
    azure_service: null
    validation: Manual verification required
  - step: 6
    action: Define Recovery Time Objective (RTO) and Recovery Point Objective (RPO)
    azure_service: null
    validation: Manual verification required
  - step: 7
    action: Document disaster recovery procedures
    azure_service: null
    validation: Manual verification required
  - step: 8
    action: Configure Azure Site Recovery or Azure Backup
    azure_service: null
    validation: Manual verification required
  - step: 9
    action: Set up geo-redundant storage
    azure_service: null
    validation: Manual verification required
  - step: 10
    action: Deploy across availability zones
    azure_service: null
    validation: Manual verification required
  - step: 11
    action: Test disaster recovery procedures
    azure_service: null
    validation: Manual verification required
  - step: 12
    action: Document test results and lessons learned
    azure_service: null
    validation: Manual verification required
  - step: 13
    action: Create Standard Operating Procedures (SOPs)
    azure_service: null
    validation: Manual verification required
  - step: 14
    action: Get policy documentation approved by stakeholders
    azure_service: null
    validation: Manual verification required
  - step: 15
    action: Train staff on new procedures
    azure_service: null
    validation: Manual verification required
  - step: 16
    action: Set up periodic compliance reviews
    azure_service: null
    validation: Manual verification required
  - step: 17
    action: Document evidence collection process
    azure_service: null
    validation: Manual verification required
ssp_mapping:
  control_family: CP - Contingency Planning
  control_numbers:
  - CP-9
  - CP-10
  ssp_sections:
  - section: 'CP-9: Recovery Objectives'
    description_template: The system implements Recovery Objectives controls in accordance with FedRAMP 20x requirements. Define Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).... Implementation leverages Azure native services combined with application-level controls and automated monitoring to ensure continuous compliance.
    implementation_details: Azure services including Availability Zones, Azure Backup, Azure Blob Storage are configured to enforce compliance requirements. Infrastructure-as-code (Bicep/Terraform) templates ensure consistent deployment across environments. Automated compliance checking in CI/CD pipelines validates all changes against Recovery Objectives requirements before deployment.
    evidence_references:
    - Configuration exports
    - Compliance reports
azure_guidance:
  recommended_services:
  - service: Availability Zones
    tier: Standard
    purpose: Required for Availability Zones functionality
    alternatives: []
  - service: Azure Backup
    tier: Standard
    purpose: Required for Azure Backup functionality
    alternatives: []
  - service: Azure Blob Storage
    tier: Standard
    purpose: Required for Azure Blob Storage functionality
    alternatives: []
  - service: Azure Monitor
    tier: Standard
    purpose: Required for Azure Monitor functionality
    alternatives: []
  - service: Azure Pipelines
    tier: Standard
    purpose: Required for Azure Pipelines functionality
    alternatives: []
  well_architected_framework:
    pillar: Security
    design_area: Identity and Access Management
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-RPL-01
    requirement_name: Recovery Objectives
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant bicep implementation of common.resilience.backup_missing
    code_sample: "// Bicep compliant configuration for common.resilience.backup_missing\nresource compliantResource 'Microsoft.Resources/example@2021-01-01' = {\n  name: 'compliant-resource'\n  properties: {\n    // Compliant configuration\n  }\n}"
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant bicep code violating common.resilience.backup_missing
    code_sample: '# Non-compliant code missing common.resilience.backup_missing requirements'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts: []
---
pattern_id: common.resilience.geo_redundancy
name: Geo-Redundant Storage
description: Detects geo-redundancy configuration
family: COMMON
severity: INFO
pattern_type: configuration
languages:
  bicep:
    ast_queries:
    - resource_type: Microsoft.Storage/storageAccounts
      property_path: sku.name
      value: Standard_GRS|Standard_RAGRS|Standard_GZRS
    regex_fallback: sku:\s*\{.*name:\s*'Standard_(GRS|RAGRS|GZRS)'
    positive_indicators:
    - GRS
    - RAGRS
    - GZRS
  terraform:
    ast_queries:
    - resource_type: azurerm_storage_account
      attribute: account_replication_type
      value: GRS|RAGRS|GZRS
    regex_fallback: account_replication_type.*=.*"(GRS|RAGRS|GZRS)"
finding:
  title_template: Geo-redundant storage configured
  description_template: Storage has geo-redundancy for disaster recovery. Verify RPO/RTO meet FedRAMP requirements.
  remediation_template: N/A - Positive finding
tags:
- resilience
- geo-redundancy
- positive
nist_controls:
- cp-6
- cp-9
related_ksis:
- KSI-RPL-01
- KSI-RPL-02
evidence_artifacts:
- artifact_type: logs
  name: Authentication logs with MFA details
  source: Azure Monitor - SigninLogs
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: configuration
  name: Conditional Access policies export
  source: Microsoft Graph API
  frequency: weekly
  retention_months: 36
  format: JSON
- artifact_type: report
  name: Authentication methods compliance report
  source: Microsoft Graph API
  frequency: weekly
  retention_months: 36
  format: CSV
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: "# Azure Policy for compliance enforcement\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.resilience.geo_redundancy \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.resilience.geo_redundancy Validation'\n  inputs:\n    script: |\n      # Validate common.resilience.geo_redundancy compliance\n      python validate.py --pattern common.resilience.geo_redundancy"
    azure_services: &id001
    - Availability Zones
    - Azure Backup
    - Azure Blob Storage
    - Azure Monitor
    - Azure Pipelines
    - Azure Site Recovery
    - Log Analytics
  automation_2:
    description: Azure Monitor for continuous monitoring
    implementation: "# Azure Monitor for continuous monitoring\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.resilience.geo_redundancy \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.resilience.geo_redundancy Validation'\n  inputs:\n    script: |\n      # Validate common.resilience.geo_redundancy compliance\n      python validate.py --pattern common.resilience.geo_redundancy"
    azure_services: *id001
  automation_3:
    description: Log Analytics queries for compliance validation
    implementation: "# Log Analytics queries for compliance validation\n# GitHub Actions\n- name: COMMON Compliance Check\n  run: |\n    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern common.resilience.geo_redundancy \\\n      --code-path ./src\n    \n# Azure Pipelines\n- task: PowerShell@2\n  displayName: 'common.resilience.geo_redundancy Validation'\n  inputs:\n    script: |\n      # Validate common.resilience.geo_redundancy compliance\n      python validate.py --pattern common.resilience.geo_redundancy"
    azure_services: *id001
implementation:
  prerequisites:
  - Azure subscription with required permissions
  - Microsoft Entra ID tenant configured
  steps:
  - step: 1
    action: Review FedRAMP 20x requirement documentation
    azure_service: null
    validation: Manual verification required
  - step: 2
    action: Identify systems and resources in scope
    azure_service: null
    validation: Manual verification required
  - step: 3
    action: Create resource group for FedRAMP resources
    azure_service: null
    validation: Manual verification required
  - step: 4
    action: Set up Azure Key Vault for secrets management
    azure_service: null
    validation: Manual verification required
  - step: 5
    action: Configure Log Analytics workspace
    azure_service: null
    validation: Manual verification required
  - step: 6
    action: Define Recovery Time Objective (RTO) and Recovery Point Objective (RPO)
    azure_service: null
    validation: Manual verification required
  - step: 7
    action: Document disaster recovery procedures
    azure_service: null
    validation: Manual verification required
  - step: 8
    action: Configure Azure Site Recovery or Azure Backup
    azure_service: null
    validation: Manual verification required
  - step: 9
    action: Set up geo-redundant storage
    azure_service: null
    validation: Manual verification required
  - step: 10
    action: Deploy across availability zones
    azure_service: null
    validation: Manual verification required
  - step: 11
    action: Test disaster recovery procedures
    azure_service: null
    validation: Manual verification required
  - step: 12
    action: Document test results and lessons learned
    azure_service: null
    validation: Manual verification required
  - step: 13
    action: Create Standard Operating Procedures (SOPs)
    azure_service: null
    validation: Manual verification required
  - step: 14
    action: Get policy documentation approved by stakeholders
    azure_service: null
    validation: Manual verification required
  - step: 15
    action: Train staff on new procedures
    azure_service: null
    validation: Manual verification required
  - step: 16
    action: Set up periodic compliance reviews
    azure_service: null
    validation: Manual verification required
  - step: 17
    action: Document evidence collection process
    azure_service: null
    validation: Manual verification required
ssp_mapping:
  control_family: CP - Contingency Planning
  control_numbers:
  - CP-6
  - CP-9
  ssp_sections:
  - section: 'CP-6: Recovery Objectives'
    description_template: The system implements Recovery Objectives controls in accordance with FedRAMP 20x requirements. Define Recovery Time Objectives (RTO) and Recovery Point Objectives (RPO).... Implementation leverages Azure native services combined with application-level controls and automated monitoring to ensure continuous compliance.
    implementation_details: Azure services including Availability Zones, Azure Backup, Azure Blob Storage are configured to enforce compliance requirements. Infrastructure-as-code (Bicep/Terraform) templates ensure consistent deployment across environments. Automated compliance checking in CI/CD pipelines validates all changes against Recovery Objectives requirements before deployment.
    evidence_references:
    - Configuration exports
    - Compliance reports
azure_guidance:
  recommended_services:
  - service: Availability Zones
    tier: Standard
    purpose: Required for Availability Zones functionality
    alternatives: []
  - service: Azure Backup
    tier: Standard
    purpose: Required for Azure Backup functionality
    alternatives: []
  - service: Azure Blob Storage
    tier: Standard
    purpose: Required for Azure Blob Storage functionality
    alternatives: []
  - service: Azure Monitor
    tier: Standard
    purpose: Required for Azure Monitor functionality
    alternatives: []
  - service: Azure Pipelines
    tier: Standard
    purpose: Required for Azure Pipelines functionality
    alternatives: []
  well_architected_framework:
    pillar: Security
    design_area: Identity and Access Management
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-RPL-01
    requirement_name: Recovery Objectives
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant bicep implementation of common.resilience.geo_redundancy
    code_sample: "// Bicep compliant configuration for common.resilience.geo_redundancy\nresource compliantResource 'Microsoft.Resources/example@2021-01-01' = {\n  name: 'compliant-resource'\n  properties: {\n    // Compliant configuration\n  }\n}"
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant bicep code violating common.resilience.geo_redundancy
    code_sample: '# Non-compliant code missing common.resilience.geo_redundancy requirements'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts: []
