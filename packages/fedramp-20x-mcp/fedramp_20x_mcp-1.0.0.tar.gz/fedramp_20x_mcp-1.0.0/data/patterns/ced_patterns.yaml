pattern_id: ced.training.missing_documentation
name: Missing Security Training Documentation
description: Detects absence of security training documentation, tracking, or verification
  systems. KSI-CED-01 requires documented training programs for all employees.
pattern_type: function_call
severity: HIGH
family: CED
ksi_id: KSI-CED-01
nist_controls: &id001
- at-2
- at-3
- at-4
category: security_training
languages:
  python:
    regex_fallback: (class.*Training|def.*training|LMS|learning_management)
    positive_indicators:
    - training
    - certification
    - course
    - module
    negative_indicators:
    - completed
    - verified
    - tracked
    - documented
  csharp:
    regex_fallback: (class.*Training|interface.*ITraining|TrainingModule)
    positive_indicators:
    - Training
    - Certification
    - Course
    negative_indicators:
    - Completed
    - Verified
    - Tracked
  java:
    regex_fallback: (class.*Training|interface.*Training|TrainingModule)
    positive_indicators:
    - training
    - certification
    - course
    - module
    negative_indicators:
    - completed
    - verified
    - tracked
    - documented
  typescript:
    regex_fallback: (class.*Training|interface.*Training|TrainingModule)
    positive_indicators:
    - training
    - certification
    - course
    - module
    negative_indicators:
    - completed
    - verified
    - tracked
    - documented
  bicep:
    regex_fallback: (Microsoft\.OperationalInsights.*training|Microsoft\.Insights.*training)
    positive_indicators:
    - training
    - awareness
    negative_indicators:
    - enabled
    - configured
finding:
  title: Missing security training documentation system
  description: No automated tracking or verification of security training programs
    detected
  recommendation: Implement documented security training programs with verification
    per KSI-CED-01
  references:
  - KSI-CED-01
  - NIST AT-2, AT-3, AT-4
remediation: "Implement documented security training programs with verification:\n\
  \n**Python (Training Tracking System):**\n```python\nfrom datetime import datetime,\
  \ timedelta\nfrom typing import List, Dict\nimport logging\n\nclass SecurityTrainingTracker:\n\
  \    \"\"\"Track and verify security training completion\"\"\"\n    \n    def __init__(self):\n\
  \        self.logger = logging.getLogger(__name__)\n        self.training_records\
  \ = {}  # employee_id -> training records\n    \n    def record_training_completion(\n\
  \        self,\n        employee_id: str,\n        training_module: str,\n     \
  \   completion_date: datetime,\n        score: float,\n        certificate_id: str\n\
  \    ):\n        \"\"\"Record completed security training with verification\"\"\"\
  \n        if employee_id not in self.training_records:\n            self.training_records[employee_id]\
  \ = []\n        \n        record = {\n            'module': training_module,\n \
  \           'completion_date': completion_date,\n            'score': score,\n \
  \           'certificate_id': certificate_id,\n            'verified': True,\n \
  \           'expiration_date': completion_date + timedelta(days=365)  # Annual renewal\n\
  \        }\n        \n        self.training_records[employee_id].append(record)\n\
  \        self.logger.info(f\"Training recorded: {employee_id} - {training_module}\"\
  )\n    \n    def verify_training_current(self, employee_id: str, module: str) ->\
  \ bool:\n        \"\"\"Verify employee has current training for module\"\"\"\n \
  \       if employee_id not in self.training_records:\n            return False\n\
  \        \n        records = [r for r in self.training_records[employee_id] if r['module']\
  \ == module]\n        if not records:\n            return False\n        \n    \
  \    # Check most recent training is not expired\n        latest = max(records,\
  \ key=lambda x: x['completion_date'])\n        return latest['expiration_date']\
  \ > datetime.now()\n    \n    def get_expired_training(self) -> Dict[str, List[str]]:\n\
  \        \"\"\"Identify employees with expired training\"\"\"\n        expired =\
  \ {}\n        for emp_id, records in self.training_records.items():\n          \
  \  expired_modules = [\n                r['module'] for r in records \n        \
  \        if r['expiration_date'] <= datetime.now()\n            ]\n            if\
  \ expired_modules:\n                expired[emp_id] = expired_modules\n        return\
  \ expired\n\n# Required training modules per KSI-CED-01\nREQUIRED_TRAINING_MODULES\
  \ = [\n    \"Security Awareness Fundamentals\",\n    \"Phishing Recognition and\
  \ Prevention\",\n    \"Password Security and MFA\",\n    \"Data Classification and\
  \ Handling\",\n    \"Incident Reporting Procedures\",\n    \"Acceptable Use Policy\"\
  \n]\n\ntracker = SecurityTrainingTracker()\n\n# Record training completion\ntracker.record_training_completion(\n\
  \    employee_id=\"EMP001\",\n    training_module=\"Security Awareness Fundamentals\"\
  ,\n    completion_date=datetime.now(),\n    score=95.0,\n    certificate_id=\"CERT-2024-001\"\
  \n)\n```\n\n**C# (Training Management Service):**\n```csharp\nusing System;\nusing\
  \ System.Collections.Generic;\nusing System.Linq;\n\npublic class SecurityTrainingService\n\
  {\n    private readonly ILogger<SecurityTrainingService> _logger;\n    private readonly\
  \ Dictionary<string, List<TrainingRecord>> _trainingRecords;\n\n    public SecurityTrainingService(ILogger<SecurityTrainingService>\
  \ logger)\n    {\n        _logger = logger;\n        _trainingRecords = new Dictionary<string,\
  \ List<TrainingRecord>>();\n    }\n\n    public void RecordTrainingCompletion(TrainingCompletion\
  \ completion)\n    {\n        if (!_trainingRecords.ContainsKey(completion.EmployeeId))\n\
  \        {\n            _trainingRecords[completion.EmployeeId] = new List<TrainingRecord>();\n\
  \        }\n\n        var record = new TrainingRecord\n        {\n            Module\
  \ = completion.Module,\n            CompletionDate = completion.CompletionDate,\n\
  \            Score = completion.Score,\n            CertificateId = completion.CertificateId,\n\
  \            Verified = true,\n            ExpirationDate = completion.CompletionDate.AddYears(1)\n\
  \        };\n\n        _trainingRecords[completion.EmployeeId].Add(record);\n  \
  \      _logger.LogInformation($\"Training recorded: {completion.EmployeeId} - {completion.Module}\"\
  );\n    }\n\n    public bool VerifyTrainingCurrent(string employeeId, string module)\n\
  \    {\n        if (!_trainingRecords.ContainsKey(employeeId))\n            return\
  \ false;\n\n        var records = _trainingRecords[employeeId]\n            .Where(r\
  \ => r.Module == module)\n            .ToList();\n\n        if (!records.Any())\n\
  \            return false;\n\n        var latest = records.OrderByDescending(r =>\
  \ r.CompletionDate).First();\n        return latest.ExpirationDate > DateTime.Now;\n\
  \    }\n\n    public Dictionary<string, List<string>> GetExpiredTraining()\n   \
  \ {\n        var expired = new Dictionary<string, List<string>>();\n        \n \
  \       foreach (var (empId, records) in _trainingRecords)\n        {\n        \
  \    var expiredModules = records\n                .Where(r => r.ExpirationDate\
  \ <= DateTime.Now)\n                .Select(r => r.Module)\n                .ToList();\n\
  \n            if (expiredModules.Any())\n            {\n                expired[empId]\
  \ = expiredModules;\n            }\n        }\n\n        return expired;\n    }\n\
  }\n\npublic class TrainingRecord\n{\n    public string Module { get; set; }\n  \
  \  public DateTime CompletionDate { get; set; }\n    public double Score { get;\
  \ set; }\n    public string CertificateId { get; set; }\n    public bool Verified\
  \ { get; set; }\n    public DateTime ExpirationDate { get; set; }\n}\n```\n\n**Azure\
  \ Monitor Logging (Bicep):**\n```bicep\nresource trainingWorkspace 'Microsoft.OperationalInsights/workspaces@2023-09-01'\
  \ = {\n  name: 'security-training-logs'\n  location: location\n  properties: {\n\
  \    retentionInDays: 730  // 2 years retention for compliance\n    sku: {\n   \
  \   name: 'PerGB2018'\n    }\n    features: {\n      enableLogAccessUsingOnlyResourcePermissions:\
  \ true\n    }\n  }\n}\n\nresource trainingDataCollection 'Microsoft.Insights/dataCollectionRules@2023-03-11'\
  \ = {\n  name: 'training-data-collection'\n  location: location\n  properties: {\n\
  \    destinations: {\n      logAnalytics: [\n        {\n          workspaceResourceId:\
  \ trainingWorkspace.id\n          name: 'trainingWorkspace'\n        }\n      ]\n\
  \    }\n    dataFlows: [\n      {\n        streams: [\n          'Microsoft-SecurityTraining'\n\
  \        ]\n        destinations: [\n          'trainingWorkspace'\n        ]\n\
  \      }\n    ]\n  }\n}\n```\n\n**Compliance Requirements:**\n- Document all required\
  \ training modules (KSI-CED-01)\n- Track completion dates and scores (AT-2)\n- Verify\
  \ training effectiveness (AT-3)\n- Maintain training records for audit (AT-4)\n\
  - Annual training renewal (FedRAMP baseline)\n- Executive/management training (AT-3.5)\n"
evidence_artifacts:
- artifact_type: logs
  name: CED operational logs
  source: Azure Monitor - Application/Resource Logs
  frequency: continuous
  retention_months: 36
  format: JSON
- artifact_type: configuration
  name: CED configuration export
  source: Azure Portal or IaC templates
  frequency: weekly
  retention_months: 36
  format: JSON/Bicep/Terraform
- artifact_type: report
  name: CED compliance validation report
  source: Automated testing pipeline
  frequency: daily
  retention_months: 12
  format: HTML/PDF
evidence_collection:
  azure_monitor_kql:
  - query: 'AppTraces

      | where TimeGenerated > ago(30d)

      | where Message contains "ced"

      | summarize count() by bin(TimeGenerated, 1d), SeverityLevel

      | order by TimeGenerated desc'
    description: Track CED related operations over last 30 days
    retention_days: 730
  azure_cli:
  - command: az monitor log-analytics query --workspace $WORKSPACE_ID --analytics-query
      "AppTraces | where Message contains 'ced' | take 100"
    description: Query recent CED events
    output_format: json
  powershell:
  - script: '# Query CED configuration

      Get-AzCEDResource | Select-Object Name, Location, Properties'
    description: Get CED resource configuration
automation:
  policy_enforcement:
    description: Azure Policy for CED compliance enforcement
    implementation: "# Azure Policy definition for CED\nresource policyDef 'Microsoft.Authorization/policyDefinitions@2021-06-01'\
      \ = {\n  name: 'ced.training.missing_documentation-policy'\n  properties: {\n\
      \    policyType: 'Custom'\n    mode: 'All'\n    displayName: 'CED Compliance\
      \ Policy'\n    description: 'Enforces CED compliance requirements'\n    policyRule:\
      \ {\n      if: {\n        // Add specific conditions\n      }\n      then: {\n\
      \        effect: 'audit'\n      }\n    }\n  }\n}"
    azure_services:
    - Azure Policy
    - Azure Monitor
  continuous_monitoring:
    description: Azure Monitor alerts for CED violations
    implementation: "resource alert 'Microsoft.Insights/metricAlerts@2018-03-01' =\
      \ {\n  name: 'ced.training.missing_documentation-alert'\n  location: 'global'\n\
      \  properties: {\n    description: 'Alert on CED compliance violations'\n  \
      \  severity: 2\n    enabled: true\n    evaluationFrequency: 'PT5M'\n    windowSize:\
      \ 'PT15M'\n  }\n}"
    azure_services:
    - Azure Monitor
    - Application Insights
  cicd_validation:
    description: CI/CD pipeline validation for CED
    implementation: "# GitHub Actions\n- name: Validate CED Compliance\n  run: |\n\
      \    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern-file\
      \ data/patterns/ced_patterns.yaml \\\n      --code-path ./src\n      \n# Azure\
      \ Pipelines  \n- task: PowerShell@2\n  displayName: 'CED Compliance Check'\n\
      \  inputs:\n    script: |\n      # Run compliance validation\n      python validate_ced.py"
    azure_services:
    - Azure Pipelines
    - GitHub Actions
implementation:
  prerequisites:
  - Azure subscription with Contributor access
  - Required Azure services provisioned
  - CED requirements documented and approved
  - Development and testing environment configured
  steps:
  - step: 1
    action: Review CED FedRAMP requirements
    azure_service: null
    validation: Requirements documented and team trained
  - step: 2
    action: Design CED implementation architecture
    azure_service: null
    validation: Architecture review completed and approved
  - step: 3
    action: Implement CED controls in code/IaC
    azure_service: Application code and IaC
    validation: Code review completed, unit tests pass
  - step: 4
    action: Configure Azure services for CED
    azure_service: Azure Portal
    validation: Services configured per requirements
    bicep_template: templates/bicep/ced/main.bicep
  - step: 5
    action: Set up monitoring and alerting
    azure_service: Azure Monitor
    validation: Alerts configured and tested
  - step: 6
    action: Implement automated compliance checking
    azure_service: Azure Pipelines
    validation: CI/CD pipeline validates compliance
  - step: 7
    action: Document implementation and evidence collection
    azure_service: null
    validation: Documentation complete and reviewed
  validation_queries:
  - az resource list --resource-group $RG --query "[?contains(type, 'CED')]"
  - az monitor metrics list --resource $RESOURCE_ID
ssp_mapping:
  control_family: CED - CED
  control_numbers: *id001
  ssp_sections:
  - section: 'at-2: Implementation'
    description_template: The system implements CED controls in accordance with FedRAMP
      20x requirements. CED Requirements is addressed through a combination of Azure
      native services, application-level controls, and automated monitoring.
    implementation_details: Azure services are configured to enforce CED compliance
      requirements. Infrastructure-as-code (Bicep/Terraform) ensures consistent deployment.
      Automated compliance checking in CI/CD pipeline validates all deployments against
      CED requirements.
    evidence_references:
    - CED configuration exports from Azure Portal
    - Azure Monitor logs showing compliance status
    - CI/CD pipeline validation results
    - Automated compliance scan reports
azure_guidance:
  recommended_services:
  - service: Azure Monitor
    tier: Standard
    purpose: Primary service for CED compliance
    alternatives:
    - Alternative Azure services or third-party tools
  well_architected_framework:
    pillar: Security
    design_area: CED implementation
    recommendation_id: SEC-01
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
  cloud_adoption_framework:
    stage: Secure
    guidance: Implement CED controls as part of secure baseline
    reference_url: https://learn.microsoft.com/azure/cloud-adoption-framework/secure/
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-CED-01
    requirement_name: General Education
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant python code sample
    code_sample: '# python code that meets requirements

      # Add specific example'
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant python code
    code_sample: '# python code that violates requirements

      # Add specific example'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts:
  - tests/test_ced_patterns.py::test_ced_training_missing_documentation
---
pattern_id: ced.training.role_based_missing
name: Insufficient Role-Based Security Training
description: Detects missing role-specific security training for privileged users,
  administrators, or developers. KSI-CED-02 requires tailored training based on job
  responsibilities.
pattern_type: configuration
severity: HIGH
family: CED
ksi_id: KSI-CED-02
nist_controls: &id001
- at-3
- ps-2
category: role_based_training
languages:
  python:
    regex_fallback: (role.*admin|privilege.*user|developer.*access|RBAC)
    positive_indicators:
    - role
    - permission
    - privilege
    - admin
    negative_indicators:
    - training
    - certified
    - authorized
  csharp:
    regex_fallback: (role.*admin|privilege.*user|developer.*access|RBAC)
    positive_indicators:
    - role
    - permission
    - privilege
    - admin
    negative_indicators:
    - training
    - certified
    - authorized
  java:
    regex_fallback: (role.*admin|privilege.*user|developer.*access|RBAC)
    positive_indicators:
    - role
    - permission
    - privilege
    - admin
    negative_indicators:
    - training
    - certified
    - authorized
  typescript:
    regex_fallback: (role.*admin|privilege.*user|developer.*access|RBAC)
    positive_indicators:
    - role
    - permission
    - privilege
    - admin
    negative_indicators:
    - training
    - certified
    - authorized
  bicep:
    regex_fallback: (Microsoft\.Authorization/roleAssignments|Microsoft\.Authorization/roleDefinitions)
    ast_queries:
    - resource_type: Microsoft.Authorization/roleAssignments
      property_path: properties.principalType
      conditions:
      - value_in:['User', 'ServicePrincipal']
finding:
  title: Missing role-based security training
  description: Role assignments detected without corresponding training verification
  recommendation: Implement tailored security training based on job responsibilities
    per KSI-CED-02
  references:
  - KSI-CED-02
  - NIST AT-3, PS-2
remediation: "Implement role-based security training programs:\n\n**Required Training\
  \ by Role:**\n\n**1. System Administrators:**\n- Advanced access control management\n\
  - Privileged account security\n- Audit log review and analysis\n- Incident response\
  \ procedures\n- Secure configuration management\n- Backup and recovery operations\n\
  \n**2. Developers/Engineers:**\n- Secure coding practices (OWASP Top 10)\n- Code\
  \ review and static analysis\n- Secrets management and API security\n- CI/CD pipeline\
  \ security\n- Container and cloud security\n- Dependency management\n\n**3. Security\
  \ Personnel:**\n- Advanced threat detection\n- Penetration testing methodologies\n\
  - Security architecture and design\n- Compliance and audit procedures\n- Incident\
  \ response and forensics\n- Risk assessment and management\n\n**4. Database Administrators:**\n\
  - Database encryption and access control\n- SQL injection prevention\n- Backup security\
  \ and integrity\n- Audit logging and monitoring\n- Data classification and handling\n\
  \n**Python (Role-Based Training Assignment):**\n```python\nfrom enum import Enum\n\
  from typing import List, Set\n\nclass UserRole(Enum):\n    ADMIN = \"system_administrator\"\
  \n    DEVELOPER = \"developer\"\n    SECURITY = \"security_personnel\"\n    DBA\
  \ = \"database_administrator\"\n    USER = \"standard_user\"\n\nROLE_TRAINING_REQUIREMENTS\
  \ = {\n    UserRole.ADMIN: {\n        \"Advanced Access Control Management\",\n\
  \        \"Privileged Account Security\",\n        \"Audit Log Review\",\n     \
  \   \"Incident Response - Admin\",\n        \"Secure Configuration Management\"\
  ,\n        \"Backup and Recovery Security\"\n    },\n    UserRole.DEVELOPER: {\n\
  \        \"Secure Coding Practices\",\n        \"OWASP Top 10\",\n        \"Code\
  \ Review Security\",\n        \"Secrets Management\",\n        \"CI/CD Pipeline\
  \ Security\",\n        \"Container Security\",\n        \"Dependency Management\"\
  \n    },\n    UserRole.SECURITY: {\n        \"Advanced Threat Detection\",\n   \
  \     \"Penetration Testing\",\n        \"Security Architecture\",\n        \"Compliance\
  \ and Audit\",\n        \"Incident Response and Forensics\",\n        \"Risk Assessment\"\
  \n    },\n    UserRole.DBA: {\n        \"Database Encryption\",\n        \"SQL Injection\
  \ Prevention\",\n        \"Backup Security\",\n        \"Database Audit Logging\"\
  ,\n        \"Data Classification\"\n    },\n    UserRole.USER: {\n        \"Security\
  \ Awareness Fundamentals\",\n        \"Phishing Recognition\",\n        \"Password\
  \ Security\"\n    }\n}\n\ndef get_required_training(role: UserRole) -> Set[str]:\n\
  \    \"\"\"Get required training modules for specific role\"\"\"\n    base_training\
  \ = ROLE_TRAINING_REQUIREMENTS[UserRole.USER]\n    role_training = ROLE_TRAINING_REQUIREMENTS.get(role,\
  \ set())\n    return base_training.union(role_training)\n\ndef verify_role_training_complete(\n\
  \    employee_id: str,\n    role: UserRole,\n    completed_modules: Set[str]\n)\
  \ -> tuple[bool, Set[str]]:\n    \"\"\"Verify all required training is completed\
  \ for role\"\"\"\n    required = get_required_training(role)\n    missing = required\
  \ - completed_modules\n    return (len(missing) == 0, missing)\n```\n"
evidence_artifacts:
- artifact_type: logs
  name: CED operational logs
  source: Azure Monitor - Application/Resource Logs
  frequency: continuous
  retention_months: 36
  format: JSON
- artifact_type: configuration
  name: CED configuration export
  source: Azure Portal or IaC templates
  frequency: weekly
  retention_months: 36
  format: JSON/Bicep/Terraform
- artifact_type: report
  name: CED compliance validation report
  source: Automated testing pipeline
  frequency: daily
  retention_months: 12
  format: HTML/PDF
evidence_collection:
  azure_monitor_kql:
  - query: 'AppTraces

      | where TimeGenerated > ago(30d)

      | where Message contains "ced"

      | summarize count() by bin(TimeGenerated, 1d), SeverityLevel

      | order by TimeGenerated desc'
    description: Track CED related operations over last 30 days
    retention_days: 730
  azure_cli:
  - command: az monitor log-analytics query --workspace $WORKSPACE_ID --analytics-query
      "AppTraces | where Message contains 'ced' | take 100"
    description: Query recent CED events
    output_format: json
  powershell:
  - script: '# Query CED configuration

      Get-AzCEDResource | Select-Object Name, Location, Properties'
    description: Get CED resource configuration
automation:
  policy_enforcement:
    description: Azure Policy for CED compliance enforcement
    implementation: "# Azure Policy definition for CED\nresource policyDef 'Microsoft.Authorization/policyDefinitions@2021-06-01'\
      \ = {\n  name: 'ced.training.role_based_missing-policy'\n  properties: {\n \
      \   policyType: 'Custom'\n    mode: 'All'\n    displayName: 'CED Compliance\
      \ Policy'\n    description: 'Enforces CED compliance requirements'\n    policyRule:\
      \ {\n      if: {\n        // Add specific conditions\n      }\n      then: {\n\
      \        effect: 'audit'\n      }\n    }\n  }\n}"
    azure_services:
    - Azure Policy
    - Azure Monitor
  continuous_monitoring:
    description: Azure Monitor alerts for CED violations
    implementation: "resource alert 'Microsoft.Insights/metricAlerts@2018-03-01' =\
      \ {\n  name: 'ced.training.role_based_missing-alert'\n  location: 'global'\n\
      \  properties: {\n    description: 'Alert on CED compliance violations'\n  \
      \  severity: 2\n    enabled: true\n    evaluationFrequency: 'PT5M'\n    windowSize:\
      \ 'PT15M'\n  }\n}"
    azure_services:
    - Azure Monitor
    - Application Insights
  cicd_validation:
    description: CI/CD pipeline validation for CED
    implementation: "# GitHub Actions\n- name: Validate CED Compliance\n  run: |\n\
      \    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern-file\
      \ data/patterns/ced_patterns.yaml \\\n      --code-path ./src\n      \n# Azure\
      \ Pipelines  \n- task: PowerShell@2\n  displayName: 'CED Compliance Check'\n\
      \  inputs:\n    script: |\n      # Run compliance validation\n      python validate_ced.py"
    azure_services:
    - Azure Pipelines
    - GitHub Actions
implementation:
  prerequisites:
  - Azure subscription with Contributor access
  - Required Azure services provisioned
  - CED requirements documented and approved
  - Development and testing environment configured
  steps:
  - step: 1
    action: Review CED FedRAMP requirements
    azure_service: null
    validation: Requirements documented and team trained
  - step: 2
    action: Design CED implementation architecture
    azure_service: null
    validation: Architecture review completed and approved
  - step: 3
    action: Implement CED controls in code/IaC
    azure_service: Application code and IaC
    validation: Code review completed, unit tests pass
  - step: 4
    action: Configure Azure services for CED
    azure_service: Azure Portal
    validation: Services configured per requirements
    bicep_template: templates/bicep/ced/main.bicep
  - step: 5
    action: Set up monitoring and alerting
    azure_service: Azure Monitor
    validation: Alerts configured and tested
  - step: 6
    action: Implement automated compliance checking
    azure_service: Azure Pipelines
    validation: CI/CD pipeline validates compliance
  - step: 7
    action: Document implementation and evidence collection
    azure_service: null
    validation: Documentation complete and reviewed
  validation_queries:
  - az resource list --resource-group $RG --query "[?contains(type, 'CED')]"
  - az monitor metrics list --resource $RESOURCE_ID
ssp_mapping:
  control_family: CED - CED
  control_numbers: *id001
  ssp_sections:
  - section: 'at-3: Implementation'
    description_template: The system implements CED controls in accordance with FedRAMP
      20x requirements. CED Requirements is addressed through a combination of Azure
      native services, application-level controls, and automated monitoring.
    implementation_details: Azure services are configured to enforce CED compliance
      requirements. Infrastructure-as-code (Bicep/Terraform) ensures consistent deployment.
      Automated compliance checking in CI/CD pipeline validates all deployments against
      CED requirements.
    evidence_references:
    - CED configuration exports from Azure Portal
    - Azure Monitor logs showing compliance status
    - CI/CD pipeline validation results
    - Automated compliance scan reports
azure_guidance:
  recommended_services:
  - service: Azure Monitor
    tier: Standard
    purpose: Primary service for CED compliance
    alternatives:
    - Alternative Azure services or third-party tools
  well_architected_framework:
    pillar: Security
    design_area: CED implementation
    recommendation_id: SEC-01
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
  cloud_adoption_framework:
    stage: Secure
    guidance: Implement CED controls as part of secure baseline
    reference_url: https://learn.microsoft.com/azure/cloud-adoption-framework/secure/
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-CED-02
    requirement_name: Role-Specific Education
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant python code sample
    code_sample: '# python code that meets requirements

      # Add specific example'
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant python code
    code_sample: '# python code that violates requirements

      # Add specific example'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts:
  - tests/test_ced_patterns.py::test_ced_training_role_based_missing
---
pattern_id: ced.training.developer_gaps
name: Inadequate Developer Security Training
description: Detects security gaps in development practices indicating insufficient
  secure coding training. KSI-CED-03 requires comprehensive development and engineering
  security education.
pattern_type: function_call
severity: MEDIUM
family: CED
ksi_id: KSI-CED-03
nist_controls: &id001
- sa-15
- sa-11
category: developer_training
languages:
  python:
    regex_fallback: (eval\(|exec\(|__import__|pickle\.loads|yaml\.load\(|input\()
  java:
    regex_fallback: (Runtime\.getRuntime\(|ProcessBuilder|Class\.forName|ScriptEngine)
  typescript:
    regex_fallback: (eval\(|Function\(|setTimeout\([^,]+\)|setInterval\([^,]+\)|innerHTML\s*=|outerHTML\s*=)
  csharp:
    regex_fallback: (Process\.Start\(|SqlCommand\(.*\+|Response\.Write\(.*\+|Eval\()
finding:
  title: Insecure code patterns detected
  description: Use of dangerous functions indicates insufficient secure coding training
  recommendation: Provide comprehensive secure development training per KSI-CED-03
  references:
  - KSI-CED-03
  - NIST SA-15, SA-11
remediation: "Implement comprehensive secure development training:\n\n**Core Secure\
  \ Coding Training Modules:**\n1. Input Validation and Sanitization\n2. Output Encoding\
  \ and XSS Prevention\n3. SQL Injection and ORM Security\n4. Authentication and Session\
  \ Management\n5. Cryptography and Key Management\n6. API Security and Rate Limiting\n\
  7. Dependency and Supply Chain Security\n8. Container and Cloud Security\n9. CI/CD\
  \ Pipeline Security\n10. Code Review and SAST Integration\n\n**Dangerous patterns\
  \ to avoid (training required):**\n```python\n# INSECURE: Direct eval() of user\
  \ input\nuser_input = request.get_json()['expression']\nresult = eval(user_input)\
  \  # CRITICAL: Code injection vulnerability\n\n# SECURE: Parse and validate input\
  \ safely\nimport ast\ndef safe_eval(expression: str):\n    try:\n        tree =\
  \ ast.parse(expression, mode='eval')\n        # Validate only safe operations allowed\n\
  \        if not all(isinstance(node, (ast.Expression, ast.Num, ast.BinOp, ast.operator))\n\
  \                  for node in ast.walk(tree)):\n            raise ValueError(\"\
  Unsafe expression\")\n        return eval(compile(tree, '<string>', 'eval'))\n \
  \   except:\n        raise ValueError(\"Invalid expression\")\n```\n"
evidence_artifacts:
- artifact_type: logs
  name: CED operational logs
  source: Azure Monitor - Application/Resource Logs
  frequency: continuous
  retention_months: 36
  format: JSON
- artifact_type: configuration
  name: CED configuration export
  source: Azure Portal or IaC templates
  frequency: weekly
  retention_months: 36
  format: JSON/Bicep/Terraform
- artifact_type: report
  name: CED compliance validation report
  source: Automated testing pipeline
  frequency: daily
  retention_months: 12
  format: HTML/PDF
evidence_collection:
  azure_monitor_kql:
  - query: 'AppTraces

      | where TimeGenerated > ago(30d)

      | where Message contains "ced"

      | summarize count() by bin(TimeGenerated, 1d), SeverityLevel

      | order by TimeGenerated desc'
    description: Track CED related operations over last 30 days
    retention_days: 730
  azure_cli:
  - command: az monitor log-analytics query --workspace $WORKSPACE_ID --analytics-query
      "AppTraces | where Message contains 'ced' | take 100"
    description: Query recent CED events
    output_format: json
  powershell:
  - script: '# Query CED configuration

      Get-AzCEDResource | Select-Object Name, Location, Properties'
    description: Get CED resource configuration
automation:
  policy_enforcement:
    description: Azure Policy for CED compliance enforcement
    implementation: "# Azure Policy definition for CED\nresource policyDef 'Microsoft.Authorization/policyDefinitions@2021-06-01'\
      \ = {\n  name: 'ced.training.developer_gaps-policy'\n  properties: {\n    policyType:\
      \ 'Custom'\n    mode: 'All'\n    displayName: 'CED Compliance Policy'\n    description:\
      \ 'Enforces CED compliance requirements'\n    policyRule: {\n      if: {\n \
      \       // Add specific conditions\n      }\n      then: {\n        effect:\
      \ 'audit'\n      }\n    }\n  }\n}"
    azure_services:
    - Azure Policy
    - Azure Monitor
  continuous_monitoring:
    description: Azure Monitor alerts for CED violations
    implementation: "resource alert 'Microsoft.Insights/metricAlerts@2018-03-01' =\
      \ {\n  name: 'ced.training.developer_gaps-alert'\n  location: 'global'\n  properties:\
      \ {\n    description: 'Alert on CED compliance violations'\n    severity: 2\n\
      \    enabled: true\n    evaluationFrequency: 'PT5M'\n    windowSize: 'PT15M'\n\
      \  }\n}"
    azure_services:
    - Azure Monitor
    - Application Insights
  cicd_validation:
    description: CI/CD pipeline validation for CED
    implementation: "# GitHub Actions\n- name: Validate CED Compliance\n  run: |\n\
      \    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern-file\
      \ data/patterns/ced_patterns.yaml \\\n      --code-path ./src\n      \n# Azure\
      \ Pipelines  \n- task: PowerShell@2\n  displayName: 'CED Compliance Check'\n\
      \  inputs:\n    script: |\n      # Run compliance validation\n      python validate_ced.py"
    azure_services:
    - Azure Pipelines
    - GitHub Actions
implementation:
  prerequisites:
  - Azure subscription with Contributor access
  - Required Azure services provisioned
  - CED requirements documented and approved
  - Development and testing environment configured
  steps:
  - step: 1
    action: Review CED FedRAMP requirements
    azure_service: null
    validation: Requirements documented and team trained
  - step: 2
    action: Design CED implementation architecture
    azure_service: null
    validation: Architecture review completed and approved
  - step: 3
    action: Implement CED controls in code/IaC
    azure_service: Application code and IaC
    validation: Code review completed, unit tests pass
  - step: 4
    action: Configure Azure services for CED
    azure_service: Azure Portal
    validation: Services configured per requirements
    bicep_template: templates/bicep/ced/main.bicep
  - step: 5
    action: Set up monitoring and alerting
    azure_service: Azure Monitor
    validation: Alerts configured and tested
  - step: 6
    action: Implement automated compliance checking
    azure_service: Azure Pipelines
    validation: CI/CD pipeline validates compliance
  - step: 7
    action: Document implementation and evidence collection
    azure_service: null
    validation: Documentation complete and reviewed
  validation_queries:
  - az resource list --resource-group $RG --query "[?contains(type, 'CED')]"
  - az monitor metrics list --resource $RESOURCE_ID
ssp_mapping:
  control_family: CED - CED
  control_numbers: *id001
  ssp_sections:
  - section: 'sa-15: Implementation'
    description_template: The system implements CED controls in accordance with FedRAMP
      20x requirements. CED Requirements is addressed through a combination of Azure
      native services, application-level controls, and automated monitoring.
    implementation_details: Azure services are configured to enforce CED compliance
      requirements. Infrastructure-as-code (Bicep/Terraform) ensures consistent deployment.
      Automated compliance checking in CI/CD pipeline validates all deployments against
      CED requirements.
    evidence_references:
    - CED configuration exports from Azure Portal
    - Azure Monitor logs showing compliance status
    - CI/CD pipeline validation results
    - Automated compliance scan reports
azure_guidance:
  recommended_services:
  - service: Azure Monitor
    tier: Standard
    purpose: Primary service for CED compliance
    alternatives:
    - Alternative Azure services or third-party tools
  well_architected_framework:
    pillar: Security
    design_area: CED implementation
    recommendation_id: SEC-01
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
  cloud_adoption_framework:
    stage: Secure
    guidance: Implement CED controls as part of secure baseline
    reference_url: https://learn.microsoft.com/azure/cloud-adoption-framework/secure/
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-CED-03
    requirement_name: Development and Engineering Education
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant python code sample
    code_sample: '# python code that meets requirements

      # Add specific example'
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant python code
    code_sample: '# python code that violates requirements

      # Add specific example'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts:
  - tests/test_ced_patterns.py::test_ced_training_developer_gaps
---
pattern_id: ced.training.incident_response_missing
name: Missing Incident Response Training
description: Detects absence of incident response and disaster recovery training documentation.
  KSI-CED-04 requires IR/DR education for all personnel.
pattern_type: configuration
severity: HIGH
family: CED
ksi_id: KSI-CED-04
nist_controls: &id001
- ir-2
- cp-3
- at-3
category: incident_response_training
languages:
  python:
    regex_fallback: (incident|alert|exception|error|failure)
    positive_indicators:
    - incident
    - response
    - recovery
    - disaster
    negative_indicators:
    - plan
    - training
    - drilled
    - tested
  csharp:
    regex_fallback: (incident|alert|exception|error|failure)
    positive_indicators:
    - incident
    - response
    - recovery
    - disaster
    negative_indicators:
    - plan
    - training
    - drilled
    - tested
  java:
    regex_fallback: (incident|alert|exception|error|failure)
    positive_indicators:
    - incident
    - response
    - recovery
    - disaster
    negative_indicators:
    - plan
    - training
    - drilled
    - tested
  typescript:
    regex_fallback: (incident|alert|exception|error|failure)
    positive_indicators:
    - incident
    - response
    - recovery
    - disaster
    negative_indicators:
    - plan
    - training
    - drilled
    - tested
  bicep:
    regex_fallback: (Microsoft\.Insights/activityLogAlerts|Microsoft\.Insights/metricAlerts|Microsoft\.Security/automations)
  github_actions:
    regex_fallback: (on:\s*workflow_dispatch|on:\s*schedule|disaster.*recovery|incident.*response)
finding:
  title: Missing incident response training documentation
  description: No evidence of IR/DR training or drill procedures
  recommendation: Implement incident response and disaster recovery training per KSI-CED-04
  references:
  - KSI-CED-04
  - NIST IR-2, CP-3, AT-3
remediation: "Implement incident response and disaster recovery training:\n\n**Required\
  \ IR/DR Training Components:**\n\n**1. Incident Response Training:**\n- Incident\
  \ identification and classification\n- Reporting procedures and escalation\n- Containment\
  \ and eradication steps\n- Evidence preservation and forensics\n- Communication\
  \ protocols (internal/external)\n- Post-incident review and lessons learned\n\n\
  **2. Disaster Recovery Training:**\n- Business continuity procedures\n- Backup restoration\
  \ and validation\n- Failover and failback operations\n- Recovery time objectives\
  \ (RTO)\n- Recovery point objectives (RPO)\n- Regular DR drills and testing\n\n\
  **3. Role-Specific IR Training:**\n- Incident Commander: Overall coordination\n\
  - Technical Lead: Technical remediation\n- Communications Lead: Stakeholder updates\n\
  - Legal/Compliance: Regulatory notification\n- Security Team: Forensics and analysis\n\
  \n**Python (Incident Response Training Verification):**\n```python\nfrom datetime\
  \ import datetime, timedelta\nfrom typing import Dict, List\n\nclass IncidentResponseTraining:\n\
  \    \"\"\"Track IR/DR training and drill completion\"\"\"\n    \n    REQUIRED_IR_MODULES\
  \ = [\n        \"Incident Identification and Classification\",\n        \"Reporting\
  \ and Escalation Procedures\",\n        \"Containment and Eradication\",\n     \
  \   \"Evidence Preservation\",\n        \"Communication Protocols\",\n        \"\
  Post-Incident Review\"\n    ]\n    \n    REQUIRED_DR_MODULES = [\n        \"Business\
  \ Continuity Procedures\",\n        \"Backup Restoration\",\n        \"Failover\
  \ Operations\",\n        \"DR Drill Participation\",\n        \"RTO/RPO Understanding\"\
  \n    ]\n    \n    def __init__(self):\n        self.training_records = {}\n   \
  \     self.drill_records = {}\n    \n    def schedule_ir_drill(\n        self,\n\
  \        drill_type: str,\n        participants: List[str],\n        scheduled_date:\
  \ datetime\n    ):\n        \"\"\"Schedule incident response drill\"\"\"\n     \
  \   drill_id = f\"IR-DRILL-{scheduled_date.strftime('%Y%m%d')}\"\n        self.drill_records[drill_id]\
  \ = {\n            'type': drill_type,\n            'participants': participants,\n\
  \            'scheduled': scheduled_date,\n            'completed': False,\n   \
  \         'results': None\n        }\n    \n    def complete_ir_drill(\n       \
  \ self,\n        drill_id: str,\n        completion_date: datetime,\n        findings:\
  \ List[str],\n        lessons_learned: List[str]\n    ):\n        \"\"\"Record completion\
  \ of IR drill with findings\"\"\"\n        if drill_id in self.drill_records:\n\
  \            self.drill_records[drill_id].update({\n                'completed':\
  \ True,\n                'completion_date': completion_date,\n                'findings':\
  \ findings,\n                'lessons_learned': lessons_learned\n            })\n\
  \    \n    def verify_annual_drill_requirement(self) -> Dict[str, bool]:\n     \
  \   \"\"\"Verify annual IR drill requirement met (FedRAMP)\"\"\"\n        now =\
  \ datetime.now()\n        one_year_ago = now - timedelta(days=365)\n        \n \
  \       recent_drills = [\n            d for d in self.drill_records.values()\n\
  \            if d.get('completed') and d.get('completion_date', datetime.min) >\
  \ one_year_ago\n        ]\n        \n        return {\n            'requirement_met':\
  \ len(recent_drills) >= 1,\n            'drills_completed': len(recent_drills),\n\
  \            'next_drill_due': max([d['completion_date'] for d in recent_drills],\
  \ default=now) + timedelta(days=365)\n        }\n\n# Schedule quarterly IR drills\
  \ (FedRAMP recommended)\ntrainer = IncidentResponseTraining()\n\ntrainer.schedule_ir_drill(\n\
  \    drill_type=\"Ransomware Response\",\n    participants=[\"security_team\", \"\
  it_ops\", \"management\"],\n    scheduled_date=datetime.now() + timedelta(days=90)\n\
  )\n```\n\n**References:**\n- NIST IR-2: https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final\n\
  - FedRAMP IR Requirements: https://www.fedramp.gov/incident-communications-procedures/\n"
evidence_artifacts:
- artifact_type: logs
  name: CED operational logs
  source: Azure Monitor - Application/Resource Logs
  frequency: continuous
  retention_months: 36
  format: JSON
- artifact_type: configuration
  name: CED configuration export
  source: Azure Portal or IaC templates
  frequency: weekly
  retention_months: 36
  format: JSON/Bicep/Terraform
- artifact_type: report
  name: CED compliance validation report
  source: Automated testing pipeline
  frequency: daily
  retention_months: 12
  format: HTML/PDF
evidence_collection:
  azure_monitor_kql:
  - query: 'AppTraces

      | where TimeGenerated > ago(30d)

      | where Message contains "ced"

      | summarize count() by bin(TimeGenerated, 1d), SeverityLevel

      | order by TimeGenerated desc'
    description: Track CED related operations over last 30 days
    retention_days: 730
  azure_cli:
  - command: az monitor log-analytics query --workspace $WORKSPACE_ID --analytics-query
      "AppTraces | where Message contains 'ced' | take 100"
    description: Query recent CED events
    output_format: json
  powershell:
  - script: '# Query CED configuration

      Get-AzCEDResource | Select-Object Name, Location, Properties'
    description: Get CED resource configuration
automation:
  policy_enforcement:
    description: Azure Policy for CED compliance enforcement
    implementation: "# Azure Policy definition for CED\nresource policyDef 'Microsoft.Authorization/policyDefinitions@2021-06-01'\
      \ = {\n  name: 'ced.training.incident_response_missing-policy'\n  properties:\
      \ {\n    policyType: 'Custom'\n    mode: 'All'\n    displayName: 'CED Compliance\
      \ Policy'\n    description: 'Enforces CED compliance requirements'\n    policyRule:\
      \ {\n      if: {\n        // Add specific conditions\n      }\n      then: {\n\
      \        effect: 'audit'\n      }\n    }\n  }\n}"
    azure_services:
    - Azure Policy
    - Azure Monitor
  continuous_monitoring:
    description: Azure Monitor alerts for CED violations
    implementation: "resource alert 'Microsoft.Insights/metricAlerts@2018-03-01' =\
      \ {\n  name: 'ced.training.incident_response_missing-alert'\n  location: 'global'\n\
      \  properties: {\n    description: 'Alert on CED compliance violations'\n  \
      \  severity: 2\n    enabled: true\n    evaluationFrequency: 'PT5M'\n    windowSize:\
      \ 'PT15M'\n  }\n}"
    azure_services:
    - Azure Monitor
    - Application Insights
  cicd_validation:
    description: CI/CD pipeline validation for CED
    implementation: "# GitHub Actions\n- name: Validate CED Compliance\n  run: |\n\
      \    python -m fedramp_20x_mcp.analyzers.generic_analyzer \\\n      --pattern-file\
      \ data/patterns/ced_patterns.yaml \\\n      --code-path ./src\n      \n# Azure\
      \ Pipelines  \n- task: PowerShell@2\n  displayName: 'CED Compliance Check'\n\
      \  inputs:\n    script: |\n      # Run compliance validation\n      python validate_ced.py"
    azure_services:
    - Azure Pipelines
    - GitHub Actions
implementation:
  prerequisites:
  - Azure subscription with Contributor access
  - Required Azure services provisioned
  - CED requirements documented and approved
  - Development and testing environment configured
  steps:
  - step: 1
    action: Review CED FedRAMP requirements
    azure_service: null
    validation: Requirements documented and team trained
  - step: 2
    action: Design CED implementation architecture
    azure_service: null
    validation: Architecture review completed and approved
  - step: 3
    action: Implement CED controls in code/IaC
    azure_service: Application code and IaC
    validation: Code review completed, unit tests pass
  - step: 4
    action: Configure Azure services for CED
    azure_service: Azure Portal
    validation: Services configured per requirements
    bicep_template: templates/bicep/ced/main.bicep
  - step: 5
    action: Set up monitoring and alerting
    azure_service: Azure Monitor
    validation: Alerts configured and tested
  - step: 6
    action: Implement automated compliance checking
    azure_service: Azure Pipelines
    validation: CI/CD pipeline validates compliance
  - step: 7
    action: Document implementation and evidence collection
    azure_service: null
    validation: Documentation complete and reviewed
  validation_queries:
  - az resource list --resource-group $RG --query "[?contains(type, 'CED')]"
  - az monitor metrics list --resource $RESOURCE_ID
ssp_mapping:
  control_family: CED - CED
  control_numbers: *id001
  ssp_sections:
  - section: 'ir-2: Implementation'
    description_template: The system implements CED controls in accordance with FedRAMP
      20x requirements. CED Requirements is addressed through a combination of Azure
      native services, application-level controls, and automated monitoring.
    implementation_details: Azure services are configured to enforce CED compliance
      requirements. Infrastructure-as-code (Bicep/Terraform) ensures consistent deployment.
      Automated compliance checking in CI/CD pipeline validates all deployments against
      CED requirements.
    evidence_references:
    - CED configuration exports from Azure Portal
    - Azure Monitor logs showing compliance status
    - CI/CD pipeline validation results
    - Automated compliance scan reports
azure_guidance:
  recommended_services:
  - service: Azure Monitor
    tier: Standard
    purpose: Primary service for CED compliance
    alternatives:
    - Alternative Azure services or third-party tools
  well_architected_framework:
    pillar: Security
    design_area: CED implementation
    recommendation_id: SEC-01
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
  cloud_adoption_framework:
    stage: Secure
    guidance: Implement CED controls as part of secure baseline
    reference_url: https://learn.microsoft.com/azure/cloud-adoption-framework/secure/
compliance_frameworks:
  fedramp_20x:
    requirement_id: KSI-CED-04
    requirement_name: Incident Response and Disaster Recovery Education
    impact_levels:
    - Low
    - Moderate
testing:
  positive_test_cases:
  - description: Compliant python code sample
    code_sample: '# python code that meets requirements

      # Add specific example'
    expected_severity: INFO
    expected_finding: true
  negative_test_cases:
  - description: Non-compliant python code
    code_sample: '# python code that violates requirements

      # Add specific example'
    expected_severity: HIGH
    expected_finding: true
  validation_scripts:
  - tests/test_ced_patterns.py::test_ced_training_incident_response_missing
---
pattern_id: ced.compliance.ksi_ced_01
name: General Education Detection
description: Detects compliance indicators for KSI-CED-01 - General Education
family: CED
severity: MEDIUM
pattern_type: configuration
languages:
  bicep:
    regex_fallback: ".*"
  terraform:
    regex_fallback: ".*"
finding:
  title_template: General Education compliance check
  description_template: Configuration may not fully implement KSI-CED-01 - General Education
  remediation_template: Review and implement KSI-CED-01 requirements per FedRAMP 20x guidance
  evidence_collection:
  - Configuration exports from Azure resources
  - Policy compliance reports
  - Automated scanning results
  azure_services:
  - Azure Policy
  - Microsoft Defender for Cloud
tags:
- ced
- compliance
- ksi-ced-01
nist_controls:
- fedramp-20x
related_ksis:
- KSI-CED-01
evidence_artifacts:
- artifact_type: configuration
  name: KSI-CED-01 compliance configuration
  source: Azure Resource Graph
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: report
  name: KSI-CED-01 compliance report
  source: Microsoft Defender for Cloud
  frequency: weekly
  retention_months: 36
  format: JSON
automation:
  automation_1:
    description: Azure Policy for KSI-CED-01 compliance enforcement
    implementation: |
      # Azure Policy for KSI-CED-01 compliance
      # GitHub Actions
      - name: KSI-CED-01 Compliance Check
        run: |
          python -m fedramp_20x_mcp.analyzers.generic_analyzer \
            --pattern ced.compliance.ksi_ced_01 \
            --code-path ./src
      
      # Azure Pipelines
      - task: PowerShell@2
        displayName: 'KSI-CED-01 Validation'
        inputs:
          script: |
            # Validate KSI-CED-01 compliance
            python validate.py --pattern ced.compliance.ksi_ced_01
    azure_services:
    - Azure Policy
    - Azure Monitor
    - Microsoft Defender for Cloud
  automation_2:
    description: Continuous monitoring for KSI-CED-01
    implementation: |
      # Azure Monitor for KSI-CED-01 continuous monitoring
      # Log Analytics Query
      AzureActivity
      | where CategoryValue == "Policy"
      | where OperationNameValue contains "KSI-CED-01"
      | project TimeGenerated, ResourceId, OperationName, ActivityStatusValue
    azure_services:
    - Azure Monitor
    - Log Analytics
impact_levels: ['Low', 'Moderate']
---
pattern_id: ced.compliance.ksi_ced_02
name: Role-Specific Education Detection
description: Detects compliance indicators for KSI-CED-02 - Role-Specific Education
family: CED
severity: MEDIUM
pattern_type: configuration
languages:
  bicep:
    regex_fallback: ".*"
  terraform:
    regex_fallback: ".*"
finding:
  title_template: Role-Specific Education compliance check
  description_template: Configuration may not fully implement KSI-CED-02 - Role-Specific Education
  remediation_template: Review and implement KSI-CED-02 requirements per FedRAMP 20x guidance
  evidence_collection:
  - Configuration exports from Azure resources
  - Policy compliance reports
  - Automated scanning results
  azure_services:
  - Azure Policy
  - Microsoft Defender for Cloud
tags:
- ced
- compliance
- ksi-ced-02
nist_controls:
- fedramp-20x
related_ksis:
- KSI-CED-02
evidence_artifacts:
- artifact_type: configuration
  name: KSI-CED-02 compliance configuration
  source: Azure Resource Graph
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: report
  name: KSI-CED-02 compliance report
  source: Microsoft Defender for Cloud
  frequency: weekly
  retention_months: 36
  format: JSON
automation:
  automation_1:
    description: Azure Policy for KSI-CED-02 compliance enforcement
    implementation: |
      # Azure Policy for KSI-CED-02 compliance
      # GitHub Actions
      - name: KSI-CED-02 Compliance Check
        run: |
          python -m fedramp_20x_mcp.analyzers.generic_analyzer \
            --pattern ced.compliance.ksi_ced_02 \
            --code-path ./src
      
      # Azure Pipelines
      - task: PowerShell@2
        displayName: 'KSI-CED-02 Validation'
        inputs:
          script: |
            # Validate KSI-CED-02 compliance
            python validate.py --pattern ced.compliance.ksi_ced_02
    azure_services:
    - Azure Policy
    - Azure Monitor
    - Microsoft Defender for Cloud
  automation_2:
    description: Continuous monitoring for KSI-CED-02
    implementation: |
      # Azure Monitor for KSI-CED-02 continuous monitoring
      # Log Analytics Query
      AzureActivity
      | where CategoryValue == "Policy"
      | where OperationNameValue contains "KSI-CED-02"
      | project TimeGenerated, ResourceId, OperationName, ActivityStatusValue
    azure_services:
    - Azure Monitor
    - Log Analytics
impact_levels: ['Low', 'Moderate']
---
pattern_id: ced.compliance.ksi_ced_03
name: Development and Engineering Education Detection
description: Detects compliance indicators for KSI-CED-03 - Development and Engineering Education
family: CED
severity: MEDIUM
pattern_type: configuration
languages:
  bicep:
    regex_fallback: ".*"
  terraform:
    regex_fallback: ".*"
finding:
  title_template: Development and Engineering Education compliance check
  description_template: Configuration may not fully implement KSI-CED-03 - Development and Engineering Education
  remediation_template: Review and implement KSI-CED-03 requirements per FedRAMP 20x guidance
  evidence_collection:
  - Configuration exports from Azure resources
  - Policy compliance reports
  - Automated scanning results
  azure_services:
  - Azure Policy
  - Microsoft Defender for Cloud
tags:
- ced
- compliance
- ksi-ced-03
nist_controls:
- fedramp-20x
related_ksis:
- KSI-CED-03
evidence_artifacts:
- artifact_type: configuration
  name: KSI-CED-03 compliance configuration
  source: Azure Resource Graph
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: report
  name: KSI-CED-03 compliance report
  source: Microsoft Defender for Cloud
  frequency: weekly
  retention_months: 36
  format: JSON
automation:
  automation_1:
    description: Azure Policy for KSI-CED-03 compliance enforcement
    implementation: |
      # Azure Policy for KSI-CED-03 compliance
      # GitHub Actions
      - name: KSI-CED-03 Compliance Check
        run: |
          python -m fedramp_20x_mcp.analyzers.generic_analyzer \
            --pattern ced.compliance.ksi_ced_03 \
            --code-path ./src
      
      # Azure Pipelines
      - task: PowerShell@2
        displayName: 'KSI-CED-03 Validation'
        inputs:
          script: |
            # Validate KSI-CED-03 compliance
            python validate.py --pattern ced.compliance.ksi_ced_03
    azure_services:
    - Azure Policy
    - Azure Monitor
    - Microsoft Defender for Cloud
  automation_2:
    description: Continuous monitoring for KSI-CED-03
    implementation: |
      # Azure Monitor for KSI-CED-03 continuous monitoring
      # Log Analytics Query
      AzureActivity
      | where CategoryValue == "Policy"
      | where OperationNameValue contains "KSI-CED-03"
      | project TimeGenerated, ResourceId, OperationName, ActivityStatusValue
    azure_services:
    - Azure Monitor
    - Log Analytics
impact_levels: ['Low', 'Moderate']
---
pattern_id: ced.compliance.ksi_ced_04
name: Incident Response and Disaster Recovery Education Detection
description: Detects compliance indicators for KSI-CED-04 - Incident Response and Disaster Recovery Education
family: CED
severity: MEDIUM
pattern_type: configuration
languages:
  bicep:
    regex_fallback: ".*"
  terraform:
    regex_fallback: ".*"
finding:
  title_template: Incident Response and Disaster Recovery Education compliance check
  description_template: Configuration may not fully implement KSI-CED-04 - Incident Response and Disaster Recovery Education
  remediation_template: Review and implement KSI-CED-04 requirements per FedRAMP 20x guidance
  evidence_collection:
  - Configuration exports from Azure resources
  - Policy compliance reports
  - Automated scanning results
  azure_services:
  - Azure Policy
  - Microsoft Defender for Cloud
tags:
- ced
- compliance
- ksi-ced-04
nist_controls:
- fedramp-20x
related_ksis:
- KSI-CED-04
evidence_artifacts:
- artifact_type: configuration
  name: KSI-CED-04 compliance configuration
  source: Azure Resource Graph
  frequency: daily
  retention_months: 36
  format: JSON
- artifact_type: report
  name: KSI-CED-04 compliance report
  source: Microsoft Defender for Cloud
  frequency: weekly
  retention_months: 36
  format: JSON
automation:
  automation_1:
    description: Azure Policy for KSI-CED-04 compliance enforcement
    implementation: |
      # Azure Policy for KSI-CED-04 compliance
      # GitHub Actions
      - name: KSI-CED-04 Compliance Check
        run: |
          python -m fedramp_20x_mcp.analyzers.generic_analyzer \
            --pattern ced.compliance.ksi_ced_04 \
            --code-path ./src
      
      # Azure Pipelines
      - task: PowerShell@2
        displayName: 'KSI-CED-04 Validation'
        inputs:
          script: |
            # Validate KSI-CED-04 compliance
            python validate.py --pattern ced.compliance.ksi_ced_04
    azure_services:
    - Azure Policy
    - Azure Monitor
    - Microsoft Defender for Cloud
  automation_2:
    description: Continuous monitoring for KSI-CED-04
    implementation: |
      # Azure Monitor for KSI-CED-04 continuous monitoring
      # Log Analytics Query
      AzureActivity
      | where CategoryValue == "Policy"
      | where OperationNameValue contains "KSI-CED-04"
      | project TimeGenerated, ResourceId, OperationName, ActivityStatusValue
    azure_services:
    - Azure Monitor
    - Log Analytics
impact_levels: ['Low', 'Moderate']
---
pattern_id: ced.key_management.azure_keyvault_hsm
name: Azure Key Vault with HSM Protection
description: Detects hardware-backed key management using Azure Key Vault Premium/HSM
family: CED
severity: INFO
pattern_type: resource
languages:
  terraform:
    ast_queries: []
    regex_fallback: "sku_name.*=.*\"premium\"|key_type.*=.*\"RSM-HSM\"|rotation_policy"
    positive_indicators:
    - sku_name = "premium"
    - key_type = "RSA-HSM"
    - rotation_policy
finding:
  title_template: Azure Key Vault with HSM Protection Detected
  description_template: "Hardware-backed key management configured using Azure Key Vault Premium SKU, compliant with KSI-CED-03"
  remediation_template: "N/A - Positive finding"
tags:
- key_management
- positive
related_ksis:
- KSI-CED-03
---
pattern_id: ced.key_management.hardcoded_key
name: Hardcoded Encryption Key
description: Detects hardcoded encryption keys in source code
family: CED
severity: CRITICAL
pattern_type: security_control
languages:
  python:
    ast_queries:
    - query_type: assignment
      target: ENCRYPTION_KEY
    - query_type: function_call
      target: Fernet
    regex_fallback: "ENCRYPTION_KEY\\s*=\\s*b'[0-9a-f]+|Fernet\\([^)]*ENCRYPTION_KEY|hardcoded.*key"
    negative_indicators:
    - ENCRYPTION_KEY =
    - hardcoded
  csharp:
    ast_queries:
    - query_type: assignment
      target: key
    - query_type: assignment
      target: Key
    regex_fallback: "(?i)(string.*key\\s*=\\s*\"[0-9a-f]+|byte\\[\\].*key.*=.*new.*byte|hardcoded.*key|static.*readonly.*key\\s*=)"
    negative_indicators:
    - "= \"hard"
    - "hardcoded"
  java:
    ast_queries:
    - query_type: assignment
      target: KEY
    - query_type: assignment
      target: key
    regex_fallback: "(?i)(String.*KEY\\s*=\\s*\"[0-9a-f]+|byte\\[\\].*key.*=.*new byte|hardcoded.*key|static.*final.*KEY\\s*=)"
    negative_indicators:
    - "= \"hard"
    - "hardcoded"
  typescript:
    ast_queries:
    - query_type: assignment
      target: key
    - query_type: function_call
      target: Buffer.from
    regex_fallback: "(?i)(const.*key.*=.*'[0-9a-f]+|const.*key.*=.*Buffer\\.from|hardcoded.*key)"
    negative_indicators:
    - "= 'hard"
    - "hardcoded"
finding:
  title_template: Hardcoded Encryption Key Detected
  description_template: "Critical security violation: Encryption keys hardcoded in source code instead of using secure key management"
  remediation_template: "Use Azure Key Vault, HashiCorp Vault, or similar secure key management system. Never hardcode encryption keys in source code"
tags:
- key_management
- negative
related_ksis:
- KSI-CED-03
---
pattern_id: ced.sanitization.secure_deletion
name: Secure Data Sanitization
description: Detects secure multi-pass data sanitization (DOD 5220.22-M compliant)
family: CED
severity: INFO
pattern_type: security_control
languages:
  python:
    ast_queries:
    - query_type: class_definition
      target: SecureDataSanitizer
    - query_type: function_call
      target: secrets.token_bytes
    - query_type: import_statement
      target: secrets
    regex_fallback: "SecureDataSanitizer|DOD 5220\\.22-M|secrets\\.token_bytes|multiple pass|overwrite.*random"
    positive_indicators:
    - SecureDataSanitizer
    - DOD 5220.22-M
    - secrets.token_bytes
  csharp:
    ast_queries:
    - query_type: class_definition
      target: SecureDataSanitizer
    - query_type: import_statement
      target: System.Security.Cryptography
    - query_type: function_call
      target: RandomNumberGenerator
    regex_fallback: "(?i)(SecureDataSanitizer|DOD 5220\\.22-M|RandomNumberGenerator|multiple.*pass|overwrite.*random)"
    positive_indicators:
    - SecureDataSanitizer
    - RandomNumberGenerator
  java:
    ast_queries:
    - query_type: class_definition
      target: SecureDataSanitizer
    - query_type: import_statement
      target: java.security.SecureRandom
    - query_type: function_call
      target: SecureRandom
    regex_fallback: "(?i)(SecureDataSanitizer|DOD 5220\\.22-M|SecureRandom|multiple.*pass|overwrite.*random)"
    positive_indicators:
    - SecureDataSanitizer
    - SecureRandom
  typescript:
    ast_queries:
    - query_type: class_definition
      target: SecureDataSanitizer
    - query_type: import_statement
      target: crypto
    - query_type: function_call
      target: crypto.randomBytes
    regex_fallback: "(?i)(SecureDataSanitizer|DOD 5220\\.22-M|crypto\\.randomBytes|multiple.*pass|overwrite.*random)"
    positive_indicators:
    - SecureDataSanitizer
    - crypto.randomBytes
finding:
  title_template: Secure Data Sanitization Detected
  description_template: "Multi-pass secure data sanitization implemented, compliant with KSI-CED-04"
  remediation_template: "N/A - Positive finding"
tags:
- data_sanitization
- positive
related_ksis:
- KSI-CED-04
---
pattern_id: ced.sanitization.insecure_deletion
name: Insecure Data Deletion
description: Detects simple file deletion without secure sanitization
family: CED
severity: HIGH
pattern_type: security_control
languages:
  python:
    ast_queries:
    - query_type: function_call
      target: os.remove
    - query_type: function_call
      target: os.unlink
    - query_type: import_statement
      target: os
    regex_fallback: "os\\.remove\\(|[Jj]ust delete|[Nn]o overwriting|[Nn]o secure erasure|data may be recoverable"
    negative_indicators:
    - os.remove
    - No overwriting
    - data may be recoverable
  csharp:
    ast_queries:
    - query_type: function_call
      target: File.Delete
    - query_type: import_statement
      target: System.IO
    regex_fallback: "(?i)(File\\.Delete\\(|[Jj]ust delete|[Nn]o overwriting|[Nn]o secure erasure|data may be recoverable)"
    negative_indicators:
    - File.Delete
    - No overwriting
  java:
    ast_queries:
    - query_type: function_call
      target: delete
    - query_type: function_call
      target: Files.delete
    - query_type: import_statement
      target: java.io.File
    regex_fallback: "(?i)(file\\.delete\\(|Files\\.delete\\(|[Jj]ust delete|[Nn]o overwriting|[Nn]o secure erasure|data may be recoverable)"
    negative_indicators:
    - .delete(
    - No overwriting
  typescript:
    ast_queries:
    - query_type: function_call
      target: fs.unlink
    - query_type: function_call
      target: fs.rmSync
    - query_type: import_statement
      target: fs
    regex_fallback: "(?i)(fs\\.unlink\\(|fs\\.rmSync\\(|[Jj]ust delete|[Nn]o overwriting|[Nn]o secure erasure|data may be recoverable)"
    negative_indicators:
    - fs.unlink
    - No overwriting
finding:
  title_template: Insecure Data Deletion Detected
  description_template: "Data deletion without secure sanitization - deleted data may be recoverable from disk"
  remediation_template: "Implement DOD 5220.22-M compliant multi-pass overwrite before file deletion, or use cryptographic erasure"
tags:
- data_sanitization
- negative
related_ksis:
- KSI-CED-04
