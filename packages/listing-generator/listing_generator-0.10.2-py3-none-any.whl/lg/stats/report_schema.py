# generated by datamodel-codegen:
#   filename:  report.schema.json

from __future__ import annotations

from enum import Enum
from typing import Optional, Union

from pydantic import BaseModel, ConfigDict, conint


class Scope(Enum):
    context = 'context'
    section = 'section'


class Total(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    sizeBytes: conint(ge=0)
    tokensProcessed: conint(ge=0)
    tokensRaw: conint(ge=0)
    savedTokens: int
    savedPct: float
    ctxShare: float
    renderedTokens: Optional[conint(ge=0)] = None
    renderedOverheadTokens: Optional[int] = None
    metaSummary: dict[str, int]


class File(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    path: str
    sizeBytes: conint(ge=0)
    tokensRaw: conint(ge=0)
    tokensProcessed: conint(ge=0)
    savedTokens: int
    savedPct: float
    promptShare: float
    ctxShare: float
    meta: dict[str, Union[str, int, float, bool]]


class Context(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    templateName: str
    sectionsUsed: dict[str, conint(ge=1)]
    finalRenderedTokens: Optional[conint(ge=0)] = None
    templateOnlyTokens: Optional[conint(ge=0)] = None
    templateOverheadPct: Optional[float] = None
    finalCtxShare: Optional[float] = None


class RunResult(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    protocol: conint(ge=1)
    scope: Scope
    target: str
    tokenizerLib: str
    encoder: str
    ctxLimit: conint(ge=1)
    total: Total
    files: list[File]
    context: Optional[Context] = None
