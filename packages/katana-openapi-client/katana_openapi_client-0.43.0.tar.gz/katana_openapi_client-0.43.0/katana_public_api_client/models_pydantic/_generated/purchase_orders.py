"""Auto-generated Pydantic models - purchase_orders domain.

DO NOT EDIT - This file is generated by scripts/generate_pydantic_models.py

To regenerate, run:
    uv run poe generate-pydantic
"""

from __future__ import annotations

from enum import StrEnum
from typing import Annotated, Literal

from pydantic import AwareDatetime, ConfigDict, Field, RootModel

from katana_public_api_client.models_pydantic._base import KatanaPydanticBase

from .base import DeletableEntity, UpdatableEntity
from .common import (
    BillingStatus,
    DistributionMethod,
    EntityType,
    IngredientAvailability2,
    LastDocumentStatus,
    Status2,
    Status3,
    Status4,
)
from .contacts import Supplier
from .stock import (
    BatchTransaction4,
    BatchTransaction5,
    BatchTransaction8,
)


class OutsourcedPurchaseOrderIngredientAvailability(StrEnum):
    processed = "PROCESSED"
    in_stock = "IN_STOCK"
    not_available = "NOT_AVAILABLE"
    expected = "EXPECTED"
    no_recipe = "NO_RECIPE"


class PurchaseOrderRowRequest(KatanaPydanticBase):
    model_config = ConfigDict(
        extra="forbid",
    )
    quantity: Annotated[
        float,
        Field(description="Quantity of items to order for this purchase order line"),
    ]
    price_per_unit: Annotated[
        float, Field(description="Unit price for each item in this purchase order line")
    ]
    variant_id: Annotated[
        int, Field(description="Unique identifier of the product variant being ordered")
    ]
    tax_rate_id: Annotated[
        int | None, Field(description="Tax rate identifier to apply to this line item")
    ] = None
    purchase_uom_conversion_rate: Annotated[
        float | None,
        Field(
            description="Conversion rate between purchase unit of measure and base unit"
        ),
    ] = None
    purchase_uom: Annotated[
        str | None,
        Field(
            description="Unit of measure for purchasing this item (e.g., kg, pieces, liters)"
        ),
    ] = None
    arrival_date: Annotated[
        AwareDatetime | None,
        Field(description="Expected arrival date for this line item"),
    ] = None


class PurchaseOrderRow(UpdatableEntity):
    id: Annotated[
        int | None,
        Field(description="Unique identifier for this purchase order line item"),
    ] = None
    quantity: Annotated[
        float | None, Field(description="The quantity of items for the order line.")
    ] = None
    variant_id: Annotated[
        int | None,
        Field(description="ID of product or material variant added to the order line."),
    ] = None
    tax_rate_id: Annotated[
        int | None, Field(description="ID of tax added to price per unit.")
    ] = None
    price_per_unit: Annotated[
        float | None,
        Field(
            description="The sales price of one unit (excluding taxes) in sales order currency."
        ),
    ] = None
    price_per_unit_in_base_currency: Annotated[
        float | None, Field(description="Unit price converted to the base currency")
    ] = None
    purchase_uom_conversion_rate: Annotated[
        float | None,
        Field(
            description="The conversion rate between the purchase and stock tracking UoMs."
        ),
    ] = None
    purchase_uom: Annotated[
        str | None,
        Field(
            description="The unit used to measure the quantity of the items (e.g. pcs, kg, m) you purchase. It can be different\nfrom the unit used to track stock.\n"
        ),
    ] = None
    currency: Annotated[
        str | None, Field(description="Currency used for this line item pricing")
    ] = None
    conversion_rate: Annotated[
        float | None,
        Field(
            description="Currency rate used to convert from purchase order currency into factory base currency."
        ),
    ] = None
    total: Annotated[
        float | None,
        Field(
            description="The total value of the purchase order row (excluding taxes) in purchase order currency."
        ),
    ] = None
    total_in_base_currency: Annotated[
        float | None,
        Field(
            description="The total value of the purchase order row (excluding taxes) in base currency."
        ),
    ] = None
    conversion_date: Annotated[
        AwareDatetime | None, Field(description="The date of the conversion rate used.")
    ] = None
    received_date: Annotated[
        AwareDatetime | None,
        Field(
            description="The date when the items on the purchase order row were received to your stock."
        ),
    ] = None
    arrival_date: Annotated[
        AwareDatetime | None,
        Field(
            description="The timestamp when the item on the row is expected to arrive (in full) in your warehouse. ISO 8601\nformat with time and timezone must be used.\n"
        ),
    ] = None
    batch_transactions: Annotated[
        list[BatchTransaction4] | None,
        Field(
            description="An array of batch transactions and their quantities. You can receive stock for the same item in multiple\nbatches.\n"
        ),
    ] = None
    purchase_order_id: Annotated[
        int | None, Field(description="Unique identifier of the parent purchase order")
    ] = None
    landed_cost: Annotated[
        str | float | None,
        Field(
            description="Total landed cost including shipping, duties, and other charges",
        ),
    ] = None
    group_id: Annotated[
        int | None, Field(description="Grouping identifier for organizational purposes")
    ] = None


class PurchaseOrderRowListResponse(KatanaPydanticBase):
    data: Annotated[
        list[PurchaseOrderRow] | None,
        Field(description="Array of purchase order line item objects"),
    ] = None


class UpdatePurchaseOrderRequest(KatanaPydanticBase):
    model_config = ConfigDict(
        extra="forbid",
    )
    order_no: Annotated[
        str | None,
        Field(
            description="Updatable only when status is in NOT_RECEIVED or PARTIALLY_RECEIVED",
            min_length=3,
        ),
    ] = None
    supplier_id: Annotated[
        int | None,
        Field(
            description="Updatable only when status is in NOT_RECEIVED", le=2147483647
        ),
    ] = None
    currency: Annotated[
        str | None, Field(description="Updatable only when status is in NOT_RECEIVED")
    ] = None
    tracking_location_id: Annotated[
        int | None,
        Field(
            description="Updatable only when status is in NOT_RECEIVED and entity_type is outsourced",
            le=2147483647,
        ),
    ] = None
    status: Annotated[
        Status4 | None,
        Field(description="Current status indicating progress of order fulfillment"),
    ] = None
    expected_arrival_date: Annotated[
        AwareDatetime | None,
        Field(
            description="Updatable only when status is in NOT_RECEIVED or PARTIALLY_RECEIVED. Update will override arrival_date on purchase order rows"
        ),
    ] = None
    order_created_date: Annotated[
        AwareDatetime | None,
        Field(description="Date when the purchase order was originally created"),
    ] = None
    location_id: Annotated[
        int | None,
        Field(
            description="Updatable only when status is in NOT_RECEIVED", le=2147483647
        ),
    ] = None
    additional_info: Annotated[
        str | None,
        Field(description="Optional notes or special instructions for the supplier"),
    ] = None


class CreatePurchaseOrderAdditionalCostRowRequest(KatanaPydanticBase):
    model_config = ConfigDict(
        extra="forbid",
    )
    additional_cost_id: Annotated[
        int,
        Field(
            description="Unique identifier of the additional cost type (e.g., shipping, duty, handling)"
        ),
    ]
    group_id: Annotated[
        int,
        Field(description="Group identifier for organizing related additional costs"),
    ]
    tax_rate_id: Annotated[
        int, Field(description="Tax rate identifier to apply to this additional cost")
    ]
    price: Annotated[
        float,
        Field(
            description="Amount of the additional cost in the purchase order currency",
            ge=0.0,
            le=1e17,
        ),
    ]
    distribution_method: Annotated[
        DistributionMethod | None,
        Field(
            description="Method for distributing this cost across purchase order items"
        ),
    ] = None


class PurchaseOrderAdditionalCostRow(DeletableEntity):
    id: Annotated[
        int | None,
        Field(description="Unique identifier for this additional cost line item"),
    ] = None
    additional_cost_id: Annotated[
        int | None,
        Field(
            description="Unique identifier of the additional cost type (e.g., shipping, duty, handling)"
        ),
    ] = None
    group_id: Annotated[
        int | None,
        Field(description="Group identifier for organizing related additional costs"),
    ] = None
    name: Annotated[
        str | None, Field(description="Name or description of the additional cost")
    ] = None
    distribution_method: Annotated[
        str | None,
        Field(
            description="Method used for distributing this cost across purchase order items"
        ),
    ] = None
    tax_rate_id: Annotated[
        int | None,
        Field(description="Tax rate identifier applied to this additional cost"),
    ] = None
    tax_rate: Annotated[
        float | None,
        Field(description="Tax rate percentage applied to this additional cost"),
    ] = None
    price: Annotated[
        float | None,
        Field(
            description="Amount of the additional cost in the purchase order currency"
        ),
    ] = None
    price_in_base: Annotated[
        float | None,
        Field(description="Amount of the additional cost converted to base currency"),
    ] = None
    currency: Annotated[
        str | None, Field(description="Currency used for this additional cost")
    ] = None
    currency_conversion_rate: Annotated[
        float | None, Field(description="Exchange rate used for currency conversion")
    ] = None
    currency_conversion_rate_fix_date: Annotated[
        AwareDatetime | None,
        Field(description="Date when the currency conversion rate was fixed"),
    ] = None


class PurchaseOrderAdditionalCostRowListResponse(KatanaPydanticBase):
    data: Annotated[
        list[PurchaseOrderAdditionalCostRow] | None,
        Field(description="Array of additional cost line item objects"),
    ] = None


class UpdatePurchaseOrderAdditionalCostRowRequest(KatanaPydanticBase):
    model_config = ConfigDict(
        extra="forbid",
    )
    additional_cost_id: Annotated[
        int | None,
        Field(
            description="Unique identifier of the additional cost type (e.g., shipping, duty, handling)",
            le=2147483647,
        ),
    ] = None
    tax_rate_id: Annotated[
        int | None,
        Field(
            description="Tax rate identifier to apply to this additional cost",
            le=2147483647,
        ),
    ] = None
    price: Annotated[
        float | None,
        Field(
            description="Updated amount of the additional cost in the purchase order currency",
            ge=0.0,
            le=1e17,
        ),
    ] = None
    distribution_method: Annotated[
        DistributionMethod | None,
        Field(
            description="Method for distributing this cost across purchase order items"
        ),
    ] = None


class PurchaseOrderReceiveRow(KatanaPydanticBase):
    model_config = ConfigDict(
        extra="forbid",
    )
    purchase_order_row_id: Annotated[
        int,
        Field(
            description="Unique identifier of the purchase order row being received",
            le=2147483647,
        ),
    ]
    quantity: Annotated[
        float,
        Field(description="Quantity of items being received for this row", le=1e17),
    ]
    received_date: Annotated[
        AwareDatetime | None,
        Field(description="Optional received date in ISO 8601 format."),
    ] = None
    batch_transactions: Annotated[
        list[BatchTransaction5] | None,
        Field(
            description="Array of batch-specific transactions for this received quantity"
        ),
    ] = None


class PurchaseOrderReceiveRequest1(RootModel[list[PurchaseOrderReceiveRow]]):
    root: Annotated[
        list[PurchaseOrderReceiveRow],
        Field(
            description="Array of receive records for multiple line items",
            examples=[
                [
                    {
                        "purchase_order_row_id": 501,
                        "quantity": 150,
                        "received_date": "2024-02-15T10:00:00Z",
                    },
                    {
                        "purchase_order_row_id": 502,
                        "quantity": 75,
                        "received_date": "2024-02-15T10:00:00Z",
                    },
                ]
            ],
            min_length=1,
        ),
    ]


class PurchaseOrderReceiveRequest(
    RootModel[PurchaseOrderReceiveRequest1 | PurchaseOrderReceiveRow]
):
    root: Annotated[
        PurchaseOrderReceiveRequest1 | PurchaseOrderReceiveRow,
        Field(
            description="Request payload for recording the receipt of purchase order items at the facility",
            examples=[
                [
                    {
                        "purchase_order_row_id": 501,
                        "quantity": 150,
                        "received_date": "2024-02-15T10:00:00Z",
                    },
                    {
                        "purchase_order_row_id": 502,
                        "quantity": 75,
                        "received_date": "2024-02-15T10:00:00Z",
                    },
                ]
            ],
        ),
    ]


class CreatePurchaseOrderRowRequest(KatanaPydanticBase):
    model_config = ConfigDict(
        extra="forbid",
    )
    purchase_order_id: Annotated[
        int,
        Field(
            description="Unique identifier of the purchase order to add this line item to",
            le=2147483647,
        ),
    ]
    quantity: Annotated[
        float,
        Field(description="Quantity of items to order for this line item", le=1e17),
    ]
    variant_id: Annotated[
        int,
        Field(
            description="Unique identifier of the product variant being ordered",
            le=2147483647,
        ),
    ]
    tax_rate_id: Annotated[
        int | None,
        Field(
            description="Tax rate identifier to apply to this line item", le=2147483647
        ),
    ] = None
    group_id: Annotated[
        int | None,
        Field(
            description="Group identifier for organizing related line items",
            le=2147483647,
        ),
    ] = None
    price_per_unit: Annotated[
        float,
        Field(description="Unit price for each item in this line", ge=0.0, le=1e17),
    ]
    purchase_uom_conversion_rate: Annotated[
        float | None,
        Field(
            description="Conversion rate between purchase unit of measure and base unit",
            ge=0.0,
            le=1e17,
        ),
    ] = None
    purchase_uom: Annotated[
        str | None,
        Field(description="Unit of measure for purchasing this item", max_length=7),
    ] = None
    arrival_date: Annotated[
        AwareDatetime | None,
        Field(description="Optional arrival date in ISO 8601 format."),
    ] = None


class UpdatePurchaseOrderRowRequest(KatanaPydanticBase):
    model_config = ConfigDict(
        extra="forbid",
    )
    quantity: Annotated[
        float | None,
        Field(description="Updatable only when received_date is null", le=1e17),
    ] = None
    variant_id: Annotated[
        int | None,
        Field(description="Updatable only when received_date is null", le=2147483647),
    ] = None
    tax_rate_id: Annotated[
        int | None,
        Field(description="Updatable only when received_date is null", le=2147483647),
    ] = None
    group_id: Annotated[
        int | None,
        Field(description="Updatable only when received_date is null", le=2147483647),
    ] = None
    price_per_unit: Annotated[
        float | None,
        Field(description="Updatable only when received_date is null", ge=0.0, le=1e17),
    ] = None
    purchase_uom_conversion_rate: Annotated[
        float | None,
        Field(description="Updatable only when received_date is null", ge=0.0, le=1e17),
    ] = None
    purchase_uom: Annotated[
        str | None,
        Field(description="Updatable only when received_date is null", max_length=7),
    ] = None
    received_date: Annotated[
        AwareDatetime | None, Field(description="Updatable only when already set")
    ] = None
    arrival_date: Annotated[
        AwareDatetime | None,
        Field(description="Updatable only when received_date is not null"),
    ] = None


class PurchaseOrderAccountingMetadata(KatanaPydanticBase):
    id: Annotated[
        int, Field(description="Unique identifier for the accounting metadata record")
    ]
    purchase_order_id: Annotated[
        int | None,
        Field(description="ID of the purchase order linked to the accounting system"),
    ] = None
    purchase_order_id_1: Annotated[
        int,
        Field(
            alias="purchaseOrderId",
            description="Alternative purchase order ID field for accounting system compatibility",
        ),
    ]
    por_received_group_id: Annotated[
        int | None,
        Field(
            alias="porReceivedGroupId",
            description="ID of the received items group for accounting cost allocation",
        ),
    ] = None
    integration_type: Annotated[
        str | None,
        Field(
            alias="integrationType",
            description="Type of accounting system integration (e.g., quickbooks, xero, sage)",
        ),
    ] = None
    bill_id: Annotated[
        str | None,
        Field(
            alias="billId",
            description="Bill identifier in the external accounting system",
        ),
    ] = None
    created_at: Annotated[
        AwareDatetime | None,
        Field(
            alias="createdAt",
            description="Date and time when the accounting metadata was created",
        ),
    ] = None


class PurchaseOrderAccountingMetadataListResponse(KatanaPydanticBase):
    data: Annotated[
        list[PurchaseOrderAccountingMetadata] | None,
        Field(
            description="Array of purchase order accounting metadata objects linking to external financial systems"
        ),
    ] = None


class OutsourcedPurchaseOrderRecipeRow(DeletableEntity):
    id: int | None = None
    purchase_order_id: Annotated[
        int | None, Field(description="The purchase order this recipe row belongs to")
    ] = None
    purchase_order_row_id: Annotated[
        int,
        Field(description="The purchase order row this recipe ingredient is linked to"),
    ]
    ingredient_variant_id: Annotated[
        int, Field(description="The variant of the ingredient material required")
    ]
    planned_quantity_per_unit: Annotated[
        float,
        Field(
            description="The planned quantity of this ingredient per unit of production"
        ),
    ]
    ingredient_availability: Annotated[
        IngredientAvailability2 | None,
        Field(description="Current availability status of this ingredient"),
    ] = None
    ingredient_expected_date: Annotated[
        AwareDatetime | None,
        Field(description="Expected date when this ingredient will be available"),
    ] = None
    notes: Annotated[
        str | None,
        Field(description="Additional notes about this ingredient requirement"),
    ] = None
    batch_transactions: Annotated[
        list[BatchTransaction8] | None,
        Field(description="Batch allocation transactions for this ingredient"),
    ] = None
    cost: Annotated[
        float | None, Field(description="Cost associated with this ingredient")
    ] = None


class CreatePurchaseOrderRequest(KatanaPydanticBase):
    model_config = ConfigDict(
        extra="forbid",
    )
    order_no: Annotated[
        str,
        Field(description="Unique purchase order number for tracking and reference"),
    ]
    entity_type: Annotated[
        EntityType | None,
        Field(
            description="Type of purchase order - regular for materials or outsourced for subcontracted work"
        ),
    ] = None
    supplier_id: Annotated[
        int,
        Field(
            description="Unique identifier of the supplier providing the materials or services",
            le=2147483647,
        ),
    ]
    currency: Annotated[
        str | None,
        Field(
            description="Active ISO 4217 currency code (e.g. USD, EUR).",
            pattern="^[A-Z]{3}$",
        ),
    ] = None
    status: Annotated[
        Status2 | None,
        Field(description="Initial status of the purchase order when created"),
    ] = None
    order_created_date: Annotated[
        AwareDatetime | None,
        Field(description="Date when the purchase order was created"),
    ] = None
    location_id: Annotated[
        int,
        Field(
            description="Primary location where the purchased items will be received and stored",
            le=2147483647,
        ),
    ]
    additional_info: Annotated[
        str | None,
        Field(description="Optional notes or special instructions for the supplier"),
    ] = None
    purchase_order_rows: Annotated[
        list[PurchaseOrderRowRequest],
        Field(
            description="List of line items being ordered, including quantities and pricing",
            min_length=1,
        ),
    ]


class OutsourcedPurchaseOrderRecipeRowListResponse(KatanaPydanticBase):
    data: Annotated[
        list[OutsourcedPurchaseOrderRecipeRow] | None,
        Field(description="List of outsourced purchase order recipe row records"),
    ] = None


class PurchaseOrderBase(DeletableEntity):
    status: Annotated[Status3 | None, Field(description="Status of the order.")] = None
    order_no: Annotated[
        str | None,
        Field(
            description="A unique, identifying string used in the UI and controlled by the user."
        ),
    ] = None
    entity_type: Annotated[
        EntityType | None,
        Field(
            description='Either "regular" or "outsourced", depending on the purchase order type.'
        ),
    ] = None
    default_group_id: Annotated[
        int | None,
        Field(description="Default grouping identifier for organizational purposes"),
    ] = None
    supplier_id: Annotated[
        int | None, Field(description="ID of the supplier who this order belongs to.")
    ] = None
    currency: Annotated[
        str | None,
        Field(
            description="Currency of the purchase order. Filled with supplier currency by default."
        ),
    ] = None
    expected_arrival_date: Annotated[
        AwareDatetime | None,
        Field(
            description="The timestamp when the items are expected to arrive (in full) in your warehouse."
        ),
    ] = None
    order_created_date: Annotated[
        AwareDatetime | None,
        Field(description="The timestamp of creating the document."),
    ] = None
    additional_info: Annotated[
        str | None,
        Field(
            description="A string attached to the object to add any internal comments, links to external files, additional\ninstructions, etc.\n"
        ),
    ] = None
    location_id: Annotated[
        int | None,
        Field(description="The ID of the location to which items are received."),
    ] = None
    total: Annotated[
        float | None,
        Field(
            description="The total value of the order (including taxes) in purchase order currency."
        ),
    ] = None
    total_in_base_currency: Annotated[
        float | None,
        Field(
            description="The total value of the order (including taxes) in base currency."
        ),
    ] = None
    billing_status: Annotated[
        BillingStatus | None,
        Field(
            description='Indicating the status of generating the bill through accounting integration to either Xero or QuickBooks\nOnline. "PARTIALLY_BILLED" does not apply to Xero integration.\n'
        ),
    ] = None
    last_document_status: Annotated[
        LastDocumentStatus | None,
        Field(description="Status of the last e-mail sent from (O)PO card."),
    ] = None
    purchase_order_rows: Annotated[
        list[PurchaseOrderRow] | None,
        Field(description="List of line items in this purchase order"),
    ] = None
    supplier: Annotated[
        Supplier | None,
        Field(description="Complete supplier information for this purchase order"),
    ] = None


class RegularPurchaseOrder(PurchaseOrderBase):
    entity_type: Annotated[
        Literal["regular"], Field(description="Purchase order type identifier")
    ]
    tracking_location_id: Annotated[
        None, Field(description="Regular orders do not have tracking locations")
    ] = None


class OutsourcedPurchaseOrder(PurchaseOrderBase):
    entity_type: Annotated[
        Literal["outsourced"], Field(description="Purchase order type identifier")
    ]
    tracking_location_id: Annotated[
        int,
        Field(
            description="The ID location where the ingredients on the outsourced purchase order are processed"
        ),
    ]
    ingredient_availability: OutsourcedPurchaseOrderIngredientAvailability | None = None
    ingredient_expected_date: Annotated[
        AwareDatetime | None,
        Field(
            description="The latest date of a manufacturing order production deadline or a purchasing order expected arrival date\nthat relates to the required ingredient\n"
        ),
    ] = None


class PurchaseOrderListResponse(KatanaPydanticBase):
    data: Annotated[
        list[RegularPurchaseOrder | OutsourcedPurchaseOrder] | None,
        Field(description="Array of purchase order objects"),
    ] = None
