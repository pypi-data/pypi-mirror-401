# DO NOT EDIT THIS FILE, it is auto-generated!
from jubladb_api.core import base_client
import typing
import datetime

from jubladb_api.generated.entities.keys import *
from jubladb_api.core.base_entity import BaseEntity


from jubladb_api.generated.entities.additional_address import AdditionalAddress

from jubladb_api.generated.entities.additional_email import AdditionalEmail

from jubladb_api.generated.entities.course import Course

from jubladb_api.generated.entities.date import Date

from jubladb_api.generated.entities.event_kind_category import EventKindCategory

from jubladb_api.generated.entities.event_kind import EventKind

from jubladb_api.generated.entities.event import Event

from jubladb_api.generated.entities.group import Group

from jubladb_api.generated.entities.invoice_item import InvoiceItem

from jubladb_api.generated.entities.invoice import Invoice

from jubladb_api.generated.entities.mailing_list import MailingList

from jubladb_api.generated.entities.person_name import PersonName

from jubladb_api.generated.entities.person import Person

from jubladb_api.generated.entities.phone_number import PhoneNumber

from jubladb_api.generated.entities.role import Role

from jubladb_api.generated.entities.self_registration import SelfRegistration

from jubladb_api.generated.entities.social_account import SocialAccount


# @formatter:off


_EventKind_Include = typing.Literal["kind_category",]


_Event_Include = typing.Literal[
    "contact",
    "kind",
    "dates",
]


_Group_Include = typing.Literal[
    "contact",
    "creator",
    "updater",
    "deleter",
    "parent",
    "layer_group",
    "phone_numbers",
    "social_accounts",
    "additional_emails",
    "mailing_lists",
]


_Group_Sort = typing.Literal[
    "name_asc",
    "short_name_asc",
    "display_name_asc",
    "description_asc",
    "layer_asc",
    "parent_id_asc",
    "layer_group_id_asc",
    "type_asc",
    "email_asc",
    "address_asc",
    "zip_code_asc",
    "town_asc",
    "country_asc",
    "require_person_add_requests_asc",
    "self_registration_url_asc",
    "self_registration_require_adult_consent_asc",
    "archived_at_asc",
    "created_at_asc",
    "updated_at_asc",
    "deleted_at_asc",
    "name_desc",
    "short_name_desc",
    "display_name_desc",
    "description_desc",
    "layer_desc",
    "parent_id_desc",
    "layer_group_id_desc",
    "type_desc",
    "email_desc",
    "address_desc",
    "zip_code_desc",
    "town_desc",
    "country_desc",
    "require_person_add_requests_desc",
    "self_registration_url_desc",
    "self_registration_require_adult_consent_desc",
    "archived_at_desc",
    "created_at_desc",
    "updated_at_desc",
    "deleted_at_desc",
]


_Invoice_Include = typing.Literal[
    "group",
    "recipient",
    "invoice_items",
]


_MailingList_Include = typing.Literal["group",]


_MailingList_Sort = typing.Literal[
    "name_asc",
    "group_id_asc",
    "description_asc",
    "publisher_asc",
    "mail_name_asc",
    "additional_sender_asc",
    "subscribable_for_asc",
    "subscribable_mode_asc",
    "subscribers_may_post_asc",
    "anyone_may_post_asc",
    "preferred_labels_asc",
    "delivery_report_asc",
    "main_email_asc",
    "subscribable_asc",
    "name_desc",
    "group_id_desc",
    "description_desc",
    "publisher_desc",
    "mail_name_desc",
    "additional_sender_desc",
    "subscribable_for_desc",
    "subscribable_mode_desc",
    "subscribers_may_post_desc",
    "anyone_may_post_desc",
    "preferred_labels_desc",
    "delivery_report_desc",
    "main_email_desc",
    "subscribable_desc",
]


_Person_Include = typing.Literal[
    "primary_group",
    "layer_group",
    "roles",
    "phone_numbers",
    "social_accounts",
    "additional_emails",
]


_Person_Sort = typing.Literal[
    "first_name_asc",
    "last_name_asc",
    "nickname_asc",
    "company_name_asc",
    "company_asc",
    "email_asc",
    "address_asc",
    "address_care_of_asc",
    "street_asc",
    "housenumber_asc",
    "postbox_asc",
    "zip_code_asc",
    "town_asc",
    "country_asc",
    "primary_group_id_asc",
    "gender_asc",
    "birthday_asc",
    "picture_asc",
    "updated_at_asc",
    "additional_information_asc",
    "language_asc",
    "first_name_desc",
    "last_name_desc",
    "nickname_desc",
    "company_name_desc",
    "company_desc",
    "email_desc",
    "address_desc",
    "address_care_of_desc",
    "street_desc",
    "housenumber_desc",
    "postbox_desc",
    "zip_code_desc",
    "town_desc",
    "country_desc",
    "primary_group_id_desc",
    "gender_desc",
    "birthday_desc",
    "picture_desc",
    "updated_at_desc",
    "additional_information_desc",
    "language_desc",
]


_Role_Include = typing.Literal[
    "person",
    "group",
    "layer_group",
]


_Role_Sort = typing.Literal[
    "created_at_asc",
    "updated_at_asc",
    "start_on_asc",
    "end_on_asc",
    "name_asc",
    "person_id_asc",
    "group_id_asc",
    "type_asc",
    "label_asc",
    "created_at_desc",
    "updated_at_desc",
    "start_on_desc",
    "end_on_desc",
    "name_desc",
    "person_id_desc",
    "group_id_desc",
    "type_desc",
    "label_desc",
]


class Client(base_client.BaseClient):

    def __init__(self, url: str, api_key: str):
        super().__init__(url, {"X-TOKEN": api_key})

    def get_additional_address(
        self,
        id_or_key: int | AdditionalAddressKey,
    ) -> AdditionalAddress:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = AdditionalAddressKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key
        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:
            return cached_entity
        raise ValueError(
            f"no object known for {entity_key}. Entities of type additional_address can only be retrieved by including them while requesting other entities."
        )

    def get_additional_email(
        self,
        id_or_key: int | AdditionalEmailKey,
    ) -> AdditionalEmail:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = AdditionalEmailKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key
        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:
            return cached_entity
        raise ValueError(
            f"no object known for {entity_key}. Entities of type additional_email can only be retrieved by including them while requesting other entities."
        )

    def get_course(
        self,
        id_or_key: int | CourseKey,
    ) -> Course:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = CourseKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key
        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:
            return cached_entity
        raise ValueError(
            f"no object known for {entity_key}. Entities of type course can only be retrieved by including them while requesting other entities."
        )

    def _add_included_of_courses_to_cache(self, json_response: dict) -> None:
        for incl_data in json_response.get("included", []):
            if incl_data["type"] == "people":
                self._cache_add(Person.from_json(incl_data))
            elif incl_data["type"] == "event_kinds":
                self._cache_add(EventKind.from_json(incl_data))
            elif incl_data["type"] == "dates":
                self._cache_add(Date.from_json(incl_data))
            elif incl_data["type"] == "people":
                self._cache_add(Person.from_json(incl_data))

    def get_date(
        self,
        id_or_key: int | DateKey,
    ) -> Date:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = DateKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key
        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:
            return cached_entity
        raise ValueError(
            f"no object known for {entity_key}. Entities of type date can only be retrieved by including them while requesting other entities."
        )

    def _add_included_of_dates_to_cache(self, json_response: dict) -> None:
        for incl_data in json_response.get("included", []):
            if incl_data["type"] == "events":
                self._cache_add(Event.from_json(incl_data))

    def get_event_kind_categories_list(
        self,
    ) -> list[EventKindCategory]:

        filters = []
        filters = [f for f in filters if f[2] is not None]
        json_response = self._request_list("event_kind_category", [], [], filters)

        response_entities = []
        for data_obj in json_response["data"]:
            re = EventKindCategory.from_json(data_obj)
            self._cache_add(re)
            response_entities.append(re)

        return response_entities

    def get_event_kind_category(
        self,
        id_or_key: int | EventKindCategoryKey,
    ) -> EventKindCategory:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = EventKindCategoryKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key

        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:

            return cached_entity

        json_response = self._request_single_get(
            "event_kind_category",
            id_,
        )
        response_entity = EventKindCategory.from_json(json_response["data"])
        if response_entity.key != entity_key:
            raise ValueError("Entity key mismatch")
        self._cache_add(response_entity)

        return response_entity

    def get_event_kinds_list(
        self,
        include: list[_EventKind_Include] | typing.Literal["*"] | None = None,
    ) -> list[EventKind]:

        if include is None:
            include = []
        if include == "*":
            include = [
                "kind_category",
            ]

        filters = []
        filters = [f for f in filters if f[2] is not None]
        json_response = self._request_list("event_kind", [], include, filters)

        response_entities = []
        for data_obj in json_response["data"]:
            re = EventKind.from_json(data_obj)
            self._cache_add(re)
            response_entities.append(re)

        self._add_included_of_event_kinds_to_cache(json_response)

        return response_entities

    def get_event_kind(
        self,
        id_or_key: int | EventKindKey,
        include: list[_EventKind_Include] | typing.Literal["*"] | None = None,
    ) -> EventKind:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = EventKindKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key

        all_includes = [
            "kind_category",
        ]
        if include is None:
            include = []
        if include == "*":
            include = all_includes

        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:

            cached_relations = [
                rel for rel in all_includes if cached_entity.is_relation_loaded(rel)
            ]
            if all(rel in cached_relations for rel in include):
                return cached_entity
            else:
                include.extend(cached_relations)

        json_response = self._request_single_get(
            "event_kind",
            id_,
            include,
        )
        response_entity = EventKind.from_json(json_response["data"])
        if response_entity.key != entity_key:
            raise ValueError("Entity key mismatch")
        self._cache_add(response_entity)

        self._add_included_of_event_kinds_to_cache(json_response)

        return response_entity

    def _add_included_of_event_kinds_to_cache(self, json_response: dict) -> None:
        for incl_data in json_response.get("included", []):
            if incl_data["type"] == "event_kind_categories":
                self._cache_add(EventKindCategory.from_json(incl_data))

    def get_events_list(
        self,
        include: list[_Event_Include] | typing.Literal["*"] | None = None,
        filter_group_id_eq: int | list[int] | None = None,
        filter_group_id_not_eq: int | list[int] | None = None,
        filter_type_eq: str | list[str] | None = None,
        filter_kind_id_eq: int | list[int] | None = None,
        filter_kind_id_not_eq: int | list[int] | None = None,
        filter_kind_id_gt: int | list[int] | None = None,
        filter_kind_id_gte: int | list[int] | None = None,
        filter_kind_id_lt: int | list[int] | None = None,
        filter_kind_id_lte: int | list[int] | None = None,
        filter_updated_at_eq: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_not_eq: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_updated_at_gt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_gte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_updated_at_lt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_lte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
    ) -> list[Event]:

        if include is None:
            include = []
        if include == "*":
            include = [
                "contact",
                "kind",
                "dates",
            ]

        filters = [
            ("group_id", "eq", filter_group_id_eq),
            ("group_id", "not_eq", filter_group_id_not_eq),
            ("type", "eq", filter_type_eq),
            ("kind_id", "eq", filter_kind_id_eq),
            ("kind_id", "not_eq", filter_kind_id_not_eq),
            ("kind_id", "gt", filter_kind_id_gt),
            ("kind_id", "gte", filter_kind_id_gte),
            ("kind_id", "lt", filter_kind_id_lt),
            ("kind_id", "lte", filter_kind_id_lte),
            ("updated_at", "eq", filter_updated_at_eq),
            ("updated_at", "not_eq", filter_updated_at_not_eq),
            ("updated_at", "gt", filter_updated_at_gt),
            ("updated_at", "gte", filter_updated_at_gte),
            ("updated_at", "lt", filter_updated_at_lt),
            ("updated_at", "lte", filter_updated_at_lte),
        ]
        filters = [f for f in filters if f[2] is not None]
        json_response = self._request_list("event", [], include, filters)

        response_entities = []
        for data_obj in json_response["data"]:
            re = Event.from_json(data_obj)
            self._cache_add(re)
            response_entities.append(re)

        self._add_included_of_events_to_cache(json_response)

        return response_entities

    def get_event(
        self,
        id_or_key: int | EventKey,
        include: list[_Event_Include] | typing.Literal["*"] | None = None,
    ) -> Event:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = EventKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key

        all_includes = [
            "contact",
            "kind",
            "dates",
        ]
        if include is None:
            include = []
        if include == "*":
            include = all_includes

        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:

            cached_relations = [
                rel for rel in all_includes if cached_entity.is_relation_loaded(rel)
            ]
            if all(rel in cached_relations for rel in include):
                return cached_entity
            else:
                include.extend(cached_relations)

        json_response = self._request_single_get(
            "event",
            id_,
            include,
        )
        response_entity = Event.from_json(json_response["data"])
        if response_entity.key != entity_key:
            raise ValueError("Entity key mismatch")
        self._cache_add(response_entity)

        self._add_included_of_events_to_cache(json_response)

        return response_entity

    def _add_included_of_events_to_cache(self, json_response: dict) -> None:
        for incl_data in json_response.get("included", []):
            if incl_data["type"] == "people":
                self._cache_add(Person.from_json(incl_data))
            elif incl_data["type"] == "event_kinds":
                self._cache_add(EventKind.from_json(incl_data))
            elif incl_data["type"] == "dates":
                self._cache_add(Date.from_json(incl_data))

    def get_groups_list(
        self,
        include: list[_Group_Include] | typing.Literal["*"] | None = None,
        sort: list[_Group_Sort] | None = None,
        filter_name_eq: str | list[str] | None = None,
        filter_name_not_eq: str | list[str] | None = None,
        filter_name_eql: str | list[str] | None = None,
        filter_name_not_eql: str | list[str] | None = None,
        filter_name_prefix: str | list[str] | None = None,
        filter_name_not_prefix: str | list[str] | None = None,
        filter_name_suffix: str | list[str] | None = None,
        filter_name_not_suffix: str | list[str] | None = None,
        filter_name_match: str | list[str] | None = None,
        filter_name_not_match: str | list[str] | None = None,
        filter_short_name_eq: str | list[str] | None = None,
        filter_short_name_not_eq: str | list[str] | None = None,
        filter_short_name_eql: str | list[str] | None = None,
        filter_short_name_not_eql: str | list[str] | None = None,
        filter_short_name_prefix: str | list[str] | None = None,
        filter_short_name_not_prefix: str | list[str] | None = None,
        filter_short_name_suffix: str | list[str] | None = None,
        filter_short_name_not_suffix: str | list[str] | None = None,
        filter_short_name_match: str | list[str] | None = None,
        filter_short_name_not_match: str | list[str] | None = None,
        filter_display_name_eq: str | list[str] | None = None,
        filter_display_name_not_eq: str | list[str] | None = None,
        filter_display_name_eql: str | list[str] | None = None,
        filter_display_name_not_eql: str | list[str] | None = None,
        filter_display_name_prefix: str | list[str] | None = None,
        filter_display_name_not_prefix: str | list[str] | None = None,
        filter_display_name_suffix: str | list[str] | None = None,
        filter_display_name_not_suffix: str | list[str] | None = None,
        filter_display_name_match: str | list[str] | None = None,
        filter_display_name_not_match: str | list[str] | None = None,
        filter_description_eq: str | list[str] | None = None,
        filter_description_not_eq: str | list[str] | None = None,
        filter_description_eql: str | list[str] | None = None,
        filter_description_not_eql: str | list[str] | None = None,
        filter_description_prefix: str | list[str] | None = None,
        filter_description_not_prefix: str | list[str] | None = None,
        filter_description_suffix: str | list[str] | None = None,
        filter_description_not_suffix: str | list[str] | None = None,
        filter_description_match: str | list[str] | None = None,
        filter_description_not_match: str | list[str] | None = None,
        filter_layer_eq: bool | list[bool] | None = None,
        filter_parent_id_eq: int | list[int] | None = None,
        filter_parent_id_not_eq: int | list[int] | None = None,
        filter_parent_id_gt: int | list[int] | None = None,
        filter_parent_id_gte: int | list[int] | None = None,
        filter_parent_id_lt: int | list[int] | None = None,
        filter_parent_id_lte: int | list[int] | None = None,
        filter_layer_group_id_eq: int | list[int] | None = None,
        filter_layer_group_id_not_eq: int | list[int] | None = None,
        filter_layer_group_id_gt: int | list[int] | None = None,
        filter_layer_group_id_gte: int | list[int] | None = None,
        filter_layer_group_id_lt: int | list[int] | None = None,
        filter_layer_group_id_lte: int | list[int] | None = None,
        filter_type_eq: str | list[str] | None = None,
        filter_type_not_eq: str | list[str] | None = None,
        filter_type_eql: str | list[str] | None = None,
        filter_type_not_eql: str | list[str] | None = None,
        filter_type_prefix: str | list[str] | None = None,
        filter_type_not_prefix: str | list[str] | None = None,
        filter_type_suffix: str | list[str] | None = None,
        filter_type_not_suffix: str | list[str] | None = None,
        filter_type_match: str | list[str] | None = None,
        filter_type_not_match: str | list[str] | None = None,
        filter_email_eq: str | list[str] | None = None,
        filter_email_not_eq: str | list[str] | None = None,
        filter_email_eql: str | list[str] | None = None,
        filter_email_not_eql: str | list[str] | None = None,
        filter_email_prefix: str | list[str] | None = None,
        filter_email_not_prefix: str | list[str] | None = None,
        filter_email_suffix: str | list[str] | None = None,
        filter_email_not_suffix: str | list[str] | None = None,
        filter_email_match: str | list[str] | None = None,
        filter_email_not_match: str | list[str] | None = None,
        filter_address_eq: str | list[str] | None = None,
        filter_address_not_eq: str | list[str] | None = None,
        filter_address_eql: str | list[str] | None = None,
        filter_address_not_eql: str | list[str] | None = None,
        filter_address_prefix: str | list[str] | None = None,
        filter_address_not_prefix: str | list[str] | None = None,
        filter_address_suffix: str | list[str] | None = None,
        filter_address_not_suffix: str | list[str] | None = None,
        filter_address_match: str | list[str] | None = None,
        filter_address_not_match: str | list[str] | None = None,
        filter_zip_code_eq: int | list[int] | None = None,
        filter_zip_code_not_eq: int | list[int] | None = None,
        filter_zip_code_gt: int | list[int] | None = None,
        filter_zip_code_gte: int | list[int] | None = None,
        filter_zip_code_lt: int | list[int] | None = None,
        filter_zip_code_lte: int | list[int] | None = None,
        filter_town_eq: str | list[str] | None = None,
        filter_town_not_eq: str | list[str] | None = None,
        filter_town_eql: str | list[str] | None = None,
        filter_town_not_eql: str | list[str] | None = None,
        filter_town_prefix: str | list[str] | None = None,
        filter_town_not_prefix: str | list[str] | None = None,
        filter_town_suffix: str | list[str] | None = None,
        filter_town_not_suffix: str | list[str] | None = None,
        filter_town_match: str | list[str] | None = None,
        filter_town_not_match: str | list[str] | None = None,
        filter_country_eq: str | list[str] | None = None,
        filter_country_not_eq: str | list[str] | None = None,
        filter_country_eql: str | list[str] | None = None,
        filter_country_not_eql: str | list[str] | None = None,
        filter_country_prefix: str | list[str] | None = None,
        filter_country_not_prefix: str | list[str] | None = None,
        filter_country_suffix: str | list[str] | None = None,
        filter_country_not_suffix: str | list[str] | None = None,
        filter_country_match: str | list[str] | None = None,
        filter_country_not_match: str | list[str] | None = None,
        filter_require_person_add_requests_eq: bool | list[bool] | None = None,
        filter_self_registration_url_eq: str | list[str] | None = None,
        filter_self_registration_url_not_eq: str | list[str] | None = None,
        filter_self_registration_url_eql: str | list[str] | None = None,
        filter_self_registration_url_not_eql: str | list[str] | None = None,
        filter_self_registration_url_prefix: str | list[str] | None = None,
        filter_self_registration_url_not_prefix: str | list[str] | None = None,
        filter_self_registration_url_suffix: str | list[str] | None = None,
        filter_self_registration_url_not_suffix: str | list[str] | None = None,
        filter_self_registration_url_match: str | list[str] | None = None,
        filter_self_registration_url_not_match: str | list[str] | None = None,
        filter_self_registration_require_adult_consent_eq: (
            bool | list[bool] | None
        ) = None,
        filter_archived_at_eq: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_archived_at_not_eq: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_archived_at_gt: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_archived_at_gte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_archived_at_lt: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_archived_at_lte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_created_at_eq: datetime.datetime | list[datetime.datetime] | None = None,
        filter_created_at_not_eq: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_created_at_gt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_created_at_gte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_created_at_lt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_created_at_lte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_updated_at_eq: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_not_eq: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_updated_at_gt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_gte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_updated_at_lt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_lte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_deleted_at_eq: datetime.datetime | list[datetime.datetime] | None = None,
        filter_deleted_at_not_eq: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_deleted_at_gt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_deleted_at_gte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_deleted_at_lt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_deleted_at_lte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
    ) -> list[Group]:

        if include is None:
            include = []
        if include == "*":
            include = [
                "contact",
                "creator",
                "updater",
                "deleter",
                "parent",
                "layer_group",
                "phone_numbers",
                "social_accounts",
                "additional_emails",
                "mailing_lists",
            ]

        filters = [
            ("name", "eq", filter_name_eq),
            ("name", "not_eq", filter_name_not_eq),
            ("name", "eql", filter_name_eql),
            ("name", "not_eql", filter_name_not_eql),
            ("name", "prefix", filter_name_prefix),
            ("name", "not_prefix", filter_name_not_prefix),
            ("name", "suffix", filter_name_suffix),
            ("name", "not_suffix", filter_name_not_suffix),
            ("name", "match", filter_name_match),
            ("name", "not_match", filter_name_not_match),
            ("short_name", "eq", filter_short_name_eq),
            ("short_name", "not_eq", filter_short_name_not_eq),
            ("short_name", "eql", filter_short_name_eql),
            ("short_name", "not_eql", filter_short_name_not_eql),
            ("short_name", "prefix", filter_short_name_prefix),
            ("short_name", "not_prefix", filter_short_name_not_prefix),
            ("short_name", "suffix", filter_short_name_suffix),
            ("short_name", "not_suffix", filter_short_name_not_suffix),
            ("short_name", "match", filter_short_name_match),
            ("short_name", "not_match", filter_short_name_not_match),
            ("display_name", "eq", filter_display_name_eq),
            ("display_name", "not_eq", filter_display_name_not_eq),
            ("display_name", "eql", filter_display_name_eql),
            ("display_name", "not_eql", filter_display_name_not_eql),
            ("display_name", "prefix", filter_display_name_prefix),
            ("display_name", "not_prefix", filter_display_name_not_prefix),
            ("display_name", "suffix", filter_display_name_suffix),
            ("display_name", "not_suffix", filter_display_name_not_suffix),
            ("display_name", "match", filter_display_name_match),
            ("display_name", "not_match", filter_display_name_not_match),
            ("description", "eq", filter_description_eq),
            ("description", "not_eq", filter_description_not_eq),
            ("description", "eql", filter_description_eql),
            ("description", "not_eql", filter_description_not_eql),
            ("description", "prefix", filter_description_prefix),
            ("description", "not_prefix", filter_description_not_prefix),
            ("description", "suffix", filter_description_suffix),
            ("description", "not_suffix", filter_description_not_suffix),
            ("description", "match", filter_description_match),
            ("description", "not_match", filter_description_not_match),
            ("layer", "eq", filter_layer_eq),
            ("parent_id", "eq", filter_parent_id_eq),
            ("parent_id", "not_eq", filter_parent_id_not_eq),
            ("parent_id", "gt", filter_parent_id_gt),
            ("parent_id", "gte", filter_parent_id_gte),
            ("parent_id", "lt", filter_parent_id_lt),
            ("parent_id", "lte", filter_parent_id_lte),
            ("layer_group_id", "eq", filter_layer_group_id_eq),
            ("layer_group_id", "not_eq", filter_layer_group_id_not_eq),
            ("layer_group_id", "gt", filter_layer_group_id_gt),
            ("layer_group_id", "gte", filter_layer_group_id_gte),
            ("layer_group_id", "lt", filter_layer_group_id_lt),
            ("layer_group_id", "lte", filter_layer_group_id_lte),
            ("type", "eq", filter_type_eq),
            ("type", "not_eq", filter_type_not_eq),
            ("type", "eql", filter_type_eql),
            ("type", "not_eql", filter_type_not_eql),
            ("type", "prefix", filter_type_prefix),
            ("type", "not_prefix", filter_type_not_prefix),
            ("type", "suffix", filter_type_suffix),
            ("type", "not_suffix", filter_type_not_suffix),
            ("type", "match", filter_type_match),
            ("type", "not_match", filter_type_not_match),
            ("email", "eq", filter_email_eq),
            ("email", "not_eq", filter_email_not_eq),
            ("email", "eql", filter_email_eql),
            ("email", "not_eql", filter_email_not_eql),
            ("email", "prefix", filter_email_prefix),
            ("email", "not_prefix", filter_email_not_prefix),
            ("email", "suffix", filter_email_suffix),
            ("email", "not_suffix", filter_email_not_suffix),
            ("email", "match", filter_email_match),
            ("email", "not_match", filter_email_not_match),
            ("address", "eq", filter_address_eq),
            ("address", "not_eq", filter_address_not_eq),
            ("address", "eql", filter_address_eql),
            ("address", "not_eql", filter_address_not_eql),
            ("address", "prefix", filter_address_prefix),
            ("address", "not_prefix", filter_address_not_prefix),
            ("address", "suffix", filter_address_suffix),
            ("address", "not_suffix", filter_address_not_suffix),
            ("address", "match", filter_address_match),
            ("address", "not_match", filter_address_not_match),
            ("zip_code", "eq", filter_zip_code_eq),
            ("zip_code", "not_eq", filter_zip_code_not_eq),
            ("zip_code", "gt", filter_zip_code_gt),
            ("zip_code", "gte", filter_zip_code_gte),
            ("zip_code", "lt", filter_zip_code_lt),
            ("zip_code", "lte", filter_zip_code_lte),
            ("town", "eq", filter_town_eq),
            ("town", "not_eq", filter_town_not_eq),
            ("town", "eql", filter_town_eql),
            ("town", "not_eql", filter_town_not_eql),
            ("town", "prefix", filter_town_prefix),
            ("town", "not_prefix", filter_town_not_prefix),
            ("town", "suffix", filter_town_suffix),
            ("town", "not_suffix", filter_town_not_suffix),
            ("town", "match", filter_town_match),
            ("town", "not_match", filter_town_not_match),
            ("country", "eq", filter_country_eq),
            ("country", "not_eq", filter_country_not_eq),
            ("country", "eql", filter_country_eql),
            ("country", "not_eql", filter_country_not_eql),
            ("country", "prefix", filter_country_prefix),
            ("country", "not_prefix", filter_country_not_prefix),
            ("country", "suffix", filter_country_suffix),
            ("country", "not_suffix", filter_country_not_suffix),
            ("country", "match", filter_country_match),
            ("country", "not_match", filter_country_not_match),
            (
                "require_person_add_requests",
                "eq",
                filter_require_person_add_requests_eq,
            ),
            ("self_registration_url", "eq", filter_self_registration_url_eq),
            ("self_registration_url", "not_eq", filter_self_registration_url_not_eq),
            ("self_registration_url", "eql", filter_self_registration_url_eql),
            ("self_registration_url", "not_eql", filter_self_registration_url_not_eql),
            ("self_registration_url", "prefix", filter_self_registration_url_prefix),
            (
                "self_registration_url",
                "not_prefix",
                filter_self_registration_url_not_prefix,
            ),
            ("self_registration_url", "suffix", filter_self_registration_url_suffix),
            (
                "self_registration_url",
                "not_suffix",
                filter_self_registration_url_not_suffix,
            ),
            ("self_registration_url", "match", filter_self_registration_url_match),
            (
                "self_registration_url",
                "not_match",
                filter_self_registration_url_not_match,
            ),
            (
                "self_registration_require_adult_consent",
                "eq",
                filter_self_registration_require_adult_consent_eq,
            ),
            ("archived_at", "eq", filter_archived_at_eq),
            ("archived_at", "not_eq", filter_archived_at_not_eq),
            ("archived_at", "gt", filter_archived_at_gt),
            ("archived_at", "gte", filter_archived_at_gte),
            ("archived_at", "lt", filter_archived_at_lt),
            ("archived_at", "lte", filter_archived_at_lte),
            ("created_at", "eq", filter_created_at_eq),
            ("created_at", "not_eq", filter_created_at_not_eq),
            ("created_at", "gt", filter_created_at_gt),
            ("created_at", "gte", filter_created_at_gte),
            ("created_at", "lt", filter_created_at_lt),
            ("created_at", "lte", filter_created_at_lte),
            ("updated_at", "eq", filter_updated_at_eq),
            ("updated_at", "not_eq", filter_updated_at_not_eq),
            ("updated_at", "gt", filter_updated_at_gt),
            ("updated_at", "gte", filter_updated_at_gte),
            ("updated_at", "lt", filter_updated_at_lt),
            ("updated_at", "lte", filter_updated_at_lte),
            ("deleted_at", "eq", filter_deleted_at_eq),
            ("deleted_at", "not_eq", filter_deleted_at_not_eq),
            ("deleted_at", "gt", filter_deleted_at_gt),
            ("deleted_at", "gte", filter_deleted_at_gte),
            ("deleted_at", "lt", filter_deleted_at_lt),
            ("deleted_at", "lte", filter_deleted_at_lte),
        ]
        filters = [f for f in filters if f[2] is not None]
        json_response = self._request_list("group", sort, include, filters)

        response_entities = []
        for data_obj in json_response["data"]:
            re = Group.from_json(data_obj)
            self._cache_add(re)
            response_entities.append(re)

        self._add_included_of_groups_to_cache(json_response)

        return response_entities

    def get_group(
        self,
        id_or_key: int | GroupKey,
        include: list[_Group_Include] | typing.Literal["*"] | None = None,
    ) -> Group:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = GroupKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key

        all_includes = [
            "contact",
            "creator",
            "updater",
            "deleter",
            "parent",
            "layer_group",
            "phone_numbers",
            "social_accounts",
            "additional_emails",
            "mailing_lists",
        ]
        if include is None:
            include = []
        if include == "*":
            include = all_includes

        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:

            cached_relations = [
                rel for rel in all_includes if cached_entity.is_relation_loaded(rel)
            ]
            if all(rel in cached_relations for rel in include):
                return cached_entity
            else:
                include.extend(cached_relations)

        json_response = self._request_single_get(
            "group",
            id_,
            include,
        )
        response_entity = Group.from_json(json_response["data"])
        if response_entity.key != entity_key:
            raise ValueError("Entity key mismatch")
        self._cache_add(response_entity)

        self._add_included_of_groups_to_cache(json_response)

        return response_entity

    def _add_included_of_groups_to_cache(self, json_response: dict) -> None:
        for incl_data in json_response.get("included", []):
            if incl_data["type"] == "people":
                self._cache_add(Person.from_json(incl_data))
            elif incl_data["type"] == "people":
                self._cache_add(Person.from_json(incl_data))
            elif incl_data["type"] == "people":
                self._cache_add(Person.from_json(incl_data))
            elif incl_data["type"] == "people":
                self._cache_add(Person.from_json(incl_data))
            elif incl_data["type"] == "groups":
                self._cache_add(Group.from_json(incl_data))
            elif incl_data["type"] == "groups":
                self._cache_add(Group.from_json(incl_data))
            elif incl_data["type"] == "phone_numbers":
                self._cache_add(PhoneNumber.from_json(incl_data))
            elif incl_data["type"] == "social_accounts":
                self._cache_add(SocialAccount.from_json(incl_data))
            elif incl_data["type"] == "additional_emails":
                self._cache_add(AdditionalEmail.from_json(incl_data))
            elif incl_data["type"] == "mailing_lists":
                self._cache_add(MailingList.from_json(incl_data))

    def get_invoice_item(
        self,
        id_or_key: int | InvoiceItemKey,
    ) -> InvoiceItem:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = InvoiceItemKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key
        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:
            return cached_entity
        raise ValueError(
            f"no object known for {entity_key}. Entities of type invoice_item can only be retrieved by including them while requesting other entities."
        )

    def _add_included_of_invoice_items_to_cache(self, json_response: dict) -> None:
        for incl_data in json_response.get("included", []):
            if incl_data["type"] == "invoices":
                self._cache_add(Invoice.from_json(incl_data))

    def get_invoices_list(
        self,
        include: list[_Invoice_Include] | typing.Literal["*"] | None = None,
        filter_group_id_eq: int | list[int] | None = None,
        filter_group_id_not_eq: int | list[int] | None = None,
        filter_group_id_gt: int | list[int] | None = None,
        filter_group_id_gte: int | list[int] | None = None,
        filter_group_id_lt: int | list[int] | None = None,
        filter_group_id_lte: int | list[int] | None = None,
        filter_recipient_id_eq: int | list[int] | None = None,
        filter_recipient_id_not_eq: int | list[int] | None = None,
        filter_recipient_id_gt: int | list[int] | None = None,
        filter_recipient_id_gte: int | list[int] | None = None,
        filter_recipient_id_lt: int | list[int] | None = None,
        filter_recipient_id_lte: int | list[int] | None = None,
    ) -> list[Invoice]:

        if include is None:
            include = []
        if include == "*":
            include = [
                "group",
                "recipient",
                "invoice_items",
            ]

        filters = [
            ("group_id", "eq", filter_group_id_eq),
            ("group_id", "not_eq", filter_group_id_not_eq),
            ("group_id", "gt", filter_group_id_gt),
            ("group_id", "gte", filter_group_id_gte),
            ("group_id", "lt", filter_group_id_lt),
            ("group_id", "lte", filter_group_id_lte),
            ("recipient_id", "eq", filter_recipient_id_eq),
            ("recipient_id", "not_eq", filter_recipient_id_not_eq),
            ("recipient_id", "gt", filter_recipient_id_gt),
            ("recipient_id", "gte", filter_recipient_id_gte),
            ("recipient_id", "lt", filter_recipient_id_lt),
            ("recipient_id", "lte", filter_recipient_id_lte),
        ]
        filters = [f for f in filters if f[2] is not None]
        json_response = self._request_list("invoice", [], include, filters)

        response_entities = []
        for data_obj in json_response["data"]:
            re = Invoice.from_json(data_obj)
            self._cache_add(re)
            response_entities.append(re)

        self._add_included_of_invoices_to_cache(json_response)

        return response_entities

    def get_invoice(
        self,
        id_or_key: int | InvoiceKey,
        include: list[_Invoice_Include] | typing.Literal["*"] | None = None,
    ) -> Invoice:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = InvoiceKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key

        all_includes = [
            "group",
            "recipient",
            "invoice_items",
        ]
        if include is None:
            include = []
        if include == "*":
            include = all_includes

        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:

            cached_relations = [
                rel for rel in all_includes if cached_entity.is_relation_loaded(rel)
            ]
            if all(rel in cached_relations for rel in include):
                return cached_entity
            else:
                include.extend(cached_relations)

        json_response = self._request_single_get(
            "invoice",
            id_,
            include,
        )
        response_entity = Invoice.from_json(json_response["data"])
        if response_entity.key != entity_key:
            raise ValueError("Entity key mismatch")
        self._cache_add(response_entity)

        self._add_included_of_invoices_to_cache(json_response)

        return response_entity

    def _add_included_of_invoices_to_cache(self, json_response: dict) -> None:
        for incl_data in json_response.get("included", []):
            if incl_data["type"] == "groups":
                self._cache_add(Group.from_json(incl_data))
            elif incl_data["type"] == "people":
                self._cache_add(Person.from_json(incl_data))
            elif incl_data["type"] == "invoice_items":
                self._cache_add(InvoiceItem.from_json(incl_data))

    def get_mailing_lists_list(
        self,
        include: list[_MailingList_Include] | typing.Literal["*"] | None = None,
        sort: list[_MailingList_Sort] | None = None,
        filter_name_eq: str | list[str] | None = None,
        filter_name_not_eq: str | list[str] | None = None,
        filter_name_eql: str | list[str] | None = None,
        filter_name_not_eql: str | list[str] | None = None,
        filter_name_prefix: str | list[str] | None = None,
        filter_name_not_prefix: str | list[str] | None = None,
        filter_name_suffix: str | list[str] | None = None,
        filter_name_not_suffix: str | list[str] | None = None,
        filter_name_match: str | list[str] | None = None,
        filter_name_not_match: str | list[str] | None = None,
        filter_group_id_eq: int | list[int] | None = None,
        filter_group_id_not_eq: int | list[int] | None = None,
        filter_group_id_gt: int | list[int] | None = None,
        filter_group_id_gte: int | list[int] | None = None,
        filter_group_id_lt: int | list[int] | None = None,
        filter_group_id_lte: int | list[int] | None = None,
        filter_description_eq: str | list[str] | None = None,
        filter_description_not_eq: str | list[str] | None = None,
        filter_description_eql: str | list[str] | None = None,
        filter_description_not_eql: str | list[str] | None = None,
        filter_description_prefix: str | list[str] | None = None,
        filter_description_not_prefix: str | list[str] | None = None,
        filter_description_suffix: str | list[str] | None = None,
        filter_description_not_suffix: str | list[str] | None = None,
        filter_description_match: str | list[str] | None = None,
        filter_description_not_match: str | list[str] | None = None,
        filter_publisher_eq: str | list[str] | None = None,
        filter_publisher_not_eq: str | list[str] | None = None,
        filter_publisher_eql: str | list[str] | None = None,
        filter_publisher_not_eql: str | list[str] | None = None,
        filter_publisher_prefix: str | list[str] | None = None,
        filter_publisher_not_prefix: str | list[str] | None = None,
        filter_publisher_suffix: str | list[str] | None = None,
        filter_publisher_not_suffix: str | list[str] | None = None,
        filter_publisher_match: str | list[str] | None = None,
        filter_publisher_not_match: str | list[str] | None = None,
        filter_mail_name_eq: str | list[str] | None = None,
        filter_mail_name_not_eq: str | list[str] | None = None,
        filter_mail_name_eql: str | list[str] | None = None,
        filter_mail_name_not_eql: str | list[str] | None = None,
        filter_mail_name_prefix: str | list[str] | None = None,
        filter_mail_name_not_prefix: str | list[str] | None = None,
        filter_mail_name_suffix: str | list[str] | None = None,
        filter_mail_name_not_suffix: str | list[str] | None = None,
        filter_mail_name_match: str | list[str] | None = None,
        filter_mail_name_not_match: str | list[str] | None = None,
        filter_additional_sender_eq: str | list[str] | None = None,
        filter_additional_sender_not_eq: str | list[str] | None = None,
        filter_additional_sender_eql: str | list[str] | None = None,
        filter_additional_sender_not_eql: str | list[str] | None = None,
        filter_additional_sender_prefix: str | list[str] | None = None,
        filter_additional_sender_not_prefix: str | list[str] | None = None,
        filter_additional_sender_suffix: str | list[str] | None = None,
        filter_additional_sender_not_suffix: str | list[str] | None = None,
        filter_additional_sender_match: str | list[str] | None = None,
        filter_additional_sender_not_match: str | list[str] | None = None,
        filter_subscribable_for_eq: str | list[str] | None = None,
        filter_subscribable_for_not_eq: str | list[str] | None = None,
        filter_subscribable_for_eql: str | list[str] | None = None,
        filter_subscribable_for_not_eql: str | list[str] | None = None,
        filter_subscribable_for_prefix: str | list[str] | None = None,
        filter_subscribable_for_not_prefix: str | list[str] | None = None,
        filter_subscribable_for_suffix: str | list[str] | None = None,
        filter_subscribable_for_not_suffix: str | list[str] | None = None,
        filter_subscribable_for_match: str | list[str] | None = None,
        filter_subscribable_for_not_match: str | list[str] | None = None,
        filter_subscribable_mode_eq: str | list[str] | None = None,
        filter_subscribable_mode_not_eq: str | list[str] | None = None,
        filter_subscribable_mode_eql: str | list[str] | None = None,
        filter_subscribable_mode_not_eql: str | list[str] | None = None,
        filter_subscribable_mode_prefix: str | list[str] | None = None,
        filter_subscribable_mode_not_prefix: str | list[str] | None = None,
        filter_subscribable_mode_suffix: str | list[str] | None = None,
        filter_subscribable_mode_not_suffix: str | list[str] | None = None,
        filter_subscribable_mode_match: str | list[str] | None = None,
        filter_subscribable_mode_not_match: str | list[str] | None = None,
        filter_subscribers_may_post_eq: bool | list[bool] | None = None,
        filter_anyone_may_post_eq: bool | list[bool] | None = None,
        filter_preferred_labels_eq: str | list[str] | None = None,
        filter_delivery_report_eq: bool | list[bool] | None = None,
        filter_main_email_eq: str | list[str] | None = None,
        filter_main_email_not_eq: str | list[str] | None = None,
        filter_main_email_eql: str | list[str] | None = None,
        filter_main_email_not_eql: str | list[str] | None = None,
        filter_main_email_prefix: str | list[str] | None = None,
        filter_main_email_not_prefix: str | list[str] | None = None,
        filter_main_email_suffix: str | list[str] | None = None,
        filter_main_email_not_suffix: str | list[str] | None = None,
        filter_main_email_match: str | list[str] | None = None,
        filter_main_email_not_match: str | list[str] | None = None,
        filter_subscribable_eq: bool | list[bool] | None = None,
    ) -> list[MailingList]:

        if include is None:
            include = []
        if include == "*":
            include = [
                "group",
            ]

        filters = [
            ("name", "eq", filter_name_eq),
            ("name", "not_eq", filter_name_not_eq),
            ("name", "eql", filter_name_eql),
            ("name", "not_eql", filter_name_not_eql),
            ("name", "prefix", filter_name_prefix),
            ("name", "not_prefix", filter_name_not_prefix),
            ("name", "suffix", filter_name_suffix),
            ("name", "not_suffix", filter_name_not_suffix),
            ("name", "match", filter_name_match),
            ("name", "not_match", filter_name_not_match),
            ("group_id", "eq", filter_group_id_eq),
            ("group_id", "not_eq", filter_group_id_not_eq),
            ("group_id", "gt", filter_group_id_gt),
            ("group_id", "gte", filter_group_id_gte),
            ("group_id", "lt", filter_group_id_lt),
            ("group_id", "lte", filter_group_id_lte),
            ("description", "eq", filter_description_eq),
            ("description", "not_eq", filter_description_not_eq),
            ("description", "eql", filter_description_eql),
            ("description", "not_eql", filter_description_not_eql),
            ("description", "prefix", filter_description_prefix),
            ("description", "not_prefix", filter_description_not_prefix),
            ("description", "suffix", filter_description_suffix),
            ("description", "not_suffix", filter_description_not_suffix),
            ("description", "match", filter_description_match),
            ("description", "not_match", filter_description_not_match),
            ("publisher", "eq", filter_publisher_eq),
            ("publisher", "not_eq", filter_publisher_not_eq),
            ("publisher", "eql", filter_publisher_eql),
            ("publisher", "not_eql", filter_publisher_not_eql),
            ("publisher", "prefix", filter_publisher_prefix),
            ("publisher", "not_prefix", filter_publisher_not_prefix),
            ("publisher", "suffix", filter_publisher_suffix),
            ("publisher", "not_suffix", filter_publisher_not_suffix),
            ("publisher", "match", filter_publisher_match),
            ("publisher", "not_match", filter_publisher_not_match),
            ("mail_name", "eq", filter_mail_name_eq),
            ("mail_name", "not_eq", filter_mail_name_not_eq),
            ("mail_name", "eql", filter_mail_name_eql),
            ("mail_name", "not_eql", filter_mail_name_not_eql),
            ("mail_name", "prefix", filter_mail_name_prefix),
            ("mail_name", "not_prefix", filter_mail_name_not_prefix),
            ("mail_name", "suffix", filter_mail_name_suffix),
            ("mail_name", "not_suffix", filter_mail_name_not_suffix),
            ("mail_name", "match", filter_mail_name_match),
            ("mail_name", "not_match", filter_mail_name_not_match),
            ("additional_sender", "eq", filter_additional_sender_eq),
            ("additional_sender", "not_eq", filter_additional_sender_not_eq),
            ("additional_sender", "eql", filter_additional_sender_eql),
            ("additional_sender", "not_eql", filter_additional_sender_not_eql),
            ("additional_sender", "prefix", filter_additional_sender_prefix),
            ("additional_sender", "not_prefix", filter_additional_sender_not_prefix),
            ("additional_sender", "suffix", filter_additional_sender_suffix),
            ("additional_sender", "not_suffix", filter_additional_sender_not_suffix),
            ("additional_sender", "match", filter_additional_sender_match),
            ("additional_sender", "not_match", filter_additional_sender_not_match),
            ("subscribable_for", "eq", filter_subscribable_for_eq),
            ("subscribable_for", "not_eq", filter_subscribable_for_not_eq),
            ("subscribable_for", "eql", filter_subscribable_for_eql),
            ("subscribable_for", "not_eql", filter_subscribable_for_not_eql),
            ("subscribable_for", "prefix", filter_subscribable_for_prefix),
            ("subscribable_for", "not_prefix", filter_subscribable_for_not_prefix),
            ("subscribable_for", "suffix", filter_subscribable_for_suffix),
            ("subscribable_for", "not_suffix", filter_subscribable_for_not_suffix),
            ("subscribable_for", "match", filter_subscribable_for_match),
            ("subscribable_for", "not_match", filter_subscribable_for_not_match),
            ("subscribable_mode", "eq", filter_subscribable_mode_eq),
            ("subscribable_mode", "not_eq", filter_subscribable_mode_not_eq),
            ("subscribable_mode", "eql", filter_subscribable_mode_eql),
            ("subscribable_mode", "not_eql", filter_subscribable_mode_not_eql),
            ("subscribable_mode", "prefix", filter_subscribable_mode_prefix),
            ("subscribable_mode", "not_prefix", filter_subscribable_mode_not_prefix),
            ("subscribable_mode", "suffix", filter_subscribable_mode_suffix),
            ("subscribable_mode", "not_suffix", filter_subscribable_mode_not_suffix),
            ("subscribable_mode", "match", filter_subscribable_mode_match),
            ("subscribable_mode", "not_match", filter_subscribable_mode_not_match),
            ("subscribers_may_post", "eq", filter_subscribers_may_post_eq),
            ("anyone_may_post", "eq", filter_anyone_may_post_eq),
            ("preferred_labels", "eq", filter_preferred_labels_eq),
            ("delivery_report", "eq", filter_delivery_report_eq),
            ("main_email", "eq", filter_main_email_eq),
            ("main_email", "not_eq", filter_main_email_not_eq),
            ("main_email", "eql", filter_main_email_eql),
            ("main_email", "not_eql", filter_main_email_not_eql),
            ("main_email", "prefix", filter_main_email_prefix),
            ("main_email", "not_prefix", filter_main_email_not_prefix),
            ("main_email", "suffix", filter_main_email_suffix),
            ("main_email", "not_suffix", filter_main_email_not_suffix),
            ("main_email", "match", filter_main_email_match),
            ("main_email", "not_match", filter_main_email_not_match),
            ("subscribable", "eq", filter_subscribable_eq),
        ]
        filters = [f for f in filters if f[2] is not None]
        json_response = self._request_list("mailing_list", sort, include, filters)

        response_entities = []
        for data_obj in json_response["data"]:
            re = MailingList.from_json(data_obj)
            self._cache_add(re)
            response_entities.append(re)

        self._add_included_of_mailing_lists_to_cache(json_response)

        return response_entities

    def get_mailing_list(
        self,
        id_or_key: int | MailingListKey,
        include: list[_MailingList_Include] | typing.Literal["*"] | None = None,
    ) -> MailingList:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = MailingListKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key

        all_includes = [
            "group",
        ]
        if include is None:
            include = []
        if include == "*":
            include = all_includes

        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:

            cached_relations = [
                rel for rel in all_includes if cached_entity.is_relation_loaded(rel)
            ]
            if all(rel in cached_relations for rel in include):
                return cached_entity
            else:
                include.extend(cached_relations)

        json_response = self._request_single_get(
            "mailing_list",
            id_,
            include,
        )
        response_entity = MailingList.from_json(json_response["data"])
        if response_entity.key != entity_key:
            raise ValueError("Entity key mismatch")
        self._cache_add(response_entity)

        self._add_included_of_mailing_lists_to_cache(json_response)

        return response_entity

    def _add_included_of_mailing_lists_to_cache(self, json_response: dict) -> None:
        for incl_data in json_response.get("included", []):
            if incl_data["type"] == "groups":
                self._cache_add(Group.from_json(incl_data))

    def get_person_name(
        self,
        id_or_key: int | PersonNameKey,
    ) -> PersonName:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = PersonNameKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key
        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:
            return cached_entity
        raise ValueError(
            f"no object known for {entity_key}. Entities of type person_name can only be retrieved by including them while requesting other entities."
        )

    def get_people_list(
        self,
        include: list[_Person_Include] | typing.Literal["*"] | None = None,
        sort: list[_Person_Sort] | None = None,
        filter_first_name_eq: str | list[str] | None = None,
        filter_first_name_not_eq: str | list[str] | None = None,
        filter_first_name_eql: str | list[str] | None = None,
        filter_first_name_not_eql: str | list[str] | None = None,
        filter_first_name_prefix: str | list[str] | None = None,
        filter_first_name_not_prefix: str | list[str] | None = None,
        filter_first_name_suffix: str | list[str] | None = None,
        filter_first_name_not_suffix: str | list[str] | None = None,
        filter_first_name_match: str | list[str] | None = None,
        filter_first_name_not_match: str | list[str] | None = None,
        filter_last_name_eq: str | list[str] | None = None,
        filter_last_name_not_eq: str | list[str] | None = None,
        filter_last_name_eql: str | list[str] | None = None,
        filter_last_name_not_eql: str | list[str] | None = None,
        filter_last_name_prefix: str | list[str] | None = None,
        filter_last_name_not_prefix: str | list[str] | None = None,
        filter_last_name_suffix: str | list[str] | None = None,
        filter_last_name_not_suffix: str | list[str] | None = None,
        filter_last_name_match: str | list[str] | None = None,
        filter_last_name_not_match: str | list[str] | None = None,
        filter_nickname_eq: str | list[str] | None = None,
        filter_nickname_not_eq: str | list[str] | None = None,
        filter_nickname_eql: str | list[str] | None = None,
        filter_nickname_not_eql: str | list[str] | None = None,
        filter_nickname_prefix: str | list[str] | None = None,
        filter_nickname_not_prefix: str | list[str] | None = None,
        filter_nickname_suffix: str | list[str] | None = None,
        filter_nickname_not_suffix: str | list[str] | None = None,
        filter_nickname_match: str | list[str] | None = None,
        filter_nickname_not_match: str | list[str] | None = None,
        filter_company_name_eq: str | list[str] | None = None,
        filter_company_name_not_eq: str | list[str] | None = None,
        filter_company_name_eql: str | list[str] | None = None,
        filter_company_name_not_eql: str | list[str] | None = None,
        filter_company_name_prefix: str | list[str] | None = None,
        filter_company_name_not_prefix: str | list[str] | None = None,
        filter_company_name_suffix: str | list[str] | None = None,
        filter_company_name_not_suffix: str | list[str] | None = None,
        filter_company_name_match: str | list[str] | None = None,
        filter_company_name_not_match: str | list[str] | None = None,
        filter_company_eq: bool | list[bool] | None = None,
        filter_email_eq: str | list[str] | None = None,
        filter_email_not_eq: str | list[str] | None = None,
        filter_email_eql: str | list[str] | None = None,
        filter_email_not_eql: str | list[str] | None = None,
        filter_email_prefix: str | list[str] | None = None,
        filter_email_not_prefix: str | list[str] | None = None,
        filter_email_suffix: str | list[str] | None = None,
        filter_email_not_suffix: str | list[str] | None = None,
        filter_email_match: str | list[str] | None = None,
        filter_email_not_match: str | list[str] | None = None,
        filter_address_eq: str | list[str] | None = None,
        filter_address_not_eq: str | list[str] | None = None,
        filter_address_eql: str | list[str] | None = None,
        filter_address_not_eql: str | list[str] | None = None,
        filter_address_prefix: str | list[str] | None = None,
        filter_address_not_prefix: str | list[str] | None = None,
        filter_address_suffix: str | list[str] | None = None,
        filter_address_not_suffix: str | list[str] | None = None,
        filter_address_match: str | list[str] | None = None,
        filter_address_not_match: str | list[str] | None = None,
        filter_address_care_of_eq: str | list[str] | None = None,
        filter_address_care_of_not_eq: str | list[str] | None = None,
        filter_address_care_of_eql: str | list[str] | None = None,
        filter_address_care_of_not_eql: str | list[str] | None = None,
        filter_address_care_of_prefix: str | list[str] | None = None,
        filter_address_care_of_not_prefix: str | list[str] | None = None,
        filter_address_care_of_suffix: str | list[str] | None = None,
        filter_address_care_of_not_suffix: str | list[str] | None = None,
        filter_address_care_of_match: str | list[str] | None = None,
        filter_address_care_of_not_match: str | list[str] | None = None,
        filter_street_eq: str | list[str] | None = None,
        filter_street_not_eq: str | list[str] | None = None,
        filter_street_eql: str | list[str] | None = None,
        filter_street_not_eql: str | list[str] | None = None,
        filter_street_prefix: str | list[str] | None = None,
        filter_street_not_prefix: str | list[str] | None = None,
        filter_street_suffix: str | list[str] | None = None,
        filter_street_not_suffix: str | list[str] | None = None,
        filter_street_match: str | list[str] | None = None,
        filter_street_not_match: str | list[str] | None = None,
        filter_housenumber_eq: str | list[str] | None = None,
        filter_housenumber_not_eq: str | list[str] | None = None,
        filter_housenumber_eql: str | list[str] | None = None,
        filter_housenumber_not_eql: str | list[str] | None = None,
        filter_housenumber_prefix: str | list[str] | None = None,
        filter_housenumber_not_prefix: str | list[str] | None = None,
        filter_housenumber_suffix: str | list[str] | None = None,
        filter_housenumber_not_suffix: str | list[str] | None = None,
        filter_housenumber_match: str | list[str] | None = None,
        filter_housenumber_not_match: str | list[str] | None = None,
        filter_postbox_eq: str | list[str] | None = None,
        filter_postbox_not_eq: str | list[str] | None = None,
        filter_postbox_eql: str | list[str] | None = None,
        filter_postbox_not_eql: str | list[str] | None = None,
        filter_postbox_prefix: str | list[str] | None = None,
        filter_postbox_not_prefix: str | list[str] | None = None,
        filter_postbox_suffix: str | list[str] | None = None,
        filter_postbox_not_suffix: str | list[str] | None = None,
        filter_postbox_match: str | list[str] | None = None,
        filter_postbox_not_match: str | list[str] | None = None,
        filter_zip_code_eq: str | list[str] | None = None,
        filter_zip_code_not_eq: str | list[str] | None = None,
        filter_zip_code_eql: str | list[str] | None = None,
        filter_zip_code_not_eql: str | list[str] | None = None,
        filter_zip_code_prefix: str | list[str] | None = None,
        filter_zip_code_not_prefix: str | list[str] | None = None,
        filter_zip_code_suffix: str | list[str] | None = None,
        filter_zip_code_not_suffix: str | list[str] | None = None,
        filter_zip_code_match: str | list[str] | None = None,
        filter_zip_code_not_match: str | list[str] | None = None,
        filter_town_eq: str | list[str] | None = None,
        filter_town_not_eq: str | list[str] | None = None,
        filter_town_eql: str | list[str] | None = None,
        filter_town_not_eql: str | list[str] | None = None,
        filter_town_prefix: str | list[str] | None = None,
        filter_town_not_prefix: str | list[str] | None = None,
        filter_town_suffix: str | list[str] | None = None,
        filter_town_not_suffix: str | list[str] | None = None,
        filter_town_match: str | list[str] | None = None,
        filter_town_not_match: str | list[str] | None = None,
        filter_country_eq: str | list[str] | None = None,
        filter_country_not_eq: str | list[str] | None = None,
        filter_country_eql: str | list[str] | None = None,
        filter_country_not_eql: str | list[str] | None = None,
        filter_country_prefix: str | list[str] | None = None,
        filter_country_not_prefix: str | list[str] | None = None,
        filter_country_suffix: str | list[str] | None = None,
        filter_country_not_suffix: str | list[str] | None = None,
        filter_country_match: str | list[str] | None = None,
        filter_country_not_match: str | list[str] | None = None,
        filter_primary_group_id_eq: int | list[int] | None = None,
        filter_primary_group_id_not_eq: int | list[int] | None = None,
        filter_primary_group_id_gt: int | list[int] | None = None,
        filter_primary_group_id_gte: int | list[int] | None = None,
        filter_primary_group_id_lt: int | list[int] | None = None,
        filter_primary_group_id_lte: int | list[int] | None = None,
        filter_gender_eq: str | list[str] | None = None,
        filter_gender_not_eq: str | list[str] | None = None,
        filter_gender_eql: str | list[str] | None = None,
        filter_gender_not_eql: str | list[str] | None = None,
        filter_gender_prefix: str | list[str] | None = None,
        filter_gender_not_prefix: str | list[str] | None = None,
        filter_gender_suffix: str | list[str] | None = None,
        filter_gender_not_suffix: str | list[str] | None = None,
        filter_gender_match: str | list[str] | None = None,
        filter_gender_not_match: str | list[str] | None = None,
        filter_birthday_eq: datetime.date | list[datetime.date] | None = None,
        filter_birthday_not_eq: datetime.date | list[datetime.date] | None = None,
        filter_birthday_gt: datetime.date | list[datetime.date] | None = None,
        filter_birthday_gte: datetime.date | list[datetime.date] | None = None,
        filter_birthday_lt: datetime.date | list[datetime.date] | None = None,
        filter_birthday_lte: datetime.date | list[datetime.date] | None = None,
        filter_picture_eq: str | list[str] | None = None,
        filter_picture_not_eq: str | list[str] | None = None,
        filter_picture_eql: str | list[str] | None = None,
        filter_picture_not_eql: str | list[str] | None = None,
        filter_picture_prefix: str | list[str] | None = None,
        filter_picture_not_prefix: str | list[str] | None = None,
        filter_picture_suffix: str | list[str] | None = None,
        filter_picture_not_suffix: str | list[str] | None = None,
        filter_picture_match: str | list[str] | None = None,
        filter_picture_not_match: str | list[str] | None = None,
        filter_updated_at_eq: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_not_eq: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_updated_at_gt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_gte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_updated_at_lt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_lte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_additional_information_eq: str | list[str] | None = None,
        filter_additional_information_not_eq: str | list[str] | None = None,
        filter_additional_information_eql: str | list[str] | None = None,
        filter_additional_information_not_eql: str | list[str] | None = None,
        filter_additional_information_prefix: str | list[str] | None = None,
        filter_additional_information_not_prefix: str | list[str] | None = None,
        filter_additional_information_suffix: str | list[str] | None = None,
        filter_additional_information_not_suffix: str | list[str] | None = None,
        filter_additional_information_match: str | list[str] | None = None,
        filter_additional_information_not_match: str | list[str] | None = None,
        filter_language_eq: str | list[str] | None = None,
        filter_language_not_eq: str | list[str] | None = None,
        filter_language_eql: str | list[str] | None = None,
        filter_language_not_eql: str | list[str] | None = None,
        filter_language_prefix: str | list[str] | None = None,
        filter_language_not_prefix: str | list[str] | None = None,
        filter_language_suffix: str | list[str] | None = None,
        filter_language_not_suffix: str | list[str] | None = None,
        filter_language_match: str | list[str] | None = None,
        filter_language_not_match: str | list[str] | None = None,
    ) -> list[Person]:

        if include is None:
            include = []
        if include == "*":
            include = [
                "primary_group",
                "layer_group",
                "roles",
                "phone_numbers",
                "social_accounts",
                "additional_emails",
            ]

        filters = [
            ("first_name", "eq", filter_first_name_eq),
            ("first_name", "not_eq", filter_first_name_not_eq),
            ("first_name", "eql", filter_first_name_eql),
            ("first_name", "not_eql", filter_first_name_not_eql),
            ("first_name", "prefix", filter_first_name_prefix),
            ("first_name", "not_prefix", filter_first_name_not_prefix),
            ("first_name", "suffix", filter_first_name_suffix),
            ("first_name", "not_suffix", filter_first_name_not_suffix),
            ("first_name", "match", filter_first_name_match),
            ("first_name", "not_match", filter_first_name_not_match),
            ("last_name", "eq", filter_last_name_eq),
            ("last_name", "not_eq", filter_last_name_not_eq),
            ("last_name", "eql", filter_last_name_eql),
            ("last_name", "not_eql", filter_last_name_not_eql),
            ("last_name", "prefix", filter_last_name_prefix),
            ("last_name", "not_prefix", filter_last_name_not_prefix),
            ("last_name", "suffix", filter_last_name_suffix),
            ("last_name", "not_suffix", filter_last_name_not_suffix),
            ("last_name", "match", filter_last_name_match),
            ("last_name", "not_match", filter_last_name_not_match),
            ("nickname", "eq", filter_nickname_eq),
            ("nickname", "not_eq", filter_nickname_not_eq),
            ("nickname", "eql", filter_nickname_eql),
            ("nickname", "not_eql", filter_nickname_not_eql),
            ("nickname", "prefix", filter_nickname_prefix),
            ("nickname", "not_prefix", filter_nickname_not_prefix),
            ("nickname", "suffix", filter_nickname_suffix),
            ("nickname", "not_suffix", filter_nickname_not_suffix),
            ("nickname", "match", filter_nickname_match),
            ("nickname", "not_match", filter_nickname_not_match),
            ("company_name", "eq", filter_company_name_eq),
            ("company_name", "not_eq", filter_company_name_not_eq),
            ("company_name", "eql", filter_company_name_eql),
            ("company_name", "not_eql", filter_company_name_not_eql),
            ("company_name", "prefix", filter_company_name_prefix),
            ("company_name", "not_prefix", filter_company_name_not_prefix),
            ("company_name", "suffix", filter_company_name_suffix),
            ("company_name", "not_suffix", filter_company_name_not_suffix),
            ("company_name", "match", filter_company_name_match),
            ("company_name", "not_match", filter_company_name_not_match),
            ("company", "eq", filter_company_eq),
            ("email", "eq", filter_email_eq),
            ("email", "not_eq", filter_email_not_eq),
            ("email", "eql", filter_email_eql),
            ("email", "not_eql", filter_email_not_eql),
            ("email", "prefix", filter_email_prefix),
            ("email", "not_prefix", filter_email_not_prefix),
            ("email", "suffix", filter_email_suffix),
            ("email", "not_suffix", filter_email_not_suffix),
            ("email", "match", filter_email_match),
            ("email", "not_match", filter_email_not_match),
            ("address", "eq", filter_address_eq),
            ("address", "not_eq", filter_address_not_eq),
            ("address", "eql", filter_address_eql),
            ("address", "not_eql", filter_address_not_eql),
            ("address", "prefix", filter_address_prefix),
            ("address", "not_prefix", filter_address_not_prefix),
            ("address", "suffix", filter_address_suffix),
            ("address", "not_suffix", filter_address_not_suffix),
            ("address", "match", filter_address_match),
            ("address", "not_match", filter_address_not_match),
            ("address_care_of", "eq", filter_address_care_of_eq),
            ("address_care_of", "not_eq", filter_address_care_of_not_eq),
            ("address_care_of", "eql", filter_address_care_of_eql),
            ("address_care_of", "not_eql", filter_address_care_of_not_eql),
            ("address_care_of", "prefix", filter_address_care_of_prefix),
            ("address_care_of", "not_prefix", filter_address_care_of_not_prefix),
            ("address_care_of", "suffix", filter_address_care_of_suffix),
            ("address_care_of", "not_suffix", filter_address_care_of_not_suffix),
            ("address_care_of", "match", filter_address_care_of_match),
            ("address_care_of", "not_match", filter_address_care_of_not_match),
            ("street", "eq", filter_street_eq),
            ("street", "not_eq", filter_street_not_eq),
            ("street", "eql", filter_street_eql),
            ("street", "not_eql", filter_street_not_eql),
            ("street", "prefix", filter_street_prefix),
            ("street", "not_prefix", filter_street_not_prefix),
            ("street", "suffix", filter_street_suffix),
            ("street", "not_suffix", filter_street_not_suffix),
            ("street", "match", filter_street_match),
            ("street", "not_match", filter_street_not_match),
            ("housenumber", "eq", filter_housenumber_eq),
            ("housenumber", "not_eq", filter_housenumber_not_eq),
            ("housenumber", "eql", filter_housenumber_eql),
            ("housenumber", "not_eql", filter_housenumber_not_eql),
            ("housenumber", "prefix", filter_housenumber_prefix),
            ("housenumber", "not_prefix", filter_housenumber_not_prefix),
            ("housenumber", "suffix", filter_housenumber_suffix),
            ("housenumber", "not_suffix", filter_housenumber_not_suffix),
            ("housenumber", "match", filter_housenumber_match),
            ("housenumber", "not_match", filter_housenumber_not_match),
            ("postbox", "eq", filter_postbox_eq),
            ("postbox", "not_eq", filter_postbox_not_eq),
            ("postbox", "eql", filter_postbox_eql),
            ("postbox", "not_eql", filter_postbox_not_eql),
            ("postbox", "prefix", filter_postbox_prefix),
            ("postbox", "not_prefix", filter_postbox_not_prefix),
            ("postbox", "suffix", filter_postbox_suffix),
            ("postbox", "not_suffix", filter_postbox_not_suffix),
            ("postbox", "match", filter_postbox_match),
            ("postbox", "not_match", filter_postbox_not_match),
            ("zip_code", "eq", filter_zip_code_eq),
            ("zip_code", "not_eq", filter_zip_code_not_eq),
            ("zip_code", "eql", filter_zip_code_eql),
            ("zip_code", "not_eql", filter_zip_code_not_eql),
            ("zip_code", "prefix", filter_zip_code_prefix),
            ("zip_code", "not_prefix", filter_zip_code_not_prefix),
            ("zip_code", "suffix", filter_zip_code_suffix),
            ("zip_code", "not_suffix", filter_zip_code_not_suffix),
            ("zip_code", "match", filter_zip_code_match),
            ("zip_code", "not_match", filter_zip_code_not_match),
            ("town", "eq", filter_town_eq),
            ("town", "not_eq", filter_town_not_eq),
            ("town", "eql", filter_town_eql),
            ("town", "not_eql", filter_town_not_eql),
            ("town", "prefix", filter_town_prefix),
            ("town", "not_prefix", filter_town_not_prefix),
            ("town", "suffix", filter_town_suffix),
            ("town", "not_suffix", filter_town_not_suffix),
            ("town", "match", filter_town_match),
            ("town", "not_match", filter_town_not_match),
            ("country", "eq", filter_country_eq),
            ("country", "not_eq", filter_country_not_eq),
            ("country", "eql", filter_country_eql),
            ("country", "not_eql", filter_country_not_eql),
            ("country", "prefix", filter_country_prefix),
            ("country", "not_prefix", filter_country_not_prefix),
            ("country", "suffix", filter_country_suffix),
            ("country", "not_suffix", filter_country_not_suffix),
            ("country", "match", filter_country_match),
            ("country", "not_match", filter_country_not_match),
            ("primary_group_id", "eq", filter_primary_group_id_eq),
            ("primary_group_id", "not_eq", filter_primary_group_id_not_eq),
            ("primary_group_id", "gt", filter_primary_group_id_gt),
            ("primary_group_id", "gte", filter_primary_group_id_gte),
            ("primary_group_id", "lt", filter_primary_group_id_lt),
            ("primary_group_id", "lte", filter_primary_group_id_lte),
            ("gender", "eq", filter_gender_eq),
            ("gender", "not_eq", filter_gender_not_eq),
            ("gender", "eql", filter_gender_eql),
            ("gender", "not_eql", filter_gender_not_eql),
            ("gender", "prefix", filter_gender_prefix),
            ("gender", "not_prefix", filter_gender_not_prefix),
            ("gender", "suffix", filter_gender_suffix),
            ("gender", "not_suffix", filter_gender_not_suffix),
            ("gender", "match", filter_gender_match),
            ("gender", "not_match", filter_gender_not_match),
            ("birthday", "eq", filter_birthday_eq),
            ("birthday", "not_eq", filter_birthday_not_eq),
            ("birthday", "gt", filter_birthday_gt),
            ("birthday", "gte", filter_birthday_gte),
            ("birthday", "lt", filter_birthday_lt),
            ("birthday", "lte", filter_birthday_lte),
            ("picture", "eq", filter_picture_eq),
            ("picture", "not_eq", filter_picture_not_eq),
            ("picture", "eql", filter_picture_eql),
            ("picture", "not_eql", filter_picture_not_eql),
            ("picture", "prefix", filter_picture_prefix),
            ("picture", "not_prefix", filter_picture_not_prefix),
            ("picture", "suffix", filter_picture_suffix),
            ("picture", "not_suffix", filter_picture_not_suffix),
            ("picture", "match", filter_picture_match),
            ("picture", "not_match", filter_picture_not_match),
            ("updated_at", "eq", filter_updated_at_eq),
            ("updated_at", "not_eq", filter_updated_at_not_eq),
            ("updated_at", "gt", filter_updated_at_gt),
            ("updated_at", "gte", filter_updated_at_gte),
            ("updated_at", "lt", filter_updated_at_lt),
            ("updated_at", "lte", filter_updated_at_lte),
            ("additional_information", "eq", filter_additional_information_eq),
            ("additional_information", "not_eq", filter_additional_information_not_eq),
            ("additional_information", "eql", filter_additional_information_eql),
            (
                "additional_information",
                "not_eql",
                filter_additional_information_not_eql,
            ),
            ("additional_information", "prefix", filter_additional_information_prefix),
            (
                "additional_information",
                "not_prefix",
                filter_additional_information_not_prefix,
            ),
            ("additional_information", "suffix", filter_additional_information_suffix),
            (
                "additional_information",
                "not_suffix",
                filter_additional_information_not_suffix,
            ),
            ("additional_information", "match", filter_additional_information_match),
            (
                "additional_information",
                "not_match",
                filter_additional_information_not_match,
            ),
            ("language", "eq", filter_language_eq),
            ("language", "not_eq", filter_language_not_eq),
            ("language", "eql", filter_language_eql),
            ("language", "not_eql", filter_language_not_eql),
            ("language", "prefix", filter_language_prefix),
            ("language", "not_prefix", filter_language_not_prefix),
            ("language", "suffix", filter_language_suffix),
            ("language", "not_suffix", filter_language_not_suffix),
            ("language", "match", filter_language_match),
            ("language", "not_match", filter_language_not_match),
        ]
        filters = [f for f in filters if f[2] is not None]
        json_response = self._request_list("person", sort, include, filters)

        response_entities = []
        for data_obj in json_response["data"]:
            re = Person.from_json(data_obj)
            self._cache_add(re)
            response_entities.append(re)

        self._add_included_of_people_to_cache(json_response)

        return response_entities

    def get_person(
        self,
        id_or_key: int | PersonKey,
        include: list[_Person_Include] | typing.Literal["*"] | None = None,
    ) -> Person:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = PersonKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key

        all_includes = [
            "primary_group",
            "layer_group",
            "roles",
            "phone_numbers",
            "social_accounts",
            "additional_emails",
        ]
        if include is None:
            include = []
        if include == "*":
            include = all_includes

        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:

            cached_relations = [
                rel for rel in all_includes if cached_entity.is_relation_loaded(rel)
            ]
            if all(rel in cached_relations for rel in include):
                return cached_entity
            else:
                include.extend(cached_relations)

        json_response = self._request_single_get(
            "person",
            id_,
            include,
        )
        response_entity = Person.from_json(json_response["data"])
        if response_entity.key != entity_key:
            raise ValueError("Entity key mismatch")
        self._cache_add(response_entity)

        self._add_included_of_people_to_cache(json_response)

        return response_entity

    def _add_included_of_people_to_cache(self, json_response: dict) -> None:
        for incl_data in json_response.get("included", []):
            if incl_data["type"] == "groups":
                self._cache_add(Group.from_json(incl_data))
            elif incl_data["type"] == "groups":
                self._cache_add(Group.from_json(incl_data))
            elif incl_data["type"] == "roles":
                self._cache_add(Role.from_json(incl_data))
            elif incl_data["type"] == "phone_numbers":
                self._cache_add(PhoneNumber.from_json(incl_data))
            elif incl_data["type"] == "social_accounts":
                self._cache_add(SocialAccount.from_json(incl_data))
            elif incl_data["type"] == "additional_emails":
                self._cache_add(AdditionalEmail.from_json(incl_data))

    def get_phone_number(
        self,
        id_or_key: int | PhoneNumberKey,
    ) -> PhoneNumber:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = PhoneNumberKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key
        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:
            return cached_entity
        raise ValueError(
            f"no object known for {entity_key}. Entities of type phone_number can only be retrieved by including them while requesting other entities."
        )

    def get_roles_list(
        self,
        include: list[_Role_Include] | typing.Literal["*"] | None = None,
        sort: list[_Role_Sort] | None = None,
        filter_created_at_eq: datetime.datetime | list[datetime.datetime] | None = None,
        filter_created_at_not_eq: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_created_at_gt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_created_at_gte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_created_at_lt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_created_at_lte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_updated_at_eq: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_not_eq: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_updated_at_gt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_gte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_updated_at_lt: datetime.datetime | list[datetime.datetime] | None = None,
        filter_updated_at_lte: (
            datetime.datetime | list[datetime.datetime] | None
        ) = None,
        filter_start_on_eq: datetime.date | list[datetime.date] | None = None,
        filter_start_on_not_eq: datetime.date | list[datetime.date] | None = None,
        filter_start_on_gt: datetime.date | list[datetime.date] | None = None,
        filter_start_on_gte: datetime.date | list[datetime.date] | None = None,
        filter_start_on_lt: datetime.date | list[datetime.date] | None = None,
        filter_start_on_lte: datetime.date | list[datetime.date] | None = None,
        filter_end_on_eq: datetime.date | list[datetime.date] | None = None,
        filter_end_on_not_eq: datetime.date | list[datetime.date] | None = None,
        filter_end_on_gt: datetime.date | list[datetime.date] | None = None,
        filter_end_on_gte: datetime.date | list[datetime.date] | None = None,
        filter_end_on_lt: datetime.date | list[datetime.date] | None = None,
        filter_end_on_lte: datetime.date | list[datetime.date] | None = None,
        filter_name_eq: str | list[str] | None = None,
        filter_name_not_eq: str | list[str] | None = None,
        filter_name_eql: str | list[str] | None = None,
        filter_name_not_eql: str | list[str] | None = None,
        filter_name_prefix: str | list[str] | None = None,
        filter_name_not_prefix: str | list[str] | None = None,
        filter_name_suffix: str | list[str] | None = None,
        filter_name_not_suffix: str | list[str] | None = None,
        filter_name_match: str | list[str] | None = None,
        filter_name_not_match: str | list[str] | None = None,
        filter_person_id_eq: int | list[int] | None = None,
        filter_person_id_not_eq: int | list[int] | None = None,
        filter_person_id_gt: int | list[int] | None = None,
        filter_person_id_gte: int | list[int] | None = None,
        filter_person_id_lt: int | list[int] | None = None,
        filter_person_id_lte: int | list[int] | None = None,
        filter_group_id_eq: int | list[int] | None = None,
        filter_group_id_not_eq: int | list[int] | None = None,
        filter_group_id_gt: int | list[int] | None = None,
        filter_group_id_gte: int | list[int] | None = None,
        filter_group_id_lt: int | list[int] | None = None,
        filter_group_id_lte: int | list[int] | None = None,
        filter_type_eq: str | list[str] | None = None,
        filter_type_not_eq: str | list[str] | None = None,
        filter_type_eql: str | list[str] | None = None,
        filter_type_not_eql: str | list[str] | None = None,
        filter_type_prefix: str | list[str] | None = None,
        filter_type_not_prefix: str | list[str] | None = None,
        filter_type_suffix: str | list[str] | None = None,
        filter_type_not_suffix: str | list[str] | None = None,
        filter_type_match: str | list[str] | None = None,
        filter_type_not_match: str | list[str] | None = None,
        filter_label_eq: str | list[str] | None = None,
        filter_label_not_eq: str | list[str] | None = None,
        filter_label_eql: str | list[str] | None = None,
        filter_label_not_eql: str | list[str] | None = None,
        filter_label_prefix: str | list[str] | None = None,
        filter_label_not_prefix: str | list[str] | None = None,
        filter_label_suffix: str | list[str] | None = None,
        filter_label_not_suffix: str | list[str] | None = None,
        filter_label_match: str | list[str] | None = None,
        filter_label_not_match: str | list[str] | None = None,
    ) -> list[Role]:

        if include is None:
            include = []
        if include == "*":
            include = [
                "person",
                "group",
                "layer_group",
            ]

        filters = [
            ("created_at", "eq", filter_created_at_eq),
            ("created_at", "not_eq", filter_created_at_not_eq),
            ("created_at", "gt", filter_created_at_gt),
            ("created_at", "gte", filter_created_at_gte),
            ("created_at", "lt", filter_created_at_lt),
            ("created_at", "lte", filter_created_at_lte),
            ("updated_at", "eq", filter_updated_at_eq),
            ("updated_at", "not_eq", filter_updated_at_not_eq),
            ("updated_at", "gt", filter_updated_at_gt),
            ("updated_at", "gte", filter_updated_at_gte),
            ("updated_at", "lt", filter_updated_at_lt),
            ("updated_at", "lte", filter_updated_at_lte),
            ("start_on", "eq", filter_start_on_eq),
            ("start_on", "not_eq", filter_start_on_not_eq),
            ("start_on", "gt", filter_start_on_gt),
            ("start_on", "gte", filter_start_on_gte),
            ("start_on", "lt", filter_start_on_lt),
            ("start_on", "lte", filter_start_on_lte),
            ("end_on", "eq", filter_end_on_eq),
            ("end_on", "not_eq", filter_end_on_not_eq),
            ("end_on", "gt", filter_end_on_gt),
            ("end_on", "gte", filter_end_on_gte),
            ("end_on", "lt", filter_end_on_lt),
            ("end_on", "lte", filter_end_on_lte),
            ("name", "eq", filter_name_eq),
            ("name", "not_eq", filter_name_not_eq),
            ("name", "eql", filter_name_eql),
            ("name", "not_eql", filter_name_not_eql),
            ("name", "prefix", filter_name_prefix),
            ("name", "not_prefix", filter_name_not_prefix),
            ("name", "suffix", filter_name_suffix),
            ("name", "not_suffix", filter_name_not_suffix),
            ("name", "match", filter_name_match),
            ("name", "not_match", filter_name_not_match),
            ("person_id", "eq", filter_person_id_eq),
            ("person_id", "not_eq", filter_person_id_not_eq),
            ("person_id", "gt", filter_person_id_gt),
            ("person_id", "gte", filter_person_id_gte),
            ("person_id", "lt", filter_person_id_lt),
            ("person_id", "lte", filter_person_id_lte),
            ("group_id", "eq", filter_group_id_eq),
            ("group_id", "not_eq", filter_group_id_not_eq),
            ("group_id", "gt", filter_group_id_gt),
            ("group_id", "gte", filter_group_id_gte),
            ("group_id", "lt", filter_group_id_lt),
            ("group_id", "lte", filter_group_id_lte),
            ("type", "eq", filter_type_eq),
            ("type", "not_eq", filter_type_not_eq),
            ("type", "eql", filter_type_eql),
            ("type", "not_eql", filter_type_not_eql),
            ("type", "prefix", filter_type_prefix),
            ("type", "not_prefix", filter_type_not_prefix),
            ("type", "suffix", filter_type_suffix),
            ("type", "not_suffix", filter_type_not_suffix),
            ("type", "match", filter_type_match),
            ("type", "not_match", filter_type_not_match),
            ("label", "eq", filter_label_eq),
            ("label", "not_eq", filter_label_not_eq),
            ("label", "eql", filter_label_eql),
            ("label", "not_eql", filter_label_not_eql),
            ("label", "prefix", filter_label_prefix),
            ("label", "not_prefix", filter_label_not_prefix),
            ("label", "suffix", filter_label_suffix),
            ("label", "not_suffix", filter_label_not_suffix),
            ("label", "match", filter_label_match),
            ("label", "not_match", filter_label_not_match),
        ]
        filters = [f for f in filters if f[2] is not None]
        json_response = self._request_list("role", sort, include, filters)

        response_entities = []
        for data_obj in json_response["data"]:
            re = Role.from_json(data_obj)
            self._cache_add(re)
            response_entities.append(re)

        self._add_included_of_roles_to_cache(json_response)

        return response_entities

    def get_role(
        self,
        id_or_key: int | RoleKey,
        include: list[_Role_Include] | typing.Literal["*"] | None = None,
    ) -> Role:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = RoleKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key

        all_includes = [
            "person",
            "group",
            "layer_group",
        ]
        if include is None:
            include = []
        if include == "*":
            include = all_includes

        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:

            cached_relations = [
                rel for rel in all_includes if cached_entity.is_relation_loaded(rel)
            ]
            if all(rel in cached_relations for rel in include):
                return cached_entity
            else:
                include.extend(cached_relations)

        json_response = self._request_single_get(
            "role",
            id_,
            include,
        )
        response_entity = Role.from_json(json_response["data"])
        if response_entity.key != entity_key:
            raise ValueError("Entity key mismatch")
        self._cache_add(response_entity)

        self._add_included_of_roles_to_cache(json_response)

        return response_entity

    def _add_included_of_roles_to_cache(self, json_response: dict) -> None:
        for incl_data in json_response.get("included", []):
            if incl_data["type"] == "people":
                self._cache_add(Person.from_json(incl_data))
            elif incl_data["type"] == "groups":
                self._cache_add(Group.from_json(incl_data))
            elif incl_data["type"] == "groups":
                self._cache_add(Group.from_json(incl_data))

    def get_self_registration(
        self,
        id_or_key: int | SelfRegistrationKey,
    ) -> SelfRegistration:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = SelfRegistrationKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key
        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:
            return cached_entity
        raise ValueError(
            f"no object known for {entity_key}. Entities of type self_registration can only be retrieved by including them while requesting other entities."
        )

    def get_social_account(
        self,
        id_or_key: int | SocialAccountKey,
    ) -> SocialAccount:
        if isinstance(id_or_key, int):
            id_ = id_or_key
            entity_key = SocialAccountKey(id_)
        else:
            id_ = id_or_key.id
            entity_key = id_or_key
        cached_entity = self._cache_get(entity_key)
        if cached_entity is not None:
            return cached_entity
        raise ValueError(
            f"no object known for {entity_key}. Entities of type social_account can only be retrieved by including them while requesting other entities."
        )


# @formatter:on
