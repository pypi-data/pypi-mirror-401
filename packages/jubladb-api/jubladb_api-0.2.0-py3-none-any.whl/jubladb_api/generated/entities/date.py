# DO NOT EDIT THIS FILE, it is auto-generated!
import jubladb_api.core.metamodel_classes
import jubladb_api.core.base_entity
import jubladb_api.generated.entities.keys

import datetime

import typing

# @formatter:off


class Date(jubladb_api.core.base_entity.BaseEntity):
    def __init__(
        self,
        id_: int,
        event_id: int,
        label: str,
        location: str,
        start_at: datetime.datetime,
        finish_at: datetime.datetime,
        event: jubladb_api.generated.entities.keys.EventKey | None,
    ):
        super().__init__(id_)

        self._event_id = event_id
        self._label = label
        self._location = location
        self._start_at = start_at
        self._finish_at = finish_at

        self._event = event

    @property
    def event_id(self) -> int:
        return self._event_id

    @property
    def label(self) -> str:
        return self._label

    @property
    def location(self) -> str:
        return self._location

    @property
    def start_at(self) -> datetime.datetime:
        return self._start_at

    @property
    def finish_at(self) -> datetime.datetime:
        return self._finish_at

    @property
    def event(self) -> jubladb_api.generated.entities.keys.EventKey:
        if self._event is None:
            raise ValueError("Relation event is not included")
        return self._event

    @property
    def key(self) -> jubladb_api.generated.entities.keys.DateKey:
        return jubladb_api.generated.entities.keys.DateKey(self._id)

    @property
    def meta(self) -> jubladb_api.core.metamodel_classes.Entity:
        return jubladb_api.generated.metamodel.ENTITIES["date"]

    def is_relation_loaded(
        self,
        relation_name: typing.Literal["event",],
    ) -> bool:

        if relation_name == "event":
            return self._event is not None

        else:
            raise ValueError(f"relation {relation_name} does not exist on date")

    @classmethod
    def from_json(cls, json_data: dict):
        if json_data.get("type", None) != "dates":
            raise ValueError("Invalid data type")
        return cls(
            id_=cls._access_id(json_data),
            event_id=cls._access_data_attribute(
                json_data,
                "event_id",
                jubladb_api.core.metamodel_classes.AttributeType.INTEGER,
            ),
            label=cls._access_data_attribute(
                json_data,
                "label",
                jubladb_api.core.metamodel_classes.AttributeType.STRING,
            ),
            location=cls._access_data_attribute(
                json_data,
                "location",
                jubladb_api.core.metamodel_classes.AttributeType.STRING,
            ),
            start_at=cls._access_data_attribute(
                json_data,
                "start_at",
                jubladb_api.core.metamodel_classes.AttributeType.DATETIME,
            ),
            finish_at=cls._access_data_attribute(
                json_data,
                "finish_at",
                jubladb_api.core.metamodel_classes.AttributeType.DATETIME,
            ),
            event=cls._create_single_relation_key(
                json_data,
                "event",
                "events",
                jubladb_api.generated.entities.keys.EventKey,
            ),
        )


# @formatter:on
