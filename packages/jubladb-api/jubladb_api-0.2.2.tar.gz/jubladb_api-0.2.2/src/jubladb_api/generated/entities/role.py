# DO NOT EDIT THIS FILE, it is auto-generated!
import jubladb_api.core.metamodel_classes
import jubladb_api.core.base_entity
import jubladb_api.generated.entities.keys

import datetime

import typing

# @formatter:off


class Role(jubladb_api.core.base_entity.BaseEntity):
    def __init__(
        self,
        id_: int,
        created_at: datetime.datetime,
        updated_at: datetime.datetime,
        start_on: datetime.date,
        end_on: datetime.date | None,
        name: str,
        person_id: int,
        group_id: int,
        type: str,
        label: str | None,
        person: jubladb_api.generated.entities.keys.PersonKey | None,
        group: jubladb_api.generated.entities.keys.GroupKey | None,
        layer_group: jubladb_api.generated.entities.keys.GroupKey | None,
    ):
        super().__init__(id_)

        self._created_at = created_at
        self._updated_at = updated_at
        self._start_on = start_on
        self._end_on = end_on
        self._name = name
        self._person_id = person_id
        self._group_id = group_id
        self._type = type
        self._label = label

        self._person = person
        self._group = group
        self._layer_group = layer_group

    @property
    def created_at(self) -> datetime.datetime:
        return self._created_at

    @property
    def updated_at(self) -> datetime.datetime:
        return self._updated_at

    @property
    def start_on(self) -> datetime.date:
        return self._start_on

    @property
    def end_on(self) -> datetime.date | None:
        return self._end_on

    @property
    def name(self) -> str:
        return self._name

    @property
    def person_id(self) -> int:
        return self._person_id

    @property
    def group_id(self) -> int:
        return self._group_id

    @property
    def type(self) -> str:
        return self._type

    @property
    def label(self) -> str | None:
        return self._label

    @property
    def person(self) -> jubladb_api.generated.entities.keys.PersonKey:
        if self._person is None:
            raise ValueError("Relation person is not included")
        return self._person

    @property
    def group(self) -> jubladb_api.generated.entities.keys.GroupKey:
        if self._group is None:
            raise ValueError("Relation group is not included")
        return self._group

    @property
    def layer_group(self) -> jubladb_api.generated.entities.keys.GroupKey:
        if self._layer_group is None:
            raise ValueError("Relation layer_group is not included")
        return self._layer_group

    @property
    def key(self) -> jubladb_api.generated.entities.keys.RoleKey:
        return jubladb_api.generated.entities.keys.RoleKey(self._id)

    @property
    def meta(self) -> jubladb_api.core.metamodel_classes.Entity:
        return jubladb_api.generated.metamodel.ENTITIES["role"]

    def is_relation_loaded(
        self,
        relation_name: typing.Literal[
            "person",
            "group",
            "layer_group",
        ],
    ) -> bool:

        if relation_name == "person":
            return self._person is not None

        elif relation_name == "group":
            return self._group is not None

        elif relation_name == "layer_group":
            return self._layer_group is not None

        else:
            raise ValueError(f"relation {relation_name} does not exist on role")

    def __str__(self) -> str:
        return f"{self.__class__.__name__}({self._id}, person_id={repr(self._person_id)}, group_id={repr(self._group_id)}, type={repr(self._type)})"

    @classmethod
    def from_json(cls, json_data: dict):
        if json_data.get("type", None) != "roles":
            raise ValueError("Invalid data type")
        return cls(
            id_=cls._access_id(json_data),
            created_at=cls._access_data_attribute(
                json_data,
                "created_at",
                jubladb_api.core.metamodel_classes.AttributeType.DATETIME,
            ),
            updated_at=cls._access_data_attribute(
                json_data,
                "updated_at",
                jubladb_api.core.metamodel_classes.AttributeType.DATETIME,
            ),
            start_on=cls._access_data_attribute(
                json_data,
                "start_on",
                jubladb_api.core.metamodel_classes.AttributeType.DATE,
            ),
            end_on=cls._access_data_attribute(
                json_data,
                "end_on",
                jubladb_api.core.metamodel_classes.AttributeType.DATE,
                optional=True,
            ),
            name=cls._access_data_attribute(
                json_data,
                "name",
                jubladb_api.core.metamodel_classes.AttributeType.STRING,
            ),
            person_id=cls._access_data_attribute(
                json_data,
                "person_id",
                jubladb_api.core.metamodel_classes.AttributeType.INTEGER,
            ),
            group_id=cls._access_data_attribute(
                json_data,
                "group_id",
                jubladb_api.core.metamodel_classes.AttributeType.INTEGER,
            ),
            type=cls._access_data_attribute(
                json_data,
                "type",
                jubladb_api.core.metamodel_classes.AttributeType.STRING,
            ),
            label=cls._access_data_attribute(
                json_data,
                "label",
                jubladb_api.core.metamodel_classes.AttributeType.STRING,
                optional=True,
            ),
            person=cls._create_single_relation_key(
                json_data,
                "person",
                "people",
                jubladb_api.generated.entities.keys.PersonKey,
            ),
            group=cls._create_single_relation_key(
                json_data,
                "group",
                "groups",
                jubladb_api.generated.entities.keys.GroupKey,
            ),
            layer_group=cls._create_single_relation_key(
                json_data,
                "layer_group",
                "groups",
                jubladb_api.generated.entities.keys.GroupKey,
            ),
        )


# @formatter:on
