[tox]
requires =
    tox>=4
env_list =
    ruff,
    changelog,
    coverage,
    py3{10,11,12,13,14}
isolated_build = true

[gh-actions]
python =
    3.10: py310
    3.11: py311
    3.12: py312
    3.13: coverage
    3.14: py314

[testenv]
skip_install = false
deps =
    pytest
commands =
    pytest

[testenv:ruff]
description = run ruff
skip_install = true
deps =
    ruff
commands =
    ruff format {toxinidir}/src {toxinidir}/tests
    ruff check {toxinidir}/src {toxinidir}/tests

[testenv:changelog]
description = show changelog
skip_install = false
deps =
    towncrier
    lazy_loader==0.4
commands =
    towncrier build --draft

[testenv:coverage]
description = run tests with coverage
skip_install = false
deps =
    pytest-cov
commands =
    pytest --cov=uniharmony --cov-report=xml --cov-report=term --cov-config=pyproject.toml
