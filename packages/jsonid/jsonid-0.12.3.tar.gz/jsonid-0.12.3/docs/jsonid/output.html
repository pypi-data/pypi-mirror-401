<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>src.jsonid.output API documentation</title>
<meta name="description" content="Functions for output of results.">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>src.jsonid.output</code></h1>
</header>
<section id="section-intro">
<p>Functions for output of results.</p>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="src.jsonid.output.format_results_for_agentout"><code class="name flex">
<span>def <span class="ident">format_results_for_agentout</span></span>(<span>path: str, res: list)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def format_results_for_agentout(path: str, res: list):
    &#34;&#34;&#34;Return a result set that provides more provenance information
    if required, e.g. by a digital preservation system.

    We have elected to output JSON here as it is one of the easier
    formats to map into other formats. It is also easy to work with
    on the command line, e.g. using JQ.
    &#34;&#34;&#34;
    res = {
        &#34;path&#34;: path,
        &#34;results&#34;: res,
        &#34;count&#34;: len(res),
        &#34;agent&#34;: version.get_agent(),
    }
    return json.dumps(res, indent=2)</code></pre>
</details>
<div class="desc"><p>Return a result set that provides more provenance information
if required, e.g. by a digital preservation system.</p>
<p>We have elected to output JSON here as it is one of the easier
formats to map into other formats. It is also easy to work with
on the command line, e.g. using JQ.</p></div>
</dd>
<dt id="src.jsonid.output.format_results_for_cli"><code class="name flex">
<span>def <span class="ident">format_results_for_cli</span></span>(<span>path: str, padding: int, res: list)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def format_results_for_cli(path: str, padding: int, res: list):
    &#34;&#34;&#34;Format the results for the CLI.

    Returns a single line per path.
    &#34;&#34;&#34;
    path_formatted = _format_path(path)
    res_formatted = f&#39;{path_formatted:{padding}}\t[{len(res)}]\t{&#34; | &#34;.join(res)}&#39;
    return res_formatted</code></pre>
</details>
<div class="desc"><p>Format the results for the CLI.</p>
<p>Returns a single line per path.</p></div>
</dd>
<dt id="src.jsonid.output.mimeout"><code class="name flex">
<span>def <span class="ident">mimeout</span></span>(<span>results: list)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def mimeout(results: list):
    &#34;&#34;&#34;For every result in the result set generate an appropriate
    MIMEType.

    See the associated unit tests for more information on
    expected results.
    &#34;&#34;&#34;
    res = []
    for item in results:
        # In the first instance, deal with data we have definitively
        # identified using JSONID. Everything else will receive default
        # MIMETypes below.
        if isinstance(item, registry_class.RegistryEntry):
            res.append(
                f&#39;{item.mime[0]}; charset={item.encoding}; doctype=&#34;{item.name[0][&#34;@en&#34;]}&#34;; ref={item.identifier}&#39;
            )
            continue
        # Defensive check for the remaining data types we may be
        # working with in this utility. In the fullness of time it
        # should be possible to remove this.
        if not isinstance(item, registry.BaseCharacteristics):
            logger.error(&#34;invalid data, cannot output value for: %s&#34;, item)
            continue
        # Each remaining `if` works as a precedence. Empty over all.
        # Compression over binary, and so on.
        if item.empty:
            res.append(&#34;inode/x-empty; charset=binary&#34;)
            continue
        if item.compression:
            res.append(f&#34;{item.compression}; charset=binary&#34;)
            continue
        if item.binary:
            res.append(&#34;application/octet-stream; charset=binary&#34;)
            continue
        if item.text and item.encoding:
            res.append(f&#34;text/plain; charset={item.encoding}&#34;)
            continue
        if item.text:
            res.append(&#34;text/plain; charset=unknown&#34;)
            continue
        res.append(&#34;application/octet-stream; charset=unknown&#34;)
    return res</code></pre>
</details>
<div class="desc"><p>For every result in the result set generate an appropriate
MIMEType.</p>
<p>See the associated unit tests for more information on
expected results.</p></div>
</dd>
<dt id="src.jsonid.output.output_results"><code class="name flex">
<span>def <span class="ident">output_results</span></span>(<span>path: str, results: list, padding: int, agentout: bool)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def output_results(path: str, results: list, padding: int, agentout: bool):
    &#34;&#34;&#34;Output JSONID results.

    Print is wrapped in print_result to better enable testing, i.e.
    we can assert print_result was called with a given value easier
    and avoid risking false-negatives using standard `print()`.
    &#34;&#34;&#34;
    res = mimeout(results)
    if agentout:
        res = format_results_for_agentout(path, res)
        print_result(res)
        return
    cli_res = format_results_for_cli(path, padding, res)
    print_result(cli_res)
    return</code></pre>
</details>
<div class="desc"><p>Output JSONID results.</p>
<p>Print is wrapped in print_result to better enable testing, i.e.
we can assert print_result was called with a given value easier
and avoid risking false-negatives using standard <code>print()</code>.</p></div>
</dd>
<dt id="src.jsonid.output.print_result"><code class="name flex">
<span>def <span class="ident">print_result</span></span>(<span>result: str)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def print_result(result: str):
    &#34;&#34;&#34;Wrap print to enable e2e testing.&#34;&#34;&#34;
    print(result)</code></pre>
</details>
<div class="desc"><p>Wrap print to enable e2e testing.</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="src.jsonid" href="index.html">src.jsonid</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="src.jsonid.output.format_results_for_agentout" href="#src.jsonid.output.format_results_for_agentout">format_results_for_agentout</a></code></li>
<li><code><a title="src.jsonid.output.format_results_for_cli" href="#src.jsonid.output.format_results_for_cli">format_results_for_cli</a></code></li>
<li><code><a title="src.jsonid.output.mimeout" href="#src.jsonid.output.mimeout">mimeout</a></code></li>
<li><code><a title="src.jsonid.output.output_results" href="#src.jsonid.output.output_results">output_results</a></code></li>
<li><code><a title="src.jsonid.output.print_result" href="#src.jsonid.output.print_result">print_result</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
