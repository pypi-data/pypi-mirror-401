<!DOCTYPE html>
<html>
<head>
    <title>MDSA Dashboard - Welcome</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
</head>
<body>
    <div class="header">
        <h1>üöÄ MDSA Framework Dashboard</h1>
        <p>Multi-Domain Specialized Agentic Orchestration - Monitoring & Control</p>
    </div>

    <div class="container">
        <div class="stats">
            <div class="stat-card">
                <h3>{{ stats.total_apps }}</h3>
                <p>MDSA Applications</p>
            </div>
            <div class="stat-card">
                <h3>{{ stats.total_domains }}</h3>
                <p>Registered Domains</p>
            </div>
            <div class="stat-card orange">
                <h3>{{ stats.active_models }}</h3>
                <p>Active Models</p>
            </div>
            <div class="stat-card purple">
                <h3>{{ stats.rag_documents }}</h3>
                <p>RAG Documents</p>
            </div>
            <div class="stat-card blue">
                <h3>{{ stats.total_requests }}</h3>
                <p>Total Requests</p>
            </div>
        </div>

        <div class="nav">
            <a href="/welcome" class="active">üè† Home</a>
            <a href="/admin/rag">üì§ RAG Management</a>
            <a href="/admin/models">üîß Model Configuration</a>
            <a href="/admin/tools">üõ†Ô∏è Tools</a>
            <a href="/domains">üéØ Domains</a>
            <a href="/admin/monitor">üìä Monitor</a>
        </div>

        <h2 style="color: #2196F3; margin-top: 40px;">Registered Applications</h2>
        {% if apps %}
        <div class="domain-list">
            {% for app in apps %}
            <div class="domain-item">
                <h3>{{ app.name }}</h3>
                <p><strong>Framework:</strong> {{ app.framework }}</p>
                <p><strong>Endpoint:</strong> <a href="{{ app.endpoint }}" target="_blank">{{ app.endpoint }}</a></p>
                <p><strong>Status:</strong> <span style="color: {% if app.health_status == 'healthy' %}#4CAF50{% else %}#F44336{% endif %};">{{ app.health_status }}</span></p>
                {% if app.health_status == 'healthy' %}
                <p><strong>Response Time:</strong> {{ app.response_time_ms|round(2) }} ms</p>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state">
            <p>No applications registered yet. Start your MDSA-powered application to see it appear here.</p>
            <p style="margin-top: 20px; color: #666;">
                Applications automatically register when they call <code>register_current_app()</code>
            </p>
        </div>
        {% endif %}

        <h2 style="color: #4CAF50; margin-top: 40px;">Quick View: Domains ({{ stats.total_domains }})</h2>
        {% if domains %}
        <div class="domain-list">
            {% for domain in domains[:5] %}
            <div class="domain-item">
                <h3>{{ domain.description or domain.domain_id }}</h3>
                <p><strong>ID:</strong> {{ domain.domain_id }}</p>
                <p><strong>Model:</strong> {{ domain.model_name }}</p>
                {% if domain.app_name %}
                <p><strong>App:</strong> {{ domain.app_name }}</p>
                {% endif %}
                {% if domain.keywords %}
                <div class="keywords">
                    {% for keyword in domain.keywords[:5] %}
                    <span class="keyword">{{ keyword }}</span>
                    {% endfor %}
                    {% if domain.keywords|length > 5 %}
                    <span class="keyword">+{{ domain.keywords|length - 5 }} more</span>
                    {% endif %}
                </div>
                {% endif %}
            </div>
            {% endfor %}
            {% if domains|length > 5 %}
            <p style="text-align: center; margin-top: 20px;">
                <a href="/domains">View all {{ stats.total_domains }} domains ‚Üí</a>
            </p>
            {% endif %}
        </div>
        {% else %}
        <div class="empty-state">
            <p>No domains registered yet.</p>
        </div>
        {% endif %}

        <h2 style="color: #4CAF50; margin-top: 40px;">Features</h2>
        <ul style="color: #ccc; line-height: 2;">
            <li>‚úÖ TinyBERT Router with keyword fallback</li>
            <li>‚úÖ {{ stats.total_domains }} Specialized Domains</li>
            <li>‚úÖ DualRAG (Global + Local knowledge)</li>
            <li>‚úÖ Hybrid Orchestration (TinyBERT + Phi-2)</li>
            <li>‚úÖ Real-time monitoring via WebSocket & D3.js visualizations</li>
        </ul>

        <div class="nav" style="margin-top: 40px;">
            <a href="/monitor">üé® View Interactive Visualizations ‚Üí</a>
        </div>
    </div>

    <style>
        .empty-state {
            background: #f5f5f5;
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            margin-top: 20px;
        }
        .empty-state code {
            background: #e8e8e8;
            padding: 4px 8px;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</body>
</html>
