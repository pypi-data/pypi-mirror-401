<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AuroraView Maya Shelf Demo (Rename Selection)</title>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        background: #383838;
        color: #eee;
        font-family: sans-serif;
      }
      body { padding: 12px; }
      #shelf {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 4px 8px;
        background: #2a2a2a;
        border-radius: 4px;
      }
      #shelf-label { font-size: 12px; opacity: 0.8; margin-right: 4px; }
      #prefix {
        width: 200px;
        padding: 4px 6px;
        border-radius: 2px;
        border: 1px solid #555;
        background: #202020;
        color: #eee;
      }
      #renameBtn {
        padding: 6px 12px;
        background: #d98b3b;
        border: 1px solid #f4a64a;
        color: #1a1a1a;
        font-weight: bold;
        border-radius: 3px;
        cursor: pointer;
      }
      #renameBtn:hover { background: #f4a64a; }
      pre {
        background: #222;
        color: #ddd;
        padding: 8px;
        margin-top: 8px;
        border-radius: 3px;
        font-size: 12px;
      }
      #viewportDemo, #uiViewDemo {
        margin-top: 8px;
        height: 120px;
        border-radius: 3px;
        border: 1px solid #555;
        background: #1e1e1e;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        text-align: center;
      }
      #viewportDemo { border-color: #4a90e2; }
      #uiViewDemo { border-color: #8bc34a; }
      #eventLog {
        background: #181818;
        color: #ccc;
        padding: 6px;
        margin-top: 6px;
        border-radius: 3px;
        font-size: 11px;
        max-height: 160px;
        overflow: auto;
      }
    </style>
  </head>
  <body>
    <h1 style="font-size:14px; margin:4px 0 8px;">AuroraView Maya Shelf (Rename Selection)</h1>
    <div id="shelf">
      <span id="shelf-label">Prefix for new names:</span>
      <input id="prefix" value="av_" />
      <button id="renameBtn">Rename Selection</button>
    </div>
    <pre id="log">Select some objects in Maya, then click "Rename Selection".</pre>

    <h2 style="font-size:13px; margin:12px 0 4px;">Viewport &amp; UI interaction demo</h2>
    <div id="viewportDemo">
      Alt + Left Drag here – emits <code>viewport.orbit</code>, wheel &rarr; <code>viewport.zoom</code>
    </div>
    <div id="uiViewDemo">
      Left Drag here – emits <code>ui.view.pan</code>, wheel &rarr; <code>ui.view.zoom</code>
    </div>
    <pre id="eventLog">High-level events will appear here...</pre>

    <script>
      (function () {
        function appendEventLog(eventName, payload) {
          var el = document.getElementById('eventLog');
          if (!el) return;
          var lines = el.textContent.split('\n').filter(function (x) { return x; });
          var line = eventName + ': ' + JSON.stringify(payload);
          lines.push(line);
          var maxLines = 10;
          while (lines.length > maxLines) lines.shift();
          el.textContent = lines.join('\n');
        }

        function init() {
          var prefixInput = document.getElementById('prefix');
          var log = document.getElementById('log');
          var renameBtn = document.getElementById('renameBtn');
          var viewportBox = document.getElementById('viewportDemo');
          var uiViewBox = document.getElementById('uiViewDemo');

          renameBtn.addEventListener('click', async function () {
            try {
              var prefix = prefixInput.value || 'av_';
              var result = await auroraview.api.rename_selected({ prefix: prefix });
              log.textContent = 'Result: ' + JSON.stringify(result, null, 2);
            } catch (err) {
              console.error('[AuroraView] rename_selected error:', err);
              log.textContent = 'Error: ' + ((err && err.message) || err);
            }
          });

          var isOrbiting = false;
          var isUIPanning = false;
          var lastX = 0;
          var lastY = 0;

          if (viewportBox) {
            viewportBox.addEventListener('mousedown', function (e) {
              if (!window.auroraview) return;
              if (e.button === 0 && e.altKey) {
                isOrbiting = true;
                lastX = e.clientX;
                lastY = e.clientY;
                e.preventDefault();
              }
            });

            viewportBox.addEventListener('wheel', function (e) {
              if (!window.auroraview) return;
              e.preventDefault();
              var payloadZoom = { delta: e.deltaY, view_id: 'main', source: 'web', method: 'wheel' };
              window.auroraview.send_event('viewport.zoom', payloadZoom);
              appendEventLog('viewport.zoom', payloadZoom);
            });
          }

          if (uiViewBox) {
            uiViewBox.addEventListener('mousedown', function (e) {
              if (!window.auroraview) return;
              if (e.button !== 0) return;
              isUIPanning = true;
              lastX = e.clientX;
              lastY = e.clientY;
              e.preventDefault();
            });

            uiViewBox.addEventListener('wheel', function (e) {
              if (!window.auroraview) return;
              e.preventDefault();
              var payloadUiZoom = { delta: e.deltaY, view_id: 'ui', source: 'web', method: 'wheel' };
              window.auroraview.send_event('ui.view.zoom', payloadUiZoom);
              appendEventLog('ui.view.zoom', payloadUiZoom);
            });
          }

          window.addEventListener('mouseup', function () {
            isOrbiting = false;
            isUIPanning = false;
          });

          window.addEventListener('mousemove', function (e) {
            if (!window.auroraview) return;
            if (isOrbiting) {
              var dx = e.clientX - lastX;
              var dy = e.clientY - lastY;
              lastX = e.clientX;
              lastY = e.clientY;
              var payloadOrbit = { dx: dx, dy: dy, view_id: 'main', source: 'web' };
              window.auroraview.send_event('viewport.orbit', payloadOrbit);
              appendEventLog('viewport.orbit', payloadOrbit);
            } else if (isUIPanning) {
              var dx2 = e.clientX - lastX;
              var dy2 = e.clientY - lastY;
              lastX = e.clientX;
              lastY = e.clientY;
              var payloadPan = { dx: dx2, dy: dy2, view_id: 'ui', source: 'web' };
              window.auroraview.send_event('ui.view.pan', payloadPan);
              appendEventLog('ui.view.pan', payloadPan);
            }
          });
        }

        if (window.auroraview && window.auroraview.api) {
          init();
        } else {
          window.addEventListener('auroraviewready', init);
        }
      })();
    </script>
  </body>
</html>

