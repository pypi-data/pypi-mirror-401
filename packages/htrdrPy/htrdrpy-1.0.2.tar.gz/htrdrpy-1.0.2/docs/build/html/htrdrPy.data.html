

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>htrdrPy.data module &mdash; htrdrPy 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="htrdrPy.geometry module" href="htrdrPy.geometry.html" />
    <link rel="prev" title="htrdrPy documentation" href="htrdrPy.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            htrdrPy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="htrdrPy.html">htrdrPy documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">htrdrPy.data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#htrdrPy.data.Data"><code class="docutils literal notranslate"><span class="pre">Data</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.cleanInputs"><code class="docutils literal notranslate"><span class="pre">Data.cleanInputs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.makeAtmosphereFrom1D"><code class="docutils literal notranslate"><span class="pre">Data.makeAtmosphereFrom1D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.makeAtmosphereFrom1D_PP"><code class="docutils literal notranslate"><span class="pre">Data.makeAtmosphereFrom1D_PP()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.makeAtmosphereFrom2D"><code class="docutils literal notranslate"><span class="pre">Data.makeAtmosphereFrom2D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.makeAtmosphereFrom3D"><code class="docutils literal notranslate"><span class="pre">Data.makeAtmosphereFrom3D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.makeFromLMDZ"><code class="docutils literal notranslate"><span class="pre">Data.makeFromLMDZ()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.makeGroundFrom1D"><code class="docutils literal notranslate"><span class="pre">Data.makeGroundFrom1D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.makeGroundFrom1D_PP"><code class="docutils literal notranslate"><span class="pre">Data.makeGroundFrom1D_PP()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.makeGroundFrom2D"><code class="docutils literal notranslate"><span class="pre">Data.makeGroundFrom2D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.makeGroundFrom3D"><code class="docutils literal notranslate"><span class="pre">Data.makeGroundFrom3D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.writeInputAtmosphere"><code class="docutils literal notranslate"><span class="pre">Data.writeInputAtmosphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.writeInputGround"><code class="docutils literal notranslate"><span class="pre">Data.writeInputGround()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.writeInputs"><code class="docutils literal notranslate"><span class="pre">Data.writeInputs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.writeVTKfiles"><code class="docutils literal notranslate"><span class="pre">Data.writeVTKfiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.writeVTKfilesAtmosphere"><code class="docutils literal notranslate"><span class="pre">Data.writeVTKfilesAtmosphere()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#htrdrPy.data.Data.writeVTKfilesGround"><code class="docutils literal notranslate"><span class="pre">Data.writeVTKfilesGround()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="htrdrPy.geometry.html">htrdrPy.geometry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="htrdrPy.script.html">htrdrPy.script module</a></li>
<li class="toctree-l2"><a class="reference internal" href="htrdrPy.postprocess.html">htrdrPy.postprocess module</a></li>
<li class="toctree-l2"><a class="reference internal" href="htrdrPy.helperFunctions.html">htrdrPy.helperFunctions module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">htrdrPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="htrdrPy.html">htrdrPy documentation</a></li>
      <li class="breadcrumb-item active">htrdrPy.data module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/htrdrPy.data.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-htrdrPy.data">
<span id="htrdrpy-data-module"></span><h1>htrdrPy.data module<a class="headerlink" href="#module-htrdrPy.data" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="htrdrPy.data.Data">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">htrdrPy.data.</span></span><span class="sig-name descname"><span class="pre">Data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nTheta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nPhi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">htrdrPy.Data</span></code> is a class aiming to handle the optical and physical properties
of the system and to create the input files for htrdr.</p>
<p class="rubric">Examples</p>
<p>The first step is the creation of a instance of <code class="docutils literal notranslate"><span class="pre">htrdrPy.Data</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">htrdrPy</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">nTheta</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">nPhi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The next step is to provide the physical and radiative properties of the
atmosphere and ground. Different methods exist depending on the case
considered. In the following, we consider a 1D set of data forming an
horizontally homogeneous planet.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nLevel</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCoeff</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nWavelengths</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nWavelengths</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">altitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5e5</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scatt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">absor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asymm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2e7</span><span class="p">,</span> <span class="mf">9e7</span><span class="p">,</span> <span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">bandsUp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">wavelengths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfTemp</span><span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfAlb</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">makeAtmosphereFrom1D</span><span class="p">({</span>
<span class="gp">... </span>        <span class="s2">&quot;nLevel&quot;</span><span class="p">:</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nCoeff&quot;</span><span class="p">:</span> <span class="n">nCoeff</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nWavelengths&quot;</span><span class="p">:</span> <span class="n">nWavelengths</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="n">weights</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;altitude (m)&quot;</span><span class="p">:</span> <span class="n">altitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;temperature (K)&quot;</span><span class="p">:</span> <span class="n">temperatures</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;scattering (m-1)&quot;</span><span class="p">:</span> <span class="n">scatt</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;absorption (m-1)&quot;</span><span class="p">:</span> <span class="n">absor</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;assymetry&quot;</span><span class="p">:</span> <span class="n">asymm</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;wavelength&quot;</span><span class="p">:</span> <span class="n">wavelengths</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;band low&quot;</span><span class="p">:</span> <span class="n">bandsLow</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;band up&quot;</span><span class="p">:</span> <span class="n">bandsUp</span>
<span class="gp">... </span>        <span class="p">})</span>
<span class="go">Mesh generator. Ntheta = 30, Nphi = 50, Nz = 50, r_min = 1000000.0, r_max = 1500000.0</span>
<span class="go">Generating points...</span>
<span class="go">Generating nodes...</span>
<span class="go">Hexahedron &amp; Octahedron generation completed. N_Hexahedron = 4802, N_Octahedron = 64827</span>
<span class="go">Generating Tetrahedrons...</span>
<span class="go">Assigning data to nodes ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">makeGroundFrom1D</span><span class="p">(</span><span class="n">surfTemp</span><span class="p">,</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;lambertian&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;albedo&quot;</span><span class="p">:</span> <span class="n">surfAlb</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bandsLow</span><span class="p">,</span> <span class="n">bandsUp</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">... </span>        <span class="p">})</span>
<span class="go">Mesh generator. Ntheta = 30, Nphi = 50, R = 1000000.0</span>
<span class="go">Generating points...</span>
<span class="go">Generating nodes...</span>
<span class="go">triangles,rectangles generation completed. N_triangles = 98, N_rectangles = 1323</span>
<span class="go">Generating triangles...</span>
<span class="go">generating bin...</span>
</pre></div>
</div>
<p>Once the data have been provided, the method <code class="docutils literal notranslate"><span class="pre">htrdrPy.Data.writeInputs</span></code>
will generate the input file in an <cite>input_{name}</cite> folder.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">writeInputs</span><span class="p">()</span>
<span class="go">generating surface mesh bin file...</span>
<span class="go">Nnodes = 5586 Ncells = 2744 dim_node = 3 dim_cell = 3</span>
<span class="go">bin generation completed.</span>
<span class="go">generating surface properties bin file...</span>
<span class="go">bin generation completed.</span>
<span class="go">generating atmosphere mesh bin file...</span>
<span class="go">Nnodes = 547428 Ncells = 338541 dim_node = 3 dim_cell = 4</span>
<span class="go">bin generation completed.</span>
<span class="go">generating gas temperature bin file...</span>
<span class="go">bin generation completed.</span>
<span class="go">generating gas properties bin file...</span>
<span class="go">100%|_________________________________________________________________________________________________________________________________________________________| 20/20 [00:11&lt;00:00,  1.69it/s]</span>
<span class="go">bin generation completed.</span>
<span class="go">generating haze properties bin file...</span>
<span class="go">100%|_________________________________________________________________________________________________________________________________________________________| 20/20 [00:04&lt;00:00,  4.95it/s]</span>
<span class="go">bin generation completed.</span>
<span class="go">generating haze phase function bin file...</span>
<span class="go">bin generation completed.</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>float</em>) – Radius of the planet [m].</p></li>
<li><p><strong>nTheta</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>not requested if meshes loaded from file</em>) – Number of latitude points in the range [0°,360°] to be used.</p></li>
<li><p><strong>nPhi</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>not requested if meshes loaded from file</em>) – Number of latitude points in the range [-180°,180°].</p></li>
<li><p><strong>gravity</strong> (<em>float</em><em>, </em><em>optional</em><em>,</em>) – Gravity of the planet [m/s2]. Requested only for LMDZ-PCM
input/output files to extract the altitude grid from the
geopotential. Alternatively, the user can provide the planet mass.</p></li>
<li><p><strong>mass</strong> (<em>float</em><em>, </em><em>optional</em><em>,</em>) – Mass of the planet [kg]. Requested only for LMDZ-PCM
input/output files to extract the altitude grid from the
geopotential. Alternatively, the user can provide the planet gravity.</p></li>
<li><p><strong>name</strong> (str, optional, default uses a counter of the number of istances of <code class="docutils literal notranslate"><span class="pre">htrdrPy.Data</span></code>) – Name for the dataset, which will be used to name the input folders.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.cleanInputs">
<span class="sig-name descname"><span class="pre">cleanInputs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.cleanInputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.cleanInputs" title="Link to this definition"></a></dt>
<dd><p>Remove the inputs_{name} folder.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.makeAtmosphereFrom1D">
<span class="sig-name descname"><span class="pre">makeAtmosphereFrom1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.makeAtmosphereFrom1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.makeAtmosphereFrom1D" title="Link to this definition"></a></dt>
<dd><p>Generate a spherical atmosphere from single column data. The data
are provided at the levels, i.e. at the interface between layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – <p>Dictionnary with the following items:</p>
<ul class="simple">
<li><dl class="simple">
<dt>”nLevel”<span class="classifier">int</span></dt><dd><p>Number of levels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nCoeff”: int</dt><dd><p>Number of quadrature points for the k-coeff.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nWavelengths”:  int</dt><dd><p>Number of wavelengths.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nAngle”: int, optional</dt><dd><p>Number of angles in the phase functions (not required if
using the builtin Henyey-Greenstein phase function).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”weights”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>The weigths of the nCoeff quadrature points
(shape=(nWavelengths, nCoeff)).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”altitude (m)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of altitudes (shape=(nLevel), [m]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”temperature (K)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of temperatures (shape=(nLevel), [K]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”scattering (m-1)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of scattering coefficients
(shape=(nWavelengths, nLevel, nCoeff), [m-1]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”absorption (m-1)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of absorption coefficients
(shape=(nWavelengths, nLevel, nCoeff), [m-1]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”angles (°)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of angle values for the phase function
(shape=(nAngle), float [°]). Only required when providing
the <code class="docutils literal notranslate"><span class="pre">phaseFunc</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”phaseFunc”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of discrete phase functions (shape = (nWavelengths,
nLevel, nAngle, nCoeff)). Alternatively, the user can
provide an array of asymmetry parameter.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”asymmetry”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of asymmetry parameter (shape=(nWavelengths, nLevel,
nCoeff)).  Alternatively, the user can provide the discrete
phase function.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”wavelength”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the band center. The value is used of
the phase function.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”band low”:  <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the lower boundary of the band.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”band up”:  <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the lower boundary of the band.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The nTheta and nPhi parameters are used to define the resolution of the
atmosphere mesh and are therefore mandatory.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">htrdrPy</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">nTheta</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">nPhi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nLevel</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCoeff</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nWavelengths</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nWavelengths</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">altitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5e5</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scatt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">absor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asymm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2e7</span><span class="p">,</span> <span class="mf">9e7</span><span class="p">,</span> <span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">bandsUp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">wavelengths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">makeAtmosphereFrom1D</span><span class="p">({</span>
<span class="gp">... </span>        <span class="s2">&quot;nLevel&quot;</span><span class="p">:</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nCoeff&quot;</span><span class="p">:</span> <span class="n">nCoeff</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nWavelengths&quot;</span><span class="p">:</span> <span class="n">nWavelengths</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="n">weights</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;altitude (m)&quot;</span><span class="p">:</span> <span class="n">altitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;temperature (K)&quot;</span><span class="p">:</span> <span class="n">temperatures</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;scattering (m-1)&quot;</span><span class="p">:</span> <span class="n">scatt</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;absorption (m-1)&quot;</span><span class="p">:</span> <span class="n">absor</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;asymmetry&quot;</span><span class="p">:</span> <span class="n">asymm</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;wavelength&quot;</span><span class="p">:</span> <span class="n">wavelengths</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;band low&quot;</span><span class="p">:</span> <span class="n">bandsLow</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;band up&quot;</span><span class="p">:</span> <span class="n">bandsUp</span>
<span class="gp">... </span>        <span class="p">})</span>
<span class="go">Mesh generator. Ntheta = 30, Nphi = 50, Nz = 50, r_min = 1000000.0, r_max = 1500000.0</span>
<span class="go">Generating points...</span>
<span class="go">Generating nodes...</span>
<span class="go">Hexahedron &amp; Octahedron generation completed. N_Hexahedron = 4802, N_Octahedron = 64827</span>
<span class="go">Generating Tetrahedrons...</span>
<span class="go">Assigning data to nodes ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.makeAtmosphereFrom1D_PP">
<span class="sig-name descname"><span class="pre">makeAtmosphereFrom1D_PP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.makeAtmosphereFrom1D_PP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.makeAtmosphereFrom1D_PP" title="Link to this definition"></a></dt>
<dd><p>Generate a plan parallel atmosphere from single column data. The data
are provided at the levels, i.e. at the interface between layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – <p>Dictionnary with the following items:</p>
<ul class="simple">
<li><dl class="simple">
<dt>”nLevel”<span class="classifier">int</span></dt><dd><p>Number of levels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nCoeff”: int</dt><dd><p>Number of quadrature points for the k-coeff.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nWavelengths”:  int</dt><dd><p>Number of wavelengths.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nAngle”: int, optional</dt><dd><p>Number of angles in the phase functions (not required if
using the builtin Henyey-Greenstein phase function).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”weights”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>The weigths of the nCoeff quadrature points
(shape=(nWavelengths, nCoeff)).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”altitude (m)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of altitudes (shape=(nLevel), [m]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”temperature (K)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of temperatures (shape=(nLevel), [K]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”scattering (m-1)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of scattering coefficients
(shape=(nWavelengths, nLevel, nCoeff), [m-1]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”absorption (m-1)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of absorption coefficients
(shape=(nWavelengths, nLevel, nCoeff), [m-1]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”angles (°)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of angle values for the phase function
(shape=(nAngle), float [°]). Only required when providing
the <code class="docutils literal notranslate"><span class="pre">phaseFunc</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”phaseFunc”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of discrete phase functions (shape = (nWavelengths,
nLevel, nAngle, nCoeff)). Alternatively, the user can
provide an array of asymmetry parameter.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”asymmetry”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of asymmetry parameter (shape=(nWavelengths, nLevel,
nCoeff)).  Alternatively, the user can provide the discrete
phase function.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”wavelength”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the band center. The value is used of
the phase function.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”band low”:  <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the lower boundary of the band.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”band up”:  <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the lower boundary of the band.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In plan-parallel mode, the <code class="docutils literal notranslate"><span class="pre">radius</span></code> parameter passed at the
initialisation of the instance is used as the horizontal expansion of
the ground. Make sure to use a large enough value. Also, the nTheta and
nPhi parameters are not used.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">htrdrPy</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">nTheta</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">nPhi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nLevel</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCoeff</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nWavelengths</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nWavelengths</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">altitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5e5</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scatt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">absor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asymm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2e7</span><span class="p">,</span> <span class="mf">9e7</span><span class="p">,</span> <span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">bandsUp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">wavelengths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">makeAtmosphereFrom1D_PP</span><span class="p">({</span>
<span class="gp">... </span>        <span class="s2">&quot;nLevel&quot;</span><span class="p">:</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nCoeff&quot;</span><span class="p">:</span> <span class="n">nCoeff</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nWavelengths&quot;</span><span class="p">:</span> <span class="n">nWavelengths</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="n">weights</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;altitude (m)&quot;</span><span class="p">:</span> <span class="n">altitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;temperature (K)&quot;</span><span class="p">:</span> <span class="n">temperatures</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;scattering (m-1)&quot;</span><span class="p">:</span> <span class="n">scatt</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;absorption (m-1)&quot;</span><span class="p">:</span> <span class="n">absor</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;asymmetry&quot;</span><span class="p">:</span> <span class="n">asymm</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;wavelength&quot;</span><span class="p">:</span> <span class="n">wavelengths</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;band low&quot;</span><span class="p">:</span> <span class="n">bandsLow</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;band up&quot;</span><span class="p">:</span> <span class="n">bandsUp</span>
<span class="gp">... </span>        <span class="p">})</span>
<span class="go">Assigning data to nodes ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.makeAtmosphereFrom2D">
<span class="sig-name descname"><span class="pre">makeAtmosphereFrom2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.makeAtmosphereFrom2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.makeAtmosphereFrom2D" title="Link to this definition"></a></dt>
<dd><p>Generate a spherical atmosphere from single column data. The data
are provided at the levels, i.e. at the interface between layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – <p>Dictionnary with the following items:</p>
<ul>
<li><dl class="simple">
<dt>”nLevel”<span class="classifier">int</span></dt><dd><p>Number of levels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nLat”<span class="classifier">int</span></dt><dd><p>Number of latitudes.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nCoeff”: int</dt><dd><p>Number of quadrature points for the k-coeff.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nWavelengths”:  int</dt><dd><p>Number of wavelengths.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nAngle”: int, optional</dt><dd><p>Number of angles in the phase functions (not required if
using the builtin Henyey-Greenstein phase function).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”weights”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>The weigths of the nCoeff quadrature points
(shape=(nWavelengths, nCoeff)).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”altitude (m)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of altitudes (shape=(nLevel, nLat), [m]).</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”latitude (°)”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>List of latitudes (shape=(nLat), [°]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”temperature (K)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of temperatures (shape=(nLevel, nLat), [K]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”scattering (m-1)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of scattering coefficients
(shape=(nWavelengths, nLevel, nLat, nCoeff), [m-1]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”absorption (m-1)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of absorption coefficients
(shape=(nWavelengths, nLevel, nLat, nCoeff), [m-1]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”angles (°)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of angle values for the phase function
(shape=(nAngle), float [°]). Only required when providing
the <code class="docutils literal notranslate"><span class="pre">phaseFunc</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”phaseFunc”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of discrete phase functions (shape = (nWavelengths,
nLevel, nLat, nAngle, nCoeff)). Alternatively, the user can
provide an array of asymmetry parameter.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”asymmetry”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of asymmetry parameter (shape=(nWavelengths, nLevel,
nLat, nCoeff)).  Alternatively, the user can provide the
discrete phase function.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”wavelength”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the band center. The value is used of
the phase function.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”band low”:  <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the lower boundary of the band.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”band up”:  <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the lower boundary of the band.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The nPhi parameter provided at the initialisation of the
instance is used to define the longitudinal resolution of the
atmospheric mesh and is therefore manatory. The nTheta parameter is
obtained from the length of the <code class="docutils literal notranslate"><span class="pre">latitude</span></code> provided.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">htrdrPy</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">nPhi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nLevel</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nLat</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCoeff</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nWavelengths</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nWavelengths</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">altitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5e5</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">),</span> <span class="p">(</span><span class="n">nLat</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">nLat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">nLevel</span><span class="o">*</span><span class="n">nLat</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nLevel</span><span class="p">,</span><span class="n">nLat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scatt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nLat</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>                                                <span class="n">nLat</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">absor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nLat</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>                                                <span class="n">nLat</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asymm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nLat</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>                                                <span class="n">nLat</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2e7</span><span class="p">,</span> <span class="mf">9e7</span><span class="p">,</span> <span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">bandsUp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">wavelengths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">makeAtmosphereFrom2D</span><span class="p">({</span>
<span class="gp">... </span>        <span class="s2">&quot;nLevel&quot;</span><span class="p">:</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nLat&quot;</span><span class="p">:</span> <span class="n">nLat</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nCoeff&quot;</span><span class="p">:</span> <span class="n">nCoeff</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nWavelengths&quot;</span><span class="p">:</span> <span class="n">nWavelengths</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="n">weights</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;altitude (m)&quot;</span><span class="p">:</span> <span class="n">altitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;latitude (°)&quot;</span><span class="p">:</span> <span class="n">latitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;temperature (K)&quot;</span><span class="p">:</span> <span class="n">temperatures</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;scattering (m-1)&quot;</span><span class="p">:</span> <span class="n">scatt</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;absorption (m-1)&quot;</span><span class="p">:</span> <span class="n">absor</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;asymmetry&quot;</span><span class="p">:</span> <span class="n">asymm</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;wavelength&quot;</span><span class="p">:</span> <span class="n">wavelengths</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;band low&quot;</span><span class="p">:</span> <span class="n">bandsLow</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;band up&quot;</span><span class="p">:</span> <span class="n">bandsUp</span>
<span class="gp">... </span>        <span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.makeAtmosphereFrom3D">
<span class="sig-name descname"><span class="pre">makeAtmosphereFrom3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.makeAtmosphereFrom3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.makeAtmosphereFrom3D" title="Link to this definition"></a></dt>
<dd><p>Generate a spherical atmosphere from single column data. The data
are provided at the levels, i.e. at the interface between layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – <p>Dictionnary with the following items:</p>
<ul>
<li><dl class="simple">
<dt>”nLevel”<span class="classifier">int</span></dt><dd><p>Number of levels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nLat”<span class="classifier">int</span></dt><dd><p>Number of latitudes.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nLon”<span class="classifier">int</span></dt><dd><p>Number of longitudes.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nCoeff”: int</dt><dd><p>Number of quadrature points for the k-coeff.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nWavelengths”:  int</dt><dd><p>Number of wavelengths.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nAngle”: int, optional</dt><dd><p>Number of angles in the phase functions (not required if
using the builtin Henyey-Greenstein phase function).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”weights”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>The weigths of the nCoeff quadrature points
(shape=(nWavelengths, nCoeff)).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”altitude (m)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of altitudes (shape=(nLevel, nLat, nLon), [m]).</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”latitude (°)”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>List of latitudes (shape=(nLat), [°]).</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”longitude (°)”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>List of longitudes (shape=(nLon), [°]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”temperature (K)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of temperatures (shape=(nLevel, nLat, nLon), [K]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”scattering (m-1)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of scattering coefficients
(shape=(nWavelengths, nLevel, nLat, nLon, nCoeff), [m-1]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”absorption (m-1)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of absorption coefficients
(shape=(nWavelengths, nLevel, nLat, nLon, nCoeff), [m-1]).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”angles (°)”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of angle values for the phase function
(shape=(nAngle), float [°]). Only required when providing
the <code class="docutils literal notranslate"><span class="pre">phaseFunc</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”phaseFunc”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of discrete phase functions (shape = (nWavelengths,
nLevel, nLat, nLon, nAngle, nCoeff)). Alternatively, the
user can provide an array of asymmetry parameter.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”asymmetry”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of asymmetry parameter (shape=(nWavelengths, nLevel,
nLat, nLon, nCoeff)).  Alternatively, the user can provide
the discrete phase function.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”wavelength”: <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the band center. The value is used of
the phase function.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”band low”:  <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the lower boundary of the band.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”band up”:  <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>Array of wavelength (shape = (nWavelengths), [m]). The
values corresponds to the lower boundary of the band.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The nTheta and nPhi parameters provided at the initialisation of the
instance are not used and instead are defined from the length of the
<code class="docutils literal notranslate"><span class="pre">latitude</span> <span class="pre">(°)</span></code> and <code class="docutils literal notranslate"><span class="pre">longitude</span> <span class="pre">(°)</span></code>, respectively.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">htrdrPy</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nLevel</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nLat</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nLon</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nCoeff</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nWavelengths</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nWavelengths</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">altitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5e5</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">),</span>
<span class="gp">... </span>                                <span class="p">(</span><span class="n">nLat</span><span class="p">,</span> <span class="n">nLon</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">nLat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">longitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="n">nLon</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">nLevel</span><span class="o">*</span><span class="n">nLat</span><span class="o">*</span><span class="n">nLon</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nLevel</span><span class="p">,</span><span class="n">nLat</span><span class="p">,</span> <span class="n">nLon</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scatt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nLat</span><span class="o">*</span><span class="n">nLon</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>                                                <span class="n">nLat</span><span class="p">,</span> <span class="n">nLon</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">absor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nLat</span><span class="o">*</span><span class="n">nLon</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>                                                <span class="n">nLat</span><span class="p">,</span> <span class="n">nLon</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asymm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nLevel</span><span class="o">*</span><span class="n">nLat</span><span class="o">*</span><span class="n">nLon</span><span class="o">*</span><span class="n">nCoeff</span><span class="o">*</span><span class="n">nWavelengths</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>                                                <span class="n">nLat</span><span class="p">,</span> <span class="n">nLon</span><span class="p">,</span> <span class="n">nCoeff</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2e7</span><span class="p">,</span> <span class="mf">9e7</span><span class="p">,</span> <span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">bandsUp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">wavelengths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">makeAtmosphereFrom3D</span><span class="p">({</span>
<span class="gp">... </span>        <span class="s2">&quot;nLevel&quot;</span><span class="p">:</span> <span class="n">nLevel</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nLat&quot;</span><span class="p">:</span> <span class="n">nLat</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nLon&quot;</span><span class="p">:</span> <span class="n">nLon</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nCoeff&quot;</span><span class="p">:</span> <span class="n">nCoeff</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;nWavelengths&quot;</span><span class="p">:</span> <span class="n">nWavelengths</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="n">weights</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;altitude (m)&quot;</span><span class="p">:</span> <span class="n">altitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;latitude (°)&quot;</span><span class="p">:</span> <span class="n">latitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;longitude (°)&quot;</span><span class="p">:</span> <span class="n">longitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;temperature (K)&quot;</span><span class="p">:</span> <span class="n">temperatures</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;scattering (m-1)&quot;</span><span class="p">:</span> <span class="n">scatt</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;absorption (m-1)&quot;</span><span class="p">:</span> <span class="n">absor</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;asymmetry&quot;</span><span class="p">:</span> <span class="n">asymm</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;wavelength&quot;</span><span class="p">:</span> <span class="n">wavelengths</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;band low&quot;</span><span class="p">:</span> <span class="n">bandsLow</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;band up&quot;</span><span class="p">:</span> <span class="n">bandsUp</span>
<span class="gp">... </span>        <span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.makeFromLMDZ">
<span class="sig-name descname"><span class="pre">makeFromLMDZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">LMDZinput</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LMDZouput</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys={'altitude':</span> <span class="pre">'altitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'assym':</span> <span class="pre">'gv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'extinction':</span> <span class="pre">'kv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'geopotential':</span> <span class="pre">'pphi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'geopotentialSurf':</span> <span class="pre">'pphis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'latitude':</span> <span class="pre">'lat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'longitude':</span> <span class="pre">'lon'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'pressure':</span> <span class="pre">'p'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'ssa':</span> <span class="pre">'wv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'temp':</span> <span class="pre">'temp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'tsurf':</span> <span class="pre">'tsurf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'wavelength':</span> <span class="pre">'wavelength_vi'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time=-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hg=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nAngle=181</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phaseFunc=&lt;function</span> <span class="pre">Data.&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.makeFromLMDZ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.makeFromLMDZ" title="Link to this definition"></a></dt>
<dd><p>Generate an heterogeneous sphere from LMDZ output and input files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>LMDZinput</strong> (<em>str</em>) – Path to the netCDF file containing surface information, to be read.</p></li>
<li><p><strong>LMDZouput</strong> (<em>str</em>) – Path to the netCDF file containing atmosphere information, to be
read.</p></li>
<li><p><strong>weights</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional) – Array containing the weights of the Gaussian quadrature points for
correlated-k data (shape=(nWeight)). If not provided, assumes no
correlated-k are used. It is not required if wavelengths are
separted (see wavelengths).</p></li>
<li><p><strong>keys</strong> (<em>{str : str}</em><em>, </em><em>default htrdrPy.keysLMDZtitan_vi</em>) – <p>Dictionnary of correspondance between keys used in this method and
keys from the input/output file. It must contain the following keys:</p>
<ul>
<li><dl class="simple">
<dt>’tsurf’<span class="classifier">default ‘tsurf’</span></dt><dd><p>Key for the surface temperature.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’temp’<span class="classifier">default ‘temp’</span></dt><dd><p>Key for the atmospheric temperature.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’wavelength’<span class="classifier">default ‘wavelength_vi’</span></dt><dd><p>Key for the wavelengths.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’ssa’: default ‘wv’</dt><dd><p>Key for the single scatering albedo.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’extinction’<span class="classifier">default ‘kv’</span></dt><dd><p>Key for the extinction coefficeint.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’assym’<span class="classifier">default ‘gv’</span></dt><dd><p>Key for the assymetry parameter.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’geopotential’<span class="classifier">default ‘pphi’</span></dt><dd><p>Key for the geopotential.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’altitude’<span class="classifier">default ‘altitude’</span></dt><dd><p>Key for the altitude.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’latitude’<span class="classifier">default ‘lat’</span></dt><dd><p>Key for the latitude.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’longitude’<span class="classifier">default ‘lon’</span></dt><dd><p>Key for the longitude.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’pressure’<span class="classifier">default ‘p’</span></dt><dd><p>Key for the pressure.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>wavelengths</strong> (<em>{str : dict}</em><em>, </em><em>optional</em>) – <p>Dictionnary containing the wavelength bands data. It must be
composed of 1 sub-dictionnary for every band.</p>
<ul>
<li><dl>
<dt>’index’<span class="classifier">dict</span></dt><dd><p>Dictionnary containing the data for a specific band
(‘index’ is the index refering to the band in the GCM output
file, e.g. ‘v_23’ for the last visible band in Titan GCM).
The sub-dictionnary must contain the following items:</p>
<ul>
<li><dl class="simple">
<dt>’wavelength’<span class="classifier">float</span></dt><dd><p>Central wavelength of the band (in m).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’low’<span class="classifier">float</span></dt><dd><p>Lower bound of the band (in m).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’up’<span class="classifier">float</span></dt><dd><p>Upper bound of the band (in m).</p>
</dd>
</dl>
</li>
<li><dl>
<dt>’weights’<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</span></dt><dd><p>The weights associated to the different k-correlated
coefficents (shape=(nWeights)). If no k-coeff are used,
omit the key.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>time</strong> (<em>int</em><em>,  </em><em>default -1</em>) – Time index to use, default is last.</p></li>
<li><p><strong>hg</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether or not to use the Henyey-Greenstein phase function built in
htrdr</p></li>
<li><p><strong>nAngle</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default 181</em>) – Number of angles to use in the discrete phase functions. (If
<code class="docutils literal notranslate"><span class="pre">hg=True</span></code> nAngle is omitted).</p></li>
<li><p><strong>phaseFunc</strong> (<em>func</em><em>, </em><em>optional</em><em>, </em><em>default = 1 + g cos</em><em>(</em><em>theta</em><em>)</em>) – Function to calculate the discrete phase function. The function must
take in first argument the asymetry parameter and in second argument
the angle (in rad). If <code class="docutils literal notranslate"><span class="pre">hg=True</span></code> phaseFunc is omitted.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the surface temperature is not provided in the output file, it will
be read from the input file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.makeGroundFrom1D">
<span class="sig-name descname"><span class="pre">makeGroundFrom1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surfaceTemperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brdf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.makeGroundFrom1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.makeGroundFrom1D" title="Link to this definition"></a></dt>
<dd><p>Generates a spherical ground considering uniform temperature and
optical properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surfaceTemperature</strong> (<em>float</em>) – Temperature of the surface [K].</p></li>
<li><p><strong>brdf</strong> (<em>dict</em>) – <p>Surface reflexion properties with the following items:</p>
<ul>
<li><dl class="simple">
<dt>”kind”<span class="classifier">{“lambertian”, “specular”})</span></dt><dd><p>Kind of brdf function to use.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”albedo”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Wavelength dependent surface albedos (shape=(nWavelength)) .</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”wavelengths”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</span></dt><dd><p>Wavelengths where the albedo is defined
(shape=(nWavelength), [m]). Alternatively, the user can
specify the bands with the “bands” keyword.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”bands”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</span></dt><dd><p>Wavelengths bands where the albedo is defined
(shape=(nWavelength,2), [m]). The values corresponds
to the bands limits.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The nTheta and nPhi parameters provided at the initialisation of the
instance are used to define the resolution of the ground mesh and
are therefore manatory.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">htrdrPy</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">nTheta</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">nPhi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2e7</span><span class="p">,</span> <span class="mf">9e7</span><span class="p">,</span> <span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">bandsUp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">wavelengths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfTemp</span><span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfAlb</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">makeGroundFrom1D</span><span class="p">(</span><span class="n">surfTemp</span><span class="p">,</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;lambertian&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;albedo&quot;</span><span class="p">:</span> <span class="n">surfAlb</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bandsLow</span><span class="p">,</span> <span class="n">bandsUp</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">... </span>        <span class="p">})</span>
<span class="go">Mesh generator. Ntheta = 30, Nphi = 50, R = 1000000.0</span>
<span class="go">Generating points...</span>
<span class="go">Generating noeds...</span>
<span class="go">triangles,rectangles generation completed. N_triangles = 98, N_rectangles = 1323</span>
<span class="go">Generating triangles...</span>
<span class="go">generating bin...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.makeGroundFrom1D_PP">
<span class="sig-name descname"><span class="pre">makeGroundFrom1D_PP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surfaceTemperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brdf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.makeGroundFrom1D_PP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.makeGroundFrom1D_PP" title="Link to this definition"></a></dt>
<dd><p>Generates a plan-parallel ground considering uniform temperature and
optical properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surfaceTemperature</strong> (<em>float</em>) – Temperature of the surface [K].</p></li>
<li><p><strong>brdf</strong> (<em>dict</em>) – <p>Surface reflexion properties with the following items:</p>
<ul>
<li><dl class="simple">
<dt>”kind”<span class="classifier">{“lambertian”, “specular”})</span></dt><dd><p>Kind of brdf function to use.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”albedo”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Wavelength dependent surface albedos (shape=(nWavelength)) .</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”wavelengths”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</span></dt><dd><p>Wavelengths where the albedo is defined
(shape=(nWavelength), [m]). Alternatively, the user can
specify the bands with the “bands” keyword.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”bands”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</span></dt><dd><p>Wavelengths bands where the albedo is defined
(shape=(nWavelength,2), [m]). The values corresponds
to the bands limits.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In plan-parallel mode, the <code class="docutils literal notranslate"><span class="pre">radius</span></code> parameter passed at the
initialisation of the instance is used as the horizontal expansion of
the ground. Make sure to use a large enough value. Also, the nTheta and
nPhi parameters are not used.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">htrdrPy</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2e7</span><span class="p">,</span> <span class="mf">9e7</span><span class="p">,</span> <span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">bandsUp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">wavelengths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfTemp</span><span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfAlb</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">makeGroundFrom1D_PP</span><span class="p">(</span><span class="n">surfTemp</span><span class="p">,</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;lambertian&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;albedo&quot;</span><span class="p">:</span> <span class="n">surfAlb</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bandsLow</span><span class="p">,</span> <span class="n">bandsUp</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">... </span>        <span class="p">})</span>
<span class="go">generating bin...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.makeGroundFrom2D">
<span class="sig-name descname"><span class="pre">makeGroundFrom2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surfaceTemperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brdf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.makeGroundFrom2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.makeGroundFrom2D" title="Link to this definition"></a></dt>
<dd><p>Generates a spherical ground considering temperature and
optical properties varying along the latitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surfaceTemperature</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Temperature of the surface (shape=(nLat), [K]).</p></li>
<li><p><strong>brdf</strong> (<em>dict</em>) – <p>Surface reflexion properties with the following items:</p>
<ul>
<li><dl class="simple">
<dt>”kind”<span class="classifier">{“lambertian”, “specular”})</span></dt><dd><p>Kind of brdf function to use.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”albedo”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Wavelength dependent surface albedos
(shape=(nWavelength, nLat)).</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”latitude”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>List of latitudes (shape=(nLat), [°]).</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”wavelengths”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</span></dt><dd><p>Wavelengths where the albedo is defined
(shape=(nWavelength), [m]). Alternatively, the user can
specify the bands with the “bands” keyword.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”bands”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</span></dt><dd><p>Wavelengths bands where the albedo is defined
(shape=(nWavelength,2), [m]). The values corresponds
to the bands limits.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The nPhi parameter provided at the initialisation of the
instance is used to define the longitudinal resolution of the ground
mesh and is therefore manatory. The nTheta parameter is obtained from
the length of the <code class="docutils literal notranslate"><span class="pre">latitude</span></code> provided.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">htrdrPy</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">nPhi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nLat</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2e7</span><span class="p">,</span> <span class="mf">9e7</span><span class="p">,</span> <span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">bandsUp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">wavelengths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">nLat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfTemp</span> <span class="o">=</span> <span class="mi">300</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">latitudes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfAlb</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLat</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">makeGroundFrom2D</span><span class="p">(</span><span class="n">surfTemp</span><span class="p">,</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;lambertian&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;albedo&quot;</span><span class="p">:</span> <span class="n">surfAlb</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="n">latitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bandsLow</span><span class="p">,</span> <span class="n">bandsUp</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">... </span>        <span class="p">})</span>
<span class="go">Mesh generator. Ntheta = 30, Nphi = 50, R = 1000000.0</span>
<span class="go">Generating points...</span>
<span class="go">Generating noeds...</span>
<span class="go">triangles,rectangles generation completed. N_triangles = 98, N_rectangles = 1323</span>
<span class="go">Generating triangles...</span>
<span class="go">generating bin...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.makeGroundFrom3D">
<span class="sig-name descname"><span class="pre">makeGroundFrom3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SurfaceTemperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brdf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.makeGroundFrom3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.makeGroundFrom3D" title="Link to this definition"></a></dt>
<dd><p>Generates a spherical ground considering temperature and
optical properties varying along the latitude and longitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surfaceTemperature</strong> (<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – Temperature of the surface (shape=(nLat, nLon), [K]).</p></li>
<li><p><strong>brdf</strong> (<em>dict</em>) – <p>Surface reflexion properties with the following items:</p>
<ul>
<li><dl class="simple">
<dt>”kind”<span class="classifier">{“lambertian”, “specular”})</span></dt><dd><p>Kind of brdf function to use.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”albedo”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Wavelength dependent surface albedos
(shape=(nWavelength, nLat, nLon)).</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”latitude”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>List of latitudes (shape=(nLat), [°]).</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”longitude”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>List of longitudes (shape=(nLon), [°]).</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”wavelengths”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</span></dt><dd><p>Wavelengths where the albedo is defined
(shape=(nWavelength), [m]). Alternatively, the user can
specify the bands with the “bands” keyword.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>”bands”<span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, optional</span></dt><dd><p>Wavelengths bands where the albedo is defined
(shape=(nWavelength,2), [m]). The values corresponds
to the bands limits.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The nTheta and nPhi parameters provided at the initialisation of the
instance are not used and instead are defined from the length of the
<code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, respectively.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">htrdrPy</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nLat</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nLon</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2e7</span><span class="p">,</span> <span class="mf">9e7</span><span class="p">,</span> <span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nWavelengths</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">bandsUp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">wavelengths</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsLow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bandsUp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mf">1.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wavelengths</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">nLat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">longitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="n">nLon</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfTemp</span> <span class="o">=</span> <span class="mi">300</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">nLat</span><span class="p">,</span> <span class="n">nLon</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfAlb</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">nWavelengths</span><span class="p">,</span> <span class="n">nLat</span><span class="p">,</span> <span class="n">nLon</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">makeGroundFrom3D</span><span class="p">(</span><span class="n">surfTemp</span><span class="p">,</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;lambertian&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;albedo&quot;</span><span class="p">:</span> <span class="n">surfAlb</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="n">latitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="n">longitudes</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;bands&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bandsLow</span><span class="p">,</span> <span class="n">bandsUp</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">... </span>        <span class="p">})</span>
<span class="go">Mesh generator. Ntheta = 30, Nphi = 50, R = 1000000.0</span>
<span class="go">Generating points...</span>
<span class="go">Generating noeds...</span>
<span class="go">triangles,rectangles generation completed. N_triangles = 98, N_rectangles = 1323</span>
<span class="go">Generating triangles...</span>
<span class="go">generating bin...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.writeInputAtmosphere">
<span class="sig-name descname"><span class="pre">writeInputAtmosphere</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.writeInputAtmosphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.writeInputAtmosphere" title="Link to this definition"></a></dt>
<dd><p>Write the atmosphere binary input files for htrdr-planets</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.writeInputGround">
<span class="sig-name descname"><span class="pre">writeInputGround</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.writeInputGround"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.writeInputGround" title="Link to this definition"></a></dt>
<dd><p>Write the ground binary input files for htrdr-planets</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.writeInputs">
<span class="sig-name descname"><span class="pre">writeInputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">octree_def</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opthick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nthOctree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">procOctree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'master'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">octreeFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.writeInputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.writeInputs" title="Link to this definition"></a></dt>
<dd><p>Write the binary input files for htrdr-planets and precalculate octrees
if the <code class="docutils literal notranslate"><span class="pre">octreeFile</span></code> is passed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>octree_def</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>default 512</em>) – Maximal defintion of the octree grid.</p></li>
<li><p><strong>opthick</strong> (<em>float</em><em> or </em><em>str</em><em>, </em><em>default 1</em>) – Optical thickness threshold to assess the merge of cells.</p></li>
<li><p><strong>nthOctree</strong> (<em>int</em><em>, </em><em>default 8</em>) – Number of threads to use for octree computation.</p></li>
<li><p><strong>procOctree</strong> (<em>{'all'</em><em>, </em><em>'master'}</em><em>, </em><em>default 'master'</em>) – Which process must realize the octree calculation (useless if no
storage). Put to ‘all’ if the processes do not share the disk space.</p></li>
<li><p><strong>octreeFile</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename to use for the stroring of octrees. If not provided,
octrees are not stored on disk. If a file is provided, a “blank run”
of htrdr-planets is launched to precalculate octrees. The file is
located in the outputs_{name} folder.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">htrdrPy</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">nPhi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Planet&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">writeInputs</span><span class="p">(</span><span class="n">octreeFile</span><span class="o">=</span><span class="s2">&quot;octree.bin&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will generate the input files and start a very quick run of
htrdr-planets to generate an octree file that will be stored in
outputs_Planet/octree.bin</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">writeInputs</span><span class="p">(</span><span class="n">octree_def</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
</pre></div>
</div>
<p>This will generate the input files and keep the information on the
octree_def for the future calculation of the octrees. The octrees are
not precalculated since they will only be stored in memory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.writeVTKfiles">
<span class="sig-name descname"><span class="pre">writeVTKfiles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.writeVTKfiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.writeVTKfiles" title="Link to this definition"></a></dt>
<dd><p>Write the VTK and obj files for view in paraview or other visualisation
software handling obj and VTK files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.writeVTKfilesAtmosphere">
<span class="sig-name descname"><span class="pre">writeVTKfilesAtmosphere</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.writeVTKfilesAtmosphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.writeVTKfilesAtmosphere" title="Link to this definition"></a></dt>
<dd><p>Write the atmosphere VTK and obj files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="htrdrPy.data.Data.writeVTKfilesGround">
<span class="sig-name descname"><span class="pre">writeVTKfilesGround</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/htrdrPy/data.html#Data.writeVTKfilesGround"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#htrdrPy.data.Data.writeVTKfilesGround" title="Link to this definition"></a></dt>
<dd><p>Write the ground VTK and obj files.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="htrdrPy.html" class="btn btn-neutral float-left" title="htrdrPy documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="htrdrPy.geometry.html" class="btn btn-neutral float-right" title="htrdrPy.geometry module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Anthony Arfaux.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>