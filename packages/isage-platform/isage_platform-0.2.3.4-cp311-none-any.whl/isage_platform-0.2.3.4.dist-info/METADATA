Metadata-Version: 2.4
Name: isage-platform
Version: 0.2.3.4
Summary: SAGE Platform Services - Queue, Storage, and Service Abstractions
Author-email: IntelliStream Team <shuhao_zhang@hust.edu.cn>
License: MIT
Project-URL: Homepage, https://github.com/sage-ai/sage
Project-URL: Documentation, https://sage-ai.org/docs
Project-URL: Repository, https://github.com/sage-ai/sage
Project-URL: Issues, https://github.com/sage-ai/sage/issues
Keywords: ai,sage,platform,queue,storage,infrastructure
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: ray[client]<3.0.0,>=2.48.0
Requires-Dist: paramiko<4.0.0,>=3.5.0
Requires-Dist: fabric<4.0.0,>=3.2.0
Provides-Extra: dev
Requires-Dist: pytest>=7.4.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "dev"
Requires-Dist: ruff==0.14.6; extra == "dev"
Requires-Dist: mypy>=1.7.0; extra == "dev"
Provides-Extra: all

# SAGE Platform

> å¹³å°æœåŠ¡å±‚ (L2) - SAGE åŸºç¡€è®¾æ–½æŠ½è±¡

[![Python Version](https://img.shields.io/badge/python-3.9%2B-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](../../LICENSE)

## ğŸ“‹ æ¦‚è¿°

**SAGE Platform** æä¾›æ ¸å¿ƒåŸºç¡€è®¾æ–½æŠ½è±¡ï¼Œä½äºåŸºç¡€å±‚ï¼ˆ`sage-common`ï¼‰å’Œæ‰§è¡Œå¼•æ“ï¼ˆ`sage-kernel`ï¼‰ä¹‹é—´ã€‚è¿™ä¸ªç¬¬äºŒå±‚å¹³å°æœåŠ¡æä¾›ï¼š

## ğŸ§­ Governance / å›¢é˜Ÿåä½œåˆ¶åº¦

- `docs/governance/TEAM.md`

- `docs/governance/MAINTAINERS.md`

- `docs/governance/DEVELOPER_GUIDE.md`

- `docs/governance/PR_CHECKLIST.md`

- `docs/governance/SELF_HOSTED_RUNNER.md`

- `docs/governance/TODO.md`

- **é˜Ÿåˆ—æŠ½è±¡**ï¼šPythonã€Ray å’Œ RPC é˜Ÿåˆ—çš„ç»Ÿä¸€æ¥å£

- **å­˜å‚¨æŠ½è±¡**ï¼šå¯æ’æ‹”çš„é”®å€¼å­˜å‚¨åç«¯

- **æœåŠ¡åŸºç±»**ï¼šæ„å»º SAGE æœåŠ¡çš„åŸºç¡€

- **å¹³å°æ¥å£**ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿçš„é€šç”¨æ¨¡å¼

è¯¥åŒ…ä½¿åº”ç”¨ç¨‹åºä»£ç èƒ½å¤Ÿåœ¨æœ¬åœ°å’Œåˆ†å¸ƒå¼æ‰§è¡Œæ¨¡å¼ä¹‹é—´æ— ç¼åˆ‡æ¢ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **å¤šæ€é˜Ÿåˆ—**ï¼šPython Queueã€Ray Queue å’Œ RPC Queue çš„å•ä¸€ API
- **å¯æ’æ‹”å­˜å‚¨**ï¼šå†…å­˜ã€Redis å’Œè‡ªå®šä¹‰å­˜å‚¨åç«¯
- **æœåŠ¡æ¡†æ¶**ï¼šæ„å»ºå¹³å°æœåŠ¡çš„åŸºç±»
- **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„ç±»å‹æç¤ºå’Œè¿è¡Œæ—¶éªŒè¯
- **é›¶å¼€é”€**ï¼šæœ¬åœ°æ‰§è¡Œçš„æœ€å°æŠ½è±¡æˆæœ¬

## ç»„ä»¶

### ğŸ”„ é˜Ÿåˆ— (`sage.platform.queue`)

æ”¯æŒå¤šç§åç«¯çš„å¤šæ€é˜Ÿåˆ—æè¿°ç¬¦ï¼š

```python
from sage.platform.queue import (
    BaseQueueDescriptor,
    PythonQueueDescriptor,
    RayQueueDescriptor,
    RPCQueueDescriptor,
)

# åˆ›å»º Ray é˜Ÿåˆ—
queue_desc = RayQueueDescriptor(maxsize=1000, queue_id="my_queue")
queue = queue_desc.queue_instance

# ä½¿ç”¨é˜Ÿåˆ—æ“ä½œ
queue_desc.put(item)
item = queue_desc.get()
```

**ç‰¹æ€§**ï¼š

- å»¶è¿Ÿåˆå§‹åŒ–
- åºåˆ—åŒ–æ”¯æŒ
- è·¨è¿›ç¨‹é€šä¿¡
- åç«¯æ— å…³çš„ API

### ğŸ’¾ å­˜å‚¨ (`sage.platform.storage`)

é”®å€¼å­˜å‚¨æŠ½è±¡ï¼š

```python
from sage.platform.storage.kv_backend import BaseKVBackend, DictKVBackend

# ä½¿ç”¨å†…å­˜åç«¯
backend = DictKVBackend()
backend.set("key", "value")
value = backend.get("key")


# ä½¿ç”¨è‡ªå®šä¹‰åç«¯æ‰©å±•
class RedisKVBackend(BaseKVBackend):
    # å®ç°æŠ½è±¡æ–¹æ³•
    ...
```

**æ”¯æŒçš„æ“ä½œ**ï¼š

- `get(key)`, `set(key, value)`, `delete(key)`
- `has(key)`, `clear()`, `get_all_keys()`
- ç£ç›˜æŒä¹…åŒ–ï¼š`store_data_to_disk()`, `load_data_to_memory()`

### ğŸ”Œ æœåŠ¡ (`sage.platform.service`)

SAGE æœåŠ¡çš„åŸºç±»ï¼š

```python
from sage.platform.service import BaseService


class MyService(BaseService):
    def __init__(self, config):
        super().__init__(name="my_service")
        self.config = config

    def process(self, request):
        # æœåŠ¡é€»è¾‘
        return response
```

## ğŸ“¦ åŒ…ç»“æ„

```
sage-platform/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ sage/
â”‚       â””â”€â”€ platform/
â”‚           â”œâ”€â”€ __init__.py
â”‚           â”œâ”€â”€ queue/              # é˜Ÿåˆ—æŠ½è±¡
â”‚           â”‚   â”œâ”€â”€ base.py
â”‚           â”‚   â”œâ”€â”€ python_queue.py
â”‚           â”‚   â”œâ”€â”€ ray_queue.py
â”‚           â”‚   â””â”€â”€ rpc_queue.py
â”‚           â”œâ”€â”€ storage/            # å­˜å‚¨åç«¯
â”‚           â”‚   â””â”€â”€ kv_backend.py
â”‚           â””â”€â”€ service/            # æœåŠ¡åŸºç±»
â”‚               â””â”€â”€ base.py
â”œâ”€â”€ tests/
â”œâ”€â”€ pyproject.toml
â””â”€â”€ README.md
```

## ğŸš€ å®‰è£…

### åŸºç¡€å®‰è£…

```bash
pip install isage-platform
```

### å¼€å‘å®‰è£…

```bash
cd packages/sage-platform
pip install -e .
```

### å®‰è£…å¯é€‰ä¾èµ–

```bash
# å®‰è£… Ray æ”¯æŒï¼ˆåˆ†å¸ƒå¼é˜Ÿåˆ—ï¼‰
pip install isage-platform[ray]

# å®‰è£… Redis æ”¯æŒï¼ˆåˆ†å¸ƒå¼å­˜å‚¨ï¼‰
pip install isage-platform[redis]

# å®Œæ•´å®‰è£…
pip install isage-platform[all]
```

## ğŸ“– å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨é˜Ÿåˆ—

```python
from sage.platform.queue import RayQueueDescriptor

# åˆ›å»ºåˆ†å¸ƒå¼é˜Ÿåˆ—
queue_desc = RayQueueDescriptor(maxsize=1000, queue_id="my_distributed_queue")

# ç”Ÿäº§è€…
queue_desc.put({"task": "process_data", "data": [1, 2, 3]})

# æ¶ˆè´¹è€…
task = queue_desc.get()
print(f"å¤„ç†ä¸­: {task}")

# æ£€æŸ¥é˜Ÿåˆ—çŠ¶æ€
print(f"é˜Ÿåˆ—å¤§å°: {queue_desc.qsize()}")
print(f"æ˜¯å¦ä¸ºç©º: {queue_desc.empty()}")
```

### ä½¿ç”¨å­˜å‚¨

```python
from sage.platform.storage.kv_backend import DictKVBackend

# åˆ›å»ºå­˜å‚¨åç«¯
storage = DictKVBackend()

# å­˜å‚¨æ•°æ®
storage.set("user:1", {"name": "Alice", "age": 30})
storage.set("user:2", {"name": "Bob", "age": 25})

# æ£€ç´¢æ•°æ®
user = storage.get("user:1")
print(f"ç”¨æˆ·: {user}")

# åˆ—å‡ºæ‰€æœ‰é”®
keys = storage.get_all_keys()
print(f"æ‰€æœ‰é”®: {keys}")

# æŒä¹…åŒ–åˆ°ç£ç›˜
storage.store_data_to_disk("storage.pkl")
```

### åˆ›å»ºæœåŠ¡

```python
from sage.platform.service import BaseService


class DataProcessingService(BaseService):
    def __init__(self, config):
        super().__init__(name="data_processing")
        self.config = config
        self.initialize()

    def initialize(self):
        """åˆå§‹åŒ–æœåŠ¡èµ„æº"""
        self.logger.info(f"åˆå§‹åŒ– {self.name}")

    def process(self, request):
        """å¤„ç†ä¼ å…¥è¯·æ±‚"""
        self.logger.debug(f"å¤„ç†è¯·æ±‚: {request}")
        result = self._transform_data(request["data"])
        return {"status": "success", "result": result}

    def _transform_data(self, data):
        # æœåŠ¡é€»è¾‘
        return [x * 2 for x in data]


# ä½¿ç”¨æœåŠ¡
service = DataProcessingService({"param": "value"})
result = service.process({"data": [1, 2, 3]})
print(result)  # {"status": "success", "result": [2, 4, 6]}
```

## ğŸ”§ é…ç½®

æœåŠ¡å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ï¼š

```yaml
# platform_config.yaml
platform:
  queue:
    backend: ray  # æˆ– python, rpc
    maxsize: 1000

  storage:
    backend: dict  # æˆ– redis
    persist: true
    save_path: ./storage
```

## æ¶æ„ä½ç½®

```
L1: sage-common         â† åŸºç¡€å±‚
L2: sage-platform       â† å½“å‰å±‚
L3: sage-kernel         â† æ‰§è¡Œå¼•æ“
    sage-libs
L4: sage-middleware     â† é¢†åŸŸç»„ä»¶
L5: sage-cli            â† å‘½ä»¤è¡Œæ¥å£
    sage-tools          â† å¼€å‘å·¥å…·
```

**ç‹¬ç«‹ä»“åº“** (ä¸åœ¨ SAGE æ ¸å¿ƒæ¶æ„ä¸­):

- sage-benchmark - åŸºå‡†æµ‹è¯•
- sage-examples - åº”ç”¨ç¤ºä¾‹
- sage-studio - Web UI
- sageLLM - LLM æ¨ç†å¼•æ“

## è®¾è®¡åŸåˆ™

1. **é€šç”¨åŸºç¡€è®¾æ–½**ï¼šå¹³å°æœåŠ¡ä¸æ˜¯ SAGE ç‰¹å®šçš„
1. **åç«¯æ— å…³**ï¼šæ”¯æŒå¤šç§å®ç°ï¼ˆPythonã€Rayã€Redis ç­‰ï¼‰
1. **æœ€å°ä¾èµ–**ï¼šä»…ä¾èµ– `sage-common`
1. **å¯æ‰©å±•æ€§**ï¼šæ˜“äºæ·»åŠ æ–°åç«¯

## ä¸ºä»€ä¹ˆéœ€è¦ L2 å±‚ï¼Ÿ

åŸæœ¬è¿™äº›æŠ½è±¡è¢«åˆ†æ•£åœ¨ï¼š

- Queue Descriptor åœ¨ `sage-kernel` (L3) âœ–ï¸
- KV Backend åœ¨ `sage-middleware` (L4) âœ–ï¸
- BaseService åœ¨ `sage-kernel` (L3) âœ–ï¸

è¿™é€ æˆäº†ï¼š

- æ¶æ„æ··ä¹±ï¼ˆåŸºç¡€è®¾æ–½ä¸ä¸šåŠ¡é€»è¾‘æ··åˆï¼‰
- ä¾èµ–è¿è§„ï¼ˆL1 â†’ L3ï¼‰
- æœ‰é™çš„å¯é‡ç”¨æ€§

é€šè¿‡åˆ›å»º L2ï¼š

- âœ… æ¸…æ™°çš„å…³æ³¨ç‚¹åˆ†ç¦»
- âœ… æ­£ç¡®çš„ä¾èµ–æ–¹å‘
- âœ… æ›´å¥½çš„ç»„ä»¶é—´å¯é‡ç”¨æ€§

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
pytest tests/unit

# è¿è¡Œé›†æˆæµ‹è¯•
pytest tests/integration

# è¿è¡Œè¦†ç›–ç‡æµ‹è¯•
pytest --cov=sage.platform --cov-report=html
```

## ğŸ“š æ–‡æ¡£

- **ç”¨æˆ·æŒ‡å—**ï¼šæŸ¥çœ‹ [docs-public](https://intellistream.github.io/SAGE-Pub/guides/packages/sage-platform/)
- **API å‚è€ƒ**ï¼šæŸ¥çœ‹åŒ…çš„æ–‡æ¡£å­—ç¬¦ä¸²å’Œç±»å‹æç¤º
- **æ¶æ„**ï¼šæŸ¥çœ‹
  [å¹³å°å±‚è®¾è®¡](https://intellistream.github.io/SAGE-Pub/concepts/architecture/design-decisions/l2-platform-layer/)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](../../CONTRIBUTING.md) äº†è§£æŒ‡å—ã€‚

## ğŸ“„ è®¸å¯è¯

è¯¥é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦æƒ…è¯·æŸ¥çœ‹ [LICENSE](../../LICENSE) æ–‡ä»¶ã€‚

## ğŸ”— ç›¸å…³åŒ…

- **sage-common**ï¼šåŸºç¡€å±‚ (L1) - æä¾›åŸºæœ¬å·¥å…·
- **sage-kernel**ï¼šæ‰§è¡Œå¼•æ“ (L3) - ä½¿ç”¨å¹³å°æŠ½è±¡
- **sage-middleware**ï¼šæœåŠ¡å±‚ (L4) - ä½¿ç”¨å­˜å‚¨å’Œé˜Ÿåˆ—
- **sage-libs**ï¼šåº“å±‚ (L5) - ä½¿ç”¨æ‰€æœ‰å¹³å°æœåŠ¡

## ğŸ“® æ”¯æŒ

- **æ–‡æ¡£**ï¼šhttps://intellistream.github.io/SAGE-Pub/
- **é—®é¢˜åé¦ˆ**ï¼šhttps://github.com/intellistream/SAGE/issues
- **è®¨è®º**ï¼šhttps://github.com/intellistream/SAGE/discussions

______________________________________________________________________

**SAGE æ¡†æ¶çš„ä¸€éƒ¨åˆ†** | [ä¸»ä»“åº“](https://github.com/intellistream/SAGE)
