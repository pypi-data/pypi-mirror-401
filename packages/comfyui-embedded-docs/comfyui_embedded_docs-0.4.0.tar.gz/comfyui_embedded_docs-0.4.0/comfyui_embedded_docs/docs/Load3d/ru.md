Узел Load3D — это основной узел для загрузки и обработки 3D-модельных файлов. При загрузке узла автоматически получаются доступные 3D-ресурсы из папки `ComfyUI/input/3d/`. Также вы можете загрузить поддерживаемые 3D-файлы для предварительного просмотра с помощью функции загрузки.

**Поддерживаемые форматы**
В настоящее время этот узел поддерживает несколько форматов 3D-файлов, включая `.gltf`, `.glb`, `.obj`, `.fbx` и `.stl`.

**Настройки 3D-узла**
Некоторые параметры, связанные с 3D-узлами, можно настроить в меню настроек ComfyUI. Подробнее смотрите в следующей документации:

[Меню настроек](https://docs.comfy.org/interface/settings/3d)

Помимо обычных выходных данных, Load3D имеет множество настроек, связанных с 3D-просмотром, в меню области предпросмотра.

## Входы

| Имя параметра | Тип           | Описание                                                        | По умолчанию | Диапазон         |
|--------------|--------------|------------------------------------------------------------------|--------------|-----------------|
| model_file   | File Selection | Путь к файлу 3D-модели, поддерживает загрузку, по умолчанию читает из `ComfyUI/input/3d/` | -            | Поддерживаемые форматы |
| width        | INT           | Ширина рендеринга холста                                          | 1024         | 1-4096          |
| height       | INT           | Высота рендеринга холста                                          | 1024         | 1-4096          |

## Выходы

| Имя выхода        | Тип данных      | Описание                                                        |
|------------------|----------------|-----------------------------------------------------------------|
| image            | IMAGE          | Изображение, отрендеренное на холсте                             |
| mask             | MASK           | Маска, содержащая текущую позицию модели                         |
| mesh_path        | STRING         | Путь к файлу модели (в папке `ComfyUI/input`)                    |
| normal           | IMAGE          | Карта нормалей                                                  |
| lineart          | IMAGE          | Выход изображения лайнарт, `edge_threshold` регулируется в меню модели на холсте |
| camera_info      | LOAD3D_CAMERA  | Информация о камере                                             |
| recording_video  | VIDEO          | Записанное видео (только если запись существует)                 |

Предварительный просмотр всех выходов:
![Демонстрация управления видом](./asset/load3d_outputs.webp)

## Описание области Canvas

Область Canvas узла Load3D содержит множество операций с видом, включая:

- Настройки предпросмотра (сетка, цвет фона, предпросмотр)
- Управление камерой: FOV, тип камеры
- Интенсивность глобального освещения: регулировка яркости
- Запись видео: запись и экспорт видео
- Экспорт модели: поддержка форматов `GLB`, `OBJ`, `STL`
- и др.

![Интерфейс узла Load 3D](./asset/load3d_ui.jpg)

1. Содержит несколько меню и скрытых меню узла Load 3D
2. Меню для изменения размера окна предпросмотра и записи видео Canvas
3. Ось управления 3D-вида
4. Миниатюра предпросмотра
5. Настройка размера предпросмотра, масштабирование предпросмотра путем установки размеров и изменения размера окна

### 1. Операции с видом

<video controls width="640" height="360">
  <source src="./asset/view_operations.mp4" type="video/mp4">
  Ваш браузер не поддерживает воспроизведение видео.
</video>

Операции управления видом:

- ЛКМ + перетаскивание: вращение вида
- ПКМ + перетаскивание: перемещение вида
- Колесо мыши или средняя кнопка: масштабирование
- Ось координат: переключение видов

### 2. Функции левого меню

![Menu](./asset/menu.webp)

В области предпросмотра некоторые меню, связанные с управлением видом, скрыты в меню. Нажмите кнопку меню, чтобы развернуть различные меню

- 1. Сцена (Scene): сетка окна предпросмотра, цвет фона, настройки миниатюры
- 2. Модель (Model): режим рендеринга модели, текстуры, настройка направления вверх
- 3. Камера (Camera): переключение между ортографическим и перспективным видом, настройка угла обзора
- 4. Свет (Light): интенсивность глобального освещения сцены
- 5. Экспорт (Export): экспорт модели в другие форматы (GLB, OBJ, STL)

#### Сцена (Scene)

![scene menu](./asset/menu_scene.webp)

Меню Сцена предоставляет базовые функции настройки сцены

1. Показать/скрыть сетку
2. Установить цвет фона
3. Загрузить фоновое изображение
4. Скрыть миниатюру предпросмотра

#### Модель (Model)

![Menu_Scene](./asset/menu_model.webp)

Меню Модель предоставляет функции, связанные с моделью

1. **Направление вверх (Up direction)**: определяет, какая ось является верхней для модели
2. **Режим материала (Material mode)**: переключение режимов рендеринга — Оригинал, Нормальный, Каркас, Лайнарт

#### Камера (Camera)

![menu_modelmenu_camera](./asset/menu_camera.webp)

Это меню позволяет переключаться между ортографическим и перспективным видом, а также настраивать угол обзора

1. **Камера (Camera)**: быстрое переключение между ортографическим и перспективным видом
2. **FOV**: настройка угла обзора

#### Свет (Light)

![menu_modelmenu_camera](./asset/menu_light.webp)

Через это меню можно быстро отрегулировать интенсивность глобального освещения сцены

#### Экспорт (Export)

![menu_export](./asset/menu_export.webp)

Это меню позволяет быстро конвертировать и экспортировать форматы моделей

### 3. Функции правого меню

<video controls width="640" height="360">
  <source src="https://raw.githubusercontent.com/Comfy-Org/embedded-docs/refs/heads/main/comfyui_embedded_docs/docs/Load3d/asset/view_operations.mp4" type="video/mp4">
  Ваш браузер не поддерживает воспроизведение видео.
</video>

Правое меню имеет две основные функции:

1. **Сбросить соотношение вида**: после нажатия кнопки вид будет подстроен под заданные ширину и высоту
2. **Запись видео**: позволяет записывать текущие операции с 3D-видами в видео, поддерживает импорт и может быть выведено как `recording_video` для последующих узлов
