"""Randomness related functionality"""

import random
import string
from typing import Sequence

from fake_useragent import UserAgent

__all__ = ["Length", "ua", "rand_string", "rand_word", "rand_digits"]

type Length = int | tuple[int, int]

ua = UserAgent()
"""User-Agent header generator"""


def rand_length(n: Length) -> int:
    if isinstance(n, int):
        return n
    return random.randint(n[0], n[1])


def rand_string(charset: Sequence[str], length: Length) -> str:
    """Get a random string of specified length"""
    return "".join(random.choices(charset, k=rand_length(length)))


def rand_word(length: Length) -> str:
    """Get a random word of specified length"""
    return rand_string(string.ascii_letters, length)


def rand_digits(length: Length, base: int = 10) -> str:
    """Get a random digit string of specified length"""
    match base:
        case 2:
            charset = "01"
        case 8:
            charset = string.octdigits
        case 10:
            charset = string.digits
        case 16:
            charset = string.hexdigits
        case _:
            raise ValueError(f"unsupported base: {base}")

    return rand_string(charset, length)
