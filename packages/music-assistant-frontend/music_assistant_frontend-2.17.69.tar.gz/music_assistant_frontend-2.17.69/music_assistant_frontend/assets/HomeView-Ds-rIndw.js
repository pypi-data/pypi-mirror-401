import{C as H}from"./Container-FAarhMap.js";import{W as L}from"./WidgetRow-Bly5YUdl.js";import{u as N}from"./userPreferences-DMJzf3W5.js";import{c as $,p as O,f as x,s as p,_ as B,E as q,$ as F,q as M}from"./index-CDEBH59G.js";import{a as G}from"./PlayerCard-Cth5orVN.js";import{B as Y,n as I,s as j,l as J}from"./vuetify-RelkxOq-.js";import{d as P,c as K,b as w,e as l,ad as Q,H as s,E as n,I as v,f as c,a1 as g,al as S,F as U,M as T,D as _,r as h,o as A,a0 as X,w as Z,u as e,aG as V,az as ee,aH as te,aI as se,$ as ae,aJ as re}from"./lucide-C2DU1LFb.js";import{T as ne}from"./Toolbar-Dp1pNnt7.js";import{_ as z,a as E,b as R}from"./AvatarImage.vue_vue_type_script_setup_true_lang-DBokkkla.js";import{_ as oe,a as ie,b as le,c as de,d as C}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-DWuSqU5E.js";import{u as ue}from"./vue-router-BgJK_hRC.js";import"./index-kQIztB-E.js";import"./PanelviewItemCompact-BQPHgRIo.js";import"./NowPlayingBadge.vue_vue_type_style_index_0_lang-D7lqdhVg.js";import"./MediaItemThumb-CqYZMBB6.js";import"./ProviderIcon.vue_vue_type_style_index_0_lang-B9jfcvK2.js";import"./qrcode-DSFhiIp2.js";import"./marked-C0Rlrcoy.js";import"./color-BTziYnFN.js";import"./vue-i18n-DySrp6mW.js";import"./vueuse-DIaEWNCo.js";/* empty css            */import"./swiper-Jy9GbtzK.js";import"./index-_We2Vr5Z.js";import"./utils-CDN07tui.js";import"./reka-ui-GpbaI08z.js";import"./Button-9OJ6xEmW.js";const ce={class:"mr-3"},me={key:0},pe=P({__name:"PlayersWidgetRow",props:{settings:{},editMode:{type:Boolean}},emits:["update:settings"],setup(u,{emit:f}){const d=K(()=>Object.values($.players).filter(a=>O(a)).sort((a,o)=>a.name.toUpperCase()>o.name?.toUpperCase()?1:-1).sort((a,o)=>k(a)-k(o))),y=f;function b(a){p.activePlayerId=a.player_id}function k(a){return a.playback_state==x.PLAYING?0:a.playback_state==x.PAUSED?1:a.current_media&&a.powered?3:a.current_media?4:99}return(a,o)=>{const r=S("swiper-slide"),i=S("swiper");return l(),w("div",{class:Q(`widget-row ${u.settings&&!u.settings.enabled?"disabled":""}`)},[s(Y,{class:"header",color:"transparent"},{title:n(()=>[c("span",ce,g(a.$t("players")),1)]),append:n(()=>[u.editMode?(l(),w("div",me,[s(I,{icon:u.settings.enabled?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",onClick:o[0]||(o[0]=t=>y("update:settings",{...u.settings,enabled:!u.settings.enabled}))},null,8,["icon"])])):v("",!0)]),_:1}),s(i,{"slides-per-view":"auto","space-between":15,"free-mode":!1,navigation:!1,mousewheel:{forceToAxis:!0,releaseOnEdges:!0}},{default:n(()=>[(l(!0),w(U,null,T(d.value,t=>(l(),_(r,{key:t.player_id},{default:n(()=>[(l(),_(G,{id:t.player_id,key:t.player_id,player:t,"show-volume-control":!1,"show-menu-button":!1,"show-sub-players":!1,"show-sync-controls":!1,style:{width:"305px"},onClick:m=>b(t)},null,8,["id","player","onClick"]))]),_:2},1024))),128))]),_:1})],2)}}}),fe=B(pe,[["__scopeId","data-v-771a3548"]]),_e=P({__name:"HomeWidgetRows",props:{editMode:{type:Boolean,default:!1}},setup(u){const f=h([]),d=h({}),{getPreference:y,setPreference:b}=N(),k=y("widgetRowSettings",{players:{position:0,enabled:!0}}),a=async function(){p.currentUser?.preferences?d.value=k.value||{players:{position:0,enabled:!0}}:d.value={players:{position:0,enabled:!0}};const r=await $.getRecommendations(),i=[];let t=0;for(const m of r){t++;const D=d.value[m.uri]||{position:t,enabled:!0},W=m.translation_key?F(`recommendations.${m.translation_key}`,m.name):m.name;i.push({...m,settings:D,title:W}),f.value=i}};A(()=>{a();const r=$.subscribe(q.MEDIA_ITEM_PLAYED,async i=>{i.data&&!i.data.is_playing&&a()});X(r)}),Z(()=>p.currentUser?.preferences,r=>{r&&a()},{immediate:!1});const o=function(r,i){for(const t of f.value)if(t.uri===r){t.settings=i;break}d.value[r]=i,b("widgetRowSettings",d.value)};return(r,i)=>(l(),w(U,null,[d.value.players?.enabled||u.editMode?(l(),_(fe,{key:0,settings:d.value.players,"edit-mode":u.editMode,"onUpdate:settings":i[0]||(i[0]=t=>o("players",t))},null,8,["settings","edit-mode"])):v("",!0),(l(!0),w(U,null,T(f.value.filter(t=>t.items.length&&(t.settings.enabled||u.editMode)).sort((t,m)=>t.settings.position-m.settings.position),t=>(l(),w("div",{key:t.uri},[f.value.length?(l(),_(L,{key:0,"widget-row":t,"edit-mode":u.editMode,"onUpdate:settings":m=>o(t.uri,m)},null,8,["widget-row","edit-mode","onUpdate:settings"])):v("",!0)]))),128))],64))}}),ge={class:"avatar-trigger"},ve={class:"user-header-section"},we={class:"flex flex-col"},ye={class:"text-sm font-semibold"},be={class:"text-xs text-muted-foreground"},ke={class:"provider-warning-content"},he=P({__name:"HomeView",setup(u){const f=ue(),d=h(!1),y=h(!1),b=h(!0),k=()=>{M.logout()},a=()=>{f.push("/settings/providers")};return A(async()=>{if(M.isAdmin())try{const o=await $.getProviderConfigs();y.value=o.some(r=>r.enabled&&r.last_error)}catch{}}),(o,r)=>(l(),w("div",null,[s(ne,{"show-loading":!0,home:!0,color:"background"},{append:n(()=>[s(e(oe),null,{default:n(()=>[s(e(ie),{"as-child":""},{default:n(()=>[c("div",ge,[s(e(z),{class:"user-avatar size-10"},{default:n(()=>[e(p).currentUser?.avatar_url?(l(),_(e(E),{key:0,src:e(p).currentUser.avatar_url},null,8,["src"])):v("",!0),s(e(R),{class:"bg-primary"},{default:n(()=>[s(e(V),{size:20,class:"text-white"})]),_:1})]),_:1})])]),_:1}),s(e(le),{align:"end"},{default:n(()=>[c("div",ve,[s(e(z),{class:"user-avatar size-10"},{default:n(()=>[e(p).currentUser?.avatar_url?(l(),_(e(E),{key:0,src:e(p).currentUser.avatar_url},null,8,["src"])):v("",!0),s(e(R),{class:"bg-primary"},{default:n(()=>[s(e(V),{size:20,class:"text-white"})]),_:1})]),_:1}),c("div",we,[c("span",ye,g(e(p).currentUser?.display_name||e(p).currentUser?.username),1),c("span",be,g(e(p).currentUser?.username),1)])]),s(e(de)),s(e(C),{onClick:r[0]||(r[0]=i=>e(f).push({name:"profile"}))},{default:n(()=>[s(e(ee),{size:16}),c("span",null,g(o.$t("auth.profile")),1)]),_:1}),s(e(C),{onClick:r[1]||(r[1]=i=>d.value=!d.value)},{default:n(()=>[s(e(te),{size:16}),c("span",null,g(o.$t(d.value?"homescreen_edit_disable":"homescreen_edit_enable")),1)]),_:1}),e(p).isIngressSession?v("",!0):(l(),_(e(C),{key:0,onClick:k},{default:n(()=>[s(e(se),{size:16}),c("span",null,g(o.$t("auth.logout")),1)]),_:1}))]),_:1})]),_:1})]),_:1}),y.value&&b.value?(l(),_(j,{key:0,variant:"outlined",type:"error",icon:"mdi-alert-circle",prominent:"",class:"mx-5 mt-4",closable:"","onClick:close":r[2]||(r[2]=i=>b.value=!1)},{default:n(()=>[c("div",ke,[c("span",null,g(o.$t("settings.provider_requires_attention_detail")),1),s(I,{size:"small",color:"error",variant:"flat",onClick:a},{default:n(()=>[ae(g(o.$t("settings.fix_now")),1)]),_:1})])]),_:1})):v("",!0),s(H,{variant:"comfortable"},{default:n(()=>[(l(),_(re,null,{fallback:n(()=>[s(J,{indeterminate:""})]),default:n(()=>[c("div",null,[s(_e,{"edit-mode":d.value},null,8,["edit-mode"])])]),_:1}))]),_:1})]))}}),Ke=B(he,[["__scopeId","data-v-067064e4"]]);export{Ke as default};
