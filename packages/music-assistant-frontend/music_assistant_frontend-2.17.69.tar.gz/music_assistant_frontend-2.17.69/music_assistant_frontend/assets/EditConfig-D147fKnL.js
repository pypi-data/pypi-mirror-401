import{_ as Ve}from"./index-_We2Vr5Z.js";import{$ as i,a2 as c,a5 as M,_ as le,C as Ce}from"./index-CDEBH59G.js";import{o as we,u as he}from"./vue-router-BgJK_hRC.js";import{c as U}from"./utils-CDN07tui.js";import{u as $e,a9 as Te,p as ae,aa as Ne,ab as xe,ac as Se}from"./reka-ui-GpbaI08z.js";import{d as S,D as b,e as d,u as t,A as H,E as r,h as O,J as Ie,K as qe,b as T,ad as oe,H as s,aK as Ae,aL as Be,c as q,I as P,$ as V,a1 as g,f as x,r as h,w as Ue,a0 as De,F as z,M as Y,b7 as Fe}from"./lucide-C2DU1LFb.js";import{v as J}from"./vueuse-DIaEWNCo.js";import{e as Le,a7 as Z,s as X,n as $,R as Pe,z as Oe,m as L,a8 as Re,a9 as ze,aa as Ge,M as Me,a as _,r as G,Y as ee,Z as te,p as ne,q as He,N as Je,O as je,d as Ke,P as We}from"./vuetify-RelkxOq-.js";const Qe=S({__name:"NumberField",props:{defaultValue:{},modelValue:{},min:{},max:{},step:{},stepSnapping:{type:Boolean},formatOptions:{},locale:{},disabled:{type:Boolean},readonly:{type:Boolean},disableWheelChange:{type:Boolean},invertWheelChange:{type:Boolean},id:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue"],setup(e,{emit:p}){const y=e,f=p,C=J(y,"class"),w=$e(C,f);return(v,A)=>(d(),b(t(Te),H(t(w),{class:t(U)("grid gap-1.5",y.class)}),{default:r(m=>[O(v.$slots,"default",Ie(qe(m)))]),_:3},16,["class"]))}}),Ye=S({__name:"NumberFieldContent",props:{class:{}},setup(e){const p=e;return(y,f)=>(d(),T("div",{class:oe(t(U)("relative [&>[data-slot=input]]:has-[[data-slot=increment]]:has-[[data-slot=decrement]]:px-10",p.class))},[O(y.$slots,"default")],2))}}),Ze=S({__name:"NumberFieldDecrement",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(e){const p=e,y=J(p,"class"),f=ae(y);return(C,w)=>(d(),b(t(Ne),H({"data-slot":"decrement"},t(f),{class:t(U)("absolute top-1/2 -translate-y-1/2 left-0 p-3 disabled:cursor-not-allowed disabled:opacity-20 w-10 h-full flex items-center justify-center",p.class)}),{default:r(()=>[O(C.$slots,"default",{},()=>[s(t(Ae),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),Xe=S({__name:"NumberFieldIncrement",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(e){const p=e,y=J(p,"class"),f=ae(y);return(C,w)=>(d(),b(t(xe),H({"data-slot":"increment"},t(f),{class:t(U)("absolute top-1/2 -translate-y-1/2 right-0 disabled:cursor-not-allowed disabled:opacity-20 p-3 w-10 h-full flex items-center justify-center",p.class)}),{default:r(()=>[O(C.$slots,"default",{},()=>[s(t(Be),{class:"h-4 w-4"})])]),_:3},16,["class"]))}}),_e=S({__name:"NumberFieldInput",props:{class:{}},setup(e){const p=e;return(y,f)=>(d(),b(t(Se),{"data-slot":"input",class:oe(t(U)("flex h-9 w-full rounded-md border border-input bg-transparent py-1 px-0 text-sm text-center shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",p.class))},null,8,["class"]))}}),et={class:"config-field"},tt={key:0,class:"config-divider"},nt={key:4,class:"dsp-config"},lt={class:"dsp-status"},at={key:6,class:"config-slider-wrapper"},ot={class:"config-slider-block"},st={class:"config-slider-input"},it=S({__name:"ConfigEntryField",props:{confEntry:{},showPasswordValues:{type:Boolean},disabled:{type:Boolean}},emits:["togglePassword","action","openDsp","update:value"],setup(e,{emit:p}){const y=e,f=q(()=>y.disabled||y.confEntry.read_only),C=p,w=m=>{m==null||m===""||Array.isArray(m)&&m.length===0?C("update:value",y.confEntry.default_value):C("update:value",m)},v=()=>{C("update:value",null)},A=q(()=>{if(!y.confEntry.options)return[];const m=[];for(const u of y.confEntry.options){let o=u.value?.toString()||"",k=u.title?.toString()||"";for(const N of["@","$","|"])o.includes(N)&&(o=o.replaceAll(N,"")),k.includes(N)&&(k=k.toString().replaceAll(N,""));const I={title:i(`settings.${y.confEntry.key}.options.${o}`,k),value:u.value};I.value==y.confEntry.default_value&&(I.title+=` [${i("settings.default")}]`),m.push(I)}return m});return(m,u)=>(d(),T("div",et,[e.confEntry.type==t(c).DIVIDER?(d(),T("div",tt,[s(Le),e.confEntry.label?(d(),b(Z,{key:0,class:"divider-label"},{default:r(()=>[V(g(e.confEntry.label),1)]),_:1})):P("",!0)])):e.confEntry.type==t(c).LABEL?(d(),b(X,{key:1,variant:"tonal",type:"info",density:"comfortable",class:"config-alert"},{default:r(()=>[V(g(t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label)),1)]),_:1})):e.confEntry.type==t(c).ALERT?(d(),b(X,{key:2,density:"comfortable",type:"warning",variant:"tonal",class:"config-alert"},{default:r(()=>[V(g(t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label)),1)]),_:1})):e.confEntry.type==t(c).ACTION||e.confEntry.action&&!e.confEntry.value?(d(),b($,{key:3,variant:"outlined",class:"action-btn",disabled:f.value,onClick:u[0]||(u[0]=o=>m.$emit("action"))},{default:r(()=>[V(g(t(i)(`settings.${e.confEntry.action||e.confEntry.key}.label`,e.confEntry.action_label||e.confEntry.label)),1)]),_:1},8,["disabled"])):e.confEntry.type==t(c).DSP_SETTINGS?(d(),T("div",nt,[x("span",lt,g(e.confEntry.value?t(i)("settings.dsp_enabled"):t(i)("settings.dsp_disabled")),1),s($,{variant:"outlined",class:"action-btn",onClick:u[1]||(u[1]=o=>m.$emit("openDsp"))},{default:r(()=>[V(g(t(i)("open_dsp_settings")),1)]),_:1})])):e.confEntry.type==t(c).BOOLEAN?(d(),b(Pe,{key:5,"model-value":e.confEntry.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),color:"primary",disabled:f.value,"hide-details":"",density:"comfortable","onUpdate:modelValue":u[2]||(u[2]=o=>m.$emit("update:value",o))},null,8,["model-value","label","disabled"])):(e.confEntry.type==t(c).INTEGER||e.confEntry.type==t(c).FLOAT)&&e.confEntry.range&&e.confEntry.range.length==2?(d(),T("div",at,[s(Z,{class:"config-slider-label"},{default:r(()=>[V(g(t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label)),1)]),_:1}),x("div",ot,[s(Oe,{"model-value":e.confEntry.value,disabled:f.value,required:e.confEntry.required,min:e.confEntry.range[0],max:e.confEntry.range[1],step:e.confEntry.type==t(c).FLOAT?.5:1,"hide-details":"",color:"primary",class:"config-slider","onUpdate:modelValue":u[3]||(u[3]=o=>m.$emit("update:value",o))},null,8,["model-value","disabled","required","min","max","step"]),x("div",st,[s(t(Qe),{"model-value":e.confEntry.value,min:e.confEntry.range[0],max:e.confEntry.range[1],step:e.confEntry.type==t(c).FLOAT?.5:1,"format-options":{maximumFractionDigits:e.confEntry.type==t(c).FLOAT?1:0},class:"w-[100px]","onUpdate:modelValue":u[4]||(u[4]=o=>m.$emit("update:value",o))},{default:r(()=>[s(t(Ye),null,{default:r(()=>[s(t(_e)),s(t(Ze)),s(t(Xe))]),_:1})]),_:1},8,["model-value","min","max","step","format-options"])])])])):e.confEntry.type==t(c).SECURE_STRING?(d(),b(L,{key:7,"model-value":e.confEntry.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),required:e.confEntry.required,disabled:f.value,rules:[o=>!(!o&&e.confEntry.required)||t(i)("settings.invalid_input")],type:e.showPasswordValues?"text":"password","append-inner-icon":e.showPasswordValues?"mdi-eye":typeof e.confEntry.value=="string"&&e.confEntry.value.includes(t(M))?"":"mdi-eye-off",variant:"outlined",density:"comfortable",clearable:"",readonly:!!e.confEntry.action,"onUpdate:modelValue":u[5]||(u[5]=o=>w(o)),"onClick:appendInner":u[6]||(u[6]=o=>C("togglePassword")),"onClick:clear":v},null,8,["model-value","label","required","disabled","rules","type","append-inner-icon","readonly"])):e.confEntry.options&&e.confEntry.options.length>0?(d(),b(Re,{key:8,"model-value":e.confEntry.value,chips:e.confEntry.multi_value,clearable:!0,multiple:e.confEntry.multi_value,items:A.value,disabled:f.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),required:e.confEntry.required,rules:[o=>!(o==null&&e.confEntry.required)||t(i)("settings.invalid_input")],variant:"outlined",density:"comfortable","onUpdate:modelValue":u[7]||(u[7]=o=>w(o)),"onClick:clear":v},null,8,["model-value","chips","multiple","items","disabled","label","required","rules"])):e.confEntry.type==t(c).INTEGER||e.confEntry.type==t(c).FLOAT?(d(),b(L,{key:9,"model-value":e.confEntry.value,placeholder:e.confEntry.default_value?.toString(),disabled:f.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),required:e.confEntry.required,rules:[o=>!(!o&&e.confEntry.required)||t(i)("settings.invalid_input")],variant:"outlined",density:"comfortable",clearable:!e.confEntry.required,type:"number","onUpdate:modelValue":u[8]||(u[8]=o=>w(o)),"onClick:clear":v},null,8,["model-value","placeholder","disabled","label","required","rules","clearable"])):e.confEntry.type==t(c).ICON?(d(),b(L,{key:10,"model-value":e.confEntry.value,placeholder:e.confEntry.default_value?.toString(),clearable:"",disabled:f.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),"prepend-inner-icon":e.confEntry.value,variant:"outlined",density:"comfortable","onUpdate:modelValue":u[9]||(u[9]=o=>w(o)),"onClick:clear":v},null,8,["model-value","placeholder","disabled","label","prepend-inner-icon"])):e.confEntry.type==t(c).STRING&&e.confEntry.multi_value?(d(),b(ze,{key:11,"model-value":e.confEntry.value,multiple:"",chips:"",clearable:!0,disabled:f.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),required:e.confEntry.required,rules:[o=>!(!o&&e.confEntry.required)||t(i)("settings.invalid_input")],variant:"outlined",density:"comfortable","onUpdate:modelValue":u[10]||(u[10]=o=>w(o)),"onClick:clear":v},null,8,["model-value","disabled","label","required","rules"])):(d(),b(L,{key:12,"model-value":e.confEntry.value,placeholder:e.confEntry.default_value?.toString(),clearable:"",disabled:f.value,label:t(i)(`settings.${e.confEntry.key}.label`,e.confEntry.label),required:e.confEntry.required,rules:[o=>!(!o&&e.confEntry.required)||t(i)("settings.invalid_input")],variant:"outlined",density:"comfortable",readonly:!!e.confEntry.action,"onUpdate:modelValue":u[11]||(u[11]=o=>w(o)),"onClick:clear":v},null,8,["model-value","placeholder","disabled","label","required","rules","readonly"]))]))}}),rt=le(it,[["__scopeId","data-v-36dfaf6b"]]),ut={class:"panel-title-text"},dt={class:"config-panel-content"},ct={class:"config-actions"},ft=S({__name:"EditConfig",props:{configEntries:{},disabled:{type:Boolean}},emits:["submit","action","immediateApply"],setup(e,{emit:p}){const y=he(),f=h(!1),C=h(!1),w=p,v=h(),A=h(!1),m=h(),u=h([]),o=h(!1),k=h(),D=h({}),I=e,N=q(()=>["generic",...new Set(v.value.map(a=>a.category).filter(a=>!["generic","advanced"].includes(a))),"advanced"]),se=q(()=>{if(v.value){for(const n of v.value)if(n.required&&!(!B(n.value)||!B(n.default_value)||n.type==c.DIVIDER||n.type==c.LABEL||n.type==c.ALERT||n.type==c.ACTION))return!1;return!0}return!1}),R=q(()=>{if(!v.value)return!1;for(const n of v.value){if(n.type==c.DIVIDER||n.type==c.LABEL||n.type==c.ALERT||n.type==c.ACTION||n.type==c.SECURE_STRING&&n.value==M)continue;const a=D.value[n.key],l=n.value;if(JSON.stringify(a)!==JSON.stringify(l))return!0}return!1});Ue(()=>I.configEntries,n=>{v.value=[],D.value={};for(const l of n||[])(l.value==null||l.value==null)&&(l.value=l.default_value),D.value[l.key]=typeof l.value=="object"&&l.value!==null?JSON.parse(JSON.stringify(l.value)):l.value,v.value.push(l);const a=N.value.filter(l=>l!=="advanced");u.value=a},{immediate:!0});const ie=async function(){const{valid:n}=await m.value.validate();return n},re=async function(){await ie()&&(C.value=!0,w("submit",Q()))},ue=async function(n){w("action",n,Q())},de=function(n,a){n.value=a,n.immediate_apply&&w("immediateApply",{[n.key]:a})},j=function(n){const a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("target","_blank"),a.click()},ce=function(){y.push(`${y.currentRoute.value.path}/dsp`)},fe=function(){if(v.value)for(const n of v.value)n.value=n.default_value},ye=function(){R.value?f.value=!0:y.back()},ve=function(){f.value=!1,C.value=!0,y.back()},me=function(){f.value=!1};we((n,a,l)=>{C.value||!R.value?l():(f.value=!0,l(!1))});const K=n=>{R.value&&(n.preventDefault(),n.returnValue="")};De(()=>{window.removeEventListener("beforeunload",K)}),window.addEventListener("beforeunload",K);const B=function(n){return n==null},be=function(n){return!n.hidden},ge=function(n){if(!B(n.depends_on)){const a=v.value?.find(E=>E.key==n.depends_on);if(!a)return!1;const l=a.value;return B(n.depends_on_value)?B(n.depends_on_value_not)?!l:l==n.depends_on_value_not:l!=n.depends_on_value}return!1},Ee=q(()=>{const n={};if(!v.value)return n;for(const a of v.value){if(!be(a)||a.key==="enabled"||a.key==="name")continue;const l=a.category||"generic";n[l]||(n[l]=[]),n[l].push(a)}return n}),W=function(n){return Ee.value[n]||[]},Q=function(){const n={};for(const a of I.configEntries){let l=a.value;l==null&&(l=null),!(a.type==c.SECURE_STRING&&l==M)&&(n[a.key]=l)}return n},pe=function(n){return{generic:"mdi-cog",audio:"mdi-volume-high",advanced:"mdi-tune",network:"mdi-lan",playback:"mdi-play-circle",announcements:"mdi-bullhorn",airplay:"mdi-apple",chromecast:"mdi-cast",slimproto:"mdi-speaker-wireless",snapcast:"mdi-speaker-multiple",ugp:"mdi-speaker-multiple",authentication:"mdi-lock",sync:"mdi-sync",web_player:"mdi-play-network"}[n]||"mdi-cog-outline"},ke=function(n){return(i(`settings.${n?.key}.description`,n.description||" ")||n.help_link||" ")?.length>1};return(n,a)=>(d(),T(z,null,[v.value?(d(),b(Ge,{key:0,ref_key:"form",ref:m,modelValue:A.value,"onUpdate:modelValue":a[2]||(a[2]=l=>A.value=l),disabled:e.disabled},{default:r(()=>[s(Me,{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=l=>u.value=l),multiple:"",class:"config-panels"},{default:r(()=>[(d(!0),T(z,null,Y(N.value.filter(l=>W(l).length>0),l=>(d(),b(Je,{key:l,value:l,class:"config-panel"},{default:r(()=>[s(je,{class:"config-panel-title"},{default:r(()=>[s(Ke,{icon:pe(l),class:"mr-3",size:"20"},null,8,["icon"]),x("span",ut,g(t(i)("settings.category."+l,l)),1)]),_:2},1024),s(We,null,{default:r(()=>[x("div",dt,[(d(!0),T(z,null,Y(W(l),E=>(d(),T("div",{key:E.key,class:"config-entry"},[s(rt,{"conf-entry":E,"show-password-values":o.value,disabled:ge(E),onTogglePassword:a[0]||(a[0]=F=>o.value=!o.value),"onUpdate:value":F=>de(E,F),onAction:F=>{ue(E.action||E.key),E.value=E.action?null:E.key},onOpenDsp:ce},null,8,["conf-entry","show-password-values","disabled","onUpdate:value","onAction"]),ke(E)?(d(),b(t(Ve),{key:0,type:"button",variant:"ghost",size:"icon",class:"help-btn",onClick:F=>t(i)(`settings.${E?.key}.description`,E.description||"")?k.value=E:j(E.help_link)},{default:r(()=>[s(t(Fe),{size:20})]),_:1},8,["onClick"])):P("",!0)]))),128))])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),x("div",ct,[s($,{block:"",color:"primary",size:"large",disabled:!se.value,onClick:re},{default:r(()=>[V(g(t(i)("settings.save")),1)]),_:1},8,["disabled"]),s($,{block:"",variant:"outlined",size:"large",onClick:ye},{default:r(()=>[V(g(t(i)("close")),1)]),_:1}),s($,{block:"",variant:"text",size:"large",onClick:fe},{default:r(()=>[V(g(t(i)("settings.reset_to_defaults")),1)]),_:1})])]),_:1},8,["modelValue","disabled"])):P("",!0),s(ne,{"model-value":k.value!==void 0,width:"auto","onUpdate:modelValue":a[5]||(a[5]=l=>k.value=void 0)},{default:r(()=>[s(_,null,{default:r(()=>[s(G,null,{default:r(()=>[x("h2",null,g(t(i)(`settings.${k.value?.key}.label`,k.value?.label||"")),1)]),_:1}),s(G,{innerHTML:t(Ce)(t(i)(`settings.${k.value?.key}.description`,k.value?.description||""))},null,8,["innerHTML"]),s(ee,null,{default:r(()=>[k.value?.help_link?(d(),b($,{key:0,onClick:a[3]||(a[3]=l=>j(k.value.help_link))},{default:r(()=>[V(g(t(i)("read_more")),1)]),_:1})):P("",!0),s(te),s($,{color:"primary",onClick:a[4]||(a[4]=l=>k.value=void 0)},{default:r(()=>[V(g(t(i)("close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]),s(ne,{modelValue:f.value,"onUpdate:modelValue":a[6]||(a[6]=l=>f.value=l),"max-width":"400",persistent:""},{default:r(()=>[s(_,null,{default:r(()=>[s(He,null,{default:r(()=>[V(g(t(i)("settings.unsaved_changes")),1)]),_:1}),s(G,null,{default:r(()=>[V(g(t(i)("settings.unsaved_changes_message")),1)]),_:1}),s(ee,null,{default:r(()=>[s(te),s($,{variant:"text",onClick:me},{default:r(()=>[V(g(t(i)("settings.stay")),1)]),_:1}),s($,{color:"warning",variant:"flat",onClick:ve},{default:r(()=>[V(g(t(i)("settings.discard")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Vt=le(ft,[["__scopeId","data-v-5a9dd3b6"]]);export{Vt as E};
