import{C as be}from"./Container-FAarhMap.js";import{d as z,b as C,e as d,ad as we,u as e,h as de,D as U,E as t,A as Ce,r as w,c as D,w as j,H as a,I as F,$ as m,a1 as r,f as p,O as E,aV as Se,F as G,aL as Ue,aW as le,M as ce,aX as me,aG as ne,aY as Ve,aZ as Ie,a_ as Fe,o as Ne}from"./lucide-C2DU1LFb.js";import{_ as N}from"./index-_We2Vr5Z.js";import{_ as H}from"./Card.vue_vue_type_script_setup_true_lang-CTOKRJ9T.js";import{u as Y,c as Pe,t as Te,_ as T,a as B,b as A,d as ze,e as Z,f as J,g as Be,h as ve,p as xe,i as oe}from"./profile-Cl_127OF.js";import{_ as K,a as W,b as X}from"./CardTitle.vue_vue_type_script_setup_true_lang-Dj10vP3R.js";import{i as P}from"./vuetify-RelkxOq-.js";import{_ as Q,a as ee,b as ae,c as te,d as x,e as De,f as Le,g as je}from"./index-vt6UORr-.js";import{p as Ae,e as Re}from"./reka-ui-GpbaI08z.js";import{c as _e}from"./utils-CDN07tui.js";import{v as Ee}from"./vueuse-DIaEWNCo.js";import{c as R,J as Me,_ as se,s as q}from"./index-CDEBH59G.js";import{u as M}from"./vue-i18n-DySrp6mW.js";import{_ as re,a as ue,b as ie}from"./AvatarImage.vue_vue_type_script_setup_true_lang-DBokkkla.js";import"./index-kQIztB-E.js";import"./qrcode-DSFhiIp2.js";import"./marked-C0Rlrcoy.js";import"./color-BTziYnFN.js";import"./vue-router-BgJK_hRC.js";/* empty css            */import"./swiper-Jy9GbtzK.js";const fe=z({__name:"CardFooter",props:{class:{}},setup(V){const g=V;return(o,$)=>(d(),C("div",{"data-slot":"card-footer",class:we(e(_e)("flex items-center px-6 [.border-t]:pt-6",g.class))},[de(o.$slots,"default")],2))}}),pe=z({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(V){const g=V,o=Ee(g,"class"),$=Ae(o);return(i,_)=>(d(),U(e(Re),Ce({"data-slot":"dialog-description"},e($),{class:e(_e)("text-muted-foreground text-sm",g.class)}),{default:t(()=>[de(i.$slots,"default")]),_:3},16,["class"]))}}),Oe={key:0,class:"py-4"},qe={key:1,class:"py-4"},Ge={class:"text-sm text-muted-foreground mb-4"},He=z({__name:"CreateTokenDialog",props:{modelValue:{type:Boolean},userId:{}},emits:["update:modelValue","created"],setup(V,{emit:g}){const{t:o}=M(),$=V,i=g,_=w(!1),f=w(""),c=w(""),b=Y({defaultValues:{tokenName:""},validators:{onSubmit:Pe(o)},onSubmit:async({value:h})=>{_.value=!0;try{const S=await R.createToken(h.tokenName,$.userId);S?(P.success(o("auth.token_created")),f.value=S,c.value=h.tokenName,i("created")):P.error(o("auth.token_create_failed"))}catch(S){P.error(S.message||o("auth.token_create_failed"))}finally{_.value=!1}}});function y(h){return h.state.meta.isTouched&&!h.state.meta.isValid}const k=D(()=>{const h=c.value||"";return h.trim().length>0&&h.length<=100&&!_.value}),u=()=>{b.reset(),f.value="",c.value="",requestAnimationFrame(()=>{i("update:modelValue",!1)})},s=async()=>{if(!f.value)return;await Me(f.value)?P.success(o("auth.token_copied")):P.error(o("auth.token_copy_failed"))};return j(()=>$.modelValue,h=>{h||(b.reset(),f.value=""),c.value=""}),(h,S)=>(d(),U(e(Q),{open:V.modelValue,"onUpdate:open":S[1]||(S[1]=I=>i("update:modelValue",I))},{default:t(()=>[a(e(ee),{class:"sm:max-w-md"},{default:t(()=>[a(e(ae),null,{default:t(()=>[a(e(te),null,{default:t(()=>[m(r(f.value?c.value:h.$t("auth.create_token")),1)]),_:1}),f.value?F("",!0):(d(),U(e(pe),{key:0},{default:t(()=>[m(r(h.$t("auth.token_name_hint")),1)]),_:1}))]),_:1}),f.value?(d(),C("div",qe,[p("p",Ge,r(h.$t("auth.copy_new_token_hint")),1),a(e(De),null,{default:t(()=>[a(e(Le),{"model-value":f.value,readonly:"",class:"font-mono text-sm"},null,8,["model-value"]),a(e(je),{align:"inline-end"},{default:t(()=>[a(e(ze),{size:"icon-sm",variant:"ghost",onClick:s},{default:t(()=>[a(e(Se),{size:16})]),_:1})]),_:1})]),_:1})])):(d(),C("div",Oe,[p("form",{id:"form-create-token",onSubmit:S[0]||(S[0]=E((...I)=>e(b).handleSubmit&&e(b).handleSubmit(...I),["prevent"]))},[a(e(b).Field,{name:"tokenName",validators:{onChange:e(Te)(e(o))}},{default:t(({field:I})=>[a(e(T),{"data-invalid":y(I)},{default:t(()=>[a(e(B),{for:I.name},{default:t(()=>[m(r(h.$t("auth.token_name")),1)]),_:1},8,["for"]),a(e(x),{id:I.name,name:I.name,"model-value":c.value,"aria-invalid":y(I),placeholder:h.$t("auth.token_name_hint"),autofocus:"",autocomplete:"off",onBlur:I.handleBlur,onInput:O=>{c.value=O.target.value,I.handleChange(O.target.value)}},null,8,["id","name","model-value","aria-invalid","placeholder","onBlur","onInput"]),y(I)?(d(),U(e(A),{key:0,errors:I.state.meta.errors},null,8,["errors"])):F("",!0)]),_:2},1032,["data-invalid"])]),_:1},8,["validators"])],32)])),a(e(Z),null,{default:t(()=>[f.value?(d(),U(e(N),{key:1,variant:"default",onClick:u},{default:t(()=>[m(r(h.$t("close")),1)]),_:1})):(d(),C(G,{key:0},[a(e(N),{variant:"outline",onClick:u},{default:t(()=>[m(r(h.$t("cancel")),1)]),_:1}),a(e(N),{type:"submit",form:"form-create-token",disabled:!k.value,loading:_.value},{default:t(()=>[m(r(h.$t("create")),1)]),_:1},8,["disabled","loading"])],64))]),_:1})]),_:1})]),_:1},8,["open"]))}}),Je={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Ke={key:0,class:"empty-state"},We={class:"flex size-16 items-center justify-center rounded-full bg-muted mb-3"},Xe={class:"text-muted-foreground font-medium"},Ye={class:"text-sm text-muted-foreground mt-1"},Ze={key:1,class:"space-y-2"},Qe={class:"flex size-10 items-center justify-center rounded-full bg-muted"},ea={class:"flex-1 min-w-0"},aa={class:"font-medium truncate"},ta={class:"text-sm text-muted-foreground flex flex-wrap gap-2"},sa={key:0},la={key:1},na=z({__name:"LongLivedTokensList",props:{tokens:{}},emits:["revoke","created"],setup(V,{emit:g}){const{t:o}=M(),$=g,i=w(!1),_=c=>new Date(c).toLocaleString(),f=()=>{$("created")};return(c,b)=>(d(),U(e(H),null,{default:t(()=>[a(e(K),null,{default:t(()=>[p("div",Je,[p("div",null,[a(e(W),null,{default:t(()=>[m(r(c.$t("auth.long_lived_tokens")),1)]),_:1}),a(e(X),null,{default:t(()=>[m(r(c.$t("auth.api_tokens_description")),1)]),_:1})]),a(e(N),{onClick:b[0]||(b[0]=y=>i.value=!0)},{default:t(()=>[a(e(Ue),{size:16}),m(" "+r(c.$t("auth.create_token")),1)]),_:1})])]),_:1}),a(e(J),null,{default:t(()=>[V.tokens.length===0?(d(),C("div",Ke,[p("div",We,[a(e(le),{size:32,class:"text-muted-foreground"})]),p("p",Xe,r(c.$t("auth.no_tokens")),1),p("p",Ye,r(c.$t("auth.create_token_hint")),1)])):(d(),C("div",Ze,[(d(!0),C(G,null,ce(V.tokens,y=>(d(),C("div",{key:y.token_id,class:"flex items-center gap-4 rounded-lg border p-4 hover:bg-accent/50 transition-colors"},[p("div",Qe,[a(e(le),{size:20,class:"text-muted-foreground"})]),p("div",ea,[p("div",aa,r(y.name),1),p("div",ta,[p("span",null,r(c.$t("created"))+": "+r(_(y.created_at)),1),y.last_used_at?(d(),C("span",sa,"•")):F("",!0),y.last_used_at?(d(),C("span",la,r(c.$t("last_used"))+": "+r(_(y.last_used_at)),1)):F("",!0)])]),a(e(N),{variant:"ghost",size:"icon",class:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:E(k=>$("revoke",y),["stop"])},{default:t(()=>[a(e(me),{size:16})]),_:1},8,["onClick"])]))),128))]))]),_:1}),a(He,{modelValue:i.value,"onUpdate:modelValue":b[1]||(b[1]=y=>i.value=y),onCreated:f},null,8,["modelValue"])]),_:1}))}}),oa=se(na,[["__scopeId","data-v-7459f4e1"]]),ra={key:0,class:"mb-4 rounded-lg border border-blue-500/20 bg-blue-500/10 p-4 text-sm text-blue-600 dark:text-blue-400"},ua=z({__name:"PasswordSettings",setup(V){const{t:g}=M(),o=w(!1),$=w(""),i=w(""),_=Y({defaultValues:{newPassword:"",confirmPassword:""},validators:{onSubmit:Be(g)},onSubmit:async({value:k})=>{o.value=!0;try{await R.changePassword(k.newPassword)?(P.success(g("auth.password_changed")),_.reset(),$.value="",i.value=""):P.error(g("auth.password_change_failed"))}catch(u){P.error(u.message||g("auth.password_change_failed"))}finally{o.value=!1}}}),f=D(()=>{const k=$.value||_.state.values.newPassword||"",u=i.value||_.state.values.confirmPassword||"";return k===u&&u.length>0});function c(k){return k.state.meta.isTouched&&!k.state.meta.isValid}const b=(k,u)=>{const s=k.target.value;$.value=s,u.handleChange(s)},y=(k,u)=>{const s=k.target.value;i.value=s,u.handleChange(s)};return(k,u)=>(d(),U(e(H),null,{default:t(()=>[a(e(K),null,{default:t(()=>[a(e(W),null,{default:t(()=>[m(r(k.$t("auth.change_password")),1)]),_:1}),a(e(X),null,{default:t(()=>[m(r(k.$t("auth.update_your_password")),1)]),_:1})]),_:1}),a(e(J),null,{default:t(()=>[e(q).isIngressSession?(d(),C("div",ra,r(k.$t("auth.ingress_password_note")),1)):F("",!0),p("form",{id:"form-password-settings",onSubmit:u[0]||(u[0]=E((...s)=>e(_).handleSubmit&&e(_).handleSubmit(...s),["prevent"]))},[a(e(ve),null,{default:t(()=>[a(e(_).Field,{name:"newPassword"},{default:t(({field:s})=>[a(e(T),{"data-invalid":c(s)},{default:t(()=>[a(e(B),{for:s.name},{default:t(()=>[m(r(k.$t("auth.new_password")),1)]),_:1},8,["for"]),a(e(x),{id:s.name,name:s.name,"model-value":s.state.value,type:"password","aria-invalid":c(s),autocomplete:"new-password",onBlur:s.handleBlur,onInput:h=>b(h,s)},null,8,["id","name","model-value","aria-invalid","onBlur","onInput"]),c(s)?(d(),U(e(A),{key:0,errors:s.state.meta.errors},null,8,["errors"])):F("",!0)]),_:2},1032,["data-invalid"])]),_:1}),a(e(_).Field,{name:"confirmPassword"},{default:t(({field:s})=>[a(e(T),{"data-invalid":c(s)},{default:t(()=>[a(e(B),{for:s.name},{default:t(()=>[m(r(k.$t("auth.confirm_password")),1)]),_:1},8,["for"]),a(e(x),{id:s.name,name:s.name,"model-value":s.state.value,type:"password","aria-invalid":c(s),autocomplete:"new-password",onBlur:s.handleBlur,onInput:h=>y(h,s)},null,8,["id","name","model-value","aria-invalid","onBlur","onInput"]),c(s)?(d(),U(e(A),{key:0,errors:s.state.meta.errors},null,8,["errors"])):F("",!0)]),_:2},1032,["data-invalid"])]),_:1})]),_:1})],32)]),_:1}),a(e(fe),null,{default:t(()=>[a(e(N),{type:"submit",form:"form-password-settings",disabled:!f.value||o.value,loading:o.value},{default:t(()=>[m(r(k.$t("auth.update_password")||"Update password"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1}))}}),ia={class:"flex flex-col sm:flex-row gap-6 mb-6"},da={class:"flex flex-col items-center gap-3"},ca={class:"relative"},ma={class:"flex-1 space-y-4"},va={class:"flex flex-col items-center gap-4 py-4"},_a=z({__name:"ProfileSettings",setup(V){const{t:g}=M(),o=D(()=>q.currentUser),$=D(()=>q.isIngressSession),i=w(!1),_=w(""),f=w(!1),c=w(!1),b=w(""),y=w(""),k=w(""),u=w(""),s=Y({defaultValues:{username:o.value?.username||"",displayName:o.value?.display_name||"",avatarUrl:o.value?.avatar_url||"",role:o.value?g(`auth.${o.value.role}_role`):""},validators:{onSubmit:xe(g)},onSubmit:async({value:l})=>{if(o.value){c.value=!0;try{const v={};if(l.username!==o.value.username&&(v.username=l.username),l.displayName!==(o.value.display_name||"")&&(v.displayName=l.displayName),l.avatarUrl!==(o.value.avatar_url||"")&&(v.avatarUrl=l.avatarUrl),Object.keys(v).length===0)return;const n=await R.updateUser(o.value.user_id,v);n&&(q.currentUser=n,v.username&&(y.value=n.username||""),v.displayName!==void 0&&(k.value=n.display_name||""),v.avatarUrl!==void 0&&(u.value=n.avatar_url||"",s.setFieldValue("avatarUrl",n.avatar_url||""),f.value=!1),P.success(g("auth.profile_updated")))}catch(v){P.error(v.message||g("error_generic"))}finally{c.value=!1}}}}),h=D(()=>{if(!o.value)return!1;const l=y.value||s.state.values.username||"",v=k.value||s.state.values.displayName||"",n=u.value||s.state.values.avatarUrl||"",L=o.value.username||"",$e=o.value.display_name||"",ye=o.value.avatar_url||"";return l!==L||v!==$e||n!==ye});function S(l){return l.state.meta.isTouched&&!l.state.meta.isValid}const I=(l,v)=>{const n=l.target.value;y.value=n,v.handleChange(n)},O=(l,v)=>{const n=l.target.value;k.value=n,v.handleChange(n)},he=()=>{if(o.value){const l=o.value.avatar_url||"";y.value=o.value.username||"",k.value=o.value.display_name||"",u.value=l,b.value=l,s.setFieldValue("username",o.value.username),s.setFieldValue("displayName",o.value.display_name||""),s.setFieldValue("avatarUrl",l),s.setFieldValue("role",g(`auth.${o.value.role}_role`))}},ge=()=>{u.value=b.value,s.setFieldValue("avatarUrl",b.value),_.value=b.value,i.value=!1,f.value=!1},ke=()=>{const l=_.value;u.value=l,l!==s.state.values.avatarUrl&&s.setFieldValue("avatarUrl",l),i.value=!1,f.value=!1};return j(()=>o.value?.avatar_url,l=>{l!==void 0&&(u.value=l||"",s.setFieldValue("avatarUrl",l||""),i.value||(_.value=l||""))},{immediate:!0}),j(i,l=>{l&&(b.value=o.value?.avatar_url||u.value||s.state.values.avatarUrl||"",_.value=u.value||s.state.values.avatarUrl||o.value?.avatar_url||"",f.value=!1)}),j(o,l=>{if(l){const v=l.username||"",n=l.display_name||"";y.value=v,k.value=n,s.setFieldValue("username",v),s.setFieldValue("displayName",n),s.setFieldValue("role",g(`auth.${l.role}_role`))}},{immediate:!0}),j(_,l=>{i.value&&(u.value=l,s.setFieldValue("avatarUrl",l))}),(l,v)=>(d(),C(G,null,[a(e(H),null,{default:t(()=>[a(e(K),null,{default:t(()=>[a(e(W),null,{default:t(()=>[m(r(l.$t("auth.account_settings")),1)]),_:1}),a(e(X),null,{default:t(()=>[m(r(l.$t("auth.manage_your_profile_info")),1)]),_:1})]),_:1}),a(e(J),null,{default:t(()=>[p("form",{id:"form-profile-settings",onSubmit:v[2]||(v[2]=E((...n)=>e(s).handleSubmit&&e(s).handleSubmit(...n),["prevent"]))},[a(e(ve),null,{default:t(()=>[p("div",ia,[p("div",da,[p("div",ca,[a(e(re),{class:"size-32"},{default:t(()=>[u.value||e(s).state.values.avatarUrl||o.value?.avatar_url?(d(),U(e(ue),{key:u.value||e(s).state.values.avatarUrl||o.value?.avatar_url||"",src:u.value||e(s).state.values.avatarUrl||o.value?.avatar_url||"",onError:v[0]||(v[0]=n=>f.value=!0)},null,8,["src"])):F("",!0),a(e(ie),{class:"bg-muted"},{default:t(()=>[a(e(ne),{size:48,class:"text-muted-foreground"})]),_:1})]),_:1}),$.value?F("",!0):(d(),U(e(N),{key:0,type:"button",variant:"outline",size:"icon",class:"absolute bottom-0 right-0 size-8 rounded-full border-2 border-background bg-background shadow-md hover:bg-accent",onClick:v[1]||(v[1]=n=>i.value=!0)},{default:t(()=>[a(e(Ve),{size:14})]),_:1}))])]),p("div",ma,[a(e(s).Field,{name:"username"},{default:t(({field:n})=>[a(e(T),{"data-invalid":S(n)},{default:t(()=>[a(e(B),{for:n.name},{default:t(()=>[m(r(l.$t("auth.username")),1)]),_:1},8,["for"]),a(e(x),{id:n.name,name:n.name,"model-value":n.state.value,"aria-invalid":S(n),disabled:$.value,autocomplete:"username",onBlur:n.handleBlur,onInput:L=>I(L,n)},null,8,["id","name","model-value","aria-invalid","disabled","onBlur","onInput"]),S(n)?(d(),U(e(A),{key:0,errors:n.state.meta.errors},null,8,["errors"])):F("",!0)]),_:2},1032,["data-invalid"])]),_:1}),a(e(s).Field,{name:"displayName"},{default:t(({field:n})=>[a(e(T),{"data-invalid":S(n)},{default:t(()=>[a(e(B),{for:n.name},{default:t(()=>[m(r(l.$t("auth.display_name")),1)]),_:1},8,["for"]),a(e(x),{id:n.name,name:n.name,"model-value":n.state.value,"aria-invalid":S(n),disabled:$.value,autocomplete:"name",onBlur:n.handleBlur,onInput:L=>O(L,n)},null,8,["id","name","model-value","aria-invalid","disabled","onBlur","onInput"]),a(e(oe),null,{default:t(()=>[m(r(l.$t("optional")),1)]),_:1}),S(n)?(d(),U(e(A),{key:0,errors:n.state.meta.errors},null,8,["errors"])):F("",!0)]),_:2},1032,["data-invalid"])]),_:1}),a(e(s).Field,{name:"role"},{default:t(({field:n})=>[a(e(T),null,{default:t(()=>[a(e(B),{for:n.name},{default:t(()=>[m(r(l.$t("auth.role")),1)]),_:1},8,["for"]),a(e(x),{id:n.name,name:n.name,"model-value":n.state.value,readonly:"",disabled:"",class:"bg-muted"},null,8,["id","name","model-value"])]),_:2},1024)]),_:1})])])]),_:1})],32)]),_:1}),a(e(fe),null,{default:t(()=>[a(e(T),{orientation:"horizontal"},{default:t(()=>[h.value?(d(),U(e(N),{key:0,type:"button",variant:"outline",onClick:he},{default:t(()=>[m(r(l.$t("cancel")),1)]),_:1})):F("",!0),a(e(N),{type:"submit",form:"form-profile-settings",disabled:!h.value||c.value,loading:c.value},{default:t(()=>[m(r(l.$t("auth.save_changes")||"Save changes"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1}),a(e(Q),{open:i.value,"onUpdate:open":v[5]||(v[5]=n=>i.value=n)},{default:t(()=>[a(e(ee),{class:"sm:max-w-md"},{default:t(()=>[a(e(ae),null,{default:t(()=>[a(e(te),null,{default:t(()=>[m(r(l.$t("auth.change_avatar")),1)]),_:1}),a(e(pe),null,{default:t(()=>[m(r(l.$t("auth.avatar_url_hint")),1)]),_:1})]),_:1}),p("div",va,[a(e(re),{class:"size-36"},{default:t(()=>[_.value?(d(),U(e(ue),{key:0,src:_.value,onError:v[3]||(v[3]=n=>f.value=!0)},null,8,["src"])):F("",!0),a(e(ie),{class:"bg-muted"},{default:t(()=>[a(e(ne),{size:72,class:"text-muted-foreground"})]),_:1})]),_:1}),a(e(T),{class:"w-full"},{default:t(()=>[a(e(B),null,{default:t(()=>[m(r(l.$t("auth.avatar_url")),1)]),_:1}),a(e(x),{modelValue:_.value,"onUpdate:modelValue":v[4]||(v[4]=n=>_.value=n),placeholder:l.$t("auth.avatar_url_hint")},null,8,["modelValue","placeholder"]),a(e(oe),null,{default:t(()=>[m(r(l.$t("auth.avatar_url_hint")),1)]),_:1})]),_:1})]),a(e(Z),null,{default:t(()=>[a(e(N),{variant:"outline",onClick:ge},{default:t(()=>[m(r(l.$t("cancel")),1)]),_:1}),a(e(N),{onClick:ke},{default:t(()=>[m(r(l.$t("auth.save_changes")||"Save changes"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64))}}),fa={key:0,class:"empty-state"},pa={class:"flex size-16 items-center justify-center rounded-full bg-muted mb-3"},ha={class:"text-muted-foreground"},ga={key:1,class:"space-y-2"},ka={class:"flex size-10 items-center justify-center rounded-full bg-muted"},$a={class:"flex-1 min-w-0"},ya={class:"font-medium truncate"},ba={class:"text-sm text-muted-foreground flex flex-wrap gap-2"},wa={key:0},Ca={key:1},Sa=z({__name:"SessionTokensList",props:{tokens:{}},emits:["revoke"],setup(V,{emit:g}){const o=g,$=i=>new Date(i).toLocaleString();return(i,_)=>(d(),U(e(H),null,{default:t(()=>[a(e(K),null,{default:t(()=>[a(e(W),null,{default:t(()=>[m(r(i.$t("auth.active_sessions")),1)]),_:1}),a(e(X),null,{default:t(()=>[m(r(i.$t("auth.manage_active_sessions")),1)]),_:1})]),_:1}),a(e(J),null,{default:t(()=>[V.tokens.length===0?(d(),C("div",fa,[p("div",pa,[a(e(Ie),{size:32,class:"text-muted-foreground"})]),p("p",ha,r(i.$t("no_content")),1)])):(d(),C("div",ga,[(d(!0),C(G,null,ce(V.tokens,f=>(d(),C("div",{key:f.token_id,class:"flex items-center gap-4 rounded-lg border p-4 hover:bg-accent/50 transition-colors"},[p("div",ka,[a(e(Fe),{size:20,class:"text-muted-foreground"})]),p("div",$a,[p("div",ya,r(f.name),1),p("div",ba,[p("span",null,r(i.$t("created"))+": "+r($(f.created_at)),1),f.last_used_at?(d(),C("span",wa,"•")):F("",!0),f.last_used_at?(d(),C("span",Ca,r(i.$t("last_used"))+": "+r($(f.last_used_at)),1)):F("",!0)])]),a(e(N),{variant:"ghost",size:"icon",class:"text-destructive hover:text-destructive hover:bg-destructive/10",onClick:E(c=>o("revoke",f),["stop"])},{default:t(()=>[a(e(me),{size:16})]),_:1},8,["onClick"])]))),128))]))]),_:1})]),_:1}))}}),Ua=se(Sa,[["__scopeId","data-v-628ad67c"]]),Va={class:"user-profile"},Ia={class:"profile-content space-y-6"},Fa={class:"py-4"},Na={class:"text-sm text-muted-foreground mb-4"},Pa={class:"rounded-md bg-destructive/10 p-4"},Ta={class:"font-medium"},za=z({__name:"UserProfile",setup(V){const{t:g}=M(),o=w([]),$=w(!1),i=w(null),_=w(!1),f=D(()=>o.value.filter(u=>!u.is_long_lived)),c=D(()=>o.value.filter(u=>u.is_long_lived)),b=async()=>{try{o.value=await R.getUserTokens()}catch(u){console.error("Failed to load tokens:",u)}},y=u=>{i.value=u,$.value=!0},k=async()=>{if(i.value){_.value=!0;try{if(await R.revokeToken(i.value.token_id)){await b();const s=!i.value.is_long_lived;P.success(g(s?"auth.session_revoked":"auth.token_revoked"))}else{const s=!i.value.is_long_lived;P.error(g(s?"auth.session_revoke_failed":"auth.token_revoke_failed"))}}catch(u){console.error("Failed to revoke token:",u);const s=!i.value?.is_long_lived;P.error(g(s?"auth.session_revoke_failed":"auth.token_revoke_failed"))}finally{$.value=!1,i.value=null,_.value=!1}}};return Ne(()=>{b()}),(u,s)=>(d(),C("div",Va,[a(be,{variant:"comfortable",class:"profile-container"},{default:t(()=>[p("div",Ia,[a(_a),a(ua),a(Ua,{tokens:f.value,onRevoke:y},null,8,["tokens"]),a(oa,{tokens:c.value,onRevoke:y,onCreated:b},null,8,["tokens"])])]),_:1}),a(e(Q),{open:$.value,"onUpdate:open":s[1]||(s[1]=h=>$.value=h)},{default:t(()=>[a(e(ee),{class:"sm:max-w-md"},{default:t(()=>[a(e(ae),null,{default:t(()=>[a(e(te),null,{default:t(()=>[m(r(i.value?.is_long_lived?u.$t("auth.revoke_token"):u.$t("auth.revoke_session")),1)]),_:1})]),_:1}),p("div",Fa,[p("p",Na,r(i.value?.is_long_lived?u.$t("auth.revoke_token_confirm"):u.$t("auth.revoke_session_confirm")),1),p("div",Pa,[p("p",Ta,r(i.value?.name),1)])]),a(e(Z),null,{default:t(()=>[a(e(N),{variant:"outline",onClick:s[0]||(s[0]=h=>$.value=!1)},{default:t(()=>[m(r(u.$t("cancel")),1)]),_:1}),a(e(N),{variant:"destructive",loading:_.value,onClick:k},{default:t(()=>[m(r(u.$t("auth.revoke")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["open"])]))}}),at=se(za,[["__scopeId","data-v-3e668037"]]);export{at as default};
