import{d as O,r as _,a0 as G,c as D,w as h,b as c,e as p,I as f,D as w,H as s,u as r,E as n,f as u,a1 as d,$ as o,N as q}from"./lucide-C2DU1LFb.js";import{u as x}from"./vue-router-BgJK_hRC.js";import{c as t,E as F,k as C,a2 as E,d as S,Z as Y,_ as j}from"./index-CDEBH59G.js";import{E as K}from"./EditConfig-D147fKnL.js";import{n as Z}from"./index.browser-OxPLOBIU.js";import{n as P,s as H,d as m,a as T,q as J,r as Q,m as W,Y as X,Z as ee,p as ae}from"./vuetify-RelkxOq-.js";import"./qrcode-DSFhiIp2.js";import"./marked-C0Rlrcoy.js";import"./color-BTziYnFN.js";import"./vue-i18n-DySrp6mW.js";import"./vueuse-DIaEWNCo.js";/* empty css            */import"./swiper-Jy9GbtzK.js";import"./index-_We2Vr5Z.js";import"./utils-CDN07tui.js";import"./reka-ui-GpbaI08z.js";const le={class:"edit-player"},te={key:0},se={class:"disabled-banner"},ne={class:"header-content"},ie={class:"header-icon"},oe={class:"header-info"},re={class:"header-title-row"},de={class:"header-title"},ue={class:"header-meta"},pe={class:"meta-item"},ve={class:"meta-item"},fe={key:0,class:"meta-item"},me={key:1,class:"meta-item"},ye={key:2,class:"meta-item"},ce=O({__name:"EditPlayer",props:{playerId:{}},setup($){const z=x(),a=_(),N=Z(11),g=_(!1),v=_(!1),b=_(null),y=$,k=_(!1);(async()=>{if(y.playerId)try{k.value=(await t.getDSPConfig(y.playerId)).enabled}catch(l){console.error("Error fetching DSP config:",l)}})();const U=t.subscribe(F.PLAYER_DSP_CONFIG_UPDATED,l=>{k.value=l.data.enabled});G(U);const A=D(()=>{if(!a.value)return[];const l=Object.values(a.value.values),e=t.players[a.value.player_id];return e&&e.type!==C.GROUP?l.push({key:"dsp_settings",type:E.DSP_SETTINGS,label:"",default_value:k.value,required:!1,category:"audio"}):e&&e.type===C.GROUP&&e.supported_features.includes(S.MULTI_DEVICE_DSP)?l.push({key:"dsp_note_multi_device_group",type:E.LABEL,label:"You can configure the DSP for each player individually.",default_value:null,required:!1,category:"audio"}):e&&e.type===C.GROUP&&!e.supported_features.includes(S.MULTI_DEVICE_DSP)&&l.push({key:"dsp_note_multi_device_group_not_supported",type:E.LABEL,label:"This group type does not support DSP when playing to multiple devices.",default_value:null,required:!1,category:"audio"}),l}),B=D(()=>A.value);h(()=>y.playerId,async l=>{l&&(a.value=await t.getPlayerConfig(l))},{immediate:!0}),h(v,l=>{l&&a.value&&(b.value=a.value.name||null)});const V=function(){a.value&&(a.value.name=b.value||void 0),t.savePlayerConfig(y.playerId,{name:a.value.name||null}).then(()=>{g.value=!0}).finally(()=>{g.value=!1,v.value=!1}),v.value=!1},L=async function(l){delete l.dsp_settings,l.enabled=a.value.enabled,t.savePlayerConfig(y.playerId,l),z.push({name:"playersettings"})},M=async function(l){t.savePlayerConfig(y.playerId,l)},R=async function(l,e){g.value=!0;for(const i of Object.values(a.value.values))i.value!==void 0&&e[i.key]==null&&(e[i.key]=i.value);e.session_id=N,t.getPlayerConfigEntries(a.value.player_id,l,e).then(i=>{a.value.values={};for(const I of i)a.value.values[I.key]=I}).catch(i=>{alert(i)}).finally(()=>{g.value=!1})};return(l,e)=>(p(),c("section",le,[a.value&&r(t).getProviderManifest(a.value.provider).domain in r(t).providerManifests?(p(),c("div",te,[a.value.enabled?f("",!0):(p(),w(H,{key:0,type:"warning",variant:"tonal",class:"mb-4",closable:""},{default:n(()=>[u("div",se,[u("span",null,d(l.$t("settings.player_disabled")),1),s(P,{size:"small",color:"warning",variant:"flat",onClick:e[0]||(e[0]=i=>a.value.enabled=!0)},{default:n(()=>[o(d(l.$t("settings.enable_player")),1)]),_:1})])]),_:1})),s(T,{class:"header-card mb-4",elevation:"0"},{default:n(()=>[u("div",ne,[u("div",ie,[s(m,{size:"32",color:"primary"},{default:n(()=>[...e[6]||(e[6]=[o("mdi-speaker",-1)])]),_:1})]),u("div",oe,[u("div",re,[u("h2",de,d(a.value.name||r(t).players[a.value.player_id]?.name||a.value.default_name),1),s(P,{icon:"mdi-pencil",variant:"text",size:"small",density:"compact",class:"rename-btn",onClick:e[1]||(e[1]=i=>v.value=!0)})]),u("div",ue,[u("span",pe,[s(m,{size:"14",class:"mr-1"},{default:n(()=>[...e[7]||(e[7]=[o("mdi-identifier",-1)])]),_:1}),o(" "+d(a.value.player_id),1)]),u("span",ve,[s(m,{size:"14",class:"mr-1"},{default:n(()=>[...e[8]||(e[8]=[o("mdi-puzzle",-1)])]),_:1}),o(" "+d(r(t).getProviderManifest(a.value.provider)?.name)+" ",1),r(t).getProviderManifest(a.value.provider)?.documentation?(p(),c("a",{key:0,class:"docs-link",onClick:e[2]||(e[2]=i=>r(Y)(r(t).getProviderManifest(a.value.provider)?.documentation))},[s(m,{size:"12"},{default:n(()=>[...e[9]||(e[9]=[o("mdi-open-in-new",-1)])]),_:1})])):f("",!0)]),r(t).players[a.value.player_id]?(p(),c("span",fe,[s(m,{size:"14",class:"mr-1"},{default:n(()=>[...e[10]||(e[10]=[o("mdi-information",-1)])]),_:1}),o(" "+d(r(t).players[a.value.player_id].device_info.manufacturer)+" / "+d(r(t).players[a.value.player_id].device_info.model),1)])):f("",!0),r(t).players[a.value.player_id]?.device_info.ip_address?(p(),c("span",me,[s(m,{size:"14",class:"mr-1"},{default:n(()=>[...e[11]||(e[11]=[o("mdi-ip-network",-1)])]),_:1}),o(" "+d(r(t).players[a.value.player_id].device_info.ip_address),1)])):f("",!0),r(t).players[a.value.player_id]?(p(),c("span",ye,[s(m,{size:"14",class:"mr-1"},{default:n(()=>[...e[12]||(e[12]=[o("mdi-tag",-1)])]),_:1}),o(" "+d(l.$t(`player_type.${r(t).players[a.value.player_id].type}`)),1)])):f("",!0)])])])]),_:1})])):f("",!0),a.value?(p(),w(K,{key:1,disabled:!a.value.enabled,"config-entries":B.value,onSubmit:L,onAction:R,onImmediateApply:M},null,8,["disabled","config-entries"])):f("",!0),s(ae,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=i=>v.value=i),"max-width":"400"},{default:n(()=>[s(T,null,{default:n(()=>[s(J,null,{default:n(()=>[o(d(l.$t("settings.player_name")),1)]),_:1}),s(Q,null,{default:n(()=>[s(W,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=i=>b.value=i),placeholder:r(t).players[a.value?.player_id]?.name||a.value?.default_name,variant:"outlined",density:"comfortable",autofocus:"",clearable:"",onKeyup:q(V,["enter"])},null,8,["modelValue","placeholder"])]),_:1}),s(X,null,{default:n(()=>[s(ee),s(P,{variant:"text",onClick:e[4]||(e[4]=i=>v.value=!1)},{default:n(()=>[o(d(l.$t("close")),1)]),_:1}),s(P,{color:"primary",variant:"flat",onClick:V},{default:n(()=>[o(d(l.$t("settings.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),Ue=j(ce,[["__scopeId","data-v-8ae923f8"]]);export{Ue as default};
