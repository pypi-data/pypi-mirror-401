[tox]
envlist = py{311,312},licenses
skipsdist = True
isolated_build = true

[testenv]
passenv = HOME
sitepackages = false
skip_install = true
allowlist_externals =
    poetry
env =
    SQLALCHEMY_WARN_20=1
commands_pre =
    poetry install --all-extras
commands =
    poetry run pytest -c ../pyproject.toml {posargs}

[testenv:licenses]
allowlist_externals =
    {[testenv]allowlist_externals}
    {toxinidir}/../tools/run-liccheck.sh
commands =
    {toxinidir}/../tools/run-liccheck.sh
