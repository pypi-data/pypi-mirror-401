# Generated by the protocol buffer compiler.  DO NOT EDIT!
# sources: envoy/extensions/filters/listener/tls_inspector/v3/tls_inspector.proto
# plugin: python-betterproto2
# This file has been @generated

__all__ = ("TlsInspector",)


import betterproto2
from pydantic.dataclasses import dataclass

from .......message_pool import default_message_pool

_COMPILER_VERSION = "0.9.0"
betterproto2.check_compiler_version(_COMPILER_VERSION)


@dataclass(eq=False, repr=False, config={"extra": "forbid"})
class TlsInspector(betterproto2.Message):
    """
    [#protodoc-title: TLS Inspector Filter]
    Allows detecting whether the transport appears to be TLS or plaintext.
    [#extension: envoy.filters.listener.tls_inspector]
    """

    enable_ja3_fingerprinting: "bool | None" = betterproto2.field(
        1,
        betterproto2.TYPE_MESSAGE,
        unwrap=lambda: ______google__protobuf__.BoolValue,
        optional=True,
    )
    """
    Populate ``JA3`` fingerprint hash using data from the TLS Client Hello packet. Default is false.
    """

    enable_ja4_fingerprinting: "bool | None" = betterproto2.field(
        3,
        betterproto2.TYPE_MESSAGE,
        unwrap=lambda: ______google__protobuf__.BoolValue,
        optional=True,
    )
    """
    Populate ``JA4`` fingerprint hash using data from the TLS Client Hello packet.
    ``JA4`` is an improved version of ``JA3`` that includes TLS version, ciphers, extensions,
    and ALPN information in a hex format. Default is false.
    """

    initial_read_buffer_size: "int | None" = betterproto2.field(
        2,
        betterproto2.TYPE_MESSAGE,
        unwrap=lambda: ______google__protobuf__.UInt32Value,
        optional=True,
    )
    """
    The size in bytes of the initial buffer requested by the tls_inspector.
    If the filter needs to read additional bytes from the socket, the
    filter will double the buffer up to it's default maximum of 16KiB.
    If this size is not defined, defaults to maximum 16KiB that the
    tls inspector will consume.
    """

    close_connection_on_client_hello_parsing_errors: "bool" = betterproto2.field(
        4, betterproto2.TYPE_BOOL
    )
    """
    Close connection when TLS ClientHello message could not be parsed.
    This flag should be enabled only if it is known that incoming connections are expected to use
    TLS protocol, as Envoy does not distinguish between a plain text message or a malformed TLS
    ClientHello message.
    By default this flag is false and TLS ClientHello parsing errors are interpreted as a
    plain text connection.
    Setting this to true will cause connections to be terminated and the ``client_hello_too_large``
    counter to be incremented if the ClientHello message is over implementation defined limit
    (currently 16Kb).
    """


default_message_pool.register_message(
    "envoy.extensions.filters.listener.tls_inspector.v3", "TlsInspector", TlsInspector
)


from .......google import protobuf as ______google__protobuf__
