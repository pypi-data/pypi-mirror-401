Metadata-Version: 2.4
Name: brainsync_sdk
Version: 0.1.0
Classifier: Programming Language :: Rust
Classifier: Programming Language :: Python :: Implementation :: CPython
Classifier: Programming Language :: Python :: Implementation :: PyPy
Requires-Python: >=3.8
Description-Content-Type: text/markdown; charset=UTF-8; variant=GFM

# brainsync Rust SDK

[![Rust](https://img.shields.io/badge/rust-1.75%2B-orange.svg)](https://www.rust-lang.org/)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](../LICENSE)

brainsync è®¾å¤‡çš„ Rust SDKï¼Œæä¾›ç®€å•ã€ç±»å‹å®‰å…¨ã€é«˜æ€§èƒ½çš„ APIã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä¸€è¡Œä»£ç åˆå§‹åŒ–

```rust
use brainsync_sdk::serial::open_brainsync_serial;

let device_api = open_brainsync_serial().await?;
```

å°±è¿™ä¹ˆç®€å•ï¼`device_api` å·²ç»å®Œå…¨é…ç½®å¥½ï¼Œæ”¯æŒæ‰€æœ‰åŠŸèƒ½ã€‚

### å®Œæ•´ç¤ºä¾‹

```rust
use brainsync_sdk::serial::open_brainsync_serial;
use brainsync_sdk::api::{EegSampleRate, EegGain};
use tokio::time::{sleep, Duration};

#[tokio::main]
async fn main() -> anyhow::Result<()> {
    // 1. åˆå§‹åŒ–è®¾å¤‡
    let device_api = open_brainsync_serial().await?;
    
    // 2. è·å–å›ºä»¶ç‰ˆæœ¬
    let version = device_api.ota().get_version().await?;
    println!("Version: {}", version);
    
    // 3. é…ç½® EEG
    device_api.eeg()
        .batch_configure()
        .sample_rate(EegSampleRate::Hz500)
        .gain(EegGain::Gain24)
        .apply()
        .await?;
    
    // 4. è®¢é˜…æ•°æ®
    device_api.subscribe_eeg_data(|packet| {
        let uv = packet.to_microvolts(EegGain::Gain24);
        println!("CH0: {:.2} ÂµV", uv[0]);
    }).await;
    
    // 5. å¯ç”¨ä¼ è¾“
    device_api.eeg().set_transfer(true).await?;
    
    // 6. è¿è¡Œ
    sleep(Duration::from_secs(10)).await;
    
    // 7. åœæ­¢
    device_api.eeg().set_transfer(false).await?;
    
    Ok(())
}
```

## ğŸ“š æ–‡æ¡£

### æ ¸å¿ƒæ–‡æ¡£

- **[æ¶æ„æ€»è§ˆ](docs/ARCHITECTURE_OVERVIEW.md)** - å®Œæ•´æ¶æ„è®¾è®¡
- **[API å‚è€ƒ](docs/API_REFERENCE.md)** - å®Œæ•´ API æ–‡æ¡£
- **[ç®€åŒ– API æŒ‡å—](docs/SIMPLE_API_GUIDE.md)** - å¿«é€Ÿä¸Šæ‰‹

### ä¸“é¢˜æ–‡æ¡£

- **[æ•°æ®æµæŒ‡å—](docs/DATA_STREAM_GUIDE.md)** - æ•°æ®æµè®¢é˜…
- **[OTA æŒ‡å—](docs/OTA_GUIDE.md)** - å›ºä»¶å‡çº§
- **[API ä½¿ç”¨æŒ‡å—](docs/API_USAGE_GUIDE.md)** - ä¸‰ç§é…ç½®æ–¹å¼

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### æ¨¡å— API

| æ¨¡å— | åŠŸèƒ½ | æ–‡æ¡£ |
|------|------|------|
| **EEG** | è„‘ç”µä¿¡å·é‡‡é›†å’Œé…ç½® | [API å‚è€ƒ](docs/API_REFERENCE.md#eegapi) |
| **IMU** | æƒ¯æ€§æµ‹é‡å•å…ƒ | [API å‚è€ƒ](docs/API_REFERENCE.md#imuapi) |
| **OTA** | å›ºä»¶å‡çº§ | [OTA æŒ‡å—](docs/OTA_GUIDE.md) |
| **Magnetometer** | ç£åŠ›è®¡ | [API å‚è€ƒ](docs/API_REFERENCE.md) |
| **ADC** | æ¨¡æ•°è½¬æ¢å™¨ | [API å‚è€ƒ](docs/API_REFERENCE.md) |
| **Stimulation** | ç”µåˆºæ¿€ | [API å‚è€ƒ](docs/API_REFERENCE.md) |

### æ•°æ®æµè®¢é˜…

```rust
// EEG æ•°æ®æµ
device_api.subscribe_eeg_data(|packet| {
    println!("EEG: {:?}", packet.channel_data);
}).await;

// IMU æ•°æ®æµ
device_api.subscribe_imu_data(|packets| {
    for packet in packets {
        println!("IMU: {:?}", packet);
    }
}).await;

// ç£åŠ›è®¡æ•°æ®æµ
device_api.subscribe_mag_data(|packets| {
    println!("MAG: {} packets", packets.len());
}).await;

// ADC æ•°æ®æµ
device_api.subscribe_adc_data(|packet| {
    println!("Battery: {:.2}V", packet.bat_vol_det_voltage());
}).await;
```

### ä¸‰ç§é…ç½®æ–¹å¼

#### 1. åŸºç¡€ APIï¼ˆç®€å•ç›´æ¥ï¼‰

```rust
device_api.eeg().set_sample_rate(EegSampleRate::Hz500).await?;
device_api.eeg().set_gain(EegGain::Gain24).await?;
```

#### 2. Builder æ¨¡å¼ï¼ˆç»“æ„åŒ–ï¼‰

```rust
let config = EegConfig::builder()
    .sample_rate(EegSampleRate::Hz500)
    .gain(EegGain::Gain24)
    .build();
device_api.eeg().configure(config).await?;
```

#### 3. æ‰¹é‡é…ç½®ï¼ˆæ¨èï¼‰

```rust
device_api.eeg()
    .batch_configure()
    .sample_rate(EegSampleRate::Hz500)
    .gain(EegGain::Gain24)
    .apply()
    .await?;
```

## ğŸ“¦ ç¤ºä¾‹ç¨‹åº

### è¿è¡Œç¤ºä¾‹

```bash
# ä¸²å£é€šä¿¡ç¤ºä¾‹
cargo run --example serial_example --features "examples serial"

# OTA å›ºä»¶å‡çº§
cargo run --example ota_example --features "examples serial"

# ä¸²å£ DFU
cargo run --example serial_dfu --features "examples serial"

# ä¸¢åŒ…æ£€æµ‹
cargo run --example packet_loss_example --features "examples serial"
```

### ç¤ºä¾‹åˆ—è¡¨

| ç¤ºä¾‹ | åŠŸèƒ½ | æ–‡ä»¶ |
|------|------|------|
| **serial_example** | å®Œæ•´åŠŸèƒ½æ¼”ç¤º | [serial_example.rs](examples/serial_example.rs) |
| **ota_example** | OTA å‡çº§æ¼”ç¤º | [ota_example.rs](examples/ota_example.rs) |
| **serial_dfu** | å®Œæ•´ DFU æµç¨‹ | [serial_dfu.rs](examples/serial_dfu.rs) |
| **packet_loss_example** | ä¸¢åŒ…æ£€æµ‹ | [packet_loss_example.rs](examples/packet_loss_example.rs) |

## ğŸ—ï¸ æ¶æ„

```
ç”¨æˆ·ä»£ç  (1è¡Œ)
    â†“
open_brainsync_serial()
    â†“
Arc<DeviceApi> â† å®Œæ•´åŠŸèƒ½
    â”œâ”€â”€ ota()     â†’ OTA å‡çº§
    â”œâ”€â”€ eeg()     â†’ EEG é…ç½®
    â”œâ”€â”€ imu()     â†’ IMU é…ç½®
    â””â”€â”€ subscribe_*() â†’ æ•°æ®æµ
    â†“
åè®®å±‚ (å¸§ç¼–è§£ç )
    â†“
ä¼ è¾“å±‚ (ä¸²å£/è“ç‰™)
    â†“
ç¡¬ä»¶è®¾å¤‡
```

è¯¦ç»†æ¶æ„è¯·æŸ¥çœ‹ [æ¶æ„æ€»è§ˆ](docs/ARCHITECTURE_OVERVIEW.md)ã€‚

## ğŸ¨ è®¾è®¡ç‰¹ç‚¹

### ç®€å•æ€§

```rust
// ä¸€è¡Œä»£ç å¼€å§‹
let device_api = open_brainsync_serial().await?;
```

### ç±»å‹å®‰å…¨

```rust
// ç¼–è¯‘æ—¶æ£€æŸ¥ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯
device_api.eeg().set_sample_rate(EegSampleRate::Hz500).await?;
```

### å¼‚æ­¥ä¼˜å…ˆ

```rust
// æ‰€æœ‰ I/O æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„
let version = device_api.ota().get_version().await?;
```

### é›¶æ‹·è´

```rust
// ç›´æ¥ä»å­—èŠ‚æµè§£æï¼Œé¿å…å†…å­˜åˆ†é…
let packet = EegDataPacket::parse(data)?;
```

### å…±äº«çŠ¶æ€

```rust
// æ‰€æœ‰æ¨¡å— API å…±äº«åŒä¸€ä¸ª DeviceApi
let eeg = device_api.eeg();
let ota = device_api.ota();
// è¯·æ±‚-å“åº”æ­£ç¡®åŒ¹é…
```

## ğŸ”§ Feature Flags

```toml
[dependencies]
brainsync-sdk = { path = "sdk", features = ["serial"] }
```

å¯ç”¨ featuresï¼š

- `serial` - ä¸²å£é€šä¿¡ï¼ˆæ¨èï¼‰
- `ble` - è“ç‰™é€šä¿¡ï¼ˆå¼€å‘ä¸­ï¼‰
- `examples` - ç¤ºä¾‹ç¨‹åº

## ğŸ“Š æ€§èƒ½

- **é›¶å¼€é”€æŠ½è±¡** - æ³›å‹ + é™æ€åˆ†å‘
- **æŸ¥è¡¨æ³• CRC8** - é¢„è®¡ç®— CRC è¡¨
- **åŸå­æ“ä½œ** - æ— é”ä¸¢åŒ…æ£€æµ‹
- **å¼‚æ­¥ I/O** - åŸºäº Tokio

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
cargo test --lib protocol
cargo test --lib model

# è¿è¡Œç¤ºä¾‹ä½œä¸ºé›†æˆæµ‹è¯•
cargo run --example serial_example --features "examples serial"
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·æŸ¥çœ‹ [è´¡çŒ®æŒ‡å—](../CONTRIBUTING.md)ã€‚

## ğŸ“„ è®¸å¯è¯

MIT License

---

**å¿«é€Ÿé“¾æ¥**ï¼š
- [æ¶æ„æ€»è§ˆ](docs/ARCHITECTURE_OVERVIEW.md)
- [API å‚è€ƒ](docs/API_REFERENCE.md)
- [ç®€åŒ– API æŒ‡å—](docs/SIMPLE_API_GUIDE.md)
- [ç¤ºä¾‹ç¨‹åº](examples/)

