"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[7130],{1422:function(e,t,n){n.d(t,{H:function(){return s}});var o=n(39595),i=n(61060),a=n(25117);const s=()=>{const e=(0,o.jE)();return(0,i.n)({mutationFn:e=>a.t.createModelDefinition(e),onSuccess:()=>{e.invalidateQueries(["gateway_model_definitions"])}})}},6420:function(e,t,n){n.d(t,{BD:function(){return i},_y:function(){return o},aN:function(){return l}});const o=e=>null===e||void 0===e?null:e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(0)}K`:e.toString(),i=e=>{if(null===e||void 0===e)return null;if(0===e)return"Free";const t=1e6*e;return t<.01?`$${t.toFixed(4)}/1M`:`$${t.toFixed(2)}/1M`},a=e=>{const t=e.match(/(\d{4})(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])(?!\d)/);if(t){const[,e,n,o]=t;return new Date(parseInt(e,10),parseInt(n,10)-1,parseInt(o,10))}const n=e.match(/(\d{4})-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])/);if(n){const[,e,t,o]=n;return new Date(parseInt(e,10),parseInt(t,10)-1,parseInt(o,10))}const o=e.match(/-(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])(?:-|$)/);if(o){const[,e,t]=o,n=(new Date).getFullYear();return new Date(n,parseInt(e,10)-1,parseInt(t,10))}return null},s=e=>{const t=e.replace(/-\d{4}-\d{2}-\d{2}$/,"").replace(/-\d{8}$/,""),n=t.match(/(?:^|[/-])o(\d+)(?:-|$)/);if(n)return parseInt(n[1],10);const o=t.match(/-(\d+)\.(\d+)/);if(o)return parseFloat(`${o[1]}.${o[2]}`);const i=t.match(/-(\d)(\d)-/);if(i)return parseFloat(`${i[1]}.${i[2]}`);const a=t.match(/(\d+)-(\d{1,2})$/);if(a)return parseFloat(`${a[1]}.${a[2]}`);const s=t.match(/(\d+)-(\d{1,2})-[a-z]/i);if(s)return parseFloat(`${s[1]}.${s[2]}`);const l=t.match(/-(\d)o?(?:-|$)/);return l?parseInt(l[1],10):0},l=e=>[...e].sort((e,t)=>{const n=s(e.model),o=s(t.model);if(n!==o)return o-n;const i=a(e.model),l=a(t.model);return i&&l?l.getTime()-i.getTime():i&&!l?-1:!i&&l?1:t.model.localeCompare(e.model)})},6459:function(e,t,n){n.d(t,{v:function(){return s}});var o=n(68248),i=n(27757),a=n(73408);const s=({title:e,children:t})=>{const{theme:n}=(0,i.u)();return(0,a.FD)("div",{css:(0,o.AH)({border:`1px solid ${n.colors.borderDecorative}`,borderRadius:n.general.borderRadiusBase,padding:n.spacing.md},""),children:[(0,a.Y)(i.T.Title,{level:3,css:(0,o.AH)({marginBottom:n.spacing.md},""),children:e}),t]})}},35583:function(e,t,n){n.d(t,{o:function(){return D}});var o=n(68248),i=n(46709),a=n(27757),s=n(82716),l=n(66916),r=n(7655),d=n(40724),c=n(79081),u=n(8264),p=n(6420),m=n(73408);var g={name:"1nl7725",styles:"display:flex;flex-direction:column;align-items:flex-end;gap:2px"};const h=({inputCost:e,outputCost:t})=>{const{theme:n}=(0,a.u)(),i=e=>{if(void 0===e)return"-";const t=1e6*e;return t<.01?`$${t.toFixed(4)}`:`$${t.toFixed(2)}`};return(0,m.FD)("div",{css:g,children:[(0,m.Y)(a.T.Text,{color:"secondary",css:(0,o.AH)({fontSize:n.typography.fontSizeSm},""),children:i(e)}),(0,m.Y)(a.T.Text,{color:"secondary",css:(0,o.AH)({fontSize:n.typography.fontSizeSm},""),children:i(t)})]})};var f={name:"zl1inp",styles:"display:flex;justify-content:center"},v={name:"ti75j2",styles:"margin:0"},y={name:"ovk77c",styles:"min-width:0"},x={name:"2qga7i",styles:"text-align:right"},Y={name:"2qga7i",styles:"text-align:right"};const A=({model:e,isSelected:t,onSelect:n})=>{const{theme:i}=(0,a.u)(),l=(0,r.A)(),d=(0,p._y)(e.max_input_tokens);return(0,m.FD)("div",{onClick:()=>n(e.model),css:(0,o.AH)({display:"grid",gridTemplateColumns:"40px 1fr 110px 100px",gap:i.spacing.sm,padding:`${i.spacing.sm}px ${i.spacing.md}px`,cursor:"pointer",backgroundColor:t?i.colors.actionTertiaryBackgroundPress:"transparent","&:hover":{backgroundColor:t?i.colors.actionTertiaryBackgroundPress:i.colors.actionTertiaryBackgroundHover},borderBottom:`1px solid ${i.colors.borderDecorative}`,"&:last-child":{borderBottom:"none"},alignItems:"center"},""),children:[(0,m.Y)("div",{css:f,children:(0,m.Y)(s.Radio,{value:e.model,css:v})}),(0,m.FD)("div",{css:y,children:[(0,m.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:i.spacing.xs},""),children:[(0,m.Y)(a.T.Text,{bold:!0,children:e.model}),e.deprecation_date&&(0,m.Y)(c.T,{componentId:"mlflow.gateway.model-selector-modal.deprecation-tooltip",content:l.formatMessage({id:"lo4NN3",defaultMessage:"This model will be deprecated on {date}"},{date:e.deprecation_date}),children:(0,m.Y)(s.WarningFillIcon,{css:(0,o.AH)({fontSize:i.typography.fontSizeSm,color:i.colors.textValidationWarning},"")})})]}),(0,m.Y)(a.T.Text,{color:"secondary",css:(0,o.AH)({fontSize:i.typography.fontSizeSm,display:"block"},""),children:[e.supports_function_calling&&"Tools",e.supports_reasoning&&"Reasoning",e.supports_prompt_caching&&"Caching",e.supports_response_schema&&"Structured"].filter(Boolean).join(", ")||"\xa0"})]}),(0,m.Y)("div",{css:x,children:(0,m.Y)(a.T.Text,{color:"secondary",css:(0,o.AH)({fontSize:i.typography.fontSizeSm},""),children:d||"-"})}),(0,m.Y)("div",{css:Y,children:(0,m.Y)(h,{inputCost:e.input_cost_per_token,outputCost:e.output_cost_per_token})})]})};var b={name:"1ks9uvr",styles:"display:flex;justify-content:space-between;align-items:center;width:100%"},w={name:"1ff36h2",styles:"flex-grow:1"},C={name:"2qga7i",styles:"text-align:right"},M={name:"muj0kx",styles:"text-align:right;display:flex;flex-direction:column;align-items:flex-end"},S={name:"1kxd8xu",styles:"max-height:400px;overflow-y:auto"},F={name:"1d3w5wq",styles:"width:100%"},T={name:"1066lcq",styles:"display:flex;justify-content:space-between;align-items:center"},I={name:"opde7s",styles:"color:inherit"},_={name:"1djxupe",styles:"width:14px;height:14px"};const k=({isOpen:e,onClose:t,onSelect:n,provider:g})=>{const{theme:h}=(0,a.u)(),f=(0,r.A)(),[v,y]=(0,i.useState)(null),[x,Y]=(0,i.useState)(""),[k,D]=(0,i.useState)({search:"",capabilities:{tools:!1,reasoning:!1,promptCaching:!1,structuredOutput:!1}}),[$,H]=(0,i.useState)(!1),{data:z,isLoading:P}=(0,u.o)({provider:g||void 0}),B=x.trim().length>0,R=Object.values(k.capabilities).some(Boolean),L=Object.values(k.capabilities).filter(Boolean).length,O=(0,i.useMemo)(()=>{if(!z)return[];const e=new Date;e.setHours(0,0,0,0);const t=z.filter(t=>{if(t.deprecation_date){if(new Date(t.deprecation_date)<e)return!1}return!(k.search&&!t.model.toLowerCase().includes(k.search.toLowerCase()))&&(!(k.capabilities.tools&&!t.supports_function_calling)&&(!(k.capabilities.reasoning&&!t.supports_reasoning)&&(!(k.capabilities.promptCaching&&!t.supports_prompt_caching)&&!(k.capabilities.structuredOutput&&!t.supports_response_schema))))});return(0,p.aN)(t)},[z,k]),j=(0,i.useMemo)(()=>null===z||void 0===z?void 0:z.find(e=>e.model===v),[z,v]),W=(0,i.useCallback)(()=>{y(null),Y(""),D({search:"",capabilities:{tools:!1,reasoning:!1,promptCaching:!1,structuredOutput:!1}}),t()},[t]),N=(0,i.useCallback)(e=>{e.stopPropagation(),D(e=>({...e,capabilities:{tools:!1,reasoning:!1,promptCaching:!1,structuredOutput:!1}}))},[]),q=(0,i.useCallback)(e=>{Y(e),e.trim()&&y(null)},[]),U=(0,i.useCallback)(e=>{y(e),Y("")},[]),E=(0,i.useCallback)(()=>{B?(n({model:x.trim(),provider:g,supports_function_calling:!1}),W()):j&&(n(j),W())},[B,x,j,g,n,W]),X=B?!x.trim():!j;return(0,m.Y)(c.d,{componentId:"mlflow.gateway.model-selector-modal",title:f.formatMessage({id:"qNCHNh",defaultMessage:"Select model"}),visible:e,onCancel:W,size:"wide",footer:(0,m.FD)("div",{css:b,children:[(0,m.Y)("div",{children:(null===j||void 0===j?void 0:j.deprecation_date)&&(0,m.FD)(a.T.Text,{color:"warning",css:(0,o.AH)({display:"flex",alignItems:"center",gap:h.spacing.xs},""),children:[(0,m.Y)(s.WarningFillIcon,{}),(0,m.Y)(d.A,{id:"yFl8nB",defaultMessage:"This model will be deprecated on {date}",values:{date:j.deprecation_date}})]})}),(0,m.FD)("div",{css:(0,o.AH)({display:"flex",gap:h.spacing.sm},""),children:[(0,m.Y)(a.B,{componentId:"mlflow.gateway.model-selector-modal.cancel",onClick:W,children:f.formatMessage({id:"qz9XeG",defaultMessage:"Cancel"})}),(0,m.Y)(a.B,{componentId:"mlflow.gateway.model-selector-modal.confirm",type:"primary",disabled:X,onClick:E,children:f.formatMessage({id:"UI3HSV",defaultMessage:"Select"})})]})]}),children:(0,m.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:h.spacing.md},""),children:[(0,m.FD)("div",{css:(0,o.AH)({display:"flex",gap:h.spacing.sm,alignItems:"center"},""),children:[(0,m.Y)(l.I,{componentId:"mlflow.gateway.model-selector-modal.search",placeholder:f.formatMessage({id:"2RgAyy",defaultMessage:"Search"}),prefix:(0,m.Y)(l.S,{}),value:k.search,onChange:e=>D(t=>({...t,search:e.target.value})),css:w}),(0,m.FD)(a.aw.Root,{componentId:"mlflow.gateway.model-selector-modal.filter-popover",open:$,onOpenChange:H,children:[(0,m.Y)(a.aw.Trigger,{asChild:!0,children:(0,m.Y)(a.B,{componentId:"mlflow.gateway.model-selector-modal.filter-button",endIcon:(0,m.Y)(s.ChevronDownIcon,{}),css:(0,o.AH)({border:R?`1px solid ${h.colors.actionDefaultBorderFocus} !important`:"",backgroundColor:R?`${h.colors.actionDefaultBackgroundHover} !important`:""},""),children:(0,m.FD)("div",{css:(0,o.AH)({display:"flex",gap:h.spacing.sm,alignItems:"center"},""),children:[(0,m.Y)(s.FilterIcon,{}),f.formatMessage({id:"mitP3X",defaultMessage:"Capability{count}"},{count:R?` (${L})`:""}),R&&(0,m.Y)(l.X,{css:(0,o.AH)({fontSize:12,cursor:"pointer",color:h.colors.grey400,"&:hover":{color:h.colors.grey600}},""),onClick:N})]})})}),(0,m.Y)(a.aw.Content,{align:"end",css:(0,o.AH)({padding:h.spacing.md,minWidth:200},""),children:(0,m.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:h.spacing.sm},""),children:[(0,m.Y)("div",{css:(0,o.AH)({fontWeight:h.typography.typographyBoldFontWeight,marginBottom:h.spacing.xs},""),children:(0,m.Y)(d.A,{id:"sj0gOQ",defaultMessage:"Capabilities"})}),(0,m.Y)(s.Checkbox,{componentId:"mlflow.gateway.model-selector-modal.filter.tools",isChecked:k.capabilities.tools,onChange:()=>D(e=>({...e,capabilities:{...e.capabilities,tools:!e.capabilities.tools}})),children:(0,m.Y)(d.A,{id:"JaanQY",defaultMessage:"Tools"})}),(0,m.Y)(s.Checkbox,{componentId:"mlflow.gateway.model-selector-modal.filter.reasoning",isChecked:k.capabilities.reasoning,onChange:()=>D(e=>({...e,capabilities:{...e.capabilities,reasoning:!e.capabilities.reasoning}})),children:(0,m.Y)(d.A,{id:"YLMjFk",defaultMessage:"Reasoning"})}),(0,m.Y)(s.Checkbox,{componentId:"mlflow.gateway.model-selector-modal.filter.promptCaching",isChecked:k.capabilities.promptCaching,onChange:()=>D(e=>({...e,capabilities:{...e.capabilities,promptCaching:!e.capabilities.promptCaching}})),children:(0,m.Y)(d.A,{id:"xyQFjH",defaultMessage:"Prompt Caching"})}),(0,m.Y)(s.Checkbox,{componentId:"mlflow.gateway.model-selector-modal.filter.structuredOutput",isChecked:k.capabilities.structuredOutput,onChange:()=>D(e=>({...e,capabilities:{...e.capabilities,structuredOutput:!e.capabilities.structuredOutput}})),children:(0,m.Y)(d.A,{id:"oMP6X7",defaultMessage:"Structured Output"})})]})})]})]}),P?(0,m.Y)("div",{css:(0,o.AH)({display:"flex",justifyContent:"center",padding:h.spacing.lg},""),children:(0,m.Y)(a.S,{size:"large"})}):(0,m.FD)("div",{css:(0,o.AH)({border:`1px solid ${h.colors.borderDecorative}`,borderRadius:h.general.borderRadiusBase,overflow:"hidden",opacity:B?.5:1,pointerEvents:B?"none":"auto",transition:"opacity 0.2s ease"},""),children:[(0,m.FD)("div",{css:(0,o.AH)({display:"grid",gridTemplateColumns:"40px 1fr 110px 100px",gap:h.spacing.sm,padding:`${h.spacing.sm}px ${h.spacing.md}px`,backgroundColor:h.colors.backgroundSecondary,borderBottom:`1px solid ${h.colors.borderDecorative}`,fontWeight:h.typography.typographyBoldFontWeight,fontSize:h.typography.fontSizeSm,color:h.colors.textSecondary},""),children:[(0,m.Y)("div",{}),(0,m.Y)("div",{children:(0,m.Y)(d.A,{id:"C8Jj/L",defaultMessage:"Name"})}),(0,m.Y)("div",{css:C,children:(0,m.Y)(d.A,{id:"ew8ReB",defaultMessage:"Max Input Tokens"})}),(0,m.FD)("div",{css:M,children:[(0,m.Y)("span",{children:(0,m.Y)(d.A,{id:"ZBZBrn",defaultMessage:"Input /1M"})}),(0,m.Y)("span",{children:(0,m.Y)(d.A,{id:"58/xE7",defaultMessage:"Output /1M"})})]})]}),(0,m.Y)("div",{css:S,children:0===O.length?(0,m.Y)("div",{css:(0,o.AH)({padding:h.spacing.lg,textAlign:"center"},""),children:(0,m.Y)(a.T.Text,{color:"secondary",children:f.formatMessage({id:"M/SGM4",defaultMessage:"No models match your filters"})})}):(0,m.Y)(s.Radio.Group,{name:"model-selector",componentId:"mlflow.gateway.model-selector-modal.radio-group",value:v||"",onChange:e=>U(e.target.value),css:F,children:O.map(e=>(0,m.Y)(A,{model:e,isSelected:v===e.model,onSelect:U},e.model))})})]}),(0,m.FD)("div",{css:T,children:[(0,m.Y)(a.T.Text,{color:"secondary",size:"sm",children:f.formatMessage({id:"tyUmNa",defaultMessage:"{count, plural, one {# model} other {# models}} available"},{count:O.length})}),v&&(0,m.FD)("div",{onClick:()=>y(null),css:(0,o.AH)({display:"flex",alignItems:"center",gap:h.spacing.xs,cursor:"pointer",color:h.colors.textSecondary,"&:hover":{color:h.colors.textPrimary}},""),children:[(0,m.Y)(a.T.Text,{size:"sm",css:I,children:(0,m.Y)(d.A,{id:"PX5Nlz",defaultMessage:"Clear selection"})}),(0,m.Y)(l.X,{css:_})]})]}),(0,m.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:h.spacing.md,marginTop:h.spacing.sm},""),children:[(0,m.Y)("div",{css:(0,o.AH)({flex:1,height:1,backgroundColor:h.colors.borderDecorative},"")}),(0,m.Y)(a.T.Text,{color:"secondary",size:"sm",children:(0,m.Y)(d.A,{id:"0+djpP",defaultMessage:"or"})}),(0,m.Y)("div",{css:(0,o.AH)({flex:1,height:1,backgroundColor:h.colors.borderDecorative},"")})]}),(0,m.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:h.spacing.xs,opacity:v?.5:1,transition:"opacity 0.2s ease"},""),children:[(0,m.Y)(a.T.Text,{bold:!0,children:(0,m.Y)(d.A,{id:"w4bpXQ",defaultMessage:"Use a custom model name"})}),(0,m.Y)(l.I,{componentId:"mlflow.gateway.model-selector-modal.custom-model",placeholder:f.formatMessage({id:"+WPAn1",defaultMessage:"Enter model name..."}),value:x,onChange:e=>q(e.target.value),disabled:!!v}),(0,m.Y)(a.T.Text,{color:"secondary",size:"sm",children:(0,m.Y)(d.A,{id:"3n8Eue",defaultMessage:"Enter a model name not listed above. Capabilities may not be detected."})})]})]})})},D=({provider:e,value:t,onChange:n,disabled:c,error:p,componentIdPrefix:g="mlflow.gateway.model-select"})=>{const{theme:h}=(0,a.u)(),f=(0,r.A)(),[v,y]=(0,i.useState)(!1),{data:x}=(0,u.o)({provider:e||void 0}),Y=(0,i.useMemo)(()=>null===x||void 0===x?void 0:x.find(e=>e.model===t),[x,t]),A=(0,i.useCallback)(()=>{!c&&e&&y(!0)},[c,e]),b=(0,i.useCallback)(e=>{n(e.model)},[n]),w=(0,i.useCallback)(()=>{y(!1)},[]);return(0,m.FD)("div",{children:[(0,m.Y)(s.FormUI.Label,{htmlFor:g,children:(0,m.Y)(d.A,{id:"sptgX6",defaultMessage:"Model"})}),(0,m.Y)(l.I,{id:g,componentId:g,placeholder:e?f.formatMessage({id:"C5WOXw",defaultMessage:"Click to select a model"}):f.formatMessage({id:"rRaThb",defaultMessage:"Select a provider first"}),readOnly:!0,disabled:c||!e,onClick:A,value:t||"",validationState:p?"error":void 0,prefix:t?(0,m.Y)(s.ModelsIcon,{}):void 0,css:(0,o.AH)({cursor:c||!e?"not-allowed":"pointer","& input":{cursor:c||!e?"not-allowed":"pointer"}},"")}),p&&(0,m.Y)(s.FormUI.Message,{type:"error",message:p}),Y&&(0,m.Y)($,{model:Y}),(0,m.Y)(k,{isOpen:v,onClose:w,onSelect:b,provider:e})]})},$=(0,i.memo)(function({model:e}){const{theme:t}=(0,a.u)(),n=(0,i.useMemo)(()=>{const t=[];return e.supports_function_calling&&t.push("Tools"),e.supports_reasoning&&t.push("Reasoning"),e.supports_prompt_caching&&t.push("Caching"),t},[e.supports_function_calling,e.supports_reasoning,e.supports_prompt_caching]);return 0===n.length?null:(0,m.Y)("div",{css:(0,o.AH)({marginTop:t.spacing.xs,display:"flex",alignItems:"center",gap:t.spacing.xs,flexWrap:"wrap"},""),children:n.map(e=>(0,m.Y)(s.Tag,{componentId:`mlflow.gateway.model-select.capability.${e.toLowerCase()}`,children:e},e))})})},73716:function(e,t,n){n.d(t,{t:function(){return s}});var o=n(46709),i=n(87078),a=n(45472);function s({provider:e}){const{data:t,isLoading:n}=(0,i.d)(),s=(0,o.useMemo)(()=>t&&e?t.filter(t=>t.provider===e):[],[t,e]),{data:l,isLoading:r}=(0,a.D)({provider:e}),d=(0,o.useMemo)(()=>{var e;return null!==(e=null===l||void 0===l?void 0:l.auth_modes)&&void 0!==e?e:[]},[null===l||void 0===l?void 0:l.auth_modes]),c=null===l||void 0===l?void 0:l.default_mode,u=(0,o.useCallback)(e=>{var t;if(d.length){if(e){const t=d.find(t=>t.mode===e);if(t)return t}return null!==(t=d.find(e=>e.mode===c))&&void 0!==t?t:d[0]}},[d,c]);return{existingSecrets:s,isLoadingSecrets:n,authModes:d,defaultAuthMode:c,selectedAuthMode:u(c),isLoadingProviderConfig:r,hasExistingSecrets:s.length>0}}},85344:function(e,t,n){n.d(t,{m:function(){return a}});const o=e=>{const t=e.toLowerCase();return t.includes("unique constraint failed")||t.includes("duplicate key value violates unique constraint")||t.includes("duplicate entry")||t.includes("violation of unique key constraint")||t.includes("uniqueviolation")||t.includes("integrityerror")||t.includes("already exists")},i=e=>{const t=e.toLowerCase();return t.includes("secrets.secret_name")||t.includes("secret_name")||t.includes("secret with name")},a=(e,t={})=>{if(null===e||void 0===e||!e.message)return null;const{entityType:n,action:a="creating"}=t,s=e.message;if(o(s))return(e=>{const t=e.toLowerCase();return t.includes("endpoints.name")||t.includes("endpoint_name")})(s)?"An endpoint with this name already exists. Please choose a different name.":i(s)?"secret"===n?"A secret with this name already exists. Please choose a different name or use an existing secret.":"An API key with this name already exists. Please choose a different name or use an existing API key.":"A record with this value already exists. Please use a unique value.";if(s.length>200){return`An error occurred while ${"updating"===a?"updating":"deleting"===a?"deleting":"creating"} the ${"secret"===n?"secret":"endpoint"===n?"endpoint":"resource"}. Please try again.`}return s}},87032:function(e,t,n){n.d(t,{Bm:function(){return a},Ui:function(){return s},W_:function(){return r},cj:function(){return l},j8:function(){return d},lx:function(){return i}});const o="gateway:/";let i=function(e){return e.GATEWAY="gateway",e.OTHER="other",e}({});const a=e=>!e||e.startsWith(o)?i.GATEWAY:i.OTHER,s=e=>{if(null!==e&&void 0!==e&&e.startsWith(o))return e.replace(o,"")},l=e=>`${o}${e}`,r=e=>{var t;const n=null===(t=e.model_mappings)||void 0===t?void 0:t[0];if(null!==n&&void 0!==n&&n.model_definition)return{id:n.endpoint_id,provider:n.model_definition.provider,modelName:n.model_definition.model_name}},d=e=>/^[a-zA-Z0-9_\-.]+$/.test(e)},93422:function(e,t,n){n.d(t,{$:function(){return Y}});var o=n(68248),i=n(46709),a=n(27757),s=n(82716),l=n(7655),r=n(40724),d=n(98332),c=n(87856),u=n(87078),p=n(75329);function m(e){var t;return e&&null!==(t=e.auth_config)&&void 0!==t?t:null}var g=n(64226),h=n(22138),f=n(73408);const v=({secret:e})=>{const{theme:t}=(0,a.u)(),n=(0,i.useMemo)(()=>{var t;return e&&null!==(t=e.auth_config)&&void 0!==t?t:null},[e]);if(!n)return null;const s=Object.entries(n).filter(([e])=>"auth_mode"!==e);return 0===s.length?null:(0,f.FD)(f.FK,{children:[(0,f.Y)(a.T.Text,{color:"secondary",children:(0,f.Y)(r.A,{id:"w2WWoM",defaultMessage:"Config:"})}),(0,f.Y)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:t.spacing.xs/2},""),children:s.map(([e,n])=>(0,f.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:t.spacing.xs},""),children:[(0,f.FD)(a.T.Text,{color:"secondary",css:(0,o.AH)({fontSize:t.typography.fontSizeSm},""),children:[(0,p.u3)(e),":"]}),(0,f.Y)(a.T.Text,{css:(0,o.AH)({fontFamily:"monospace",fontSize:t.typography.fontSizeSm},""),children:String(n)})]},e))})]})};var y={name:"1d3w5wq",styles:"width:100%"};const x=({provider:e,value:t,onChange:n,disabled:l,error:d})=>{var c;const{theme:x}=(0,a.u)(),{data:Y,isLoading:A}=(0,u.d)({provider:e}),b=(0,i.useMemo)(()=>e?null===Y||void 0===Y?void 0:Y.filter(t=>t.provider===e):Y,[e,Y]),w=(0,i.useMemo)(()=>t?null===b||void 0===b?void 0:b.find(e=>e.secret_id===t):void 0,[t,b]);return A?(0,f.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:x.spacing.sm},""),children:[(0,f.Y)(a.S,{size:"small"}),(0,f.Y)(r.A,{id:"zgpnjD",defaultMessage:"Loading API keys..."})]}):(0,f.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:x.spacing.sm,width:"100%"},""),children:[(0,f.FD)("div",{children:[(0,f.Y)(s.FormUI.Label,{htmlFor:"mlflow.gateway.create-endpoint.secret-select",children:(0,f.Y)(r.A,{id:"cNkqxA",defaultMessage:"API key"})}),(0,f.Y)(s.SimpleSelect,{id:"mlflow.gateway.create-endpoint.secret-select",componentId:"mlflow.gateway.create-endpoint.secret-select",value:t,onChange:({target:e})=>n(e.value),disabled:l||!(null!==b&&void 0!==b&&b.length),placeholder:null!==b&&void 0!==b&&b.length?"Select an API key":"No API keys available for this provider",validationState:d?"error":void 0,contentProps:{matchTriggerWidth:!0,maxHeight:300},css:y,children:null===b||void 0===b?void 0:b.map(e=>(0,f.Y)(s.SimpleSelectOption,{value:e.secret_id,children:e.secret_name},e.secret_id))}),d&&(0,f.Y)(s.FormUI.Message,{type:"error",message:d})]}),w&&(0,f.FD)("div",{css:(0,o.AH)({backgroundColor:x.colors.backgroundSecondary,borderRadius:x.general.borderRadiusBase,padding:x.spacing.md,display:"flex",flexDirection:"column"},""),children:[(0,f.Y)(a.T.Text,{bold:!0,size:"sm",color:"secondary",children:(0,f.Y)(r.A,{id:"KwJRcV",defaultMessage:"API key details"})}),(0,f.FD)("div",{css:(0,o.AH)({display:"grid",gridTemplateColumns:"auto 1fr",gap:`${x.spacing.xs}px ${x.spacing.md}px`,fontSize:x.typography.fontSizeSm,marginTop:x.spacing.md},""),children:[(null===(c=m(w))||void 0===c?void 0:c.auth_mode)&&(0,f.FD)(f.FK,{children:[(0,f.Y)(a.T.Text,{color:"secondary",children:(0,f.Y)(r.A,{id:"6I8pKa",defaultMessage:"Auth Type:"})}),(0,f.Y)(a.T.Text,{children:(0,p.Qs)(String(m(w).auth_mode))})]}),(0,f.Y)(a.T.Text,{color:"secondary",children:(0,f.Y)(r.A,{id:"rvRhzv",defaultMessage:"Masked Key:"})}),(0,f.Y)(h.R,{maskedValue:w.masked_values}),(0,f.Y)(v,{secret:w}),(0,f.Y)(a.T.Text,{color:"secondary",children:(0,f.Y)(r.A,{id:"X1nbeT",defaultMessage:"Last Updated:"})}),(0,f.Y)(a.T.Text,{children:(0,f.Y)(g.f,{date:new Date(w.last_updated_at)})}),(0,f.Y)(a.T.Text,{color:"secondary",children:(0,f.Y)(r.A,{id:"evVfYj",defaultMessage:"Created:"})}),(0,f.Y)(a.T.Text,{children:(0,f.Y)(g.f,{date:new Date(w.created_at)})}),w.created_by&&(0,f.FD)(f.FK,{children:[(0,f.Y)(a.T.Text,{color:"secondary",children:(0,f.Y)(r.A,{id:"hpAK1G",defaultMessage:"Created by:"})}),(0,f.Y)(a.T.Text,{children:w.created_by})]})]})]})]})};function Y({value:e,onChange:t,provider:n,existingSecrets:d,isLoadingSecrets:c,authModes:u,defaultAuthMode:p,isLoadingProviderConfig:m,errors:g,disabled:h,componentIdPrefix:v="mlflow.gateway.api-key-config"}){const{theme:y}=(0,a.u)(),{formatMessage:Y}=(0,l.A)(),b=d.length>0,w=u.length>1,C=(0,i.useMemo)(()=>{var t;if(u.length){if(e.newSecret.authMode){const t=u.find(t=>t.mode===e.newSecret.authMode);if(t)return t}return null!==(t=u.find(e=>e.mode===p))&&void 0!==t?t:u[0]}},[u,e.newSecret.authMode,p]);(0,i.useEffect)(()=>{"new"===e.mode&&!e.newSecret.authMode&&C&&t({...e,newSecret:{...e.newSecret,authMode:C.mode}})},[e,C,t]);const M=(0,i.useCallback)(n=>{t({...e,mode:n})},[t,e]),S=(0,i.useCallback)(n=>{t({...e,existingSecretId:n})},[t,e]),F=(0,i.useCallback)(n=>{t({...e,newSecret:n})},[t,e]),T=(0,i.useCallback)(t=>{F({...e.newSecret,name:t})},[F,e.newSecret]),I=(0,i.useCallback)(t=>{F({...e.newSecret,authMode:t,secretFields:{},configFields:{}})},[F,e.newSecret]),_=(0,i.useCallback)((t,n)=>{F({...e.newSecret,secretFields:{...e.newSecret.secretFields,[t]:n}})},[F,e.newSecret]),k=(0,i.useCallback)((t,n)=>{F({...e.newSecret,configFields:{...e.newSecret.configFields,[t]:n}})},[F,e.newSecret]);return n?m?(0,f.Y)("div",{css:(0,o.AH)({display:"flex",justifyContent:"center",padding:y.spacing.md},""),children:(0,f.Y)(a.S,{size:"small"})}):(0,f.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:y.spacing.md},""),children:[(0,f.FD)(s.Radio.Group,{componentId:`${v}.mode`,name:`${v}.mode`,value:e.mode,onChange:e=>M(e.target.value),layout:"horizontal",disabled:h,children:[(0,f.Y)(s.Radio,{value:"new",children:(0,f.Y)(r.A,{id:"2pSaCv",defaultMessage:"Create new API key"})}),(0,f.Y)(s.Radio,{value:"existing",disabled:!b,children:(0,f.Y)(r.A,{id:"/NF6sl",defaultMessage:"Use existing API key"})})]}),!b&&(0,f.Y)(a.T.Text,{color:"secondary",css:(0,o.AH)({fontSize:y.typography.fontSizeSm},""),children:(0,f.Y)(r.A,{id:"EBJq8A",defaultMessage:"No existing API keys for this provider."})}),"existing"===e.mode?(0,f.Y)(x,{provider:n,value:e.existingSecretId,onChange:S,disabled:h,error:null===g||void 0===g?void 0:g.existingSecretId}):(0,f.Y)(A,{value:e.newSecret,provider:n,selectedAuthMode:C,authModes:u,hasMultipleAuthModes:w,defaultAuthMode:p,errors:null===g||void 0===g?void 0:g.newSecret,disabled:h,componentIdPrefix:v,onNameChange:T,onAuthModeChange:I,onSecretFieldChange:_,onConfigFieldChange:k})]}):(0,f.Y)(a.T.Text,{color:"secondary",children:(0,f.Y)(r.A,{id:"wx0s66",defaultMessage:"Select a provider and model to configure API key"})})}function A({value:e,provider:t,selectedAuthMode:n,authModes:u,hasMultipleAuthModes:m,defaultAuthMode:g,errors:h,disabled:v,componentIdPrefix:y,onNameChange:x,onAuthModeChange:Y,onSecretFieldChange:A,onConfigFieldChange:b}){const{theme:w}=(0,a.u)(),{formatMessage:C}=(0,l.A)(),M=(0,i.useMemo)(()=>{var e,o;const i=[...(null!==(e=null===n||void 0===n?void 0:n.secret_fields)&&void 0!==e?e:[]).map(e=>({...e,fieldType:"secret"})),...(null!==(o=null===n||void 0===n?void 0:n.config_fields)&&void 0!==o?o:[]).map(e=>({...e,fieldType:"config"}))];return(0,p.Sm)(i,t)},[null===n||void 0===n?void 0:n.secret_fields,null===n||void 0===n?void 0:n.config_fields,t]);return(0,f.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:w.spacing.md},""),children:[(0,f.FD)("div",{children:[(0,f.FD)(s.FormUI.Label,{htmlFor:`${y}.name`,children:[(0,f.Y)(r.A,{id:"4CNVbz",defaultMessage:"API key name"}),(0,f.Y)("span",{css:(0,o.AH)({color:w.colors.textValidationDanger},""),children:" *"})]}),(0,f.Y)(d.f,{id:`${y}.name`,componentId:`${y}.name`,value:e.name,onChange:e=>x(e.target.value),placeholder:C({id:"tatySQ",defaultMessage:"my-api-key"}),validationState:null!==h&&void 0!==h&&h.name?"error":void 0,disabled:v}),null!==h&&void 0!==h&&h.name?(0,f.Y)(s.FormUI.Message,{type:"error",message:h.name}):(0,f.Y)(s.FormUI.Hint,{children:(0,f.Y)(r.A,{id:"7AbOaV",defaultMessage:"A unique name to identify this API key for reuse across endpoints"})})]}),m&&(0,f.FD)("div",{children:[(0,f.Y)(s.FormUI.Label,{children:(0,f.Y)(r.A,{id:"JwhonN",defaultMessage:"Authentication method"})}),(0,f.Y)(s.Radio.Group,{name:`${y}.auth-mode`,componentId:`${y}.auth-mode`,value:e.authMode||g,onChange:e=>Y(e.target.value),disabled:v,children:(0,f.Y)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:w.spacing.sm},""),children:u.map(e=>(0,f.Y)(s.Radio,{value:e.mode,children:(0,f.FD)("div",{children:[(0,f.Y)("div",{css:(0,o.AH)({fontWeight:w.typography.typographyBoldFontWeight},""),children:e.display_name}),e.description&&(0,f.Y)("div",{css:(0,o.AH)({color:w.colors.textSecondary,fontSize:w.typography.fontSizeSm},""),children:e.description})]})},e.mode))})})]}),M.map(t=>{var n,i,a,l,r,u;return(0,f.FD)("div",{children:[(0,f.FD)(s.FormUI.Label,{htmlFor:`${y}.${t.fieldType}.${t.name}`,children:[(0,p.u3)(t.name),t.required&&(0,f.Y)("span",{css:(0,o.AH)({color:w.colors.textValidationDanger},""),children:" *"})]}),"secret"===t.fieldType?(0,f.Y)(c.L,{id:`${y}.secret.${t.name}`,componentId:`${y}.secret.${t.name}`,value:null!==(n=e.secretFields[t.name])&&void 0!==n?n:"",onChange:e=>A(t.name,e.target.value),placeholder:t.description,validationState:null!==h&&void 0!==h&&null!==(i=h.secretFields)&&void 0!==i&&i[t.name]?"error":void 0,disabled:v}):(0,f.Y)(d.f,{id:`${y}.config.${t.name}`,componentId:`${y}.config.${t.name}`,value:null!==(a=e.configFields[t.name])&&void 0!==a?a:"",onChange:e=>b(t.name,e.target.value),placeholder:t.description,validationState:null!==h&&void 0!==h&&null!==(l=h.configFields)&&void 0!==l&&l[t.name]?"error":void 0,disabled:v}),"secret"===t.fieldType&&(null===h||void 0===h||null===(r=h.secretFields)||void 0===r?void 0:r[t.name])&&(0,f.Y)(s.FormUI.Message,{type:"error",message:h.secretFields[t.name]}),"config"===t.fieldType&&(null===h||void 0===h||null===(u=h.configFields)||void 0===u?void 0:u[t.name])&&(0,f.Y)(s.FormUI.Message,{type:"error",message:h.configFields[t.name]})]},t.name)})]})}}}]);