"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[7267],{5857:function(e,n,t){t.d(n,{O:function(){return i},n:function(){return a}});var r=t(46709),o=t(91105);const i="selectedDatasetId",a=()=>{var e;const[n,t]=(0,o.ok)();return[null!==(e=n.get(i))&&void 0!==e?e:void 0,(0,r.useCallback)(e=>{t(n=>e?(n.set(i,e),n):(n.delete(i),n),{replace:!0})},[t]),(0,r.useCallback)(()=>{t(e=>(e.delete(i),e),{replace:!0})},[t])]}},16144:function(e,n,t){t.d(n,{f:function(){return r.f}});var r=t(64226)},27556:function(e,n,t){t.d(n,{YQ:function(){return o},d7:function(){return a}});var r=t(46709);function o(e,n,t){var o=this,i=(0,r.useRef)(null),a=(0,r.useRef)(0),s=(0,r.useRef)(null),l=(0,r.useRef)([]),u=(0,r.useRef)(),d=(0,r.useRef)(),c=(0,r.useRef)(e),m=(0,r.useRef)(!0);c.current=e;var h="undefined"!=typeof window,p=!n&&0!==n&&h;if("function"!=typeof e)throw new TypeError("Expected a function");n=+n||0;var g=!!(t=t||{}).leading,f=!("trailing"in t)||!!t.trailing,v="maxWait"in t,y="debounceOnServer"in t&&!!t.debounceOnServer,b=v?Math.max(+t.maxWait||0,n):null;(0,r.useEffect)(function(){return m.current=!0,function(){m.current=!1}},[]);var R=(0,r.useMemo)(function(){var e=function(e){var n=l.current,t=u.current;return l.current=u.current=null,a.current=e,d.current=c.current.apply(t,n)},t=function(e,n){p&&cancelAnimationFrame(s.current),s.current=p?requestAnimationFrame(e):setTimeout(e,n)},r=function(e){if(!m.current)return!1;var t=e-i.current;return!i.current||t>=n||t<0||v&&e-a.current>=b},R=function(n){return s.current=null,f&&l.current?e(n):(l.current=u.current=null,d.current)},w=function e(){var o=Date.now();if(r(o))return R(o);if(m.current){var s=n-(o-i.current),l=v?Math.min(s,b-(o-a.current)):s;t(e,l)}},x=function(){if(h||y){var c=Date.now(),p=r(c);if(l.current=[].slice.call(arguments),u.current=o,i.current=c,p){if(!s.current&&m.current)return a.current=i.current,t(w,n),g?e(i.current):d.current;if(v)return t(w,n),e(i.current)}return s.current||t(w,n),d.current}};return x.cancel=function(){s.current&&(p?cancelAnimationFrame(s.current):clearTimeout(s.current)),a.current=0,l.current=i.current=u.current=s.current=null},x.isPending=function(){return!!s.current},x.flush=function(){return s.current?R(Date.now()):d.current},x},[g,v,n,b,f,p,h,y]);return R}function i(e,n){return e===n}function a(e,n,t){var a=t&&t.equalityFn||i,s=(0,r.useRef)(e),l=(0,r.useState)({})[1],u=o((0,r.useCallback)(function(e){s.current=e,l({})},[l]),n,t),d=(0,r.useRef)(e);return a(d.current,e)||(u(e),d.current=e),[s.current,u]}},29774:function(e,n,t){t.d(n,{Au:function(){return s},tF:function(){return l}});var r=t(46709),o=t(36476),i=t(73408);const a=(0,r.createContext)({currentUserActionError:null,handleError:()=>{},handlePromise:()=>{},clearUserActionError:()=>{}}),s=({children:e,errorFilter:n})=>{const[t,s]=(0,r.useState)(null),l=(0,r.useCallback)((e,t)=>{if(null===n||void 0===n||!n(e)){const n=(0,o.a$)(e);s(n),t&&t(n)}},[s,n]),u=(0,r.useCallback)(e=>{e.catch(e=>{l(e)})},[l]),d=(0,r.useCallback)(()=>{s(null)},[s]);return(0,i.Y)(a.Provider,{value:(0,r.useMemo)(()=>({currentUserActionError:t,handleError:l,handlePromise:u,clearUserActionError:d}),[d,t,l,u]),children:e})},l=()=>{const{currentUserActionError:e,handleError:n,handlePromise:t,clearUserActionError:o}=(0,r.useContext)(a),i=(0,r.useCallback)((e,t,r)=>{n(t,r)},[n]);return(0,r.useMemo)(()=>({currentUserActionError:e,handleError:n,handleErrorWithEvent:i,handlePromise:t,clearUserActionError:o}),[o,n,t,e,i])}},33972:function(e,n,t){t.d(n,{i:function(){return i}});var r=t(76118),o=t(46709);const i=(e,n)=>{const t=(0,o.useRef)();return t.current&&(0,r.isEqual)(n,t.current.deps)||(t.current={deps:n,value:e()}),t.current.value}},60062:function(e,n,t){t.d(n,{E:function(){return g}});var r=t(46709),o=t(48667),i=t(56606),a=t(27949),s=t(23403),l=t(4200);class u extends l.Q{constructor(e,n){super(),this.client=e,this.queries=[],this.result=[],this.observers=[],this.observersMap={},n&&this.setQueries(n)}onSubscribe(){1===this.listeners.size&&this.observers.forEach(e=>{e.subscribe(n=>{this.onUpdate(e,n)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.observers.forEach(e=>{e.destroy()})}setQueries(e,n){this.queries=e,a.j.batch(()=>{const e=this.observers,t=this.findMatchingObservers(this.queries);t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions,n));const r=t.map(e=>e.observer),o=Object.fromEntries(r.map(e=>[e.options.queryHash,e])),a=r.map(e=>e.getCurrentResult()),s=r.some((n,t)=>n!==e[t]);(e.length!==r.length||s)&&(this.observers=r,this.observersMap=o,this.result=a,this.hasListeners()&&((0,i.iv)(e,r).forEach(e=>{e.destroy()}),(0,i.iv)(r,e).forEach(e=>{e.subscribe(n=>{this.onUpdate(e,n)})}),this.notify()))})}getCurrentResult(){return this.result}getQueries(){return this.observers.map(e=>e.getCurrentQuery())}getObservers(){return this.observers}getOptimisticResult(e){return this.findMatchingObservers(e).map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions))}findMatchingObservers(e){const n=this.observers,t=new Map(n.map(e=>[e.options.queryHash,e])),r=e.map(e=>this.client.defaultQueryOptions(e)),o=r.flatMap(e=>{const n=t.get(e.queryHash);return null!=n?[{defaultedQueryOptions:e,observer:n}]:[]}),i=new Set(o.map(e=>e.defaultedQueryOptions.queryHash)),a=r.filter(e=>!i.has(e.queryHash)),l=new Set(o.map(e=>e.observer)),u=n.filter(e=>!l.has(e)),d=e=>{const n=this.client.defaultQueryOptions(e),t=this.observersMap[n.queryHash];return null!=t?t:new s.$(this.client,n)},c=a.map((e,n)=>{if(e.keepPreviousData){const t=u[n];if(void 0!==t)return{defaultedQueryOptions:e,observer:t}}return{defaultedQueryOptions:e,observer:d(e)}});return o.concat(c).sort((e,n)=>r.indexOf(e.defaultedQueryOptions)-r.indexOf(n.defaultedQueryOptions))}onUpdate(e,n){const t=this.observers.indexOf(e);-1!==t&&(this.result=(0,i._D)(this.result,t,n),this.notify())}notify(){a.j.batch(()=>{this.listeners.forEach(({listener:e})=>{e(this.result)})})}}var d=t(39595),c=t(56718),m=t(77524),h=t(60164),p=t(2719);function g({queries:e,context:n}){const t=(0,d.jE)({context:n}),i=(0,c.w)(),s=(0,m.h)(),l=r.useMemo(()=>e.map(e=>{const n=t.defaultQueryOptions(e);return n._optimisticResults=i?"isRestoring":"optimistic",n}),[e,t,i]);l.forEach(e=>{(0,p.tu)(e),(0,h.LJ)(e,s)}),(0,h.wZ)(s);const[g]=r.useState(()=>new u(t,l)),f=g.getOptimisticResult(l);(0,o.r)(r.useCallback(e=>i?()=>{}:g.subscribe(a.j.batchCalls(e)),[g,i]),()=>g.getCurrentResult(),()=>g.getCurrentResult()),r.useEffect(()=>{g.setQueries(l,{listeners:!1})},[l,g]);const v=f.some((e,n)=>(0,p.EU)(l[n],e,i))?f.flatMap((e,n)=>{const t=l[n],r=g.getObservers()[n];if(t&&r){if((0,p.EU)(t,e,i))return(0,p.iL)(t,r,s);(0,p.nE)(e,i)&&(0,p.iL)(t,r,s)}return[]}):[];if(v.length>0)throw Promise.all(v);const y=g.getQueries(),b=f.find((e,n)=>{var t,r;return(0,h.$1)({result:e,errorResetBoundary:s,useErrorBoundary:null!=(t=null==(r=l[n])?void 0:r.useErrorBoundary)&&t,query:y[n]})});if(null!=b&&b.error)throw b.error;return f}},64226:function(e,n,t){t.d(n,{f:function(){return u}});t(46709);var r=t(79081),o=t(7655),i=t(73408);const a=86400,s={timeZoneName:"short",year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"},l=({date:e,intl:n,tooltipFormatOptions:t=s})=>{const r=new Date,o=Math.round((r.getTime()-e.getTime())/1e3),i=navigator.language||"en-US";let l="";try{l=Intl.DateTimeFormat(i,t).format(e)}catch(u){}for(const s of(e=>[{seconds:31536e3,timeAgoMessage:n=>e.formatMessage({id:"NF6ePS",defaultMessage:"{count, plural, =1 {1 year} other {# years}} ago"},{count:n})},{seconds:2592e3,timeAgoMessage:n=>e.formatMessage({id:"N79Rdb",defaultMessage:"{count, plural, =1 {1 month} other {# months}} ago"},{count:n})},{seconds:a,timeAgoMessage:n=>e.formatMessage({id:"XwD3hV",defaultMessage:"{count, plural, =1 {1 day} other {# days}} ago"},{count:n})},{seconds:3600,timeAgoMessage:n=>e.formatMessage({id:"i1Hj20",defaultMessage:"{count, plural, =1 {1 hour} other {# hours}} ago"},{count:n})},{seconds:60,timeAgoMessage:n=>e.formatMessage({id:"ZO8PZt",defaultMessage:"{count, plural, =1 {1 minute} other {# minutes}} ago"},{count:n})},{seconds:1,timeAgoMessage:n=>e.formatMessage({id:"gQB+Vs",defaultMessage:"{count, plural, =1 {1 second} other {# seconds}} ago"},{count:n})}])(n)){const e=Math.floor(o/s.seconds);if(e>=1)return{displayText:s.timeAgoMessage(e),tooltipTitle:l}}return{displayText:n.formatMessage({id:"ZOsiNc",defaultMessage:"just now"}),tooltipTitle:l}},u=({date:e,tooltipFormatOptions:n=s})=>{const t=(0,o.A)(),{displayText:a,tooltipTitle:u}=l({date:e,intl:t,tooltipFormatOptions:n});return(0,i.Y)(r.T,{componentId:"web-shared.time-ago",content:u,children:(0,i.Y)("span",{children:a})})}},65159:function(e,n,t){t.r(n),t.d(n,{default:function(){return yn}});var r=t(68248),o=t(59930),i=t.n(o),a=t(46709),s=t(95328),l=t(29774),u=t(89949),d=t(82716),c=t(27757),m=t(40724),h=t(73408);var p={name:"1vfb318",styles:"flex:1;display:flex;align-items:center;justify-content:center"};const g=({error:e})=>{var n;return(0,h.Y)(d.PageWrapper,{css:p,children:(0,h.Y)(d.Empty,{"data-testid":"fallback",title:(0,h.Y)(m.A,{id:"w80phd",defaultMessage:"Error"}),description:null!==(n=null===e||void 0===e?void 0:e.message)&&void 0!==n?n:(0,h.Y)(m.A,{id:"tQrhZ8",defaultMessage:"An error occurred while rendering this component."}),image:(0,h.Y)(c.k,{})})})},f=({children:e,resetKey:n})=>(0,h.Y)(u.tH,{FallbackComponent:g,resetKeys:[n],children:(0,h.Y)(l.Au,{children:e})});var v=t(76256),y=t(77680),b=t(79081),R=t(91105),w=t(70513),x=t(60284),S=t(49620),C=t(67063),D=t(16144);const M=(e,n)=>[e,n].join("."),Y=e=>{const[n,...t]=e.split(".");if(t.length&&Object.values(se).includes(n))return{columnType:n,key:t.join(".")}};var I=t(34931);const A=(0,a.createContext)({isRowHidden:()=>!1,toggleRowVisibility:()=>{},setVisibilityMode:()=>{},visibilityMode:I.oy.SHOWALL,usingCustomVisibility:!1,allRunsHidden:!1}),T=({children:e})=>{const[n,t]=(0,a.useState)(new Set),[r,o]=(0,a.useState)(I.oy.SHOWALL),i=(0,a.useCallback)((e,t,o)=>r===I.oy.CUSTOM?n.has(e):r===I.oy.HIDEALL||(r===I.oy.FIRST_10_RUNS?t>=10:r===I.oy.FIRST_20_RUNS?t>=20:r===I.oy.HIDE_FINISHED_RUNS&&["FINISHED","FAILED","KILLED"].includes(null!==o&&void 0!==o?o:"")),[n,r]),s=(0,a.useCallback)(e=>{t(n=>{const t=new Set(n);return t.has(e)?t.delete(e):t.add(e),t}),o(I.oy.CUSTOM)},[]),l=(0,a.useCallback)(e=>{o(e),e!==I.oy.CUSTOM&&t(new Set)},[]),u=r===I.oy.CUSTOM&&n.size>0,d=r===I.oy.HIDEALL,c=(0,a.useMemo)(()=>({isRowHidden:i,toggleRowVisibility:s,setVisibilityMode:l,visibilityMode:r,usingCustomVisibility:u,allRunsHidden:d}),[i,s,l,r,u,d]);return(0,h.Y)(A.Provider,{value:c,children:e})},k=()=>(0,a.useContext)(A);var E=t(44105),F=t(181),L=t(5857);const U=({dataset:e,children:n,className:t})=>{const{experimentId:r}=(0,R.g)(),o=(0,a.useMemo)(()=>(0,F.pt)(e.source),[e.source]),{search:i,hash:s}=(0,R.zy)();if(null!==o&&void 0!==o&&o.dataset_id&&r){const e=x.Ay.getExperimentPageTabRoute(r,E.fM.Datasets),a=new URLSearchParams(i);return a.set(L.O,o.dataset_id),(0,h.Y)(R.N_,{to:{pathname:e,search:a.toString(),hash:s},className:t,children:n})}return n};const H=({row:e,table:{options:{meta:n}}})=>"subRuns"in e.original?(0,h.Y)("div",{children:"-"}):(0,h.Y)(d.Checkbox,{componentId:"mlflow.eval-runs.checkbox-cell","data-testid":`eval-runs-table-cell-checkbox-${e.id}`,disabled:!e.getCanSelect(),isChecked:e.getIsSelected(),wrapperStyle:{padding:0,margin:0},onChange:()=>e.toggleSelected()});var O={name:"y1ecum",styles:"text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex-shrink:1"};const _=({row:e,table:{options:{meta:n}}})=>{const{theme:t}=(0,c.u)(),o=(0,S.MQ)(),i=(0,S.LE)();if("subRuns"in e.original)return(0,h.Y)("div",{children:"-"});const a=e.original.info.runUuid;return(0,h.FD)("div",{css:(0,r.AH)({overflow:"hidden",display:"flex",alignItems:"center",gap:t.spacing.xs},""),onClick:()=>{var e,t;null===(e=(t=n).setSelectedRunUuid)||void 0===e||e.call(t,a)},children:[(0,h.Y)(C.E,{color:i(a),onChangeColor:e=>o({runUuid:a,colorValue:e})}),(0,h.Y)(c.T.Link,{css:O,componentId:"mlflow.eval-runs.run-name-cell",id:"run-name-cell",children:e.original.info.runName}),(0,h.Y)("div",{css:(0,r.AH)({display:"none",flexShrink:0,".eval-runs-table-row:hover &":{display:"inline"},svg:{width:t.typography.fontSizeMd,height:t.typography.fontSizeMd}},""),children:(0,h.Y)(R.N_,{target:"_blank",rel:"noreferrer",to:x.Ay.getRunPageTabRoute(e.original.info.experimentId,a,E.N3.EVALUATIONS),children:(0,h.Y)(b.T,{content:(0,h.Y)(m.A,{id:"T3RjOb",defaultMessage:"Go to the run"}),componentId:"mlflow.eval-runs.run-name-cell.tooltip",children:(0,h.Y)(c.B,{type:"link",target:"_blank",icon:(0,h.Y)(c.au,{}),size:"small",componentId:"mlflow.eval-runs.run-name-cell.open-run-page"})})})})]})};var N={name:"1kvqz6y",styles:"& > svg{width:12px;height:12px;}"},B={name:"1bnhmdk",styles:"overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap"},z={name:"1cot5qr",styles:"max-width:100%;margin-right:0"};const q=({row:e,table:{options:{meta:n}}})=>{var t,o,i,a;const{theme:s}=(0,c.u)();if("subRuns"in e.original)return(0,h.Y)("div",{children:"-"});const l=e.original,u=null!==(t=null===(o=l.inputs)||void 0===o?void 0:o.datasetInputs)&&void 0!==t?t:[],m=null!==(i=null===(a=u[0])||void 0===a?void 0:a.dataset)&&void 0!==i?i:null;if(!m)return(0,h.Y)("div",{children:"-"});const p=(0,h.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",gap:s.spacing.xs,maxWidth:"100%",color:s.colors.textPrimary},""),children:[(0,h.Y)(d.TableIcon,{css:N}),(0,h.Y)(c.T.Text,{css:B,children:m.name})]}),g=(0,h.Y)(U,{dataset:m,children:p});return(0,h.Y)("div",{children:(0,h.Y)(b.T,{componentId:"mlflow.eval-runs.dataset-cell-tooltip",content:m.name,children:(0,h.Y)(d.Tag,{componentId:"mlflow.eval-runs.dataset-cell",onClick:()=>{var e,t,r,o;n.setSelectedDatasetWithRun({datasetWithTags:{dataset:m},runData:{experimentId:null===(e=l.info)||void 0===e?void 0:e.experimentId,runUuid:null!==(t=null===(r=l.info)||void 0===r?void 0:r.runUuid)&&void 0!==t?t:"",runName:null===(o=l.info)||void 0===o?void 0:o.runName,datasets:u}}),n.setIsDrawerOpen(!0)},id:"dataset-cell",css:z,children:g})})})};var P={name:"18x9eu",styles:"max-width:100%;margin-right:0;cursor:pointer"},V={name:"qhxz92",styles:"max-width:100%"},W={name:"1bnhmdk",styles:"overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap"};const K=({row:e})=>{var n,t,o,i,a;const s="inputs"in e.original?null===(n=e.original.inputs)||void 0===n||null===(t=n.modelInputs)||void 0===t||null===(o=t[0])||void 0===o?void 0:o.modelId:void 0,{theme:l}=(0,c.u)(),{data:u,isLoading:m}=(0,w.b3)({loggedModelId:s,enabled:Boolean(s)});if(!s||"subRuns"in e.original)return(0,h.Y)("div",{children:"-"});const p=null!==(i=null===u||void 0===u||null===(a=u.info)||void 0===a?void 0:a.name)&&void 0!==i?i:s;return m?(0,h.Y)(d.ParagraphSkeleton,{}):(0,h.Y)(b.T,{componentId:"mlflow.eval-runs.model-version-cell-tooltip",content:p,children:(0,h.Y)(d.Tag,{componentId:"mlflow.eval-runs.model-version-cell",id:"model-version-cell",css:P,children:(0,h.Y)(R.N_,{to:x.Ay.getExperimentLoggedModelDetailsPageRoute(e.original.info.experimentId,s),target:"_blank",css:V,children:(0,h.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",gap:l.spacing.xs,maxWidth:"100%"},""),children:[(0,h.Y)(d.ModelsIcon,{css:(0,r.AH)({"& > svg":{width:12,height:12,color:l.colors.textPrimary}},"")}),(0,h.Y)(c.T.Text,{css:W,children:p})]})})})})},j=({getValue:e})=>{const n=e();return(0,h.Y)("span",{title:n,children:null!==n&&void 0!==n?n:"-"})};var Q={name:"1bnhmdk",styles:"overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap"},G={name:"zfbdj8",styles:"display:none;flex-shrink:0"};const $=({column:e,title:n})=>{const{theme:t}=(0,c.u)(),o=(0,a.useMemo)(()=>{var n,t;return null!==(n=null===(t=Y(e.id))||void 0===t?void 0:t.key)&&void 0!==n?n:e.id},[e.id]);return(0,h.FD)("div",{css:(0,r.AH)({overflow:"hidden",display:"flex",alignItems:"center",gap:t.spacing.xs,":hover":{cursor:"pointer","& > div":{display:"inline"}}},""),children:[(0,h.Y)(b.T,{componentId:"codegen_no_dynamic_mlflow_web_js_src_experiment_tracking_pages_experiment_evaluation_runs_experimentevaluationrunstablecellrenderers_284",content:o,children:(0,h.Y)("span",{css:Q,children:(0,h.Y)(c.T.Text,{bold:!0,children:null!==n&&void 0!==n?n:o})})}),!e.getIsSorted()&&(0,h.Y)("div",{css:G,children:(0,h.Y)(d.SortUnsortedIcon,{})})]})},Z=({row:e})=>{if("subRuns"in e.original)return(0,h.Y)("div",{children:"-"});const n=e.original.info.startTime;return n?(0,h.Y)(D.f,{date:new Date(Number(n))}):(0,h.Y)("div",{children:"-"})};var X={name:"e0dnmk",styles:"cursor:pointer"};const J=({row:e,table:n})=>{const{isRowHidden:t,toggleRowVisibility:r}=k();if("subRuns"in e.original)return(0,h.Y)("div",{children:"-"});const o=e.original.info.runUuid,i=e.index,a=e.original.info.status,s=t(o,i,a)?d.VisibleOffIcon:d.VisibleIcon;return(0,h.Y)(s,{onClick:()=>r(o),css:X})};var ee=t(21678);let ne=function(e){return e.TRACES="traces",e.CHARTS="charts",e}({});const te="viewMode";var re=t(7655);const oe=a.memo(function(){const{theme:e}=(0,c.u)(),n=(0,re.A)(),{visibilityMode:t,setVisibilityMode:r,usingCustomVisibility:o,allRunsHidden:i}=k();return(0,h.FD)(d.DropdownMenu.Root,{modal:!1,children:[(0,h.Y)(d.DropdownMenu.Trigger,{asChild:!0,children:(0,h.Y)("button",{css:ie.actionButton(e),"data-testid":"eval-runs-visibility-column-header","aria-label":n.formatMessage({id:"wKXJ6U",defaultMessage:"Toggle visibility of evaluation runs"}),children:t===I.oy.HIDEALL||t===I.oy.HIDE_FINISHED_RUNS||i?(0,h.Y)(d.VisibleOffIcon,{}):(0,h.Y)(d.VisibleIcon,{})})}),(0,h.Y)(d.DropdownMenu.Content,{children:(0,h.FD)(d.DropdownMenu.RadioGroup,{componentId:"mlflow.eval-runs.visibility-mode-selector",value:t,onValueChange:e=>r(e),children:[(0,h.FD)(d.DropdownMenu.RadioItem,{value:I.oy.FIRST_10_RUNS,children:[(0,h.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,h.Y)(d.DashIcon,{}):null}),(0,h.Y)(m.A,{id:"vEuvEt",defaultMessage:"Show first 10"})]}),(0,h.FD)(d.DropdownMenu.RadioItem,{value:I.oy.FIRST_20_RUNS,children:[(0,h.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,h.Y)(d.DashIcon,{}):null}),(0,h.Y)(m.A,{id:"LK+UHk",defaultMessage:"Show first 20"})]}),(0,h.FD)(d.DropdownMenu.RadioItem,{value:I.oy.SHOWALL,children:[(0,h.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,h.Y)(d.DashIcon,{}):null}),(0,h.Y)(m.A,{id:"WDqWWa",defaultMessage:"Show all runs"})]}),(0,h.FD)(d.DropdownMenu.RadioItem,{value:I.oy.HIDEALL,children:[(0,h.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,h.Y)(d.DashIcon,{}):null}),(0,h.Y)(m.A,{id:"QH2RJZ",defaultMessage:"Hide all runs"})]}),(0,h.FD)(d.DropdownMenu.RadioItem,{value:I.oy.HIDE_FINISHED_RUNS,children:[(0,h.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,h.Y)(d.DashIcon,{}):null}),(0,h.Y)(m.A,{id:"Q7MSrQ",defaultMessage:"Hide finished runs"})]})]})})]})}),ie={actionButton:e=>({background:"transparent",border:"none",cursor:"pointer",padding:0,margin:0,display:"inline-flex",alignItems:"center",justifyContent:"flex-start",verticalAlign:"text-bottom",minWidth:24,minHeight:24,svg:{width:e.general.iconFontSize,height:e.general.iconFontSize,cursor:"pointer",color:e.colors.textPrimary,flexShrink:0}})};let ae=function(e){return e.checkbox="checkbox",e.visibility="visibility",e.runName="run_name",e.dataset="dataset",e.modelVersion="model_version",e.createdAt="created_at",e}({}),se=function(e){return e.ATTRIBUTE="attribute",e.METRIC="metric",e.PARAM="param",e.TAG="tag",e}({});const le=new Set([ae.checkbox,ae.visibility,ae.runName]),ue={[ae.checkbox]:!0,[ae.visibility]:!0,[ae.runName]:!0,[ae.createdAt]:!0,[ae.dataset]:!0,[ae.modelVersion]:!0},de={[ae.checkbox]:(0,y.zR)({id:"TQ3N+4",defaultMessage:"Select"}),[ae.visibility]:(0,y.zR)({id:"6ZhLfu",defaultMessage:"Visibility"}),[ae.runName]:(0,y.zR)({id:"TWnsnV",defaultMessage:"Run Name"}),[ae.createdAt]:(0,y.zR)({id:"2OrFCG",defaultMessage:"Created at"}),[ae.dataset]:(0,y.zR)({id:"SQUVnW",defaultMessage:"Dataset"}),[ae.modelVersion]:(0,y.zR)({id:"CZXHRi",defaultMessage:"Version"})},ce={[se.ATTRIBUTE]:(0,y.zR)({id:"4HKr3y",defaultMessage:"Attributes"}),[se.METRIC]:(0,y.zR)({id:"zZCBR9",defaultMessage:"Metrics"}),[se.PARAM]:(0,y.zR)({id:"mY6f0y",defaultMessage:"Params"}),[se.TAG]:(0,y.zR)({id:"HbC1a1",defaultMessage:"Tags"})};var me=t(90061),he=t(43617),pe=t(1475);var ge={name:"ti75j2",styles:"margin:0"},fe={name:"14sng3t",styles:"max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis"};const ve=({groupKey:e,groupValue:n})=>{const{theme:t}=(0,c.u)();return(0,h.Y)(b.T,{content:e+": "+n,componentId:"mlflow.eval-runs.group-tag",children:(0,h.FD)(d.Tag,{css:ge,componentId:"mlflow.eval-runs.group-tag",children:[(0,h.FD)(c.T.Text,{bold:!0,css:(0,r.AH)({maxWidth:100,marginRight:t.spacing.xs,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},""),children:[e,":"]}),(0,h.Y)(c.T.Text,{css:fe,children:n})]})})},ye=({groupValues:e})=>{const n=e.groupByData;return e.mode===pe.uq.Dataset?(0,h.Y)(ve,{groupKey:"Dataset",groupValue:String(e.value)},n):(0,h.Y)(ve,{groupKey:n,groupValue:String(e.value)},n)};var be={name:"ozd7xs",styles:"flex-shrink:0"};const Re=a.memo(({row:e,isActive:n})=>{const{theme:t}=(0,c.u)();return"groupValues"in e.original?(0,h.Y)(d.TableRow,{className:"eval-runs-table-row",children:(0,h.Y)(d.TableCell,{children:(0,h.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",gap:t.spacing.sm},""),children:[(0,h.Y)(c.B,{componentId:"mlflow.eval-runs.group-expand-button",size:"small",css:be,icon:e.getIsExpanded()?(0,h.Y)(d.ChevronDownIcon,{}):(0,h.Y)(c.o,{}),onClick:e.getToggleExpandedHandler()}),(0,h.Y)(c.T.Text,{bold:!0,children:(0,h.Y)(m.A,{id:"UWHfmZ",defaultMessage:"Group:"})}),e.original.groupValues.map(e=>(0,h.Y)(ye,{groupValues:e},e.groupByData))]})})},e.id):(0,h.Y)(d.TableRow,{className:"eval-runs-table-row",children:e.getVisibleCells().map(e=>{var r;return(0,h.Y)(d.TableCell,{css:[null===(r=e.column.columnDef.meta)||void 0===r?void 0:r.styles,{backgroundColor:n?t.colors.actionDefaultBackgroundHover:"transparent"},""],children:(0,he.Kv)(e.column.columnDef.cell,e.getContext())},e.id)})},e.id)},(e,n)=>e.isActive===n.isActive&&e.isSelected===n.isSelected&&e.columns===n.columns&&e.isExpanded===n.isExpanded&&e.isHidden===n.isHidden);var we={name:"82a6rk",styles:"flex:1"};const xe=(0,a.forwardRef)(({data:e,uniqueColumns:n,selectedColumns:t,selectedRunUuid:r,setSelectedRunUuid:o,isLoading:i,hasNextPage:s,rowSelection:l,setRowSelection:u,setSelectedDatasetWithRun:c,setIsDrawerOpen:p,viewMode:g,onScroll:f},y)=>{const[b,R]=(0,a.useState)([]),[w,x]=(0,a.useState)(!0),{isRowHidden:S}=k(),C=(0,a.useMemo)(()=>{const e=(e=>{const n=[{id:ae.checkbox,cell:H,enableResizing:!1,enableSorting:!1,size:32,meta:{styles:{minWidth:32,maxWidth:32}}}];e===ne.CHARTS&&n.push({id:ae.visibility,header:oe,cell:J,enableResizing:!1,enableSorting:!1,size:40,meta:{styles:{minWidth:40,maxWidth:40,padding:"0 4px"}}});const t=[{id:ae.runName,header:()=>(0,h.Y)(m.A,{...de[ae.runName]}),cell:_,enableResizing:!0,meta:{styles:{minWidth:100}}},{id:ae.createdAt,header:e=>(0,h.Y)($,{...e,title:(0,h.Y)(m.A,{...de[ae.createdAt]})}),accessorFn:e=>{if(!("subRuns"in e))return e.info.startTime},cell:Z,enableSorting:!0,sortingFn:"alphanumeric",enableResizing:!0,meta:{styles:{minWidth:100}}},{id:ae.dataset,header:()=>(0,h.Y)(m.A,{...de[ae.dataset]}),cell:q,enableResizing:!0,meta:{styles:{minWidth:100}}},{id:ae.modelVersion,header:()=>(0,h.Y)(m.A,{...de[ae.modelVersion]}),cell:K,enableResizing:!0,meta:{styles:{minWidth:100}}}];return[...n,...t]})(g);return n.forEach(n=>{e.push({id:n,accessorFn:e=>{if(!("subRuns"in e))return((e,n)=>{var t,r,o,i,a,s,l,u,d,c,m,h,p;const{columnType:g,key:f}=null!==(t=Y(e))&&void 0!==t?t:{};if(f)switch(g){case se.METRIC:return null!==(r=null===(o=n.data)||void 0===o||null===(i=o.metrics)||void 0===i||null===(a=i.find(e=>e.key===f))||void 0===a?void 0:a.value)&&void 0!==r?r:void 0;case se.PARAM:return null!==(s=null===(l=n.data)||void 0===l||null===(u=l.params)||void 0===u||null===(d=u.find(e=>e.key===f))||void 0===d?void 0:d.value)&&void 0!==s?s:void 0;case se.TAG:return null!==(c=null===(m=n.data)||void 0===m||null===(h=m.tags)||void 0===h||null===(p=h.find(e=>e.key===f))||void 0===p?void 0:p.value)&&void 0!==c?c:void 0;default:return}})(n,e)},cell:j,header:$,enableSorting:!0,sortingFn:"alphanumeric",meta:{styles:{minWidth:100,maxWidth:200}}})}),e.filter(e=>{var n;return t[null!==(n=e.id)&&void 0!==n?n:""]})},[t,n,g]),D=(0,v.L)("mlflow/server/js/src/experiment-tracking/pages/experiment-evaluation-runs/ExperimentEvaluationRunsTable.tsx",{columns:C,data:e,getCoreRowModel:(0,me.HT)(),getRowId:(e,n)=>"info"in e?e.info.runUuid:e.groupKey,enableSorting:!0,onSortingChange:R,getSortedRowModel:(0,me.h5)(),enableColumnResizing:!1,enableExpanding:!0,getExpandedRowModel:(0,me.D0)(),getSubRows:e=>{if("subRuns"in e)return e.subRuns},getRowCanExpand:e=>{var n;return Boolean(null===(n=e.subRows)||void 0===n?void 0:n.length)},onExpandedChange:x,meta:{setSelectedRunUuid:o,setSelectedDatasetWithRun:c,setIsDrawerOpen:p},onRowSelectionChange:u,state:{rowSelection:l,sorting:b,expanded:w}});return(0,h.FD)(d.Table,{css:we,scrollable:!0,onScroll:f,ref:y,children:[(0,h.Y)(d.TableRow,{isHeader:!0,children:D.getLeafHeaders().map(e=>{var n;return(0,h.Y)(d.TableHeader,{css:null===(n=e.column.columnDef.meta)||void 0===n?void 0:n.styles,sortable:e.column.getCanSort(),sortDirection:e.column.getIsSorted(),onToggleSort:e.column.getToggleSortingHandler(),componentId:"mlflow.eval-runs.header",header:e,column:e.column,children:(0,he.Kv)(e.column.columnDef.header,e.getContext())},e.id)})}),!i&&D.getRowModel().rows.map(e=>{const n="info"in e.original&&e.original.info.runUuid===r,t="info"in e.original?e.original.info.status:void 0;return(0,h.Y)(Re,{row:e,isActive:n,isSelected:l[e.id],isExpanded:e.getIsExpanded(),isHidden:S(e.id,e.index,t),columns:C},e.id)}),(i||s)&&(0,h.Y)(d.TableSkeletonRows,{table:D})]})});var Se=t(25637),Ce=t(42595),De=t(33702),Me=t(8740),Ye=t(76118),Ie=t(18585);const Ae=({groupByConfig:e,setGroupByConfig:n,runs:t})=>{const r=t.some(e=>{var n,t,r;return(null!==(n=null===(t=e.inputs)||void 0===t||null===(r=t.datasetInputs)||void 0===r?void 0:r.length)&&void 0!==n?n:0)>0}),{uniqueParams:o,uniqueTags:i}=(0,a.useMemo)(()=>{const e=new Set,n=new Set;for(const s of t){for(const n of null!==(r=null===(o=s.data)||void 0===o?void 0:o.params)&&void 0!==r?r:[]){var r,o;e.add(n.key)}for(const e of null!==(i=null===(a=s.data)||void 0===a?void 0:a.tags)&&void 0!==i?i:[]){var i,a;(0,F.oD)(e.key)&&n.add(e.key)}}return{uniqueParams:e,uniqueTags:n}},[t]),s=(t,r)=>{var o;const i=null!==(o=null===e||void 0===e?void 0:e.groupByKeys)&&void 0!==o?o:[],a=new Set(i);if((0,Ie.sd)(e,t,r))for(const e of a)e.mode===t&&e.groupByData===r&&a.delete(e);else a.add({mode:t,groupByData:r});var s;0===a.size?n(null):n({aggregateFunction:null!==(s=null===e||void 0===e?void 0:e.aggregateFunction)&&void 0!==s?s:pe.it.Average,groupByKeys:Array.from(a)})};return(0,h.FD)(d.DialogCombobox,{componentId:"mlflow.eval-runs.table-column-selector",label:"Group by",multiSelect:!0,children:[(0,h.Y)(d.DialogComboboxTrigger,{}),(0,h.Y)(d.DialogComboboxContent,{children:(0,h.FD)(d.DialogComboboxOptionList,{children:[r&&(0,h.FD)(h.FK,{children:[(0,h.Y)(d.DialogComboboxSectionHeader,{children:(0,h.Y)(m.A,{id:"BfMFME",defaultMessage:"Attributes"})}),(0,h.Y)(d.DialogComboboxOptionListCheckboxItem,{value:"dataset",checked:(0,Ie.sd)(e,pe.uq.Dataset,"dataset"),onChange:()=>{s(pe.uq.Dataset,"dataset")}},"dataset")]}),o.size>0&&(0,h.FD)(h.FK,{children:[(0,h.Y)(d.DialogComboboxSectionHeader,{children:(0,h.Y)(m.A,{id:"lS7kq2",defaultMessage:"Parameters"})}),Array.from(o).map(n=>(0,h.Y)(d.DialogComboboxOptionListCheckboxItem,{value:n,checked:(0,Ie.sd)(e,pe.uq.Param,n),onChange:()=>{s(pe.uq.Param,n)}},n))]}),i.size>0&&(0,h.FD)(h.FK,{children:[(0,h.Y)(d.DialogComboboxSectionHeader,{children:(0,h.Y)(m.A,{id:"sEVVSd",defaultMessage:"Tags"})}),Array.from(i).map(n=>(0,h.Y)(d.DialogComboboxOptionListCheckboxItem,{value:n,checked:(0,Ie.sd)(e,pe.uq.Tag,n),onChange:()=>{s(pe.uq.Tag,n)}},n))]})]})})]})};var Te=t(61060),ke=t(12803);const Ee=({rowSelection:e,setRowSelection:n,refetchRuns:t,onCompare:r,selectedRunUuid:o,compareToRunUuid:i})=>{(0,re.A)();const[s,l]=(0,a.useState)(!1),u=(0,a.useMemo)(()=>Object.entries(e).filter(([e,n])=>n).map(([e])=>e),[e]),{mutate:p,isLoading:g}=(({onSuccess:e,onError:n})=>{const{mutate:t,isLoading:r}=(0,Te.n)({mutationFn:({runUuids:e})=>Promise.all(e.map(e=>ke.x.deleteRun({run_id:e}))),onSuccess:e,onError:n});return{mutate:t,isLoading:r}})({onSuccess:()=>{t(),n({}),l(!1)}}),f=(0,a.useCallback)(()=>{p({runUuids:u})},[p,u]),v=(0,a.useCallback)(()=>{2===u.length&&r(u[0],u[1])},[r,u]),y=2===u.length,R=(0,a.useMemo)(()=>{if(!o||!i||2!==u.length)return!1;const e=new Set([o,i]);return u.every(n=>e.has(n))},[o,i,u]),w=!y||R,x=0===u.length;return(0,h.FD)(h.FK,{children:[(0,h.FD)(d.DropdownMenu.Root,{children:[(0,h.Y)(d.DropdownMenu.Trigger,{asChild:!0,children:(0,h.Y)(c.B,{type:"primary",componentId:"mlflow.eval-runs.actions-button",disabled:x,endIcon:(0,h.Y)(d.ChevronDownIcon,{}),children:(0,h.Y)(m.A,{id:"N/tNrE",defaultMessage:"Actions"})})}),(0,h.FD)(d.DropdownMenu.Content,{children:[(0,h.Y)(d.DropdownMenu.Item,{componentId:"mlflow.eval-runs.actions.compare",onClick:v,disabled:w,disabledReason:(0,h.Y)(m.A,{id:"Ub+VQh",defaultMessage:"Please select 2 runs to compare"}),children:(0,h.Y)(m.A,{id:"2igs1f",defaultMessage:"Compare"})}),(0,h.Y)(d.DropdownMenu.Item,{componentId:"mlflow.eval-runs.actions.delete",onClick:()=>l(!0),children:(0,h.Y)(m.A,{id:"7tlSUw",defaultMessage:"Delete runs"})})]})]}),(0,h.Y)(b.d,{componentId:"mlflow.eval-runs.runs-delete-modal",visible:s,onOk:f,okButtonProps:{danger:!0,loading:g},okText:(0,h.Y)(m.A,{id:"EBwDIg",defaultMessage:"Delete"}),onCancel:()=>{l(!1)},cancelText:(0,h.Y)(m.A,{id:"2+EUFB",defaultMessage:"Cancel"}),confirmLoading:g,title:(0,h.Y)(m.A,{id:"mmz4aA",defaultMessage:"Delete {numRuns, plural, =1 {1 run} other {# runs}}",values:{numRuns:u.length}}),children:(0,h.Y)(m.A,{id:"xIP8WW",defaultMessage:"Are you sure you want to delete these runs?"})})]})};const Fe=e=>{const n=new Set,t=new Set,r=[];return e.forEach(e=>{var o,i,a;null===(o=e.data.metrics)||void 0===o||o.forEach(e=>{n.add(e.key)}),null===(i=e.data.params)||void 0===i||i.forEach(e=>{t.add(e.key)});const s={};null===(a=e.data.tags)||void 0===a||a.forEach(e=>{s[e.key]={key:e.key,value:e.value}}),r.push(s)}),{metricKeyList:Array.from(n),paramKeyList:Array.from(t),tagsList:r}};var Le={name:"ozd7xs",styles:"flex-shrink:0"},Ue={name:"ovk77c",styles:"min-width:0"},He={name:"ozd7xs",styles:"flex-shrink:0"};const Oe=({rowSelection:e,setRowSelection:n,refetchRuns:t,isFetching:o,runs:i,searchRunsError:s,searchFilter:l,setSearchFilter:u,selectedColumns:p,setSelectedColumns:g,groupByConfig:f,setGroupByConfig:v,viewMode:y,setViewMode:R,onCompare:w,selectedRunUuid:x,compareToRunUuid:S})=>{const C=(0,re.A)(),{theme:D}=(0,c.u)(),M=(Object.entries(e).filter(([e,n])=>n).map(([e])=>e),(0,a.useMemo)(()=>(0,Ye.groupBy)(Object.entries(p),([e])=>{var n,t;return null!==(n=null===(t=Y(e))||void 0===t?void 0:t.columnType)&&void 0!==n?n:se.ATTRIBUTE}),[p]));return(0,h.FD)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",gap:D.spacing.sm},""),children:[(0,h.FD)("div",{css:(0,r.AH)({display:"flex",gap:D.spacing.sm},""),children:[(0,h.FD)(d.SegmentedControlGroup,{name:"mlflow.eval-runs.page-mode-selector",componentId:"mlflow.eval-runs.page-mode-selector",value:y,css:Le,children:[(0,h.Y)(d.SegmentedControlButton,{value:ne.TRACES,icon:(0,h.Y)(b.T,{componentId:"mlflow.eval-runs.traces-mode-toggle-tooltip",content:(0,h.Y)(m.A,{id:"nIk08y",defaultMessage:"Trace view"}),delayDuration:0,children:(0,h.Y)(d.ListBorderIcon,{})}),onClick:()=>null===R||void 0===R?void 0:R(ne.TRACES)}),(0,h.Y)(d.SegmentedControlButton,{value:ne.CHARTS,icon:(0,h.Y)(b.T,{componentId:"mlflow.eval-runs.charts-mode-toggle-tooltip",content:(0,h.Y)(m.A,{id:"RUju4k",defaultMessage:"Charts"}),delayDuration:0,children:(0,h.Y)(d.ChartLineIcon,{})}),onClick:()=>null===R||void 0===R?void 0:R(ne.CHARTS)})]}),(0,h.Y)(Me.D,{css:Ue,runsData:Fe(i),searchFilter:l,onSearchFilterChange:u,onClear:()=>u(""),requestError:s}),(0,h.Y)(b.T,{componentId:"mlflow.eval-runs.table-refresh-button.tooltip",content:C.formatMessage({id:"ckfi1K",defaultMessage:"Refresh evaluation runs"}),children:(0,h.Y)(c.B,{componentId:"mlflow.eval-runs.table-refresh-button",icon:(0,h.Y)(d.RefreshIcon,{}),onClick:t,loading:o,css:He,disabled:o,"aria-label":C.formatMessage({id:"rcdaen",defaultMessage:"Refresh evaluation runs"})})})]}),(0,h.FD)("div",{css:(0,r.AH)({display:"flex",gap:D.spacing.sm},""),children:[(0,h.FD)(d.DialogCombobox,{componentId:"mlflow.eval-runs.table-column-selector",label:"Columns",multiSelect:!0,children:[(0,h.Y)(d.DialogComboboxTrigger,{}),(0,h.Y)(d.DialogComboboxContent,{children:(0,h.Y)(d.DialogComboboxOptionList,{children:Object.entries(M).map(([e,n])=>{if(!n.length)return null;const t=ce[e];return(0,h.FD)(h.FK,{children:[(0,h.Y)(b.S,{size:"xs"}),(0,h.Y)(d.DialogComboboxSectionHeader,{children:t?C.formatMessage(t):e}),n.map(([e,n])=>{var t,r;const o=de[e],i=o?C.formatMessage(o):null!==(t=null===(r=Y(e))||void 0===r?void 0:r.key)&&void 0!==t?t:e;return le.has(e)?null:(0,h.Y)(d.DialogComboboxOptionListCheckboxItem,{value:e,onChange:()=>{const t={...p};t[e]=!n,g(t)},checked:n,children:i},e)})]})})})})]}),(0,h.Y)(Ae,{groupByConfig:f,setGroupByConfig:v,runs:i}),(0,h.Y)(Ee,{rowSelection:e,setRowSelection:n,refetchRuns:t,onCompare:w,selectedRunUuid:x,compareToRunUuid:S})]})]})};var _e=t.p+"static/media/eval-runs-empty.5b96bbb9a4c5dc6b413000491892bb6f.svg",Ne=t(11522),Be=t(48292);const ze="selectedRunUuid";var qe=t(78171),Pe=t(19112);const Ve=e=>`import mlflow\nfrom mlflow.genai import datasets, evaluate, scorers\n\nmlflow.set_experiment(experiment_id="${e}")\n\n# Step 1: Define evaluation dataset\neval_dataset = [{\n  "inputs": {\n    "query": "What is MLflow?",\n  }\n}]\n\n# Step 2: Define predict_fn\n# predict_fn will be called for every row in your evaluation\n# dataset. Replace with your app's prediction function.\n# NOTE: The **kwargs to predict_fn are the same as the keys of\n# the \`inputs\` in your dataset.\ndef predict(query):\n  return query + " an answer"\n\n# Step 3: Run evaluation\nevaluate(\n  data=eval_dataset,\n  predict_fn=predict,\n  scorers=scorers.get_all_scorers()\n)\n\n# Results will appear back in this UI`,We=({experimentId:e})=>{(0,re.A)();const{theme:n}=(0,c.u)(),[t,o]=(0,a.useState)(!1),i=(0,h.Y)(m.A,{id:"7BkVQ9",defaultMessage:"Run the following code to start an evaluation."}),s=(0,h.Y)(Pe.z7,{theme:n.isDarkMode?"duotoneDark":"light",language:"python",children:Ve(e)});return(0,h.FD)(h.FK,{children:[(0,h.Y)(c.B,{componentId:"mlflow.eval-runs.start-run-button",icon:(0,h.Y)(d.ChartLineIcon,{}),onClick:()=>o(!0),children:(0,h.Y)(m.A,{id:"cMa3hp",defaultMessage:"Run evaluation"})}),(0,h.Y)(b.d,{componentId:"mlflow.eval-runs.start-run-modal",title:(0,h.Y)(m.A,{id:"3QGkg9",defaultMessage:"Run evaluation"}),visible:t,okText:"Discard",footer:null,onCancel:()=>o(!1),children:(0,h.FD)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",gap:n.spacing.sm},""),children:[(0,h.Y)(c.T.Text,{children:i}),s]})})]})},Ke=e=>e.mode===pe.uq.Dataset?`Dataset: ${e.value}`:`${e.groupByData} (${e.mode}): ${e.value}`,je=(e,n)=>{var t,r,o,i,a,s,l,u,d,c,m;const h=n.groupByKeys,p=[];for(const g of h)switch(g.mode){case pe.uq.Dataset:p.push({mode:pe.uq.Dataset,groupByData:"dataset",value:null!==(t=null===(r=e.inputs)||void 0===r||null===(o=r.datasetInputs)||void 0===o||null===(i=o[0])||void 0===i||null===(a=i.dataset)||void 0===a?void 0:a.digest)&&void 0!==t?t:null});break;case pe.uq.Param:const n=null===(s=e.data)||void 0===s||null===(l=s.params)||void 0===l?void 0:l.find(e=>e.key===g.groupByData);p.push({mode:pe.uq.Param,groupByData:g.groupByData,value:null!==(u=null===n||void 0===n?void 0:n.value)&&void 0!==u?u:null});break;case pe.uq.Tag:const h=null===(d=e.data)||void 0===d||null===(c=d.tags)||void 0===c?void 0:c.find(e=>e.key===g.groupByData);p.push({mode:pe.uq.Tag,groupByData:g.groupByData,value:null!==(m=null===h||void 0===h?void 0:h.value)&&void 0!==m?m:null})}return p};var Qe=t(35286),Ge=t(29757),$e=t(51120),Ze=t(95379),Xe=t(86133);const Je=(e,n=1)=>`experiment-evaluation-runs-charts-ui-state-v${n}-${e}`,en=()=>({compareRunCharts:void 0,compareRunSections:void 0,autoRefreshEnabled:!1,isAccordionReordered:!1,chartsSearchFilter:"",globalLineChartConfig:void 0,isDirty:!1}),nn=(e,n)=>{if("UPDATE"===n.type)return{...n.stateSetter(e),isDirty:!0};if("METRICS_UPDATED"===n.type){const{compareRunCharts:t,compareRunSections:r}=(e=>{const n=(0,Ye.compact)((0,Ye.uniq)(e.map(e=>e.includes("/")?(0,Ye.first)(e.split("/")):null))),t=e.map(e=>{const n=e.includes("/")?(0,Ye.first)(e.split("/")):null;return{deleted:!1,type:Xe.zL.BAR,uuid:`autogen-${e}`,metricSectionId:n?`autogen-${n}`:"default",isGenerated:!0,metricKey:e,displayName:e}}),r=n.map(e=>({display:!0,name:e,uuid:`autogen-${e}`,isReordered:!1}));return(0,Ye.isEmpty)(r)&&r.push({display:!0,name:"Metrics",uuid:"default",isReordered:!1}),{compareRunCharts:t,compareRunSections:r}})(n.allMetricKeys);return((e,n)=>{var t,r;if((!e.compareRunCharts||!e.compareRunSections||!e.isDirty)&&(n.compareRunCharts.length>0||n.compareRunSections.length>0))return{...e,compareRunCharts:null!==(t=n.compareRunCharts)&&void 0!==t?t:[],compareRunSections:null!==(r=n.compareRunSections)&&void 0!==r?r:[]};const o=n.compareRunCharts.filter(n=>{var t;return!(null!==(t=e.compareRunCharts)&&void 0!==t&&t.find(e=>e.uuid===n.uuid))}),i=n.compareRunSections.filter(n=>{var t;return o.find(e=>e.metricSectionId===n.uuid)&&!(null!==(t=e.compareRunSections)&&void 0!==t&&t.find(e=>e.uuid===n.uuid))});return i.length>0||o.length>0?{...e,compareRunCharts:e.compareRunCharts?[...e.compareRunCharts,...o]:n.compareRunCharts,compareRunSections:e.compareRunSections?[...e.compareRunSections,...i]:n.compareRunSections}:e})(e,{compareRunCharts:t,compareRunSections:r})}return"INITIALIZE"===n.type&&n.initialConfig?n.initialConfig:e},tn=(e,n)=>{const[t,r]=(0,a.useReducer)(nn,void 0,en),[o,i]=(0,a.useState)(!0);(0,a.useEffect)(()=>{i(!0),(async e=>{const n=localStorage.getItem(Je(e));if(n)try{return JSON.parse(n)}catch{return}})(n).then(e=>{r({type:"INITIALIZE",initialConfig:e}),i(!1)})},[n]),(0,a.useEffect)(()=>{o||r({type:"METRICS_UPDATED",allMetricKeys:e})},[e,o]),(0,a.useEffect)(()=>{t.isDirty&&(async(e,n)=>{localStorage.setItem(Je(e),JSON.stringify(n))})(n,t)},[n,t]);const s=(0,a.useCallback)(e=>r({type:"UPDATE",stateSetter:e}),[]);return{chartUIState:t,updateUIState:s,loading:o}};var rn=t(33972),on=t(55600),an=t(94119);const sn=[Xe.zL.LINE,Xe.zL.BAR,Xe.zL.CONTOUR,Xe.zL.DIFFERENCE,Xe.zL.PARALLEL,Xe.zL.SCATTER],ln=({runs:e=[],chartUIState:n})=>{var t;const r=(0,S.LE)(),{isRowHidden:o}=k(),i=(0,a.useMemo)(()=>e.filter(e=>e.info).map((e,n)=>{var t,i,a;const s=(0,Ye.keyBy)(null===(t=e.data)||void 0===t?void 0:t.metrics,"key"),l=(0,Ye.keyBy)(null===(i=e.data)||void 0===i?void 0:i.params,"key"),u=(0,Ye.keyBy)(null===(a=e.data)||void 0===a?void 0:a.tags,"key");return{displayName:e.info.runName,images:{},metrics:s,params:l,tags:u,uuid:e.info.runUuid,color:r(e.info.runUuid),runInfo:e.info,hidden:o(e.info.runUuid,n,e.info.status)}}),[e,o,r]),s=(0,a.useMemo)(()=>(0,Ye.uniq)(i.flatMap(e=>Object.keys(e.metrics))),[i]),l=(0,a.useMemo)(()=>(0,Ye.uniq)(i.flatMap(e=>Object.keys(e.params))),[i]),u=(0,Ze.KP)(),d=(0,Ze.iO)(),c=(0,Ze.cA)(),m=(0,Ze.Ez)(),[p,g]=(0,a.useState)(null),f=(0,a.useCallback)(e=>n=>g(Xe.i$.getEmptyChartCardByType(n,!1,void 0,e)),[]),v=(0,a.useMemo)(()=>({runs:i}),[i]);return(0,h.Y)("div",{children:(0,h.Y)(Qe.W,{contextData:v,component:an.X,children:(0,h.FD)(Ge.c_,{visibleChartCards:n.compareRunCharts,children:[(0,h.Y)($e.J,{supportedChartTypes:sn,compareRunSections:n.compareRunSections,compareRunCharts:n.compareRunCharts,reorderCharts:d,insertCharts:c,chartData:i,startEditChart:g,removeChart:u,addNewChartCard:f,search:null!==(t=n.chartsSearchFilter)&&void 0!==t?t:"",groupBy:null,setFullScreenChart:()=>{},autoRefreshEnabled:n.autoRefreshEnabled,hideEmptyCharts:!1,globalLineChartConfig:n.globalLineChartConfig}),p&&(0,h.Y)(on.z,{chartRunData:i,metricKeyList:s,paramKeyList:l,config:p,onSubmit:e=>{m({...e,displayName:void 0}),g(null)},onCancel:()=>g(null),groupBy:null,supportedChartTypes:sn})]})})})},un=({runs:e=[],experimentId:n})=>{const t=(0,a.useMemo)(()=>{const n=e.flatMap(e=>{var n,t;return(null===(n=e.data)||void 0===n||null===(t=n.metrics)||void 0===t?void 0:t.map(e=>e.key))||[]});return Array.from(new Set(n))},[e]),r=(0,rn.i)(()=>t,[t]),{chartUIState:o,loading:i,updateUIState:s}=tn(r,n);return i?(0,h.Y)(d.TableSkeleton,{lines:5}):(0,h.Y)(Ze.oB,{updateChartsUIState:s,children:(0,h.Y)(ln,{runs:e,chartUIState:o})})};var dn=t(54871);var cn={name:"1h0bf8r",styles:"body, :host{user-select:none;}"},mn={name:"n56zw6",styles:"display:flex;flex-direction:row;flex:1;min-height:0px"},hn={name:"5ob2ly",styles:"display:flex;position:relative"},pn={name:"1752fna",styles:"max-width:min(100%, 600px);text-align:center"},gn={name:"1bmnxg7",styles:"white-space:nowrap"},fn={name:"zt9k2r",styles:"max-width:100%;max-height:200px"};const vn=()=>{var e;const{experimentId:n}=(0,R.g)(),{theme:t}=(0,c.u)(),[o,l]=(0,a.useState)(432),[u,d]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[f,v]=(0,a.useState)(""),[y,b]=(0,a.useState)(),[w,x]=(0,a.useState)(!1),[S,C]=(0,a.useState)(ue),[D,Y]=(0,a.useState)(null),{viewMode:I,setViewMode:A}=(()=>{const[e,n]=(0,R.ok)();return{viewMode:(0,ee.SK)(ne,e.get(te),ne.TRACES),setViewMode:e=>{n(n=>{const t=new URLSearchParams(n);return t.set(te,e),t})}}})(),[k,E]=(()=>{var e;const[n,t]=(0,R.ok)(),r=null!==(e=n.get(ze))&&void 0!==e?e:void 0,o=(0,a.useCallback)(e=>{t(n=>void 0===e?(n.delete(ze),n):(n.set(ze,e),n),{replace:!0})},[t]);return[r,o]})(),[L,U]=(0,qe.Y)();i()(n,"Experiment ID must be defined");const[H,O]=(0,a.useState)({});(0,dn.Gt)("selectedRunIds",H);const{data:_,isLoading:N,isFetching:B,error:z,fetchNextPage:q,hasNextPage:P,refetch:V}=(0,s.X)({experimentId:n,enabled:!0,filter:f}),W=null!==(e=null===_||void 0===_?void 0:_.map(e=>e.info.runUuid))&&void 0!==e?e:[];null===_||void 0===_||!_.length||k&&W.includes(k)||E(_[0].info.runUuid);const K=(0,a.useMemo)(()=>{const e=new Set,n=new Set,t=new Set;for(const a of null!==_&&void 0!==_?_:[]){for(const n of null!==(r=a.data.metrics)&&void 0!==r?r:[]){var r;e.add(n.key)}for(const e of null!==(o=a.data.params)&&void 0!==o?o:[]){var o;n.add(e.key)}for(const e of null!==(i=a.data.tags)&&void 0!==i?i:[]){var i;(0,F.oD)(e.key)&&t.add(e.key)}}return[...Array.from(e).map(e=>M(se.METRIC,e)),...Array.from(n).map(e=>M(se.PARAM,e)),...Array.from(t).map(e=>M(se.TAG,e))]},[_]),j=(0,a.useMemo)(()=>Object.keys(ue),[]),Q=(0,a.useMemo)(()=>Object.keys(S).filter(e=>!j.includes(e)),[j,S]);(0,a.useMemo)(()=>(0,Ye.xor)(Q,K),[Q,K]).length>0&&C({...ue,...(0,Ye.mapValues)((0,Ye.keyBy)(K),()=>!1)});const G=0===W.length&&!f&&!N,$=((e,n)=>{if(!n)return e;const t={};for(const o of e){const e=je(o,n),r=e.map(Ke).join(", ");t[r]||(t[r]={groupValues:e,subRuns:[]}),t[r].subRuns.push(o)}const r=[];return Object.entries(t).forEach(([e,{groupValues:n,subRuns:t}])=>{const o={groupKey:e,groupValues:n,subRuns:t};r.push(o)}),r})(null!==_&&void 0!==_?_:[],D),Z=(0,a.useCallback)((e,n)=>{E(e),U(n)},[E,U]);(0,a.useEffect)(()=>{const e=Object.entries(H).filter(([e,n])=>n).map(([e])=>e);if(k&&L){const n=e.includes(k),t=e.includes(L);n&&t||(U(void 0),e.length>0&&E(e[0]))}},[H,k,L,E,U]);const X=(0,a.useRef)(null),J=(0,a.useCallback)(e=>{if(e){const{scrollHeight:n,scrollTop:t,clientHeight:r}=e;n-t-r<100&&!B&&P&&q()}},[q,B,P]);return(0,a.useEffect)(()=>{J(X.current)},[J]),(0,h.Y)(T,{children:(0,h.FD)("div",{css:mn,children:[(0,h.Y)(Se.ResizableBox,{css:hn,style:{flex:`0 0 ${p?0:o}px`},width:o,axis:"x",resizeHandles:["e"],minConstraints:[250,0],handle:(0,h.Y)(Ce.z,{runListHidden:p,updateRunListHidden:e=>{g(!p)}}),onResize:(e,{size:n})=>{p||l(n.width)},onResizeStart:()=>!p&&d(!0),onResizeStop:()=>d(!1),children:(0,h.FD)("div",{css:(0,r.AH)({display:p?"none":"flex",flexDirection:"column",gap:t.spacing.sm,maxWidth:"100%",flex:1,zIndex:0,minHeight:"0px",overflow:"hidden",paddingRight:t.spacing.sm},""),children:[(0,h.Y)(Oe,{runs:null!==_&&void 0!==_?_:[],refetchRuns:V,isFetching:B||N,searchRunsError:z,searchFilter:f,setSearchFilter:v,rowSelection:H,setRowSelection:O,selectedColumns:S,setSelectedColumns:C,groupByConfig:D,setGroupByConfig:Y,viewMode:I,setViewMode:A,onCompare:Z,selectedRunUuid:k,compareToRunUuid:L}),(0,h.Y)(xe,{data:$,uniqueColumns:K,selectedColumns:S,selectedRunUuid:I===ne.TRACES?k:void 0,setSelectedRunUuid:e=>{E(e),U(void 0)},isLoading:N,hasNextPage:null!==P&&void 0!==P&&P,rowSelection:H,setRowSelection:O,setSelectedDatasetWithRun:b,setIsDrawerOpen:x,viewMode:I,onScroll:e=>J(e.currentTarget),ref:X})]})}),(0,h.Y)("div",{css:(0,r.AH)({flex:1,display:"flex",borderLeft:`1px solid ${t.colors.border}`,minHeight:"0px",overflowY:"scroll"},""),children:k?(0,h.Y)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",flex:1,minHeight:"0px",paddingLeft:t.spacing.sm},""),children:(e=>{var t;return I===ne.CHARTS?(0,h.Y)(un,{runs:_,experimentId:n}):(0,h.Y)(De.r,{experimentId:n,runUuid:e,runDisplayName:Ne.A.getRunDisplayName(null===_||void 0===_||null===(t=_.find(n=>n.info.runUuid===e))||void 0===t?void 0:t.info,e),setCurrentRunUuid:E,showCompareSelector:!0,showRefreshButton:!0})})(k)}):G?(0,h.FD)("div",{css:(0,r.AH)({display:"flex",flex:1,flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:t.spacing.lg,paddingLeft:t.spacing.md,maxWidth:"100%"},""),children:[(0,h.Y)(c.T.Title,{level:3,color:"secondary",children:(0,h.Y)(m.A,{id:"050N3C",defaultMessage:"Evaluate and improve the quality, cost, latency of your GenAI app"})}),(0,h.Y)(c.T.Paragraph,{color:"secondary",css:pn,children:(0,h.Y)(m.A,{id:"NKj5Xb",defaultMessage:"Create evaluation datasets in order to iteratively evaluate and improve your app. Run evaluations to check that your fixes are working, and compare quality between app / prompt versions. {learnMoreLink}",values:{learnMoreLink:(0,h.Y)(c.T.Link,{componentId:"mlflow.eval-runs.empty-state.learn-more-link",href:"https://mlflow.org/docs/latest/genai/eval-monitor/quickstart/",css:gn,openInNewTab:!0,children:(0,h.Y)(m.A,{id:"TdTXXf",defaultMessage:"Learn more"})})}})}),(0,h.Y)("img",{css:fn,src:_e,alt:"No runs found"}),(0,h.Y)("div",{css:(0,r.AH)({display:"flex",gap:t.spacing.sm,marginTop:t.spacing.md},""),children:(0,h.Y)(We,{experimentId:n})})]}):null}),u&&(0,h.Y)(r.mL,{styles:cn}),y&&(0,h.Y)(Be.O,{isOpen:w,setIsOpen:x,selectedDatasetWithRun:y,setSelectedDatasetWithRun:b})]})})};var yn=()=>(0,h.Y)(f,{children:(0,h.Y)(vn,{})})},70513:function(e,n,t){t.d(n,{Ef:function(){return l},b3:function(){return s}});var r=t(49708),o=t(61077);t(46709);const i=e=>["GET_LOGGED_MODEL",e],a=async({queryKey:[,e]})=>(0,o.ff)((0,o.we)(`ajax-api/2.0/mlflow/logged-models/${e}`),"GET"),s=({loggedModelId:e,enabled:n=!0})=>{const{data:t,isLoading:o,isFetching:s,refetch:l,error:u}=(0,r.I)({queryKey:i(null!==e&&void 0!==e?e:""),queryFn:a,cacheTime:0,refetchOnWindowFocus:!1,retry:!1,enabled:n});return{isLoading:o,isFetching:s,data:null===t||void 0===t?void 0:t.model,refetch:l,error:u}},l=async(e,n=!1)=>{try{return await(0,o.ff)((0,o.we)(`ajax-api/2.0/mlflow/logged-models/${e}`),"GET")}catch(t){if(n)return;throw t}}},95328:function(e,n,t){t.d(n,{X:function(){return a}});var r=t(96584),o=t(12803),i=t(46709);const a=({experimentId:e,enabled:n,filter:t})=>{const{data:a,fetchNextPage:s,hasNextPage:l,isLoading:u,isFetching:d,refetch:c,error:m}=(0,r.q)({queryKey:["SEARCH_RUNS",e,t],queryFn:async({pageParam:n})=>{const r={experiment_ids:[e],order_by:["attributes.start_time DESC"],run_view_type:"ACTIVE_ONLY",filter:t,max_results:50,page_token:n};return o.x.searchRuns(r)},cacheTime:0,refetchOnWindowFocus:!1,retry:!1,enabled:n,getNextPageParam:e=>e.next_page_token}),{evaluationRuns:h,trainingRuns:p}=(0,i.useMemo)(()=>{if(null===a||void 0===a||!a.pages)return{evaluationRuns:[],trainingRuns:[]};return a.pages.flatMap(e=>e.runs||[]).reduce((e,n)=>{var t,r,o;return(null!==(t=null===(r=n.outputs)||void 0===r||null===(o=r.modelOutputs)||void 0===o?void 0:o.length)&&void 0!==t?t:0)?e.trainingRuns.push(n):e.evaluationRuns.push(n),e},{evaluationRuns:[],trainingRuns:[]})},[a]);return{data:h,trainingRuns:p,hasNextPage:l,fetchNextPage:s,refetch:c,isLoading:u,isFetching:d,error:m}}}}]);