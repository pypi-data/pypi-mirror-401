"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[2673],{72673:function(e,t,r){r.d(t,{TraceErrorsChart:function(){return he}});var n=r(68248),o=r(46709),i=r(27757),a=r(40724),s=r(66774),c=r(90970),l=r(56809),u=r(13240),p=r(15714),y=r(73377),d=r(69960),f=r.n(d),m=r(67427),v=r.n(m),h=r(32307),b=r.n(h),g=r(41001),x=r(60974),O=r(27605),A=r(80654),w=r(59122);function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D(n.key),n)}}function j(e,t,r){return t=T(t),function(e,t){if(t&&("object"===E(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,S()?Reflect.construct(t,r||[],T(e).constructor):t.apply(e,r))}function S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(S=function(){return!!e})()}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}function C(e,t,r){return(t=D(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D(e){var t=function(e,t){if("object"!=E(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==E(t)?t:t+""}var _=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),j(this,t,arguments)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){return null}}])&&P(r.prototype,n),o&&P(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(o.Component);C(_,"displayName","ZAxis"),C(_,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var I=r(44133),N=r(89667),M=r(1203),R=r(26565),K=r(33685),z=r(7721),F=r(27470),Y=r(94537),W=["option","isActive"];function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},L.apply(this,arguments)}function B(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function U(e){var t=e.option,r=e.isActive,n=B(e,W);return"string"===typeof t?o.createElement(Y.yp,L({option:o.createElement(F.i,L({type:t},n)),isActive:r,shapeType:"symbols"},n)):o.createElement(Y.yp,L({option:t,isActive:r,shapeType:"symbols"},n))}function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function G(){return G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},G.apply(this,arguments)}function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach(function(t){ee(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function $(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,te(n.key),n)}}function q(e,t,r){return t=X(t),function(e,t){if(t&&("object"===J(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Z()?Reflect.construct(t,r||[],X(e).constructor):t.apply(e,r))}function Z(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Z=function(){return!!e})()}function X(e){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},X(e)}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Q(e,t)}function ee(e,t,r){return(t=te(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function te(e){var t=function(e,t){if("object"!=J(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=J(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==J(t)?t:t+""}var re=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ee(e=q(this,t,[].concat(n)),"state",{isAnimationFinished:!1}),ee(e,"handleAnimationEnd",function(){e.setState({isAnimationFinished:!0})}),ee(e,"handleAnimationStart",function(){e.setState({isAnimationFinished:!1})}),ee(e,"id",(0,R.NF)("recharts-scatter-")),e}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(t,e),r=t,i=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curPoints:e.points,prevPoints:t.curPoints}:e.points!==t.curPoints?{curPoints:e.points}:null}}],(n=[{key:"renderSymbolsStatically",value:function(e){var t=this,r=this.props,n=r.shape,i=r.activeShape,a=r.activeIndex,s=(0,A.J9)(this.props,!1);return e.map(function(e,r){var c=a===r,l=c?i:n,u=V(V({},s),e);return o.createElement(x.W,G({className:"recharts-scatter-symbol",key:"symbol-".concat(null===e||void 0===e?void 0:e.cx,"-").concat(null===e||void 0===e?void 0:e.cy,"-").concat(null===e||void 0===e?void 0:e.size,"-").concat(r)},(0,z.XC)(t.props,e,r),{role:"img"}),o.createElement(U,G({option:l,isActive:c,key:"symbol-".concat(r)},u)))})}},{key:"renderSymbolsWithAnimation",value:function(){var e=this,t=this.props,r=t.points,n=t.isAnimationActive,i=t.animationBegin,a=t.animationDuration,s=t.animationEasing,c=t.animationId,l=this.state.prevPoints;return o.createElement(y.Ay,{begin:i,duration:a,isActive:n,easing:s,from:{t:0},to:{t:1},key:"pie-".concat(c),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(t){var n=t.t,i=r.map(function(e,t){var r=l&&l[t];if(r){var o=(0,R.Dj)(r.cx,e.cx),i=(0,R.Dj)(r.cy,e.cy),a=(0,R.Dj)(r.size,e.size);return V(V({},e),{},{cx:o(n),cy:i(n),size:a(n)})}var s=(0,R.Dj)(0,e.size);return V(V({},e),{},{size:s(n)})});return o.createElement(x.W,null,e.renderSymbolsStatically(i))})}},{key:"renderSymbols",value:function(){var e=this.props,t=e.points,r=e.isAnimationActive,n=this.state.prevPoints;return!(r&&t&&t.length)||n&&v()(n,t)?this.renderSymbolsStatically(t):this.renderSymbolsWithAnimation()}},{key:"renderErrorBar",value:function(){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var e=this.props,t=e.points,r=e.xAxis,n=e.yAxis,i=e.children,a=(0,A.aS)(i,N.u);return a?a.map(function(e,i){var a=e.props,s=a.direction,c=a.dataKey;return o.cloneElement(e,{key:"".concat(s,"-").concat(c,"-").concat(t[i]),data:t,xAxis:r,yAxis:n,layout:"x"===s?"vertical":"horizontal",dataPointFormatter:function(e,t){return{x:e.cx,y:e.cy,value:"x"===s?+e.node.x:+e.node.y,errorVal:(0,K.kr)(e,t)}}})}):null}},{key:"renderLine",value:function(){var e,t,r=this.props,n=r.points,i=r.line,a=r.lineType,s=r.lineJointType,c=(0,A.J9)(this.props,!1),l=(0,A.J9)(i,!1);if("joint"===a)e=n.map(function(e){return{x:e.cx,y:e.cy}});else if("fitting"===a){var u=(0,R.jG)(n),p=u.xmin,y=u.xmax,d=u.a,f=u.b,m=function(e){return d*e+f};e=[{x:p,y:m(p)},{x:y,y:m(y)}]}var v=V(V(V({},c),{},{fill:"none",stroke:c&&c.fill},l),{},{points:e});return t=o.isValidElement(i)?o.cloneElement(i,v):b()(i)?i(v):o.createElement(I.I,G({},v,{type:s})),o.createElement(x.W,{className:"recharts-scatter-line",key:"recharts-scatter-line"},t)}},{key:"render",value:function(){var e=this.props,t=e.hide,r=e.points,n=e.line,i=e.className,a=e.xAxis,s=e.yAxis,c=e.left,l=e.top,u=e.width,p=e.height,y=e.id,d=e.isAnimationActive;if(t||!r||!r.length)return null;var m=this.state.isAnimationFinished,v=(0,g.A)("recharts-scatter",i),h=a&&a.allowDataOverflow,b=s&&s.allowDataOverflow,A=h||b,w=f()(y)?this.id:y;return o.createElement(x.W,{className:v,clipPath:A?"url(#clipPath-".concat(w,")"):null},h||b?o.createElement("defs",null,o.createElement("clipPath",{id:"clipPath-".concat(w)},o.createElement("rect",{x:h?c:c-u/2,y:b?l:l-p/2,width:h?u:2*u,height:b?p:2*p}))):null,n&&this.renderLine(),this.renderErrorBar(),o.createElement(x.W,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!d||m)&&O.Z.renderCallByParent(this.props,r))}}])&&$(r.prototype,n),i&&$(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(o.PureComponent);ee(re,"displayName","Scatter"),ee(re,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!w.m.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"}),ee(re,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,o=e.item,i=e.displayedData,a=e.xAxisTicks,s=e.yAxisTicks,c=e.offset,l=o.props.tooltipType,u=(0,A.aS)(o.props.children,M.f),p=f()(t.dataKey)?o.props.dataKey:t.dataKey,y=f()(r.dataKey)?o.props.dataKey:r.dataKey,d=n&&n.dataKey,m=n?n.range:_.defaultProps.range,v=m&&m[0],h=t.scale.bandwidth?t.scale.bandwidth():0,b=r.scale.bandwidth?r.scale.bandwidth():0,g=i.map(function(e,i){var c=(0,K.kr)(e,p),m=(0,K.kr)(e,y),g=!f()(d)&&(0,K.kr)(e,d)||"-",x=[{name:f()(t.dataKey)?o.props.name:t.name||t.dataKey,unit:t.unit||"",value:c,payload:e,dataKey:p,type:l},{name:f()(r.dataKey)?o.props.name:r.name||r.dataKey,unit:r.unit||"",value:m,payload:e,dataKey:y,type:l}];"-"!==g&&x.push({name:n.name||n.dataKey,unit:n.unit||"",value:g,payload:e,dataKey:d,type:l});var O=(0,K.nb)({axis:t,ticks:a,bandSize:h,entry:e,index:i,dataKey:p}),A=(0,K.nb)({axis:r,ticks:s,bandSize:b,entry:e,index:i,dataKey:y}),w="-"!==g?n.scale(g):v,E=Math.sqrt(Math.max(w,0)/Math.PI);return V(V({},e),{},{cx:O,cy:A,x:O-E,y:A-E,xAxis:t,yAxis:r,zAxis:n,width:2*E,height:2*E,size:w,node:{x:c,y:m,z:g},tooltipPayload:x,tooltipPosition:{x:O,y:A},payload:e},u&&u[i]&&u[i].props)});return V({points:g},c)});var ne=r(60719),oe=r(49960),ie=r(44941),ae=(0,c.gu)({chartName:"ComposedChart",GraphicalChild:[p.N,l.G,u.y,re],axisComponents:[{axisType:"xAxis",AxisComp:ne.W},{axisType:"yAxis",AxisComp:oe.h},{axisType:"zAxis",AxisComp:_}],formatAxisMap:ie.pr}),se=r(858),ce=r(97245),le=r(6581),ue=r(54313),pe=r(23327),ye=r(83110),de=r(69983);const fe=(0,ue.iK)(ue.PA.STATUS,ue.uI.ERROR);var me=r(3409),ve=r(73408);const he=()=>{const{theme:e}=(0,i.u)(),t=(0,me.zZ)(),r=(0,me.IT)(),c=(0,me.gy)(),{getOpacity:l,handleLegendMouseEnter:y,handleLegendMouseLeave:d}=(0,ye.pH)(),{chartData:f,totalErrors:m,overallErrorRate:v,avgErrorRate:h,isLoading:b,error:g,hasData:x}=function(){const{experimentId:e,startTimeMs:t,endTimeMs:r,timeIntervalSeconds:n,timeBuckets:i}=(0,de.W)(),{data:a,isLoading:s,error:c}=(0,pe.o4)({experimentId:e,startTimeMs:t,endTimeMs:r,viewType:ue.mW.TRACES,metricName:ue.po.TRACE_COUNT,aggregations:[{aggregation_type:ue.DF.COUNT}],timeIntervalSeconds:n,filters:[fe]}),{data:l,isLoading:u,error:p}=(0,pe.o4)({experimentId:e,startTimeMs:t,endTimeMs:r,viewType:ue.mW.TRACES,metricName:ue.po.TRACE_COUNT,aggregations:[{aggregation_type:ue.DF.COUNT}],timeIntervalSeconds:n}),y=(0,o.useMemo)(()=>(null===a||void 0===a?void 0:a.data_points)||[],[null===a||void 0===a?void 0:a.data_points]),d=(0,o.useMemo)(()=>(null===l||void 0===l?void 0:l.data_points)||[],[null===l||void 0===l?void 0:l.data_points]),f=s||u,m=c||p,v=(0,o.useMemo)(()=>y.reduce((e,t)=>{var r;return e+((null===(r=t.values)||void 0===r?void 0:r[ue.DF.COUNT])||0)},0),[y]),h=(0,o.useMemo)(()=>d.reduce((e,t)=>{var r;return e+((null===(r=t.values)||void 0===r?void 0:r[ue.DF.COUNT])||0)},0),[d]),b=h>0?v/h*100:0,g=(0,o.useCallback)(e=>{var t;return(null===(t=e.values)||void 0===t?void 0:t[ue.DF.COUNT])||0},[]),x=(0,ye.NM)(y,g),O=(0,ye.NM)(d,g),A=(0,o.useMemo)(()=>i.map(e=>{const t=x.get(e)||0,r=O.get(e)||0,o=r>0?t/r*100:0;return{name:(0,ye.fq)(e,n),errorCount:t,errorRate:Math.round(100*o)/100}}),[i,x,O,n]),w=(0,o.useMemo)(()=>0===A.length?0:A.reduce((e,t)=>e+t.errorRate,0)/A.length,[A]);return{chartData:A,totalErrors:v,overallErrorRate:b,avgErrorRate:w,isLoading:f,error:m,hasData:d.length>0}}(),O=(0,o.useCallback)((e,t)=>"Error Count"===t?[e.toLocaleString(),t]:[`${e.toFixed(1)}%`,t],[]);return b?(0,ve.Y)(me.lh,{}):g?(0,ve.Y)(me.nN,{}):(0,ve.FD)(me.h,{componentId:"mlflow.charts.trace_errors",children:[(0,ve.Y)(me.XQ,{icon:(0,ve.Y)(i.k,{}),title:(0,ve.Y)(a.A,{id:"t3mHNt",defaultMessage:"Errors"}),value:m.toLocaleString(),subtitle:`(Overall error rate: ${v.toFixed(1)}%)`}),(0,ve.Y)("div",{css:(0,n.AH)({height:me.tz,marginTop:e.spacing.sm},""),children:x?(0,ve.Y)(s.u,{width:"100%",height:"100%",children:(0,ve.FD)(ae,{data:f,margin:{top:10,right:10,left:10,bottom:0},children:[(0,ve.Y)(ne.W,{dataKey:"name",...t}),(0,ve.Y)(oe.h,{yAxisId:"left",...r}),(0,ve.Y)(oe.h,{yAxisId:"right",orientation:"right",domain:[0,100],tickFormatter:e=>`${e}%`,...r}),(0,ve.Y)(se.m,{content:(0,ve.Y)(me.Vn,{formatter:O}),cursor:{fill:e.colors.actionTertiaryBackgroundHover}}),(0,ve.Y)(u.y,{yAxisId:"left",dataKey:"errorCount",fill:e.colors.red400,radius:[4,4,0,0],name:"Error Count",fillOpacity:l("Error Count"),legendType:"square"}),h>0&&(0,ve.Y)(ce.e,{yAxisId:"right",y:h,stroke:e.colors.textSecondary,strokeDasharray:"4 4",label:{value:`AVG (${h.toFixed(1)}%)`,position:"insideTopRight",fill:e.colors.textSecondary,fontSize:10}}),(0,ve.Y)(p.N,{yAxisId:"right",type:"monotone",dataKey:"errorRate",stroke:e.colors.yellow500,strokeWidth:2,dot:!1,name:"Error Rate",strokeOpacity:l("Error Rate"),legendType:"plainline"}),(0,ve.Y)(le.s,{verticalAlign:"bottom",onMouseEnter:y,onMouseLeave:d,...c})]})}):(0,ve.Y)(me.iE,{})})]})}}}]);