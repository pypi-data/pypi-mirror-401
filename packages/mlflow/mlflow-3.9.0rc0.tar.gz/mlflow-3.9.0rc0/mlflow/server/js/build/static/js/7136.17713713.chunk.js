"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[7136],{27151:function(e,n,l){l.d(n,{U:function(){return o.U}});var o=l(63420)},64755:function(e,n,l){l.r(n),l.d(n,{default:function(){return ke}});var o=l(68248),i=l(27757),a=l(82716),t=l(40724),s=l(55570),d=l(91113),r=l(66916),c=l(7655),u=l(46709),m=l(87078),p=l(30431),g=l(89015),h=l(49708),f=l(25117);const v=()=>{var e,n;const l=(0,h.I)(["gateway_model_definitions"],{queryFn:()=>f.t.listModelDefinitions(),retry:!1});return{data:null===(e=l.data)||void 0===e?void 0:e.model_definitions,error:null!==(n=l.error)&&void 0!==n?n:void 0,isLoading:l.isLoading,refetch:l.refetch}};var y=l(75329),C=l(64226),b=l(93585),D=l(73408);const k=({availableProviders:e,filter:n,onFilterChange:l})=>(0,D.Y)(b.E,{availableProviders:e,filter:n,onFilterChange:l,componentIdPrefix:"mlflow.gateway.api-keys-list"});let Y=function(e){return e.KEY_NAME="key_name",e.PROVIDER="provider",e.ENDPOINTS="endpoints",e.USED_BY="used_by",e.LAST_UPDATED="last_updated",e.CREATED="created",e}({});const x={[Y.PROVIDER]:"Provider",[Y.ENDPOINTS]:"Endpoints",[Y.USED_BY]:"Used by",[Y.LAST_UPDATED]:"Last updated",[Y.CREATED]:"Created"},w=Object.keys(x),A=({visibleColumns:e,onColumnsChange:n})=>{const{theme:l}=(0,i.u)(),t=(0,c.A)();return(0,D.FD)(a.DialogCombobox,{componentId:"mlflow.gateway.api-keys-list.columns-dropdown",label:"Columns",multiSelect:!0,children:[(0,D.Y)(a.DialogComboboxCustomButtonTriggerWrapper,{children:(0,D.Y)(i.B,{componentId:"mlflow.gateway.api-keys-list.columns-button",endIcon:(0,D.Y)(a.ChevronDownIcon,{}),"data-testid":"api-keys-column-selector-button",children:(0,D.FD)("div",{css:(0,o.AH)({display:"flex",gap:l.spacing.sm,alignItems:"center"},""),children:[(0,D.Y)(a.ColumnsIcon,{}),t.formatMessage({id:"Qayyg6",defaultMessage:"Columns"})]})})}),(0,D.Y)(a.DialogComboboxContent,{minWidth:200,children:(0,D.Y)(a.DialogComboboxOptionList,{children:w.map(l=>(0,D.Y)(a.DialogComboboxOptionListCheckboxItem,{value:l,checked:e.includes(l),onChange:()=>(l=>{const o=e.includes(l)?e.filter(e=>e!==l):[...e,l];n(o)})(l),children:x[l]},l))})})]})},M=w.filter(e=>e!==Y.CREATED);var S={name:"1hetg88",styles:"max-width:300px"},F={name:"1189xqs",styles:"flex:2"},_={name:"82a6rk",styles:"flex:1"},T={name:"82a6rk",styles:"flex:1"},I={name:"82a6rk",styles:"flex:1"},E={name:"82a6rk",styles:"flex:1"},H={name:"82a6rk",styles:"flex:1"},P={name:"1yvnci",styles:"flex:0;min-width:96px;max-width:96px"},B={name:"1189xqs",styles:"flex:2"},R={name:"82a6rk",styles:"flex:1"},O={name:"82a6rk",styles:"flex:1"},z={name:"82a6rk",styles:"flex:1"},L={name:"opde7s",styles:"color:inherit"},$={name:"82a6rk",styles:"flex:1"},K={name:"82a6rk",styles:"flex:1"},U={name:"1yvnci",styles:"flex:0;min-width:96px;max-width:96px"};const N=({onKeyClick:e,onEditClick:n,onDeleteClick:l,onEndpointsClick:s,onBindingsClick:d})=>{const{theme:h}=(0,i.u)(),{formatMessage:f}=(0,c.A)(),[b,x]=(0,u.useState)(""),[w,N]=(0,u.useState)({providers:[]}),[j,q]=(0,u.useState)(M),{secrets:V,filteredSecrets:W,isLoading:Q,availableProviders:G,getModelDefinitionsForSecret:J,getEndpointsForSecret:X,getBindingsForSecret:Z,getEndpointCount:ee,getBindingCount:ne}=(({searchFilter:e,filter:n})=>{const{data:l,isLoading:o}=(0,m.d)(),{data:i,isLoading:a}=(0,p.c)(),{data:t,isLoading:s}=v(),{data:d,isLoading:r}=(0,g.K)(),c=(0,u.useMemo)(()=>{const e=new Map;return t?(t.forEach(n=>{const l=n.secret_id;l&&(e.has(l)||e.set(l,[]),e.get(l).push(n))}),e):e},[t]),h=(0,u.useMemo)(()=>{const e=new Map;return i?(i.forEach(n=>{var l;null===(l=n.model_mappings)||void 0===l||l.forEach(l=>{var o;const i=null===(o=l.model_definition)||void 0===o?void 0:o.secret_id;i&&(e.has(i)||e.set(i,new Set),e.get(i).add(n.endpoint_id))})}),e):e},[i]),f=(0,u.useMemo)(()=>{const e=new Map;return h.forEach((n,l)=>{n.forEach(n=>{e.has(n)||e.set(n,new Set),e.get(n).add(l)})}),e},[h]),y=(0,u.useMemo)(()=>{const e=new Map;return d&&f.size?(d.forEach(n=>{const l=f.get(n.endpoint_id);l&&l.forEach(n=>{var l;const o=null!==(l=e.get(n))&&void 0!==l?l:0;e.set(n,o+1)})}),e):e},[d,f]),C=(0,u.useCallback)(e=>{if(!d)return[];const n=h.get(e);return n?d.filter(e=>n.has(e.endpoint_id)):[]},[d,h]),b=(0,u.useCallback)(e=>{if(!i)return[];const n=h.get(e);return n?i.filter(e=>n.has(e.endpoint_id)):[]},[i,h]),D=(0,u.useCallback)(e=>{var n;return null!==(n=c.get(e))&&void 0!==n?n:[]},[c]),k=(0,u.useCallback)(e=>{var n,l;return null!==(n=null===(l=h.get(e))||void 0===l?void 0:l.size)&&void 0!==n?n:0},[h]),Y=(0,u.useCallback)(e=>{var n;return null!==(n=y.get(e))&&void 0!==n?n:0},[y]),x=l?Array.from(new Set(l.map(e=>e.provider).filter(e=>!!e))):[],w=(0,u.useMemo)(()=>{if(!l)return[];let o=l;if(e.trim()){const n=e.toLowerCase();o=o.filter(e=>e.secret_name.toLowerCase().includes(n))}return n.providers.length>0&&(o=o.filter(e=>e.provider&&n.providers.includes(e.provider))),o},[l,e,n]);return{secrets:null!==l&&void 0!==l?l:[],filteredSecrets:w,isLoading:o||a||s||r,availableProviders:x,getModelDefinitionsForSecret:D,getEndpointsForSecret:b,getBindingsForSecret:C,getEndpointCount:k,getBindingCount:Y}})({searchFilter:b,filter:w});if((Q||!V.length)&&Q)return(0,D.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",justifyContent:"center",gap:h.spacing.sm,padding:h.spacing.lg,minHeight:200},""),children:[(0,D.Y)(i.S,{size:"small"}),(0,D.Y)(t.A,{id:"iqlzHb",defaultMessage:"Loading API keys..."})]});const le=b.trim().length>0||w.providers.length>0;return(0,D.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:h.spacing.md},""),children:[(0,D.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:h.spacing.sm},""),children:[(0,D.Y)(r.I,{componentId:"mlflow.gateway.api-keys-list.search",prefix:(0,D.Y)(r.S,{}),placeholder:f({id:"QqbUt/",defaultMessage:"Search API Keys"}),value:b,onChange:e=>x(e.target.value),allowClear:!0,css:S}),(0,D.Y)(k,{availableProviders:G,filter:w,onFilterChange:N}),(0,D.Y)(A,{visibleColumns:j,onColumnsChange:q})]}),(0,D.FD)(a.Table,{scrollable:!0,empty:(()=>{const e=0===V.length;return 0===W.length&&le?(0,D.Y)(a.Empty,{title:(0,D.Y)(t.A,{id:"8kU9Sc",defaultMessage:"No API keys found"}),description:null}):e?(0,D.Y)(a.Empty,{image:(0,D.Y)(a.KeyIcon,{}),title:(0,D.Y)(t.A,{id:"UqGOOx",defaultMessage:"No API keys created"}),description:(0,D.Y)(t.A,{id:"BF9qQD",defaultMessage:'Use "Create API key" button to create a new API key'})}):null})(),css:(0,o.AH)({border:`1px solid ${h.colors.borderDecorative}`,borderRadius:h.general.borderRadiusBase},""),children:[(0,D.FD)(a.TableRow,{isHeader:!0,children:[(0,D.Y)(a.TableHeader,{componentId:"mlflow.gateway.api-keys-list.name-header",css:F,children:(0,D.Y)(t.A,{id:"6HjFD0",defaultMessage:"Key name"})}),j.includes(Y.PROVIDER)&&(0,D.Y)(a.TableHeader,{componentId:"mlflow.gateway.api-keys-list.provider-header",css:_,children:(0,D.Y)(t.A,{id:"CvNffK",defaultMessage:"Provider"})}),j.includes(Y.ENDPOINTS)&&(0,D.Y)(a.TableHeader,{componentId:"mlflow.gateway.api-keys-list.endpoints-header",css:T,children:(0,D.Y)(t.A,{id:"0Qu0bD",defaultMessage:"Endpoints"})}),j.includes(Y.USED_BY)&&(0,D.Y)(a.TableHeader,{componentId:"mlflow.gateway.api-keys-list.used-by-header",css:I,children:(0,D.Y)(t.A,{id:"T3Ew34",defaultMessage:"Used by"})}),j.includes(Y.LAST_UPDATED)&&(0,D.Y)(a.TableHeader,{componentId:"mlflow.gateway.api-keys-list.updated-header",css:E,children:(0,D.Y)(t.A,{id:"kAR6Ws",defaultMessage:"Last updated"})}),j.includes(Y.CREATED)&&(0,D.Y)(a.TableHeader,{componentId:"mlflow.gateway.api-keys-list.created-header",css:H,children:(0,D.Y)(t.A,{id:"dNaKCA",defaultMessage:"Created"})}),(0,D.Y)(a.TableHeader,{componentId:"mlflow.gateway.api-keys-list.actions-header",css:P})]}),W.map(t=>{const r=J(t.secret_id),c=ee(t.secret_id),u=ne(t.secret_id);return(0,D.FD)(a.TableRow,{children:[(0,D.Y)(a.TableCell,{css:B,children:(0,D.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:h.spacing.sm},""),children:[(0,D.Y)(a.KeyIcon,{css:(0,o.AH)({color:h.colors.textSecondary,flexShrink:0},"")}),(0,D.Y)("span",{role:"button",tabIndex:0,onClick:()=>null===e||void 0===e?void 0:e(t),onKeyDown:n=>{"Enter"!==n.key&&" "!==n.key||null===e||void 0===e||e(t)},css:(0,o.AH)({color:h.colors.actionPrimaryBackgroundDefault,fontWeight:h.typography.typographyBoldFontWeight,cursor:"pointer","&:hover":{textDecoration:"underline"}},""),children:t.secret_name})]})}),j.includes(Y.PROVIDER)&&(0,D.Y)(a.TableCell,{css:R,children:t.provider?(0,D.Y)(i.T.Text,{children:(0,y.aU)(t.provider)}):(0,D.Y)(i.T.Text,{color:"secondary",children:"-"})}),j.includes(Y.ENDPOINTS)&&(0,D.Y)(a.TableCell,{css:O,children:c>0?(0,D.Y)("span",{role:"button",tabIndex:0,onClick:()=>null===s||void 0===s?void 0:s(t,X(t.secret_id)),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||null===s||void 0===s||s(t,X(t.secret_id))},css:(0,o.AH)({color:h.colors.actionPrimaryBackgroundDefault,cursor:"pointer","&:hover":{textDecoration:"underline"}},""),children:c}):(0,D.Y)(i.T.Text,{color:"secondary",children:c})}),j.includes(Y.USED_BY)&&(0,D.Y)(a.TableCell,{css:z,children:u>0?(0,D.FD)("button",{type:"button",onClick:()=>{const e=Z(t.secret_id);null===d||void 0===d||d(t,e)},css:(0,o.AH)({display:"flex",alignItems:"center",gap:h.spacing.xs,background:"none",border:"none",padding:0,cursor:"pointer",color:h.colors.actionPrimaryBackgroundDefault,"&:hover":{textDecoration:"underline"}},""),children:[(0,D.Y)(a.LinkIcon,{css:(0,o.AH)({color:h.colors.textSecondary,fontSize:14},"")}),(0,D.FD)(i.T.Text,{css:L,children:[u," ",1===u?"resource":"resources"]})]}):(0,D.Y)(i.T.Text,{color:"secondary",children:"-"})}),j.includes(Y.LAST_UPDATED)&&(0,D.Y)(a.TableCell,{css:$,children:(0,D.Y)(C.f,{date:new Date(t.last_updated_at)})}),j.includes(Y.CREATED)&&(0,D.Y)(a.TableCell,{css:K,children:(0,D.Y)(C.f,{date:new Date(t.created_at)})}),(0,D.Y)(a.TableCell,{css:U,children:(0,D.FD)("div",{css:(0,o.AH)({display:"flex",gap:h.spacing.xs},""),children:[(0,D.Y)(i.B,{componentId:"mlflow.gateway.api-keys-list.edit-button",type:"primary",icon:(0,D.Y)(a.PencilIcon,{}),"aria-label":f({id:"jA7Y1x",defaultMessage:"Edit API key"}),onClick:()=>null===n||void 0===n?void 0:n(t)}),(0,D.Y)(i.B,{componentId:"mlflow.gateway.api-keys-list.delete-button",type:"primary",icon:(0,D.Y)(a.TrashIcon,{}),"aria-label":f({id:"rq7u9r",defaultMessage:"Delete API key"}),onClick:()=>null===l||void 0===l?void 0:l(t,r,X(t.secret_id),u)})]})})]},t.secret_id)})]})]})};var j=l(79081),q=l(27151),V=l(87856),W=l(98332),Q=l(45472);const G=({provider:e,value:n,onChange:l,errors:s,disabled:d,componentIdPrefix:r="mlflow.gateway.secret-form",hideNameField:m=!1})=>{const{theme:p}=(0,i.u)(),{formatMessage:g}=(0,c.A)(),{data:h,isLoading:f}=(0,Q.D)({provider:e}),v=(0,u.useMemo)(()=>{var e;return null!==(e=null===h||void 0===h?void 0:h.auth_modes)&&void 0!==e?e:[]},[null===h||void 0===h?void 0:h.auth_modes]),C=v.length>1,b=(0,u.useMemo)(()=>{var e;if(v.length){if(n.authMode){const e=v.find(e=>e.mode===n.authMode);if(e)return e}return null!==(e=v.find(e=>e.mode===(null===h||void 0===h?void 0:h.default_mode)))&&void 0!==e?e:v[0]}},[v,n.authMode,null===h||void 0===h?void 0:h.default_mode]),k=n.authMode||(null===b||void 0===b?void 0:b.mode)||"",Y=(0,u.useMemo)(()=>{var n,l;const o=[...(null!==(n=null===b||void 0===b?void 0:b.secret_fields)&&void 0!==n?n:[]).map(e=>({...e,fieldType:"secret"})),...(null!==(l=null===b||void 0===b?void 0:b.config_fields)&&void 0!==l?l:[]).map(e=>({...e,fieldType:"config"}))];return(0,y.Sm)(o,e)},[null===b||void 0===b?void 0:b.secret_fields,null===b||void 0===b?void 0:b.config_fields,e]),x=(0,u.useCallback)(e=>{l({...n,name:e})},[l,n]),w=(0,u.useCallback)((e,o)=>{l({...n,secretFields:{...n.secretFields,[e]:o}})},[l,n]),A=(0,u.useCallback)((e,o)=>{l({...n,configFields:{...n.configFields,[e]:o}})},[l,n]),M=(0,u.useCallback)(e=>{l({...n,authMode:e,secretFields:{},configFields:{}})},[l,n]);return e?f?(0,D.Y)("div",{css:(0,o.AH)({display:"flex",justifyContent:"center",padding:p.spacing.lg},""),children:(0,D.Y)(i.S,{size:"small"})}):(0,D.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:p.spacing.md},""),children:[!m&&(0,D.FD)("div",{children:[(0,D.FD)(a.FormUI.Label,{htmlFor:`${r}.name`,children:[(0,D.Y)(t.A,{id:"4CNVbz",defaultMessage:"API key name"}),(0,D.Y)("span",{css:(0,o.AH)({color:p.colors.textValidationDanger},""),children:" *"})]}),(0,D.Y)(W.f,{id:`${r}.name`,componentId:`${r}.name`,value:n.name,onChange:e=>x(e.target.value),placeholder:g({id:"AGLzB5",defaultMessage:"my-api-key"}),validationState:null!==s&&void 0!==s&&s.name?"error":void 0,disabled:d}),(null===s||void 0===s?void 0:s.name)&&(0,D.Y)(a.FormUI.Message,{type:"error",message:s.name})]}),C&&(0,D.FD)("div",{children:[(0,D.Y)(a.FormUI.Label,{children:(0,D.Y)(t.A,{id:"JwhonN",defaultMessage:"Authentication method"})}),(0,D.Y)(a.Radio.Group,{name:`${r}.auth-mode`,componentId:`${r}.auth-mode`,value:k,onChange:e=>M(e.target.value),disabled:d,children:(0,D.Y)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:p.spacing.sm},""),children:v.map(e=>(0,D.Y)(a.Radio,{value:e.mode,children:(0,D.FD)("div",{children:[(0,D.Y)("div",{css:(0,o.AH)({fontWeight:p.typography.typographyBoldFontWeight},""),children:e.display_name}),e.description&&(0,D.Y)("div",{css:(0,o.AH)({color:p.colors.textSecondary,fontSize:p.typography.fontSizeSm},""),children:e.description})]})},e.mode))})})]}),Y.map(e=>{var l,i,t,c,u,m;return(0,D.FD)("div",{children:[(0,D.FD)(a.FormUI.Label,{htmlFor:`${r}.${e.fieldType}.${e.name}`,children:[(0,y.u3)(e.name),e.required&&(0,D.Y)("span",{css:(0,o.AH)({color:p.colors.textValidationDanger},""),children:" *"})]}),"secret"===e.fieldType?(0,D.Y)(V.L,{id:`${r}.secret.${e.name}`,componentId:`${r}.secret.${e.name}`,value:null!==(l=n.secretFields[e.name])&&void 0!==l?l:"",onChange:n=>w(e.name,n.target.value),placeholder:e.description,validationState:null!==s&&void 0!==s&&null!==(i=s.secretFields)&&void 0!==i&&i[e.name]?"error":void 0,disabled:d}):(0,D.Y)(W.f,{id:`${r}.config.${e.name}`,componentId:`${r}.config.${e.name}`,value:null!==(t=n.configFields[e.name])&&void 0!==t?t:"",onChange:n=>A(e.name,n.target.value),placeholder:e.description,validationState:null!==s&&void 0!==s&&null!==(c=s.configFields)&&void 0!==c&&c[e.name]?"error":void 0,disabled:d}),"secret"===e.fieldType&&(null===s||void 0===s||null===(u=s.secretFields)||void 0===u?void 0:u[e.name])&&(0,D.Y)(a.FormUI.Message,{type:"error",message:s.secretFields[e.name]}),"config"===e.fieldType&&(null===s||void 0===s||null===(m=s.configFields)||void 0===m?void 0:m[e.name])&&(0,D.Y)(a.FormUI.Message,{type:"error",message:s.configFields[e.name]})]},e.name)})]}):(0,D.Y)("div",{css:(0,o.AH)({color:p.colors.textSecondary},""),children:(0,D.Y)(t.A,{id:"YGo9ni",defaultMessage:"Select a provider to configure API key"})})};var J=l(22138);var X={name:"1fttcpj",styles:"display:flex;flex-direction:column"},Z={name:"ti75j2",styles:"margin:0"};const ee=({secret:e,showCard:n=!0})=>{const{theme:l}=(0,i.u)(),o=(0,u.useMemo)(()=>(e=>({labelStyle:{minWidth:100,flexShrink:0},rowStyle:{display:"flex",alignItems:"center",gap:e.spacing.sm},rowStyleFlexStart:{display:"flex",alignItems:"flex-start",gap:e.spacing.sm},containerStyle:{display:"flex",flexDirection:"column",gap:e.spacing.sm},configColumnStyle:{display:"flex",flexDirection:"column",gap:e.spacing.xs},configRowStyle:{display:"flex",gap:e.spacing.xs},timestampRowStyle:{display:"flex",alignItems:"center",gap:e.spacing.xs},cardStyle:{padding:e.spacing.md,border:`1px solid ${e.colors.borderDecorative}`,borderRadius:e.general.borderRadiusBase,backgroundColor:e.colors.backgroundSecondary},monoStyle:{fontFamily:"monospace",wordBreak:"break-all"}}))(l),[l]),a=(0,u.useMemo)(()=>{var n;return null!==(n=e.auth_config)&&void 0!==n?n:null},[e.auth_config]),s=(0,D.FD)("div",{css:X,children:[(0,D.Y)(i.T.Title,{level:3,css:Z,children:e.secret_name}),(0,D.Y)(j.S,{size:"md"}),(0,D.FD)("div",{css:o.containerStyle,children:[e.provider&&(0,D.FD)("div",{css:o.rowStyle,children:[(0,D.Y)(i.T.Text,{color:"secondary",css:o.labelStyle,children:(0,D.Y)(t.A,{id:"hJcrnh",defaultMessage:"Provider"})}),(0,D.Y)(i.T.Text,{children:(0,y.aU)(e.provider)})]}),(null===a||void 0===a?void 0:a.auth_mode)&&(0,D.FD)("div",{css:o.rowStyle,children:[(0,D.Y)(i.T.Text,{color:"secondary",css:o.labelStyle,children:(0,D.Y)(t.A,{id:"iN/n6b",defaultMessage:"Auth Type"})}),(0,D.Y)(i.T.Text,{children:(0,y.Qs)(String(a.auth_mode))})]}),(0,D.FD)("div",{css:o.rowStyleFlexStart,children:[(0,D.Y)(i.T.Text,{color:"secondary",css:o.labelStyle,children:(0,D.Y)(t.A,{id:"90097b",defaultMessage:"Masked Key"})}),(0,D.Y)(J.R,{maskedValue:e.masked_values})]}),a&&Object.keys(a).filter(e=>"auth_mode"!==e).length>0&&(0,D.FD)("div",{css:o.rowStyle,children:[(0,D.Y)(i.T.Text,{color:"secondary",css:o.labelStyle,children:(0,D.Y)(t.A,{id:"R2NKiZ",defaultMessage:"Config"})}),(0,D.Y)("div",{css:o.configColumnStyle,children:Object.entries(a).filter(([e])=>"auth_mode"!==e).map(([e,n])=>(0,D.FD)("div",{css:o.configRowStyle,children:[(0,D.FD)(i.T.Text,{color:"secondary",children:[(0,y.u3)(e),":"]}),(0,D.Y)(i.T.Text,{css:o.monoStyle,children:String(n)})]},e))})]}),(0,D.FD)("div",{css:o.rowStyle,children:[(0,D.Y)(i.T.Text,{color:"secondary",css:o.labelStyle,children:(0,D.Y)(t.A,{id:"rdrvCs",defaultMessage:"Created"})}),(0,D.FD)("div",{css:o.timestampRowStyle,children:[(0,D.Y)(C.f,{date:new Date(e.created_at)}),e.created_by&&(0,D.Y)(i.T.Text,{color:"secondary",children:(0,D.Y)(t.A,{id:"Z4cZMo",defaultMessage:"by {user}",values:{user:e.created_by}})})]})]}),(0,D.FD)("div",{css:o.rowStyle,children:[(0,D.Y)(i.T.Text,{color:"secondary",css:o.labelStyle,children:(0,D.Y)(t.A,{id:"/y0ZU4",defaultMessage:"Updated"})}),(0,D.FD)("div",{css:o.timestampRowStyle,children:[(0,D.Y)(C.f,{date:new Date(e.last_updated_at)}),e.last_updated_by&&(0,D.Y)(i.T.Text,{color:"secondary",children:(0,D.Y)(t.A,{id:"sSLvV0",defaultMessage:"by {user}",values:{user:e.last_updated_by}})})]})]})]})]});return n?(0,D.Y)("div",{css:o.cardStyle,children:s}):s};var ne=l(44341);const le={name:"",authMode:"",secretFields:{},configFields:{}},oe=({open:e,onClose:n,onSuccess:l})=>{const{theme:s}=(0,i.u)(),d=(0,c.A)(),[r,m]=(0,u.useState)(""),[p,g]=(0,u.useState)(le),[h,f]=(0,u.useState)({}),{mutateAsync:v,isLoading:y,error:C,reset:b}=(0,ne.w)(),{data:k}=(0,Q.D)({provider:r}),Y=(0,u.useCallback)(e=>{m(e),g(le),f({}),b()},[b]),x=(0,u.useCallback)(e=>{g(e),f(n=>({...n,name:e.name?void 0:n.name})),b()},[b]),w=(0,u.useCallback)(()=>{const e={};r||(e.provider=d.formatMessage({id:"R7s1xC",defaultMessage:"Provider is required"})),p.name.trim()||(e.name=d.formatMessage({id:"OxQK9l",defaultMessage:"Key name is required"}));return Object.values(p.secretFields).some(e=>Boolean(e))||(e.secretFields={}),f(e),0===Object.keys(e).length},[r,p.name,p.secretFields,d]),A=(0,u.useCallback)(()=>{m(""),g(le),f({}),b(),n()},[n,b]),M=(0,u.useCallback)(async()=>{if(!w())return;const e={...p.configFields};p.authMode&&(e.auth_mode=p.authMode),await v({secret_name:p.name,secret_value:p.secretFields,provider:r,auth_config:Object.keys(e).length>0?e:void 0}).then(()=>{A(),null===l||void 0===l||l()})},[w,p,r,v,A,l]),S=(0,u.useMemo)(()=>{if(!C)return null;const e=C.message;return e.toLowerCase().includes("unique constraint")||e.toLowerCase().includes("duplicate")?d.formatMessage({id:"tPUQUF",defaultMessage:"An API key with this name already exists. Please choose a different name."}):e.length>200?d.formatMessage({id:"r0mM8+",defaultMessage:"An error occurred while creating the API key. Please try again."}):e},[C,d]),F=(0,u.useMemo)(()=>{var e,n;if(null!==k&&void 0!==k&&null!==(e=k.auth_modes)&&void 0!==e&&e.length)return p.authMode?k.auth_modes.find(e=>e.mode===p.authMode):null!==(n=k.auth_modes.find(e=>e.mode===k.default_mode))&&void 0!==n?n:k.auth_modes[0]},[k,p.authMode]),_=(0,u.useMemo)(()=>{var e,n,l,o;if(!r)return!1;if(!p.name.trim())return!1;if(!(null!==(e=null===F||void 0===F||null===(n=F.secret_fields)||void 0===n?void 0:n.filter(e=>e.required))&&void 0!==e?e:[]).every(e=>{var n;return Boolean(null===(n=p.secretFields[e.name])||void 0===n?void 0:n.trim())}))return!1;return!!(null!==(l=null===F||void 0===F||null===(o=F.config_fields)||void 0===o?void 0:o.filter(e=>e.required))&&void 0!==l?l:[]).every(e=>{var n;return Boolean(null===(n=p.configFields[e.name])||void 0===n?void 0:n.trim())})},[r,p.name,p.secretFields,p.configFields,F]);return(0,D.Y)(j.d,{componentId:"mlflow.gateway.create-api-key-modal",title:d.formatMessage({id:"tCkDwC",defaultMessage:"Create API Key"}),visible:e,onCancel:A,onOk:M,okText:d.formatMessage({id:"UXdH8W",defaultMessage:"Create API Key"}),cancelText:d.formatMessage({id:"hHNj31",defaultMessage:"Cancel"}),confirmLoading:y,okButtonProps:{disabled:!_},size:"normal",children:(0,D.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:s.spacing.lg},""),children:[S&&(0,D.Y)(a.Alert,{componentId:"mlflow.gateway.create-api-key-modal.error",type:"error",message:S,closable:!1}),(0,D.Y)(q.U,{value:r,onChange:Y,error:h.provider,componentIdPrefix:"mlflow.gateway.create-api-key-modal.provider"}),r&&(0,D.Y)(G,{provider:r,value:p,onChange:x,errors:h,componentIdPrefix:"mlflow.gateway.create-api-key-modal"}),!r&&(0,D.Y)("div",{css:(0,o.AH)({color:s.colors.textSecondary,textAlign:"center",padding:s.spacing.lg},""),children:(0,D.Y)(t.A,{id:"mMR/YQ",defaultMessage:"Select a provider to configure your API key"})})]})})};var ie=l(61060);const ae={name:"",authMode:"",secretFields:{},configFields:{}},te=({secret:e,onClose:n,onSuccess:l})=>{var o;const i=(0,c.A)(),[a,t]=(0,u.useState)(ae),[s,d]=(0,u.useState)({}),{mutateAsync:r,isLoading:m,error:p,reset:g}=(0,ie.n)({mutationFn:e=>f.t.updateSecret(e)}),h=null!==(o=null===e||void 0===e?void 0:e.provider)&&void 0!==o?o:"",{data:v}=(0,Q.D)({provider:h}),y=(0,u.useRef)(g);y.current=g,(0,u.useEffect)(()=>{if(e){var n;let l="";null!==(n=e.auth_config)&&void 0!==n&&n.auth_mode&&(l=String(e.auth_config.auth_mode)),t({name:e.secret_name,authMode:l,secretFields:{},configFields:{}}),d({}),y.current()}},[e]);const C=(0,u.useCallback)(e=>{t(e),g()},[g]),b=(0,u.useCallback)(()=>{const e={};return Object.values(a.secretFields).some(e=>Boolean(e))||(e.secretFields={}),d(e),0===Object.keys(e).length},[a.secretFields]),D=(0,u.useCallback)(()=>{t(ae),d({}),g(),n()},[n,g]),k=(0,u.useMemo)(()=>{if(!p)return null;const e=p.message;return e.length>200?i.formatMessage({id:"zRwy1a",defaultMessage:"An error occurred while updating the API key. Please try again."}):e},[p,i]),Y=(0,u.useMemo)(()=>{var e,n;if(null!==v&&void 0!==v&&null!==(e=v.auth_modes)&&void 0!==e&&e.length)return a.authMode?v.auth_modes.find(e=>e.mode===a.authMode):null!==(n=v.auth_modes.find(e=>e.mode===v.default_mode))&&void 0!==n?n:v.auth_modes[0]},[v,a.authMode]),x=(0,u.useCallback)(async()=>{if(e&&b())try{const n=a.authMode||(null===Y||void 0===Y?void 0:Y.mode),o={...a.configFields};n&&(o.auth_mode=n),await r({secret_id:e.secret_id,secret_value:a.secretFields,auth_config:Object.keys(o).length>0?o:void 0}),D(),null===l||void 0===l||l()}catch{}},[e,b,a,Y,r,D,l]),w=(0,u.useMemo)(()=>{var e,n,l,o;if(!(null!==(e=null===Y||void 0===Y||null===(n=Y.secret_fields)||void 0===n?void 0:n.filter(e=>e.required))&&void 0!==e?e:[]).every(e=>{var n;return Boolean(null===(n=a.secretFields[e.name])||void 0===n?void 0:n.trim())}))return!1;return!!(null!==(l=null===Y||void 0===Y||null===(o=Y.config_fields)||void 0===o?void 0:o.filter(e=>e.required))&&void 0!==l?l:[]).every(e=>{var n;return Boolean(null===(n=a.configFields[e.name])||void 0===n?void 0:n.trim())})},[a.secretFields,a.configFields,Y]);return{formData:a,errors:s,isLoading:m,errorMessage:k,selectedAuthMode:Y,isFormValid:w,provider:h,handleFormDataChange:C,handleSubmit:x,handleClose:D}};var se={name:"4zleql",styles:"display:block"},de={name:"4zleql",styles:"display:block"};const re=({open:e,secret:n,onClose:l,onSuccess:s})=>{const{theme:d}=(0,i.u)(),u=(0,c.A)(),{formData:m,errors:p,isLoading:g,errorMessage:h,isFormValid:f,provider:v,handleFormDataChange:C,handleSubmit:b,handleClose:k}=te({secret:n,onClose:l,onSuccess:s});return n?(0,D.Y)(j.d,{componentId:"mlflow.gateway.edit-api-key-modal",title:u.formatMessage({id:"Lpz85i",defaultMessage:"Edit API Key"}),visible:e,onCancel:k,onOk:b,okText:u.formatMessage({id:"SMVe/s",defaultMessage:"Save Changes"}),cancelText:u.formatMessage({id:"hHNj31",defaultMessage:"Cancel"}),confirmLoading:g,okButtonProps:{disabled:!f},size:"normal",children:(0,D.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:d.spacing.lg},""),children:[h&&(0,D.Y)(a.Alert,{componentId:"mlflow.gateway.edit-api-key-modal.error",type:"error",message:h,closable:!1}),(0,D.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:d.spacing.xs},""),children:[(0,D.Y)(i.T.Text,{bold:!0,children:(0,D.Y)(t.A,{id:"sEheG0",defaultMessage:"Key Name"})}),(0,D.Y)(j.T,{componentId:"mlflow.gateway.edit-api-key-modal.name-tooltip",content:(0,D.FD)(D.FK,{children:[u.formatMessage({id:"2tQXw0",defaultMessage:"Key name cannot be changed."}),(0,D.Y)("br",{}),u.formatMessage({id:"Q5CR/y",defaultMessage:"Create a new key if a different name is needed."})]}),children:(0,D.Y)("span",{css:se,children:(0,D.Y)(r.I,{componentId:"mlflow.gateway.edit-api-key-modal.name",value:n.secret_name,disabled:!0,css:(0,o.AH)({backgroundColor:d.colors.actionDisabledBackground},"")})})})]}),v&&(0,D.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:d.spacing.xs},""),children:[(0,D.Y)(i.T.Text,{bold:!0,children:(0,D.Y)(t.A,{id:"R3TrL7",defaultMessage:"Provider"})}),(0,D.Y)(j.T,{componentId:"mlflow.gateway.edit-api-key-modal.provider-tooltip",content:(0,D.FD)(D.FK,{children:[u.formatMessage({id:"02+DX/",defaultMessage:"Provider cannot be changed."}),(0,D.Y)("br",{}),u.formatMessage({id:"tCC/M3",defaultMessage:"Create a new key if a different provider is needed."})]}),children:(0,D.Y)("span",{css:de,children:(0,D.Y)(r.I,{componentId:"mlflow.gateway.edit-api-key-modal.provider",value:(0,y.aU)(v),disabled:!0,css:(0,o.AH)({backgroundColor:d.colors.actionDisabledBackground},"")})})})]}),(0,D.Y)(G,{provider:v,value:m,onChange:C,errors:p,componentIdPrefix:"mlflow.gateway.edit-api-key-modal",hideNameField:!0})]})}):null};var ce=l(39595);const ue=({open:e,secret:n,endpoints:l,onClose:a,onSuccess:s})=>{const{theme:d}=(0,i.u)(),{mutateAsync:r}=(()=>{const e=(0,ce.jE)();return(0,ie.n)({mutationFn:e=>f.t.deleteSecret(e),onSuccess:()=>{e.invalidateQueries(["gateway_secrets"])}})})(),c=l.length>0;if(!n)return null;return(0,D.Y)(W.A,{open:e,onClose:a,onConfirm:async()=>{n&&(await r(n.secret_id),null===s||void 0===s||s())},title:"Delete API Key",itemName:n.secret_name,itemType:"API key",componentIdPrefix:"mlflow.gateway.delete-api-key-modal",requireConfirmation:c,warningMessage:c?(0,D.Y)(t.A,{id:"jzNMBH",defaultMessage:"This key is currently in use. After deleting, you will need to attach a different API key to continue using the endpoints currently using this key."}):void 0,additionalContent:(()=>{if(c)return(0,D.FD)("div",{children:[(0,D.Y)(i.T.Text,{color:"secondary",children:(0,D.Y)(t.A,{id:"cAujuc",defaultMessage:"Endpoints using this key ({count})",values:{count:l.length}})}),(0,D.Y)("div",{css:(0,o.AH)({marginTop:d.spacing.xs,maxHeight:120,overflowY:"auto",border:`1px solid ${d.colors.borderDecorative}`,borderRadius:d.general.borderRadiusBase},""),children:l.map(e=>{var n;const l=null===(n=e.model_mappings)||void 0===n?void 0:n.map(e=>{var n;return null===(n=e.model_definition)||void 0===n?void 0:n.model_name}).filter(Boolean).join(", ");return(0,D.FD)("div",{css:(0,o.AH)({padding:`${d.spacing.xs}px ${d.spacing.sm}px`,borderBottom:`1px solid ${d.colors.borderDecorative}`,"&:last-child":{borderBottom:"none"}},""),children:[(0,D.Y)(i.T.Text,{css:(0,o.AH)({fontSize:d.typography.fontSizeSm},""),children:e.name||e.endpoint_id}),l&&(0,D.Y)(i.T.Text,{color:"secondary",css:(0,o.AH)({display:"block",fontSize:d.typography.fontSizeSm},""),children:l})]},e.endpoint_id)})})]})})()})};var me={name:"1fttcpj",styles:"display:flex;flex-direction:column"};const pe=({open:e,secret:n,onClose:l,onEdit:s,onDelete:d})=>{const{theme:r}=(0,i.u)(),{formatMessage:m}=(0,c.A)(),p=(0,u.useCallback)(e=>{e||l()},[l]),g=(0,u.useCallback)(()=>{n&&s&&(l(),s(n))},[n,s,l]),h=(0,u.useCallback)(()=>{n&&d&&(l(),d(n))},[n,d,l]);return(0,D.Y)(a.Drawer.Root,{modal:!0,open:e,onOpenChange:p,children:(0,D.FD)(a.Drawer.Content,{componentId:"mlflow.gateway.api-key-details.drawer",width:480,title:(0,D.FD)("span",{css:(0,o.AH)({display:"inline-flex",alignItems:"center",gap:r.spacing.sm},""),children:[(0,D.Y)("span",{css:(0,o.AH)({borderRadius:r.borders.borderRadiusSm,background:r.colors.actionDefaultBackgroundHover,padding:r.spacing.xs,color:r.colors.blue500,height:"min-content",display:"flex",alignItems:"center",justifyContent:"center"},""),children:(0,D.Y)(a.KeyIcon,{})}),(0,D.Y)(t.A,{id:"DMKCLJ",defaultMessage:"API Key Details"})]}),children:[(0,D.Y)(j.S,{size:"md"}),n&&(0,D.FD)("div",{css:me,children:[(0,D.Y)(ee,{secret:n,showCard:!1}),(0,D.FD)("div",{css:(0,o.AH)({marginTop:r.spacing.lg,display:"flex",gap:r.spacing.sm},""),children:[(0,D.Y)(i.B,{componentId:"mlflow.gateway.api-key-details.drawer.edit-button",icon:(0,D.Y)(a.PencilIcon,{}),onClick:g,"aria-label":m({id:"ZAqdq9",defaultMessage:"Edit API key"}),children:(0,D.Y)(t.A,{id:"8iJrii",defaultMessage:"Edit API Key"})}),(0,D.Y)(i.B,{componentId:"mlflow.gateway.api-key-details.drawer.delete-button",danger:!0,icon:(0,D.Y)(a.TrashIcon,{}),onClick:h,"aria-label":m({id:"cGGc0A",defaultMessage:"Delete API key"}),children:(0,D.Y)(t.A,{id:"T6s9Mi",defaultMessage:"Delete API Key"})})]})]})]})})};var ge=l(91105),he=l(29447);var fe={name:"ti75j2",styles:"margin:0"};const ve=({open:e,keyName:n,endpoints:l,onClose:s})=>{const{theme:d}=(0,i.u)(),r=(0,c.A)();return(0,D.Y)(a.Drawer.Root,{modal:!0,open:e,onOpenChange:e=>{e||s()},children:(0,D.FD)(a.Drawer.Content,{componentId:"mlflow.gateway.endpoints-using-key.drawer",width:480,title:(0,D.Y)(i.T.Title,{level:3,css:fe,children:(0,D.Y)(t.A,{id:"KObL+y",defaultMessage:"Endpoints ({count})",values:{count:l.length}})}),children:[(0,D.Y)(j.S,{size:"md"}),0===l.length?(0,D.Y)(a.Empty,{description:(0,D.Y)(t.A,{id:"yQkV88",defaultMessage:"No endpoints are using this key"})}):(0,D.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:d.spacing.md},""),children:[(0,D.Y)(i.T.Text,{color:"secondary",children:(0,D.Y)(t.A,{id:"Hn1aOC",defaultMessage:"Endpoints using key: {name}",values:{name:n}})}),(0,D.Y)("div",{css:(0,o.AH)({border:`1px solid ${d.colors.borderDecorative}`,borderRadius:d.general.borderRadiusBase,overflow:"hidden"},""),children:l.map((e,n)=>(0,D.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:d.spacing.xs,padding:d.spacing.sm,borderBottom:n<l.length-1?`1px solid ${d.colors.borderDecorative}`:"none"},""),children:[(0,D.Y)(ge.N_,{to:he.Ay.getEndpointDetailsRoute(e.endpoint_id),css:(0,o.AH)({color:d.colors.actionPrimaryBackgroundDefault,textDecoration:"none",fontWeight:d.typography.typographyBoldFontWeight,"&:hover":{textDecoration:"underline"}},""),children:e.name||e.endpoint_id}),e.model_mappings&&e.model_mappings.length>0&&(0,D.Y)("div",{css:(0,o.AH)({display:"flex",flexWrap:"wrap",gap:d.spacing.xs,color:d.colors.textSecondary,fontSize:d.typography.fontSizeSm},""),children:e.model_mappings.map((n,l)=>{var o,i;return(0,D.FD)("span",{children:[null!==(o=null===(i=n.model_definition)||void 0===i?void 0:i.model_name)&&void 0!==o?o:"Unknown model",l<e.model_mappings.length-1&&","]},n.mapping_id)})}),(0,D.Y)("span",{css:(0,o.AH)({color:d.colors.textSecondary,fontSize:d.typography.fontSizeSm},""),children:(0,D.Y)(t.A,{id:"NV7Fz+",defaultMessage:"Created {date}",values:{date:r.formatDate(new Date(e.created_at),{year:"numeric",month:"short",day:"numeric"})}})})]},e.endpoint_id))})]})]})})};const ye=e=>"scorer_job"===e?"Scorer Job":e;var Ce={name:"ti75j2",styles:"margin:0"};const be=({open:e,bindings:n,endpoints:l,onClose:s})=>{const{theme:d}=(0,i.u)(),r=(0,c.A)(),m=e=>{var n;return(null===(n=l.find(n=>n.endpoint_id===e))||void 0===n?void 0:n.name)||e},p=(0,u.useMemo)(()=>{const e=new Map;return n.forEach(n=>{const l=e.get(n.resource_type)||[];e.set(n.resource_type,[...l,n])}),e},[n]),g=e=>(0,D.FD)(i.T.Text,{bold:!0,children:[ye(e.resource_type)," ",e.resource_id]});return(0,D.Y)(a.Drawer.Root,{modal:!0,open:e,onOpenChange:e=>{e||s()},children:(0,D.FD)(a.Drawer.Content,{componentId:"mlflow.gateway.bindings-using-key.drawer",width:480,title:(0,D.Y)(i.T.Title,{level:3,css:Ce,children:(0,D.Y)(t.A,{id:"PMaJHI",defaultMessage:"Used by ({count})",values:{count:n.length}})}),children:[(0,D.Y)(j.S,{size:"md"}),0===n.length?(0,D.Y)(a.Empty,{description:(0,D.Y)(t.A,{id:"hvImg5",defaultMessage:"No resources are using this key"})}):(0,D.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:d.spacing.md},""),children:[(0,D.Y)(i.T.Text,{color:"secondary",children:(0,D.Y)(t.A,{id:"cHV5jh",defaultMessage:"Resources using this key via endpoints"})}),Array.from(p.entries()).map(([e,n])=>(0,D.FD)("div",{children:[(0,D.FD)(i.T.Text,{bold:!0,css:(0,o.AH)({marginBottom:d.spacing.sm,display:"block"},""),children:[ye(e),"s (",n.length,")"]}),(0,D.Y)("div",{css:(0,o.AH)({border:`1px solid ${d.colors.borderDecorative}`,borderRadius:d.general.borderRadiusBase,overflow:"hidden"},""),children:n.map((e,l)=>(0,D.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:d.spacing.xs,padding:d.spacing.sm,borderBottom:l<n.length-1?`1px solid ${d.colors.borderDecorative}`:"none"},""),children:[g(e),(0,D.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:d.spacing.xs},""),children:[(0,D.Y)(i.T.Text,{color:"secondary",css:(0,o.AH)({fontSize:d.typography.fontSizeSm},""),children:(0,D.Y)(t.A,{id:"pcn2Ff",defaultMessage:"via endpoint:"})}),(0,D.Y)(ge.N_,{to:he.Ay.getEndpointDetailsRoute(e.endpoint_id),css:(0,o.AH)({fontSize:d.typography.fontSizeSm,color:d.colors.actionPrimaryBackgroundDefault,textDecoration:"none","&:hover":{textDecoration:"underline"}},""),children:m(e.endpoint_id)})]}),(0,D.Y)(i.T.Text,{color:"secondary",css:(0,o.AH)({fontSize:d.typography.fontSizeSm},""),children:(0,D.Y)(t.A,{id:"aW3CeS",defaultMessage:"Bound {date}",values:{date:r.formatDate(new Date(e.created_at),{year:"numeric",month:"short",day:"numeric"})}})})]},`${e.endpoint_id}-${e.resource_type}-${e.resource_id}`))})]},e))]})]})})};var De={name:"3z2sxu",styles:"display:flex;flex-direction:column;flex:1;overflow:hidden"};var ke=(0,s.X)(d.A.mlflowServices.EXPERIMENTS,()=>{var e,n,l,s,d;const{theme:r}=(0,i.u)(),{allEndpoints:c,isCreateModalOpen:h,isDetailsDrawerOpen:f,isEditModalOpen:y,isDeleteModalOpen:C,isEndpointsDrawerOpen:b,isBindingsDrawerOpen:k,selectedSecret:Y,editingSecret:x,deleteModalData:w,endpointsDrawerData:A,bindingsDrawerData:M,handleKeyClick:S,handleEditClick:F,handleDeleteClick:_,handleEndpointsClick:T,handleBindingsClick:I,handleCreateClick:E,handleCreateModalClose:H,handleCreateSuccess:P,handleDrawerClose:B,handleDeleteFromDrawer:R,handleEditModalClose:O,handleEditSuccess:z,handleDeleteModalClose:L,handleDeleteSuccess:$,handleEndpointsDrawerClose:K,handleBindingsDrawerClose:U}=function(){const{refetch:e}=(0,m.d)(),{data:n,refetch:l}=(0,p.c)(),{data:o}=(0,g.K)(),{data:i,refetch:a}=v(),[t,s]=(0,u.useState)(!1),[d,r]=(0,u.useState)(null),[c,h]=(0,u.useState)(null),[f,y]=(0,u.useState)(null),[C,b]=(0,u.useState)(null),[D,k]=(0,u.useState)(null),Y=(0,u.useCallback)(e=>i?i.filter(n=>n.secret_id===e):[],[i]),x=(0,u.useCallback)(e=>n?n.filter(n=>{var l;return null===(l=n.model_mappings)||void 0===l?void 0:l.some(n=>{var l;return(null===(l=n.model_definition)||void 0===l?void 0:l.secret_id)===e})}):[],[n]),w=(0,u.useCallback)(e=>{if(!o||!n)return 0;const l=new Set(n.filter(n=>{var l;return null===(l=n.model_mappings)||void 0===l?void 0:l.some(n=>{var l;return(null===(l=n.model_definition)||void 0===l?void 0:l.secret_id)===e})}).map(e=>e.endpoint_id));return o.filter(e=>l.has(e.endpoint_id)).length},[o,n]),A=(0,u.useCallback)(()=>{s(!0)},[]),M=(0,u.useCallback)(()=>{s(!1)},[]),S=(0,u.useCallback)(()=>{e()},[e]),F=(0,u.useCallback)(e=>{r(e)},[]),_=(0,u.useCallback)(()=>{r(null)},[]),T=(0,u.useCallback)(e=>{h(e)},[]),I=(0,u.useCallback)(()=>{h(null)},[]),E=(0,u.useCallback)(()=>{e(),d&&c&&d.secret_id===c.secret_id&&r(null)},[e,d,c]),H=(0,u.useCallback)((e,n,l,o)=>{y({secret:e,modelDefinitions:n,endpoints:l,bindingCount:o})},[]),P=(0,u.useCallback)(e=>{const n=Y(e.secret_id),l=x(e.secret_id),o=w(e.secret_id);y({secret:e,modelDefinitions:n,endpoints:l,bindingCount:o})},[Y,x,w]),B=(0,u.useCallback)(()=>{y(null)},[]),R=(0,u.useCallback)(async()=>{await e(),await Promise.allSettled([l(),a()])},[e,l,a]),O=(0,u.useCallback)((e,n)=>{b({secret:e,endpoints:n})},[]),z=(0,u.useCallback)(()=>{b(null)},[]),L=(0,u.useCallback)((e,n)=>{k({secret:e,bindings:n})},[]),$=(0,u.useCallback)(()=>{k(null)},[]);return{allEndpoints:n,isCreateModalOpen:t,isDetailsDrawerOpen:null!==d,isEditModalOpen:null!==c,isDeleteModalOpen:null!==f,isEndpointsDrawerOpen:null!==C,isBindingsDrawerOpen:null!==D,selectedSecret:d,editingSecret:c,deleteModalData:f,endpointsDrawerData:C,bindingsDrawerData:D,handleKeyClick:F,handleEditClick:T,handleDeleteClick:H,handleEndpointsClick:O,handleBindingsClick:L,handleCreateClick:A,handleCreateModalClose:M,handleCreateSuccess:S,handleDrawerClose:_,handleDeleteFromDrawer:P,handleEditModalClose:I,handleEditSuccess:E,handleDeleteModalClose:B,handleDeleteSuccess:R,handleEndpointsDrawerClose:z,handleBindingsDrawerClose:$}}();return(0,D.FD)("div",{css:De,children:[(0,D.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:r.spacing.md,borderBottom:`1px solid ${r.colors.borderDecorative}`},""),children:[(0,D.FD)(i.T.Title,{level:3,css:(0,o.AH)({margin:0,display:"flex",alignItems:"center",gap:r.spacing.sm},""),children:[(0,D.Y)(a.KeyIcon,{}),(0,D.Y)(t.A,{id:"2PCNVS",defaultMessage:"API Keys"})]}),(0,D.Y)(i.B,{componentId:"mlflow.gateway.api-keys.create-button",type:"primary",icon:(0,D.Y)(a.PlusIcon,{}),onClick:E,children:(0,D.Y)(t.A,{id:"0sy/fq",defaultMessage:"Create API key"})})]}),(0,D.Y)("div",{css:(0,o.AH)({flex:1,overflow:"auto",padding:r.spacing.md},""),children:(0,D.Y)(N,{onKeyClick:S,onEditClick:F,onDeleteClick:_,onEndpointsClick:T,onBindingsClick:I})}),(0,D.Y)(oe,{open:h,onClose:H,onSuccess:P}),(0,D.Y)(re,{open:y,secret:x,onClose:O,onSuccess:z}),(0,D.Y)(pe,{open:f,secret:Y,onClose:B,onEdit:F,onDelete:R}),(0,D.Y)(ve,{open:b,keyName:null!==(e=null===A||void 0===A?void 0:A.secret.secret_name)&&void 0!==e?e:"",endpoints:null!==(n=null===A||void 0===A?void 0:A.endpoints)&&void 0!==n?n:[],onClose:K}),(0,D.Y)(be,{open:k,bindings:null!==(l=null===M||void 0===M?void 0:M.bindings)&&void 0!==l?l:[],endpoints:null!==c&&void 0!==c?c:[],onClose:U}),(0,D.Y)(ue,{open:C,secret:null!==(s=null===w||void 0===w?void 0:w.secret)&&void 0!==s?s:null,endpoints:null!==(d=null===w||void 0===w?void 0:w.endpoints)&&void 0!==d?d:[],onClose:L,onSuccess:$})]})})},89015:function(e,n,l){l.d(n,{K:function(){return a}});var o=l(49708),i=l(25117);const a=()=>{var e,n,l;const a=(0,o.I)(["gateway_bindings"],{queryFn:()=>i.t.listEndpointBindings(),retry:!1});return{data:null!==(e=null===(n=a.data)||void 0===n?void 0:n.bindings)&&void 0!==e?e:[],error:null!==(l=a.error)&&void 0!==l?l:void 0,isLoading:a.isLoading,refetch:a.refetch}}},93585:function(e,n,l){l.d(n,{E:function(){return m}});var o=l(68248),i=l(46709),a=l(82716),t=l(27757),s=l(66916),d=l(7655),r=l(40724),c=l(75329),u=l(73408);const m=({availableProviders:e,filter:n,onFilterChange:l,componentIdPrefix:m})=>{const{theme:p}=(0,t.u)(),g=(0,d.A)(),[h,f]=(0,i.useState)(!1),v=n.providers.length>0,y=n.providers.length,C=(0,i.useMemo)(()=>[...e].sort((e,n)=>(0,c.aU)(e).localeCompare((0,c.aU)(n))),[e]),b=(0,i.useCallback)(e=>{const o=n.providers.includes(e)?n.providers.filter(n=>n!==e):[...n.providers,e];l({...n,providers:o})},[n,l]),D=(0,i.useCallback)(e=>{e.stopPropagation(),l({providers:[]})},[l]);return(0,u.FD)(t.aw.Root,{componentId:`${m}.filter-popover`,open:h,onOpenChange:f,children:[(0,u.Y)(t.aw.Trigger,{asChild:!0,children:(0,u.Y)(t.B,{componentId:`${m}.filter-button`,endIcon:(0,u.Y)(a.ChevronDownIcon,{}),css:(0,o.AH)({border:v?`1px solid ${p.colors.actionDefaultBorderFocus} !important`:"",backgroundColor:v?`${p.colors.actionDefaultBackgroundHover} !important`:""},""),children:(0,u.FD)("div",{css:(0,o.AH)({display:"flex",gap:p.spacing.sm,alignItems:"center"},""),children:[(0,u.Y)(a.FilterIcon,{}),g.formatMessage({id:"NVsatz",defaultMessage:"Provider{count}"},{count:v?` (${y})`:""}),v&&(0,u.Y)(s.X,{css:(0,o.AH)({fontSize:12,cursor:"pointer",color:p.colors.grey400,"&:hover":{color:p.colors.grey600}},""),onClick:D})]})})}),(0,u.Y)(t.aw.Content,{align:"start",css:(0,o.AH)({padding:p.spacing.md,minWidth:200},""),children:(0,u.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:p.spacing.sm},""),children:[(0,u.Y)("div",{css:(0,o.AH)({fontWeight:p.typography.typographyBoldFontWeight,marginBottom:p.spacing.xs},""),children:(0,u.Y)(r.A,{id:"J7x8/9",defaultMessage:"Provider"})}),0===C.length?(0,u.Y)("div",{css:(0,o.AH)({color:p.colors.textSecondary,fontSize:p.typography.fontSizeSm},""),children:(0,u.Y)(r.A,{id:"9FaThs",defaultMessage:"No providers available"})}):C.map(e=>(0,u.Y)(a.Checkbox,{componentId:`${m}.filter.provider.${e}`,isChecked:n.providers.includes(e),onChange:()=>b(e),children:(0,c.aU)(e)},e))]})})]})}}}]);