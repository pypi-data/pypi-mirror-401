"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[9847],{5857:function(e,t,n){n.d(t,{O:function(){return i},n:function(){return r}});var a=n(46709),o=n(91105);const i="selectedDatasetId",r=()=>{var e;const[t,n]=(0,o.ok)();return[null!==(e=t.get(i))&&void 0!==e?e:void 0,(0,a.useCallback)(e=>{n(t=>e?(t.set(i,e),t):(t.delete(i),t),{replace:!0})},[n]),(0,a.useCallback)(()=>{n(e=>(e.delete(i),e),{replace:!0})},[n])]}},29774:function(e,t,n){n.d(t,{Au:function(){return s},tF:function(){return l}});var a=n(46709),o=n(36476),i=n(73408);const r=(0,a.createContext)({currentUserActionError:null,handleError:()=>{},handlePromise:()=>{},clearUserActionError:()=>{}}),s=({children:e,errorFilter:t})=>{const[n,s]=(0,a.useState)(null),l=(0,a.useCallback)((e,n)=>{if(null===t||void 0===t||!t(e)){const t=(0,o.a$)(e);s(t),n&&n(t)}},[s,t]),d=(0,a.useCallback)(e=>{e.catch(e=>{l(e)})},[l]),c=(0,a.useCallback)(()=>{s(null)},[s]);return(0,i.Y)(r.Provider,{value:(0,a.useMemo)(()=>({currentUserActionError:n,handleError:l,handlePromise:d,clearUserActionError:c}),[c,n,l,d]),children:e})},l=()=>{const{currentUserActionError:e,handleError:t,handlePromise:n,clearUserActionError:o}=(0,a.useContext)(r),i=(0,a.useCallback)((e,n,a)=>{t(n,a)},[t]);return(0,a.useMemo)(()=>({currentUserActionError:e,handleError:t,handleErrorWithEvent:i,handlePromise:n,clearUserActionError:o}),[o,t,n,e,i])}},29847:function(e,t,n){n.r(t),n.d(t,{default:function(){return De}});var a=n(68248),o=n(27757),i=n(25637),r=n(42595),s=n(46709),l=n(91105),d=n(59930),c=n.n(d),u=n(82716),m=n(66916),h=n(42747),p=n(43617),g=n(90061),f=n(76256),v=n(73408);var x={name:"y1ecum",styles:"text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex-shrink:1"};var w=n(79081),b=n(11522);var y=n(40724),Y=n(34599),D=n(61077),S=n(39595),C=n(61060);var I={name:"1hcx8jb",styles:"padding:0"},M={name:"1r962iv",styles:"padding:4px"};var F=n(12998);var P={name:"1tzoh5y",styles:"width:fit-content;max-width:100%;cursor:pointer"},T={name:"hdknak",styles:"display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap"};var k=n(76118),z=n(52849),R=n(32874);const A="dataset_id",_="name",E="last_update_time",L="actions",H=[A,_,E,L],N=[L],K=[{id:A,accessorKey:"dataset_id",header:"Dataset ID",enableSorting:!1,cell:({row:e})=>{const t=e.original.dataset_id,{copy:n,tooltipOpen:a,tooltipMessage:o,handleTooltipOpenChange:i}=(0,F.Ld)(t,"Click to copy");return(0,v.Y)(w.T,{content:o,open:a,onOpenChange:i,componentId:"mlflow.eval-datasets.dataset-id-tooltip",children:(0,v.Y)(u.Tag,{css:P,componentId:"mlflow.eval-datasets.dataset-id",color:"indigo",onClick:n,children:(0,v.Y)("span",{css:T,children:t})})})}},{id:_,accessorKey:"name",header:"Name",enableSorting:!0,cell:({row:e})=>{const{theme:t}=(0,o.u)();return(0,v.Y)("div",{css:(0,a.AH)({overflow:"hidden",display:"flex",alignItems:"center",gap:t.spacing.xs},""),children:(0,v.Y)(o.T.Link,{css:x,componentId:"mlflow.eval-datasets.dataset-name-cell",children:e.original.name})})}},{id:E,accessorKey:"last_update_time",accessorFn:e=>e.last_update_time?new Date(e.last_update_time).getTime():0,header:"Updated At",enableSorting:!0,size:150,maxSize:150,cell:({row:e})=>e.original.last_update_time?(0,v.Y)(w.T,{content:new Date(e.original.last_update_time).toLocaleString(),componentId:"mlflow.eval-datasets.last-updated-cell-tooltip",children:(0,v.Y)("span",{children:b.A.timeSinceStr(e.original.last_update_time)})}):(0,v.Y)("span",{children:"-"})},{id:"created_time",accessorKey:"created_time",accessorFn:e=>e.created_time?new Date(e.created_time).getTime():0,header:"Created At",enableSorting:!0,cell:({row:e})=>new Date(e.original.created_time).toLocaleString()},{id:"created_by",accessorKey:"created_by",header:"Created By",enableSorting:!0},{id:"source_type",accessorKey:"source_type",header:"Source Type",enableSorting:!0},{id:"actions",header:"",enableSorting:!1,size:36,maxSize:36,cell:({row:e})=>{const t=(0,S.jE)(),{deleteEvaluationDatasetMutation:n,isLoading:a}=(({onSuccess:e,onError:t})=>{const n=(0,S.jE)(),{mutate:a,isLoading:o}=(0,C.n)({mutationFn:async({datasetId:e})=>{await(0,D.ff)((0,D.we)(`ajax-api/3.0/mlflow/datasets/${e}`),"DELETE")},onSuccess:()=>{n.invalidateQueries({queryKey:[Y.P4]}),null===e||void 0===e||e()},onError:e=>{null===t||void 0===t||t(e)}});return{deleteEvaluationDatasetMutation:a,isLoading:o}})({onSuccess:()=>{t.invalidateQueries({queryKey:[Y.P4]})}}),i=(0,s.useCallback)(()=>{n({datasetId:e.original.dataset_id})},[n,e]);return(0,v.Y)(u.TableRowAction,{css:I,children:(0,v.FD)(u.DropdownMenu.Root,{children:[(0,v.Y)(u.DropdownMenu.Trigger,{asChild:!0,children:(0,v.Y)(o.B,{componentId:"mlflow.eval-datasets.dataset-actions-menu",size:"small",icon:(0,v.Y)(u.OverflowIcon,{}),"aria-label":"Dataset actions",css:M})}),(0,v.Y)(u.DropdownMenu.Content,{align:"end",children:(0,v.FD)(u.DropdownMenu.Item,{componentId:"mlflow.eval-datasets.delete-dataset-menu-option",disabled:a,onClick:e=>{e.stopPropagation(),e.preventDefault(),i()},children:[(0,v.Y)(u.DropdownMenu.IconWrapper,{children:(0,v.Y)(u.TrashIcon,{})}),(0,v.Y)(y.A,{id:"cMRvTA",defaultMessage:"Delete dataset"}),a&&(0,v.Y)(u.DropdownMenu.HintColumn,{children:(0,v.Y)(o.S,{})})]})})]})})}}],B=s.memo(({row:e,isActive:t,onSelectDataset:n})=>{const{theme:i}=(0,o.u)();return(0,v.Y)(u.TableRow,{className:"eval-datasets-table-row",onClick:()=>n(e.original),children:e.getVisibleCells().map(e=>(0,v.Y)(u.TableCell,{css:(0,a.AH)({backgroundColor:t?i.colors.actionDefaultBackgroundHover:"transparent",width:e.column.columnDef.size?`${e.column.columnDef.size}px`:"auto",maxWidth:e.column.columnDef.maxSize?`${e.column.columnDef.maxSize}px`:"auto",minWidth:e.column.columnDef.minSize?`${e.column.columnDef.minSize}px`:"auto",..."actions"===e.column.id&&{paddingLeft:0,paddingRight:0}},""),children:(0,p.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)},(e,t)=>e.isActive===t.isActive&&(0,k.isEqual)(e.columnVisibility,t.columnVisibility));var O={name:"10jtkcq",styles:"display:flex;flex-direction:column;width:100%;height:100%"},$={name:"82a6rk",styles:"flex:1"},j={name:"1jrb16",styles:"flex:1;min-height:0;position:relative"},V={name:"13udsys",styles:"height:100%"};const q=({experimentId:e,datasets:t,isLoading:n,isFetching:i,error:r,refetch:l,fetchNextPage:d,hasNextPage:c,selectedDatasetId:x,setSelectedDatasetId:w,searchFilter:b,setSearchFilter:y})=>{const Y=(0,h.tz)(),{theme:D}=(0,o.u)(),[S,C]=(0,s.useState)([{id:"created_time",desc:!0}]),[I,M]=(0,s.useState)(K.reduce((e,t)=>{var n,a;return e[null!==(n=t.id)&&void 0!==n?n:""]=H.includes(null!==(a=t.id)&&void 0!==a?a:""),e},{})),[F,P]=(0,s.useState)(b),T=(0,f.L)("mlflow/server/js/src/experiment-tracking/pages/experiment-evaluation-datasets/components/ExperimentEvaluationDatasetsListTable.tsx",{columns:K,data:null!==t&&void 0!==t?t:[],getCoreRowModel:(0,g.HT)(),getRowId:e=>e.dataset_id,enableSorting:!0,onSortingChange:C,getSortedRowModel:(0,g.h5)(),enableColumnResizing:!1,state:{sorting:S,columnVisibility:I}}),k=(0,z.v)({isFetching:i,hasNextPage:null!==c&&void 0!==c&&c,fetchNextPage:d});return r?(0,v.Y)("div",{children:"Error loading datasets"}):(0,v.FD)("div",{css:O,children:[(0,v.FD)("div",{css:(0,a.AH)({display:"flex",gap:D.spacing.sm,alignItems:"center",marginBottom:D.spacing.sm},""),children:[(0,v.Y)(m.I,{allowClear:!0,placeholder:"Search by dataset name",value:F,onChange:e=>{P(e.target.value),e.target.value||y(e.target.value)},onClear:()=>{P(""),y("")},onPressEnter:()=>y(F),componentId:"mlflow.eval-datasets.search-input",css:$,prefix:(0,v.Y)(m.S,{})}),(0,v.FD)("div",{css:(0,a.AH)({display:"flex",alignItems:"center",marginRight:D.spacing.sm},""),children:[(0,v.Y)(o.B,{icon:(0,v.Y)(u.RefreshIcon,{}),disabled:i,onClick:()=>l(),componentId:"mlflow.eval-datasets.table-refresh-button"}),(0,v.FD)(u.DropdownMenu.Root,{children:[(0,v.Y)(u.DropdownMenu.Trigger,{asChild:!0,children:(0,v.Y)(o.B,{icon:(0,v.Y)(u.ColumnsIcon,{}),componentId:"mlflow.eval-datasets.table-column-selector-button"})}),(0,v.Y)(u.DropdownMenu.Content,{children:K.map(e=>{var t,n,a,i;return!N.includes(null!==(t=e.id)&&void 0!==t?t:"")&&(0,v.FD)(u.DropdownMenu.CheckboxItem,{componentId:"mlflow.eval-datasets.table-column-selector-checkbox",checked:null!==(a=I[null!==(i=e.id)&&void 0!==i?i:""])&&void 0!==a&&a,onCheckedChange:t=>{var n;return M({...I,[null!==(n=e.id)&&void 0!==n?n:""]:t})},children:[(0,v.Y)(u.DropdownMenu.ItemIndicator,{}),(0,v.Y)(o.T.Text,{children:e.header})]},null!==(n=e.id)&&void 0!==n?n:"")})})]})]})]}),(0,v.Y)(R.Z,{experimentId:e}),(0,v.Y)("div",{css:j,children:(0,v.FD)(u.Table,{css:V,empty:n||i||0!==t.length?void 0:(0,v.Y)(u.Empty,{description:Y.formatMessage({id:"F4K195",defaultMessage:"No evaluation datasets found"})}),onScroll:e=>k(e.currentTarget),scrollable:!0,children:[(0,v.Y)(u.TableRow,{isHeader:!0,children:T.getLeafHeaders().map(e=>(0,v.Y)(u.TableHeader,{sortable:e.column.getCanSort(),sortDirection:e.column.getIsSorted(),onToggleSort:e.column.getToggleSortingHandler(),componentId:"mlflow.eval-datasets.column-header",header:e,column:e.column,css:(0,a.AH)({width:e.column.columnDef.size?`${e.column.columnDef.size}px`:"auto",maxWidth:e.column.columnDef.maxSize?`${e.column.columnDef.maxSize}px`:"auto",minWidth:e.column.columnDef.minSize?`${e.column.columnDef.minSize}px`:"auto",cursor:e.column.getCanSort()?"pointer":"default"},""),children:(0,p.Kv)(e.column.columnDef.header,e.getContext())},e.id))}),!n&&T.getRowModel().rows.map(e=>(0,v.Y)(B,{row:e,columnVisibility:I,isActive:e.original.dataset_id===x,onSelectDataset:e=>w(e.dataset_id)},e.id)),(n||i)&&(0,v.Y)(u.TableSkeletonRows,{table:T})]})})]})};var U=n(96584),W=n(181);var J=n(7655);const Q=({text:e,searchFilter:t,theme:n})=>{const o=(0,s.useMemo)(()=>{if(!t.trim())return[e];const o=new RegExp(`(${(0,k.escapeRegExp)(t)})`,"gi"),i=e.split(o),r=n.isDarkMode?n.colors.blue800:n.colors.blue100;return i.map((e,n)=>e.toLowerCase()===t.toLowerCase()?(0,v.Y)("span",{css:(0,a.AH)({backgroundColor:r},""),children:e},n):e)},[e,t,n]);return(0,v.Y)(v.FK,{children:o})},Z=({cell:e,table:{options:t}})=>{var n,i;const{theme:r}=(0,o.u)(),l=e.getValue(),d=void 0!==l?JSON.stringify(l,null,2):"",c=null===t||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.rowSize,u=(null===t||void 0===t||null===(i=t.meta)||void 0===i?void 0:i.searchFilter)||"",m=(0,s.useMemo)(()=>d?d.split("\n").length:1,[d]);(0,s.useMemo)(()=>Math.min(Math.max(m+1,3),20),[m]);return(0,v.Y)("div",{css:(0,a.AH)({overflow:"hidden",display:"flex",alignItems:"center",gap:r.spacing.xs,flex:1},""),children:"sm"===c?(0,v.Y)("code",{css:(0,a.AH)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:`${r.typography.fontSizeSm}px !important`,margin:"0 !important"},""),children:d}):(0,v.Y)("div",{css:(0,a.AH)({overflow:"auto",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word",resize:"vertical",width:"100%",border:`1px solid ${r.colors.border}`,padding:r.spacing.xs,backgroundColor:r.colors.backgroundSecondary,fontSize:`${r.typography.fontSizeSm}px`,maxHeight:r.typography.fontSizeLg*("md"===c?10:20)},""),children:(0,v.Y)(Q,{text:d,searchFilter:u,theme:r})})})};var G={name:"1cl2a0e",styles:"display:flex;align-items:flex-start;justify-content:space-between"},X={name:"1ap1kl4",styles:"max-width:540px;flex:1"};const ee=({dataset:e,datasetRecords:t,columns:n,columnVisibility:i,setColumnVisibility:r,rowSize:s,setRowSize:l,searchFilter:d,setSearchFilter:c})=>{const{theme:h}=(0,o.u)(),p=null===e||void 0===e?void 0:e.name,g=(e=>{var t;if(!e)return;const n=(0,W.pt)(e);return null!==(t=null===n||void 0===n?void 0:n.num_records)&&void 0!==t?t:void 0})(null===e||void 0===e?void 0:e.profile),f=t.length;return(0,v.FD)("div",{css:(0,a.AH)({display:"flex",flexDirection:"column",gap:h.spacing.sm,marginBottom:h.spacing.sm},""),children:[(0,v.FD)("div",{css:G,children:[(0,v.FD)("div",{css:(0,a.AH)({display:"flex",flexDirection:"column",paddingLeft:h.spacing.sm,paddingRight:h.spacing.sm},""),children:[(0,v.Y)(o.T.Title,{level:3,withoutMargins:!0,children:p}),(0,v.Y)(o.T.Text,{color:"secondary",size:"sm",children:(0,v.Y)(y.A,{id:"crmbMK",defaultMessage:"Displaying {loadedRecordsCount} of {totalRecordsCount, plural, =1 {1 record} other {# records}}",values:{loadedRecordsCount:null!==f&&void 0!==f?f:0,totalRecordsCount:null!==g&&void 0!==g?g:0}})})]}),(0,v.FD)("div",{css:(0,a.AH)({display:"flex",alignItems:"flex-start",gap:h.spacing.xs},""),children:[(0,v.FD)(u.DropdownMenu.Root,{children:[(0,v.Y)(u.DropdownMenu.Trigger,{asChild:!0,children:(0,v.Y)(o.B,{componentId:"mlflow.eval-datasets.records-toolbar.row-size-toggle",icon:(0,v.Y)(u.RowsIcon,{})})}),(0,v.Y)(u.DropdownMenu.Content,{align:"end",children:(0,v.FD)(u.DropdownMenu.RadioGroup,{componentId:"mlflow.eval-datasets.records-toolbar.row-size-radio",value:s,onValueChange:e=>l(e),children:[(0,v.Y)(u.DropdownMenu.Label,{children:(0,v.Y)(o.T.Text,{color:"secondary",children:(0,v.Y)(y.A,{id:"DcGPfO",defaultMessage:"Row height"})})}),(0,v.FD)(u.DropdownMenu.RadioItem,{value:"sm",children:[(0,v.Y)(u.DropdownMenu.ItemIndicator,{}),(0,v.Y)(o.T.Text,{children:(0,v.Y)(y.A,{id:"ZNyTjg",defaultMessage:"Small"})})]},"sm"),(0,v.FD)(u.DropdownMenu.RadioItem,{value:"md",children:[(0,v.Y)(u.DropdownMenu.ItemIndicator,{}),(0,v.Y)(o.T.Text,{children:(0,v.Y)(y.A,{id:"fcIHyN",defaultMessage:"Medium"})})]},"md"),(0,v.FD)(u.DropdownMenu.RadioItem,{value:"lg",children:[(0,v.Y)(u.DropdownMenu.ItemIndicator,{}),(0,v.Y)(o.T.Text,{children:(0,v.Y)(y.A,{id:"xgbeVS",defaultMessage:"Large"})})]},"lg")]})})]}),(0,v.FD)(u.DropdownMenu.Root,{children:[(0,v.Y)(u.DropdownMenu.Trigger,{asChild:!0,children:(0,v.Y)(o.B,{componentId:"mlflow.eval-datasets.records-toolbar.columns-toggle",icon:(0,v.Y)(u.ColumnsIcon,{})})}),(0,v.Y)(u.DropdownMenu.Content,{children:n.map(e=>{var t,n;return(0,v.FD)(u.DropdownMenu.CheckboxItem,{componentId:"mlflow.eval-datasets.records-toolbar.column-checkbox",checked:null!==(t=i[null!==(n=e.id)&&void 0!==n?n:""])&&void 0!==t&&t,onCheckedChange:t=>{var n;return r({...i,[null!==(n=e.id)&&void 0!==n?n:""]:t})},children:[(0,v.Y)(u.DropdownMenu.ItemIndicator,{}),(0,v.Y)(o.T.Text,{children:e.header})]},e.id)})})]})]})]}),(0,v.Y)("div",{css:(0,a.AH)({paddingLeft:h.spacing.sm,paddingRight:h.spacing.sm},""),children:(0,v.Y)(m.I,{componentId:"mlflow.eval-datasets.records-toolbar.search-input",prefix:(0,v.Y)(m.S,{}),placeholder:"Search inputs and expectations",value:d,onChange:e=>c(e.target.value),css:X})})]})};const te="inputs",ne="outputs",ae="expectations",oe=[{id:te,accessorKey:"inputs",header:"Inputs",enableResizing:!1,cell:Z},{id:ne,accessorKey:"outputs",header:"Outputs",enableResizing:!1,cell:Z},{id:ae,accessorKey:"expectations",header:"Expectations",enableResizing:!1,cell:Z}];var ie={name:"1w4ngjc",styles:"flex:1;min-height:0;position:relative;overflow:hidden;display:flex;flex-direction:column"},re={name:"82a6rk",styles:"flex:1"},se={name:"1w2a2xb",styles:"position:sticky;top:0;z-index:1"};const le=({dataset:e})=>{const t=(0,J.A)(),n=e.dataset_id,[a,o]=(0,s.useState)("md"),[i,r]=(0,s.useState)(""),[l,d]=(0,s.useState)({[te]:!0,[ne]:!1,[ae]:!0}),{data:c,isLoading:m,isFetching:h,error:x,fetchNextPage:w,hasNextPage:b}=(({datasetId:e,enabled:t=!0})=>{const{data:n,fetchNextPage:a,hasNextPage:o,isLoading:i,isFetching:r,refetch:l,error:d}=(0,U.q)({queryKey:[Y.uz,e],queryFn:async({queryKey:[,e],pageParam:t})=>{const n=new URLSearchParams;return n.set("dataset_id",e),n.set("max_results",50..toString()),t&&n.set("page_token",null!==t&&void 0!==t?t:""),await(0,D.ff)((0,D.we)(`ajax-api/3.0/mlflow/datasets/${e}/records?${n.toString()}`),"GET")},cacheTime:0,refetchOnWindowFocus:!1,retry:!1,enabled:t,getNextPageParam:e=>e.next_page_token});return{data:(0,s.useMemo)(()=>{var e;return null!==(e=null===n||void 0===n?void 0:n.pages.flatMap(e=>(0,W.pt)(e.records)))&&void 0!==e?e:[]},[n]),fetchNextPage:a,hasNextPage:o,isLoading:i,isFetching:r,refetch:l,error:d}})({datasetId:null!==n&&void 0!==n?n:"",enabled:!!n}),y=(0,z.v)({isFetching:h,hasNextPage:null!==b&&void 0!==b&&b,fetchNextPage:w}),S=(0,s.useMemo)(()=>{if(!i.trim())return null!==c&&void 0!==c?c:[];const e=i.toLowerCase();return(null!==c&&void 0!==c?c:[]).filter(t=>{if(JSON.stringify(t.inputs||{}).toLowerCase().includes(e))return!0;return!!JSON.stringify(t.expectations||{}).toLowerCase().includes(e)})},[c,i]);(0,s.useEffect)(()=>{if(!i.trim()||h||!b)return;const e="sm"===a?20:"md"===a?10:5;S.length<e&&w()},[S.length,i,h,b,w,a]);const C=(0,f.L)("mlflow/server/js/src/experiment-tracking/pages/experiment-evaluation-datasets/components/ExperimentEvaluationDatasetRecordsTable.tsx",{columns:oe,data:S,getCoreRowModel:(0,g.HT)(),getRowId:e=>e.dataset_record_id,enableColumnResizing:!1,meta:{rowSize:a,searchFilter:i},state:{columnVisibility:l}});return(0,v.FD)("div",{css:ie,children:[(0,v.Y)(ee,{dataset:e,datasetRecords:null!==c&&void 0!==c?c:[],columns:oe,columnVisibility:l,setColumnVisibility:d,rowSize:a,setRowSize:o,searchFilter:i,setSearchFilter:r}),(0,v.FD)(u.Table,{css:re,empty:m||0!==C.getRowModel().rows.length?void 0:(0,v.Y)(u.Empty,{description:t.formatMessage({id:"TnD/vL",defaultMessage:"No records found"})}),scrollable:!0,onScroll:e=>y(e.currentTarget),children:[(0,v.Y)(u.TableRow,{isHeader:!0,children:C.getLeafHeaders().map(e=>e.column.getIsVisible()&&(0,v.Y)(u.TableHeader,{componentId:"mlflow.eval-dataset-records.column-header",header:e,column:e.column,css:se,children:(0,p.Kv)(e.column.columnDef.header,e.getContext())},e.id))}),C.getRowModel().rows.map(e=>(0,v.Y)(u.TableRow,{children:e.getVisibleCells().map(e=>(0,v.Y)(u.TableCell,{children:(0,p.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)),(m||h)&&(0,v.Y)(u.TableSkeletonRows,{table:C})]})]})};var de=n(29774),ce=n(89949);var ue={name:"1vfb318",styles:"flex:1;display:flex;align-items:center;justify-content:center"};const me=({error:e})=>{var t;return(0,v.Y)(u.PageWrapper,{css:ue,children:(0,v.Y)(u.Empty,{"data-testid":"fallback",title:(0,v.Y)(y.A,{id:"WtUqxc",defaultMessage:"Error"}),description:null!==(t=null===e||void 0===e?void 0:e.message)&&void 0!==t?t:(0,v.Y)(y.A,{id:"9J8zoa",defaultMessage:"An error occurred while rendering this component."}),image:(0,v.Y)(o.k,{})})})},he=({children:e,resetKey:t})=>(0,v.Y)(ce.tH,{FallbackComponent:me,resetKeys:[t],children:(0,v.Y)(de.Au,{children:e})});var pe=n.p+"static/media/eval-datasets-empty.16c4b3426c8a8c4a9defc41bfb653504.svg";var ge={name:"xvginl",styles:"max-width:600px"};const fe=({experimentId:e})=>{const{theme:t}=(0,o.u)();return(0,v.FD)("div",{css:(0,a.AH)({display:"flex",flex:1,flexDirection:"column",justifyContent:"center",alignItems:"center",padding:t.spacing.md},""),children:[(0,v.Y)(o.T.Title,{level:3,color:"secondary",children:(0,v.Y)(y.A,{id:"c1jD8u",defaultMessage:"Create an evaluation dataset"})}),(0,v.Y)(o.T.Paragraph,{color:"secondary",css:ge,children:(0,v.Y)(y.A,{id:"BMUd0e",defaultMessage:"Create evaluation datasets in order to iteratively evaluate and improve your app. For example, build a dataset from production traces with negative feedback. {learnMoreLink}",values:{learnMoreLink:(0,v.Y)(o.T.Link,{componentId:"mlflow.eval-datasets.learn-more-link",href:"https://mlflow.org/docs/latest/genai/datasets/",openInNewTab:!0,children:(0,v.Y)(y.A,{id:"izS5yQ",defaultMessage:"Learn more"})})}})}),(0,v.Y)("img",{css:(0,a.AH)({marginBottom:t.spacing.md,maxWidth:"min(100%, 600px)"},""),src:pe,alt:"No datasets found"}),(0,v.Y)(R.Z,{experimentId:e})]})};var ve=n(5857),xe=n(72607);var we={name:"1h0bf8r",styles:"body, :host{user-select:none;}"},be={name:"n56zw6",styles:"display:flex;flex-direction:row;flex:1;min-height:0px"},ye={name:"5ob2ly",styles:"display:flex;position:relative"};const Ye=()=>{const{experimentId:e}=(0,l.g)(),{theme:t}=(0,o.u)(),[n,d]=(0,s.useState)(400),[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),[g,f]=(0,ve.n)(),[x,w]=(0,s.useState)("");c()(e,"Experiment ID must be defined");const{data:b,isLoading:y,isFetching:Y,error:D,refetch:S,fetchNextPage:C,hasNextPage:I}=(0,xe.J)({experimentId:e,nameFilter:x}),M=(0,s.useMemo)(()=>{var e;return null!==(e=null===b||void 0===b?void 0:b.map(e=>e.dataset_id))&&void 0!==e?e:[]},[b]);(0,s.useEffect)(()=>{null===b||void 0===b||!b.length||g&&M.includes(g)||f(b[0].dataset_id)},[b,g,M,f]);const F=(0,s.useMemo)(()=>{if(null!==b&&void 0!==b&&b.length&&g)return b.find(e=>e.dataset_id===g)},[b,g]);return(0,v.FD)("div",{css:be,children:[(0,v.Y)(i.ResizableBox,{css:ye,style:{flex:`0 0 ${h?0:n}px`},width:n,axis:"x",resizeHandles:["e"],minConstraints:[250,0],handle:(0,v.Y)(r.z,{runListHidden:h,updateRunListHidden:()=>{p(!h)}}),onResize:(e,{size:t})=>{h||d(t.width)},onResizeStart:()=>!h&&m(!0),onResizeStop:()=>m(!1),children:(0,v.Y)("div",{css:(0,a.AH)({display:h?"none":"flex",flex:1,minWidth:0},""),children:(0,v.Y)(q,{experimentId:e,datasets:b,isLoading:y,isFetching:Y,error:D,refetch:S,fetchNextPage:C,hasNextPage:I,selectedDatasetId:g,setSelectedDatasetId:f,searchFilter:x,setSearchFilter:w})})}),(0,v.FD)("div",{css:(0,a.AH)({flex:1,display:"flex",borderLeft:`1px solid ${t.colors.border}`,minHeight:"0px",overflow:"hidden"},""),children:[!y&&!F&&(0,v.Y)(fe,{experimentId:e}),F&&(0,v.Y)(le,{dataset:F})]}),u&&(0,v.Y)(a.mL,{styles:we})]})};var De=()=>(0,v.Y)(he,{children:(0,v.Y)(Ye,{})})},32874:function(e,t,n){n.d(t,{Z:function(){return v}});var a=n(27757),o=n(82716),i=n(46709),r=n(40724),s=n(79081),l=n(66916),d=n(42747),c=n(61077),u=n(39595),m=n(61060),h=n(34599);var p=n(73408);const g=({visible:e,experimentId:t,onCancel:n})=>{const{theme:r}=(0,a.u)(),g=(0,d.tz)(),[f,v]=(0,i.useState)(""),[x,w]=(0,i.useState)(""),{createEvaluationDatasetMutation:b,isLoading:y}=(({onSuccess:e,onError:t})=>{const n=(0,u.jE)(),{mutate:a,isLoading:o}=(0,m.n)({mutationFn:async({datasetName:e,experimentIds:t})=>{const n={name:e,experiment_ids:t};return(await(0,c.ff)((0,c.we)("ajax-api/3.0/mlflow/datasets/create"),"POST",n)).dataset},onSuccess:()=>{n.invalidateQueries({queryKey:[h.P4]}),null===e||void 0===e||e()},onError:e=>{null===t||void 0===t||t(e)}});return{createEvaluationDatasetMutation:a,isLoading:o}})({onSuccess:()=>{n()}}),Y=(0,i.useCallback)(()=>{f?b({datasetName:f,experimentIds:[t]}):w(g.formatMessage({id:"sbHChH",defaultMessage:"Dataset name is required"}))},[b,t,f,g]);return(0,p.FD)(s.d,{componentId:"mlflow.create-evaluation-dataset-modal",visible:e,onCancel:n,okText:g.formatMessage({id:"creoEe",defaultMessage:"Create"}),cancelText:g.formatMessage({id:"nEnDEu",defaultMessage:"Cancel"}),onOk:Y,okButtonProps:{loading:y,disabled:!f},title:(0,p.Y)(d.sA,{id:"287Ack",defaultMessage:"Create evaluation dataset"}),zIndex:r.options.zIndexBase+20,children:[(0,p.Y)(o.FormUI.Label,{htmlFor:"dataset-name-input",children:(0,p.Y)(d.sA,{id:"xdFMIN",defaultMessage:"Dataset name"})}),(0,p.Y)(l.I,{componentId:"mlflow.create-evaluation-dataset-modal.dataset-name",id:"dataset-name-input",name:"name",type:"text",placeholder:g.formatMessage({id:"ZQpc2w",defaultMessage:"Enter dataset name"}),value:f,onChange:e=>{v(e.target.value),w("")}}),x&&(0,p.Y)(o.FormUI.Message,{type:"error",message:x})]})};var f={name:"b9l38d",styles:"width:min-content"};const v=({experimentId:e})=>{const[t,n]=(0,i.useState)(!1);return(0,p.FD)(p.FK,{children:[(0,p.Y)(a.B,{componentId:"mlflow.eval-datasets.create-dataset-button",css:f,icon:(0,p.Y)(o.DatabaseIcon,{}),onClick:()=>n(!0),children:(0,p.Y)(r.A,{id:"N7BCue",defaultMessage:"Create dataset"})}),(0,p.Y)(g,{experimentId:e,visible:t,onCancel:()=>n(!1)})]})}},34599:function(e,t,n){n.d(t,{P4:function(){return o},lA:function(){return i},uz:function(){return a}});const a="GET_DATASET_RECORDS",o="SEARCH_EVALUATION_DATASETS",i="FETCH_TRACES"},42595:function(e,t,n){n.d(t,{t:function(){return u},z:function(){return m}});var a=n(68248),o=n(27757),i=n(46709),r=n(25637),s=n(52572),l=n(73408);var d={name:"1h0bf8r",styles:"body, :host{user-select:none;}"},c={name:"5ob2ly",styles:"display:flex;position:relative"};const u=({runListHidden:e,width:t,onResize:n,children:o,onHiddenChange:u,maxWidth:h})=>{const p=(0,s.e)(),[g,f]=(0,i.useState)(!1);return(0,l.FD)(l.FK,{children:[(0,l.Y)(r.ResizableBox,{css:c,style:{flex:`0 0 ${e?0:t}px`},width:t,axis:"x",resizeHandles:["e"],minConstraints:[250,0],maxConstraints:void 0===h?void 0:[h,0],handle:(0,l.Y)(m,{runListHidden:e,updateRunListHidden:e=>{u?u(e):p(t=>({...t,runListHidden:e}))}}),onResize:(t,{size:a})=>{e||n(a.width)},onResizeStart:()=>!e&&f(!0),onResizeStop:()=>f(!1),children:o}),g&&(0,l.Y)(a.mL,{styles:d})]})},m=i.forwardRef(({updateRunListHidden:e,runListHidden:t,...n},i)=>{const{theme:r}=(0,o.u)();return(0,l.FD)("div",{ref:i,...n,css:(0,a.AH)({transition:"opacity 0.2s",width:0,overflow:"visible",height:"100%",position:"relative",zIndex:10,display:"flex",opacity:t?1:0,"&:hover":{opacity:1,".bar":{opacity:1},".button":{border:`2px solid ${r.colors.actionDefaultBorderHover}`}}},""),children:[(0,l.Y)("div",{css:(0,a.AH)({position:"absolute",left:-r.general.iconSize/2,width:r.general.iconSize,cursor:t?void 0:"ew-resize",height:"100%",top:0,bottom:0},""),children:(0,l.Y)("div",{className:"button",css:(0,a.AH)({top:"50%",transition:"border-color 0.2s",position:"absolute",width:r.general.iconSize,height:r.general.iconSize,backgroundColor:r.colors.backgroundPrimary,borderRadius:r.general.iconSize,overflow:"hidden",border:`1px solid ${r.colors.border}`,display:"flex",alignItems:"center",justifyContent:"center",zIndex:11},""),children:(0,l.Y)(o.B,{componentId:"mlflow.experiment_page.table_resizer.collapse",onClick:()=>e(!t),icon:t?(0,l.Y)(o.o,{}):(0,l.Y)(o.n,{}),size:"small"})})}),(0,l.Y)("div",{className:"bar",css:(0,a.AH)({position:"absolute",opacity:0,left:-1.5,width:3,height:"100%",top:0,bottom:0,backgroundColor:r.colors.actionPrimaryBackgroundDefault},"")})]})})},52572:function(e,t,n){n.d(t,{e:function(){return s},i:function(){return r}});var a=n(46709),o=n(73408);const i=a.createContext(e=>e),r=({children:e,setUIState:t})=>(0,o.Y)(i.Provider,{value:t,children:e}),s=()=>a.useContext(i)},52849:function(e,t,n){n.d(t,{v:function(){return o}});var a=n(46709);const o=({isFetching:e,hasNextPage:t,fetchNextPage:n})=>(0,a.useCallback)(a=>{if(a){const{scrollHeight:o,scrollTop:i,clientHeight:r}=a;o-i-r<200&&!e&&t&&n()}},[n,e,t])},59930:function(e){e.exports=function(e,t,n,a,o,i,r,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[n,a,o,i,r,s],c=0;(l=new Error(t.replace(/%s/g,function(){return d[c++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}},72607:function(e,t,n){n.d(t,{J:function(){return s}});var a=n(96584),o=n(61077),i=n(46709),r=n(34599);const s=({experimentId:e,enabled:t=!0,nameFilter:n=""})=>{const{data:s,fetchNextPage:l,hasNextPage:d,isLoading:c,isFetching:u,refetch:m,error:h}=(0,a.q)({queryKey:[r.P4,e,n],queryFn:async({queryKey:[,e,t],pageParam:n})=>{const a={experiment_ids:[e],filter_string:t?`name ILIKE '%${t}%'`:void 0,order_by:["created_time DESC"],max_results:50,page_token:n};return await(0,o.ff)((0,o.we)("ajax-api/3.0/mlflow/datasets/search"),"POST",a)},cacheTime:0,refetchOnWindowFocus:!1,retry:!1,enabled:t,getNextPageParam:e=>e.next_page_token});return{data:(0,i.useMemo)(()=>{var e;return null!==(e=null===s||void 0===s?void 0:s.pages.flatMap(e=>{var t;return null!==(t=e.datasets)&&void 0!==t?t:[]}))&&void 0!==e?e:[]},[s]),fetchNextPage:l,hasNextPage:d,isLoading:c,isFetching:u,refetch:m,error:h}}},76256:function(e,t,n){n.d(t,{L:function(){return o},S:function(){return i}});var a=n(43617);function o(e,t){return(0,a.N4)(t)}const i=a.N4},96584:function(e,t,n){n.d(t,{q:function(){return l}});var a=n(56606),o=n(23403),i=n(60783);class r extends o.${constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e,t){super.setOptions({...e,behavior:(0,i.PL)()},t)}getOptimisticResult(e){return e.behavior=(0,i.PL)(),super.getOptimisticResult(e)}fetchNextPage({pageParam:e,...t}={}){return this.fetch({...t,meta:{fetchMore:{direction:"forward",pageParam:e}}})}fetchPreviousPage({pageParam:e,...t}={}){return this.fetch({...t,meta:{fetchMore:{direction:"backward",pageParam:e}}})}createResult(e,t){var n,a,o,r,s,l;const{state:d}=e,c=super.createResult(e,t),{isFetching:u,isRefetching:m}=c,h=u&&"forward"===(null==(n=d.fetchMeta)||null==(a=n.fetchMore)?void 0:a.direction),p=u&&"backward"===(null==(o=d.fetchMeta)||null==(r=o.fetchMore)?void 0:r.direction);return{...c,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,i.rB)(t,null==(s=d.data)?void 0:s.pages),hasPreviousPage:(0,i.RQ)(t,null==(l=d.data)?void 0:l.pages),isFetchingNextPage:h,isFetchingPreviousPage:p,isRefetching:m&&!h&&!p}}}var s=n(93769);function l(e,t,n){const o=(0,a.vh)(e,t,n);return(0,s.t)(o,r)}}}]);